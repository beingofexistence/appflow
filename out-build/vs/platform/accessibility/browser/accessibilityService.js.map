{"version":3,"sources":["file:///workspace/appflow/src/vs/platform/accessibility/browser/accessibilityService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAWzF,IAAM,IAAI,GAAV,MAAM,IAAqB,SAAQ,eAAG;QAW5C,YACqB,CAAwC,EAC5C,CAAoC,EAC7B,CAA6C;YAEpE,KAAK,EAAE,CAAC;YAJ6B,MAAC,GAAD,CAAC,CAAsB;YAC3B,MAAC,GAAD,CAAC,CAAkB;YACV,MAAC,GAAD,CAAC,CAAyB;YAV3D,MAAC,wCAAoD;YAC5C,MAAC,GAAmC,IAAI,WAAG,EAAY,CAAC;YAIxD,MAAC,GAA2B,IAAI,WAAG,EAAY,CAAC;YAQlE,IAAI,CAAC,CAAC,GAAkC,mBAAG,CAAgC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAkB,CAAC;YAE3G,MAAM,gBAAgB,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAgC,GAAG,CAAC,IAAI,CAAC,uBAAuB,EAAE,CAAC,CAAC;YACzG,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAqB,wBAAwB,CAAC,CAAC,CAAC,EAAE;gBACtE,IAAI,CAAC,CAAC,oBAAoB,CAAC,6BAA6B,CAAC,EAAE;oBAC1D,gBAAgB,EAAE,CAAC;oBACnB,IAAI,CAAC,CAAC,CAAiC,IAAI,EAAE,CAAC;iBAC9C;gBACD,IAAI,CAAC,CAAC,oBAAoB,CAAC,wBAAwB,CAAC,EAAE;oBACrD,IAAI,CAAC,CAAC,GAAsB,IAAI,CAAC,CAAC,CAAqB,QAAQ,CAAC,wBAAwB,CAAC,CAAC;oBAC1F,IAAI,CAAC,CAAC,CAAyB,IAAI,EAAE,CAAC;iBACtC;YACF,CAAC,CAAC,CAAC,CAAC;YACJ,gBAAgB,EAAE,CAAC;YACnB,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,gCAAgC,CAAC,GAAG,EAAE,CAAC,gBAAgB,EAAE,CAAC,CAAC,CAAC;YAEhF,MAAM,mBAAmB,GAAG,MAAM,CAAC,UAAU,CAAC,kCAAkC,CAAC,CAAC;YAClF,IAAI,CAAC,CAAC,GAAsB,mBAAmB,CAAC,OAAO,CAAC;YACxD,IAAI,CAAC,CAAC,GAAsB,IAAI,CAAC,CAAC,CAAqB,QAAQ,CAAwB,wBAAwB,CAAC,CAAC;YAEjH,IAAI,CAAC,CAAC,CAA0B,mBAAmB,CAAC,CAAC;QACtD,CAAC;QAEO,CAAC,CAA0B,mBAAmC;YAErE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAc,YAAY,EAAE;gBACtC,kEAAkE;gBAClE,kCAAkC;gBAClC,OAAO;aACP;YAED,IAAI,CAAC,CAAC,CAAS,IAAA,SAAG,EAAmB,mBAAmB,EAAE,QAAQ,EAAE,GAAG,EAAE;gBACxE,IAAI,CAAC,CAAC,GAAsB,mBAAmB,CAAC,OAAO,CAAC;gBACxD,IAAI,IAAI,CAAC,CAAC,KAAwB,MAAM,EAAE;oBACzC,IAAI,CAAC,CAAC,CAAyB,IAAI,EAAE,CAAC;iBACtC;YACF,CAAC,CAAC,CAAC,CAAC;YAEJ,MAAM,iBAAiB,GAAG,GAAG,EAAE;gBAC9B,MAAM,MAAM,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;gBACtC,IAAI,CAAC,CAAC,CAAc,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,MAAM,CAAC,CAAC;gBACxE,IAAI,CAAC,CAAC,CAAc,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,CAAC,MAAM,CAAC,CAAC;YAC1E,CAAC,CAAC;YAEF,iBAAiB,EAAE,CAAC;YACpB,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,wBAAwB,CAAC,GAAG,EAAE,CAAC,iBAAiB,EAAE,CAAC,CAAC,CAAC;QAC1E,CAAC;QAED,IAAI,gCAAgC;YACnC,OAAO,IAAI,CAAC,CAAC,CAAiC,KAAK,CAAC;QACrD,CAAC;QAED,uBAAuB;YACtB,MAAM,MAAM,GAAG,IAAI,CAAC,CAAC,CAAqB,QAAQ,CAAC,6BAA6B,CAAC,CAAC;YAClF,OAAO,MAAM,KAAK,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,IAAI,IAAI,CAAC,CAAC,yCAAqD,CAAC,CAAC;QAC9G,CAAC;QAED,IAAI,wBAAwB;YAC3B,OAAO,IAAI,CAAC,CAAC,CAAyB,KAAK,CAAC;QAC7C,CAAC;QAED,eAAe;YACd,MAAM,MAAM,GAAG,IAAI,CAAC,CAAC,CAAoB;YACzC,OAAO,MAAM,KAAK,IAAI,IAAI,CAAC,MAAM,KAAK,MAAM,IAAI,IAAI,CAAC,CAAC,CAAoB,CAAC;QAC5E,CAAC;QAED,yBAAyB;YACxB,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAC/B,CAAC;QAED,uBAAuB;YACtB,OAAO,IAAI,CAAC,CAAC,CAAqB;QACnC,CAAC;QAED,uBAAuB,CAAC,oBAA0C;YACjE,IAAI,IAAI,CAAC,CAAC,KAAyB,oBAAoB,EAAE;gBACxD,OAAO;aACP;YAED,IAAI,CAAC,CAAC,GAAuB,oBAAoB,CAAC;YAClD,IAAI,CAAC,CAAC,CAAiC,IAAI,EAAE,CAAC;QAC/C,CAAC;QAED,KAAK,CAAC,OAAe;YACpB,IAAA,UAAG,EAAG,OAAO,CAAC,CAAC;QAChB,CAAC;KACD,CAAA;IAvGY,oBAAI;mBAAJ,IAAI;QAYd,WAAA,gBAAG,CAAA;QACH,WAAA,mBAAG,CAAA;QACH,WAAA,mBAAG,CAAA;OAdO,IAAI,CAuGhB","file":"accessibilityService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { addDisposableListener } from 'vs/base/browser/dom';\nimport { alert } from 'vs/base/browser/ui/aria/aria';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { AccessibilitySupport, CONTEXT_ACCESSIBILITY_MODE_ENABLED, IAccessibilityService } from 'vs/platform/accessibility/common/accessibility';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { ILayoutService } from 'vs/platform/layout/browser/layoutService';\n\nexport class AccessibilityService extends Disposable implements IAccessibilityService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate _accessibilityModeEnabledContext: IContextKey<boolean>;\n\tprotected _accessibilitySupport = AccessibilitySupport.Unknown;\n\tprotected readonly _onDidChangeScreenReaderOptimized = new Emitter<void>();\n\n\tprotected _configMotionReduced: 'auto' | 'on' | 'off';\n\tprotected _systemMotionReduced: boolean;\n\tprotected readonly _onDidChangeReducedMotion = new Emitter<void>();\n\n\tconstructor(\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@ILayoutService private readonly _layoutService: ILayoutService,\n\t\t@IConfigurationService protected readonly _configurationService: IConfigurationService,\n\t) {\n\t\tsuper();\n\t\tthis._accessibilityModeEnabledContext = CONTEXT_ACCESSIBILITY_MODE_ENABLED.bindTo(this._contextKeyService);\n\n\t\tconst updateContextKey = () => this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('editor.accessibilitySupport')) {\n\t\t\t\tupdateContextKey();\n\t\t\t\tthis._onDidChangeScreenReaderOptimized.fire();\n\t\t\t}\n\t\t\tif (e.affectsConfiguration('workbench.reduceMotion')) {\n\t\t\t\tthis._configMotionReduced = this._configurationService.getValue('workbench.reduceMotion');\n\t\t\t\tthis._onDidChangeReducedMotion.fire();\n\t\t\t}\n\t\t}));\n\t\tupdateContextKey();\n\t\tthis._register(this.onDidChangeScreenReaderOptimized(() => updateContextKey()));\n\n\t\tconst reduceMotionMatcher = window.matchMedia(`(prefers-reduced-motion: reduce)`);\n\t\tthis._systemMotionReduced = reduceMotionMatcher.matches;\n\t\tthis._configMotionReduced = this._configurationService.getValue<'auto' | 'on' | 'off'>('workbench.reduceMotion');\n\n\t\tthis.initReducedMotionListeners(reduceMotionMatcher);\n\t}\n\n\tprivate initReducedMotionListeners(reduceMotionMatcher: MediaQueryList) {\n\n\t\tif (!this._layoutService.hasContainer) {\n\t\t\t// we can't use `ILayoutService.container` because the application\n\t\t\t// doesn't have a single container\n\t\t\treturn;\n\t\t}\n\n\t\tthis._register(addDisposableListener(reduceMotionMatcher, 'change', () => {\n\t\t\tthis._systemMotionReduced = reduceMotionMatcher.matches;\n\t\t\tif (this._configMotionReduced === 'auto') {\n\t\t\t\tthis._onDidChangeReducedMotion.fire();\n\t\t\t}\n\t\t}));\n\n\t\tconst updateRootClasses = () => {\n\t\t\tconst reduce = this.isMotionReduced();\n\t\t\tthis._layoutService.container.classList.toggle('reduce-motion', reduce);\n\t\t\tthis._layoutService.container.classList.toggle('enable-motion', !reduce);\n\t\t};\n\n\t\tupdateRootClasses();\n\t\tthis._register(this.onDidChangeReducedMotion(() => updateRootClasses()));\n\t}\n\n\tget onDidChangeScreenReaderOptimized(): Event<void> {\n\t\treturn this._onDidChangeScreenReaderOptimized.event;\n\t}\n\n\tisScreenReaderOptimized(): boolean {\n\t\tconst config = this._configurationService.getValue('editor.accessibilitySupport');\n\t\treturn config === 'on' || (config === 'auto' && this._accessibilitySupport === AccessibilitySupport.Enabled);\n\t}\n\n\tget onDidChangeReducedMotion(): Event<void> {\n\t\treturn this._onDidChangeReducedMotion.event;\n\t}\n\n\tisMotionReduced(): boolean {\n\t\tconst config = this._configMotionReduced;\n\t\treturn config === 'on' || (config === 'auto' && this._systemMotionReduced);\n\t}\n\n\talwaysUnderlineAccessKeys(): Promise<boolean> {\n\t\treturn Promise.resolve(false);\n\t}\n\n\tgetAccessibilitySupport(): AccessibilitySupport {\n\t\treturn this._accessibilitySupport;\n\t}\n\n\tsetAccessibilitySupport(accessibilitySupport: AccessibilitySupport): void {\n\t\tif (this._accessibilitySupport === accessibilitySupport) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._accessibilitySupport = accessibilitySupport;\n\t\tthis._onDidChangeScreenReaderOptimized.fire();\n\t}\n\n\talert(message: string): void {\n\t\talert(message);\n\t}\n}\n"]}