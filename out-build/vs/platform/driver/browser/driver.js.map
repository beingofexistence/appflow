{"version":3,"sources":["file:///workspace/appflow/src/vs/platform/driver/browser/driver.ts"],"names":[],"mappings":"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","file":"driver.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getClientArea, getTopLeftOffset } from 'vs/base/browser/dom';\nimport { coalesce } from 'vs/base/common/arrays';\nimport { language, locale } from 'vs/base/common/platform';\nimport { IElement, ILocaleInfo, ILocalizedStrings, ILogFile, IWindowDriver } from 'vs/platform/driver/common/driver';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport localizedStrings from 'vs/platform/languagePacks/common/localizedStrings';\nimport { getLogs } from 'vs/platform/log/browser/log';\n\nexport class BrowserWindowDriver implements IWindowDriver {\n\n\tconstructor(\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService\n\t) {\n\t}\n\n\tasync getLogs(): Promise<ILogFile[]> {\n\t\treturn getLogs(this.fileService, this.environmentService);\n\t}\n\n\tasync setValue(selector: string, text: string): Promise<void> {\n\t\tconst element = document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\treturn Promise.reject(new Error(`Element not found: ${selector}`));\n\t\t}\n\n\t\tconst inputElement = element as HTMLInputElement;\n\t\tinputElement.value = text;\n\n\t\tconst event = new Event('input', { bubbles: true, cancelable: true });\n\t\tinputElement.dispatchEvent(event);\n\t}\n\n\tasync isActiveElement(selector: string): Promise<boolean> {\n\t\tconst element = document.querySelector(selector);\n\n\t\tif (element !== document.activeElement) {\n\t\t\tconst chain: string[] = [];\n\t\t\tlet el = document.activeElement;\n\n\t\t\twhile (el) {\n\t\t\t\tconst tagName = el.tagName;\n\t\t\t\tconst id = el.id ? `#${el.id}` : '';\n\t\t\t\tconst classes = coalesce(el.className.split(/\\s+/g).map(c => c.trim())).map(c => `.${c}`).join('');\n\t\t\t\tchain.unshift(`${tagName}${id}${classes}`);\n\n\t\t\t\tel = el.parentElement;\n\t\t\t}\n\n\t\t\tthrow new Error(`Active element not found. Current active element is '${chain.join(' > ')}'. Looking for ${selector}`);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tasync getElements(selector: string, recursive: boolean): Promise<IElement[]> {\n\t\tconst query = document.querySelectorAll(selector);\n\t\tconst result: IElement[] = [];\n\t\tfor (let i = 0; i < query.length; i++) {\n\t\t\tconst element = query.item(i);\n\t\t\tresult.push(this.serializeElement(element, recursive));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate serializeElement(element: Element, recursive: boolean): IElement {\n\t\tconst attributes = Object.create(null);\n\n\t\tfor (let j = 0; j < element.attributes.length; j++) {\n\t\t\tconst attr = element.attributes.item(j);\n\t\t\tif (attr) {\n\t\t\t\tattributes[attr.name] = attr.value;\n\t\t\t}\n\t\t}\n\n\t\tconst children: IElement[] = [];\n\n\t\tif (recursive) {\n\t\t\tfor (let i = 0; i < element.children.length; i++) {\n\t\t\t\tconst child = element.children.item(i);\n\t\t\t\tif (child) {\n\t\t\t\t\tchildren.push(this.serializeElement(child, true));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst { left, top } = getTopLeftOffset(element as HTMLElement);\n\n\t\treturn {\n\t\t\ttagName: element.tagName,\n\t\t\tclassName: element.className,\n\t\t\ttextContent: element.textContent || '',\n\t\t\tattributes,\n\t\t\tchildren,\n\t\t\tleft,\n\t\t\ttop\n\t\t};\n\t}\n\n\tasync getElementXY(selector: string, xoffset?: number, yoffset?: number): Promise<{ x: number; y: number }> {\n\t\tconst offset = typeof xoffset === 'number' && typeof yoffset === 'number' ? { x: xoffset, y: yoffset } : undefined;\n\t\treturn this._getElementXY(selector, offset);\n\t}\n\n\tasync typeInEditor(selector: string, text: string): Promise<void> {\n\t\tconst element = document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Editor not found: ${selector}`);\n\t\t}\n\n\t\tconst textarea = element as HTMLTextAreaElement;\n\t\tconst start = textarea.selectionStart;\n\t\tconst newStart = start + text.length;\n\t\tconst value = textarea.value;\n\t\tconst newValue = value.substr(0, start) + text + value.substr(start);\n\n\t\ttextarea.value = newValue;\n\t\ttextarea.setSelectionRange(newStart, newStart);\n\n\t\tconst event = new Event('input', { 'bubbles': true, 'cancelable': true });\n\t\ttextarea.dispatchEvent(event);\n\t}\n\n\tasync getTerminalBuffer(selector: string): Promise<string[]> {\n\t\tconst element = document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Terminal not found: ${selector}`);\n\t\t}\n\n\t\tconst xterm = (element as any).xterm;\n\n\t\tif (!xterm) {\n\t\t\tthrow new Error(`Xterm not found: ${selector}`);\n\t\t}\n\n\t\tconst lines: string[] = [];\n\t\tfor (let i = 0; i < xterm.buffer.active.length; i++) {\n\t\t\tlines.push(xterm.buffer.active.getLine(i)!.translateToString(true));\n\t\t}\n\n\t\treturn lines;\n\t}\n\n\tasync writeInTerminal(selector: string, text: string): Promise<void> {\n\t\tconst element = document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\tthrow new Error(`Element not found: ${selector}`);\n\t\t}\n\n\t\tconst xterm = (element as any).xterm;\n\n\t\tif (!xterm) {\n\t\t\tthrow new Error(`Xterm not found: ${selector}`);\n\t\t}\n\n\t\txterm._core.coreService.triggerDataEvent(text);\n\t}\n\n\tgetLocaleInfo(): Promise<ILocaleInfo> {\n\t\treturn Promise.resolve({\n\t\t\tlanguage: language,\n\t\t\tlocale: locale\n\t\t});\n\t}\n\n\tgetLocalizedStrings(): Promise<ILocalizedStrings> {\n\t\treturn Promise.resolve({\n\t\t\topen: localizedStrings.open,\n\t\t\tclose: localizedStrings.close,\n\t\t\tfind: localizedStrings.find\n\t\t});\n\t}\n\n\tprotected async _getElementXY(selector: string, offset?: { x: number; y: number }): Promise<{ x: number; y: number }> {\n\t\tconst element = document.querySelector(selector);\n\n\t\tif (!element) {\n\t\t\treturn Promise.reject(new Error(`Element not found: ${selector}`));\n\t\t}\n\n\t\tconst { left, top } = getTopLeftOffset(element as HTMLElement);\n\t\tconst { width, height } = getClientArea(element as HTMLElement);\n\t\tlet x: number, y: number;\n\n\t\tif (offset) {\n\t\t\tx = left + offset.x;\n\t\t\ty = top + offset.y;\n\t\t} else {\n\t\t\tx = left + (width / 2);\n\t\t\ty = top + (height / 2);\n\t\t}\n\n\t\tx = Math.round(x);\n\t\ty = Math.round(y);\n\n\t\treturn { x, y };\n\t}\n\n\tasync exitApplication(): Promise<void> {\n\t\t// No-op in web\n\t}\n}\n\nexport function registerWindowDriver(instantiationService: IInstantiationService): void {\n\tObject.assign(window, { driver: instantiationService.createInstance(BrowserWindowDriver) });\n}\n"]}