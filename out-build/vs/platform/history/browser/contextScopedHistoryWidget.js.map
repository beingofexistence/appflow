{"version":3,"sources":["vs/platform/history/browser/contextScopedHistoryWidget.ts"],"names":[],"mappings":"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","file":"contextScopedHistoryWidget.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IHistoryNavigationWidget } from 'vs/base/browser/history';\nimport { IContextViewProvider } from 'vs/base/browser/ui/contextview/contextview';\nimport { FindInput, IFindInputOptions } from 'vs/base/browser/ui/findinput/findInput';\nimport { IReplaceInputOptions, ReplaceInput } from 'vs/base/browser/ui/findinput/replaceInput';\nimport { HistoryInputBox, IHistoryInputOptions } from 'vs/base/browser/ui/inputbox/inputBox';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { ContextKeyExpr, IContextKey, IContextKeyService, RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { KeybindingsRegistry, KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { localize } from 'vs/nls';\nimport { DisposableStore, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\n\nexport const historyNavigationVisible = new RawContextKey<boolean>('suggestWidgetVisible', false, localize('suggestWidgetVisible', \"Whether suggestion are visible\"));\n\nconst HistoryNavigationWidgetFocusContext = 'historyNavigationWidgetFocus';\nconst HistoryNavigationForwardsEnablementContext = 'historyNavigationForwardsEnabled';\nconst HistoryNavigationBackwardsEnablementContext = 'historyNavigationBackwardsEnabled';\n\nexport interface IHistoryNavigationContext extends IDisposable {\n\thistoryNavigationForwardsEnablement: IContextKey<boolean>;\n\thistoryNavigationBackwardsEnablement: IContextKey<boolean>;\n}\n\nlet lastFocusedWidget: IHistoryNavigationWidget | undefined = undefined;\nconst widgets: IHistoryNavigationWidget[] = [];\n\nexport function registerAndCreateHistoryNavigationContext(scopedContextKeyService: IContextKeyService, widget: IHistoryNavigationWidget): IHistoryNavigationContext {\n\tif (widgets.includes(widget)) {\n\t\tthrow new Error('Cannot register the same widget multiple times');\n\t}\n\n\twidgets.push(widget);\n\tconst disposableStore = new DisposableStore();\n\tconst historyNavigationWidgetFocus = new RawContextKey<boolean>(HistoryNavigationWidgetFocusContext, false).bindTo(scopedContextKeyService);\n\tconst historyNavigationForwardsEnablement = new RawContextKey<boolean>(HistoryNavigationForwardsEnablementContext, true).bindTo(scopedContextKeyService);\n\tconst historyNavigationBackwardsEnablement = new RawContextKey<boolean>(HistoryNavigationBackwardsEnablementContext, true).bindTo(scopedContextKeyService);\n\n\tconst onDidFocus = () => {\n\t\thistoryNavigationWidgetFocus.set(true);\n\t\tlastFocusedWidget = widget;\n\t};\n\n\tconst onDidBlur = () => {\n\t\thistoryNavigationWidgetFocus.set(false);\n\t\tif (lastFocusedWidget === widget) {\n\t\t\tlastFocusedWidget = undefined;\n\t\t}\n\t};\n\n\t// Check for currently being focused\n\tif (widget.element === document.activeElement) {\n\t\tonDidFocus();\n\t}\n\n\tdisposableStore.add(widget.onDidFocus(() => onDidFocus()));\n\tdisposableStore.add(widget.onDidBlur(() => onDidBlur()));\n\tdisposableStore.add(toDisposable(() => {\n\t\twidgets.splice(widgets.indexOf(widget), 1);\n\t\tonDidBlur();\n\t}));\n\n\treturn {\n\t\thistoryNavigationForwardsEnablement,\n\t\thistoryNavigationBackwardsEnablement,\n\t\tdispose() {\n\t\t\tdisposableStore.dispose();\n\t\t}\n\t};\n}\n\nexport class ContextScopedHistoryInputBox extends HistoryInputBox {\n\n\tconstructor(container: HTMLElement, contextViewProvider: IContextViewProvider | undefined, options: IHistoryInputOptions,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper(container, contextViewProvider, options);\n\t\tconst scopedContextKeyService = this._register(contextKeyService.createScoped(this.element));\n\t\tthis._register(registerAndCreateHistoryNavigationContext(scopedContextKeyService, this));\n\t}\n\n}\n\nexport class ContextScopedFindInput extends FindInput {\n\n\tconstructor(container: HTMLElement | null, contextViewProvider: IContextViewProvider, options: IFindInputOptions,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper(container, contextViewProvider, options);\n\t\tconst scopedContextKeyService = this._register(contextKeyService.createScoped(this.inputBox.element));\n\t\tthis._register(registerAndCreateHistoryNavigationContext(scopedContextKeyService, this.inputBox));\n\t}\n}\n\nexport class ContextScopedReplaceInput extends ReplaceInput {\n\n\tconstructor(container: HTMLElement | null, contextViewProvider: IContextViewProvider | undefined, options: IReplaceInputOptions,\n\t\t@IContextKeyService contextKeyService: IContextKeyService, showReplaceOptions: boolean = false\n\t) {\n\t\tsuper(container, contextViewProvider, showReplaceOptions, options);\n\t\tconst scopedContextKeyService = this._register(contextKeyService.createScoped(this.inputBox.element));\n\t\tthis._register(registerAndCreateHistoryNavigationContext(scopedContextKeyService, this.inputBox));\n\t}\n\n}\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: 'history.showPrevious',\n\tweight: KeybindingWeight.WorkbenchContrib,\n\twhen: ContextKeyExpr.and(\n\t\tContextKeyExpr.has(HistoryNavigationWidgetFocusContext),\n\t\tContextKeyExpr.equals(HistoryNavigationBackwardsEnablementContext, true),\n\t\tContextKeyExpr.not('isComposing'),\n\t\thistoryNavigationVisible.isEqualTo(false),\n\t),\n\tprimary: KeyCode.UpArrow,\n\tsecondary: [KeyMod.Alt | KeyCode.UpArrow],\n\thandler: (accessor) => {\n\t\tlastFocusedWidget?.showPreviousValue();\n\t}\n});\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: 'history.showNext',\n\tweight: KeybindingWeight.WorkbenchContrib,\n\twhen: ContextKeyExpr.and(\n\t\tContextKeyExpr.has(HistoryNavigationWidgetFocusContext),\n\t\tContextKeyExpr.equals(HistoryNavigationForwardsEnablementContext, true),\n\t\tContextKeyExpr.not('isComposing'),\n\t\thistoryNavigationVisible.isEqualTo(false),\n\t),\n\tprimary: KeyCode.DownArrow,\n\tsecondary: [KeyMod.Alt | KeyCode.DownArrow],\n\thandler: (accessor) => {\n\t\tlastFocusedWidget?.showNextValue();\n\t}\n});\n"]}