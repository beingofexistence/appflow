{"version":3,"sources":["vs/platform/userDataSync/common/userDataSyncResourceProvider.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;;IAoCzF,IAAM,IAAI,GAAV,MAAM,IAAI;;iBAIQ,MAAC,GAAuB,uBAAvB,AAA8C,CAAC;iBAChD,MAAC,GAAyB,eAAzB,AAAwC,CAAC;iBAC1C,MAAC,GAAwB,cAAxB,AAAsC,CAAC;QAIhE,YAC6C,CAA8B,EACzB,CAAmC,EACxC,CAAgB,EACvC,kBAAuB,EACN,CAAuB,EAC3B,CAAmB,EACtB,CAAgB,EACJ,CAA4B,EAC/B,CAAyB,EACzB,CAAyB;YATrB,MAAC,GAAD,CAAC,CAA6B;YACzB,MAAC,GAAD,CAAC,CAAkC;YACxC,MAAC,GAAD,CAAC,CAAe;YAEtB,MAAC,GAAD,CAAC,CAAsB;YAC3B,MAAC,GAAD,CAAC,CAAkB;YACtB,MAAC,GAAD,CAAC,CAAe;YACJ,MAAC,GAAD,CAAC,CAA2B;YAC/B,MAAC,GAAD,CAAC,CAAwB;YACzB,MAAC,GAAD,CAAC,CAAwB;YAEjE,IAAI,CAAC,CAAC,GAAQ,kBAAkB,CAAC,MAAM,CAAC;QACzC,CAAC;QAED,KAAK,CAAC,uBAAuB;YAC5B,MAAM,QAAQ,GAAG,MAAM,IAAI,CAAC,CAAC,CAAwB,YAAY,yCAAwB,IAAI,EAAE,SAAS,CAAC,CAAC;YAC1G,IAAI,QAAQ,CAAC,OAAO,EAAE;gBACrB,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAa,QAAQ,CAAC,OAAO,yCAAwB,CAAC;gBAC7E,OAAO,IAAA,mCAAI,EAA0B,QAAQ,CAAC,CAAC;aAC/C;YACD,OAAO,EAAE,CAAC;QACX,CAAC;QAED,KAAK,CAAC,sBAAsB,CAAC,QAAc;YAC1C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,CAAC,CAA6B,kBAAkB,yCAAwB,SAAS,EAAE,QAAQ,CAAC,CAAC;YACrH,IAAI,IAAI,CAAC,MAAM,EAAE;gBAChB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,CAAC,CAA6B,sBAAsB,yCAAwB,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;gBACzI,IAAI,OAAO,EAAE;oBACZ,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAa,OAAO,yCAAwB,CAAC;oBACpE,OAAO,IAAA,mCAAI,EAA0B,QAAQ,CAAC,CAAC;iBAC/C;aACD;YACD,OAAO,EAAE,CAAC;QACX,CAAC;QAED,KAAK,CAAC,sBAAsB,CAAC,QAAc;YAC1C,MAAM,IAAI,GAAG,MAAM,IAAI,CAAC,CAAC,CAA6B,kBAAkB,CAAC,UAAU,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;YAC1G,IAAI,IAAI,CAAC,MAAM,EAAE;gBAChB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,CAAC,CAA6B,sBAAsB,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,GAAG,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC;gBAC9H,IAAI,OAAO,EAAE;oBACZ,MAAM,YAAY,GAAkB,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;oBACxD,OAAO,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;iBACpE;aACD;YACD,OAAO,EAAE,CAAC;QACX,CAAC;QAED,KAAK,CAAC,4BAA4B,CAAC,YAA0B,EAAE,OAA8B;YAC5F,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,CAAC,CAAwB,kBAAkB,CAAC,YAAY,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC;YAC1G,OAAO,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,CAAC;gBACzC,OAAO;gBACP,GAAG,EAAE,IAAI,CAAC,CAAC,CAAK;oBACf,MAAM,EAAE,IAAI;oBACZ,YAAY;oBACZ,OAAO,EAAE,OAAO,EAAE,EAAE,IAAI,IAAI,CAAC,CAAC,CAAuB,cAAc,CAAC,EAAE;oBACtE,QAAQ,EAAE,SAAS;oBACnB,UAAU,EAAE,OAAO,EAAE,UAAU;oBAC/B,GAAG;oBACH,IAAI,EAAE,SAAS;iBACf,CAAC;aACF,CAAC,CAAC,CAAC;QACL,CAAC;QAED,KAAK,CAAC,2BAA2B,CAAC,YAA0B,EAAE,OAA8B,EAAE,QAAc;YAC3G,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,CAAC,CAA6B,kBAAkB,CAAC,YAAY,EAAE,OAAO,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAC;YACzH,OAAO,OAAO,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,EAAE,GAAG,EAAE,EAAE,EAAE,CAAC,CAAC;gBACzC,OAAO;gBACP,GAAG,EAAE,IAAI,CAAC,CAAC,CAAK;oBACf,MAAM,EAAE,KAAK;oBACb,YAAY;oBACZ,OAAO,EAAE,OAAO,EAAE,EAAE,IAAI,IAAI,CAAC,CAAC,CAAuB,cAAc,CAAC,EAAE;oBACtE,UAAU,EAAE,OAAO,EAAE,UAAU;oBAC/B,GAAG;oBACH,IAAI,EAAE,SAAS;oBACf,QAAQ;iBACR,CAAC;aACF,CAAC,CAAC,CAAC;QACL,CAAC;QAED,2BAA2B,CAAC,EAAE,GAAG,EAAuB;YACvD,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAU,GAAG,CAAC,CAAC;YACtC,MAAM,OAAO,GAAG,QAAQ,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAuB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,QAAQ,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;YAClH,OAAO,QAAQ,IAAI,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,EAAE,YAAY,EAAE,QAAQ,EAAE,YAAY,EAAE,CAAC,CAAC,CAAC,SAAS,CAAC;QAC5F,CAAC;QAED,KAAK,CAAC,sBAAsB,CAAC,EAAE,GAAG,EAAuB;YACxD,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAU,GAAG,CAAC,CAAC;YACtC,IAAI,CAAC,QAAQ,EAAE;gBACd,OAAO,EAAE,CAAC;aACV;YAED,MAAM,OAAO,GAAG,IAAI,CAAC,CAAC,CAAuB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,QAAQ,CAAC,OAAO,CAAC,CAAC;YAC3F,QAAQ,QAAQ,CAAC,YAAY,EAAE;gBAC9B,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA8B,GAAG,EAAE,OAAO,CAAC,CAAC;gBACrF,iDAA6B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAiC,GAAG,EAAE,OAAO,CAAC,CAAC;gBAC3F,qCAAuB,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA2B,GAAG,EAAE,OAAO,CAAC,CAAC;gBAC/E,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA8B,GAAG,EAAE,OAAO,CAAC,CAAC;gBACrF,iDAA6B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAiC,GAAG,EAAE,OAAO,CAAC,CAAC;gBAC3F,+CAA4B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAgC,GAAG,EAAE,OAAO,CAAC,CAAC;gBACzF,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA8B,GAAG,EAAE,OAAO,CAAC,CAAC;gBACrF,uDAAgC,CAAC,CAAC,OAAO,EAAE,CAAC;aAC5C;QACF,CAAC;QAED,KAAK,CAAC,YAAY,CAAC,EAAE,GAAG,EAAuB;YAC9C,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAU,GAAG,CAAC,CAAC;YACtC,IAAI,CAAC,QAAQ,EAAE;gBACd,OAAO,SAAS,CAAC;aACjB;YACD,IAAI,QAAQ,CAAC,MAAM,EAAE;gBACpB,IAAI,QAAQ,CAAC,GAAG,EAAE;oBACjB,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,CAAC,CAAC,CAAW,QAAQ,CAAC,YAAY,EAAE,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,UAAU,CAAC,CAAC;oBACrG,IAAI,OAAO,EAAE;wBACZ,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAa,OAAO,EAAE,QAAQ,CAAC,YAAY,CAAC,CAAC;wBACpE,OAAO,QAAQ,EAAE,SAAS,CAAC;qBAC3B;iBACD;gBACD,OAAO,SAAS,CAAC;aACjB;YAED,IAAI,QAAQ,CAAC,QAAQ,EAAE;gBACtB,IAAI,QAAQ,CAAC,GAAG,EAAE;oBACjB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,CAAC,CAA6B,sBAAsB,CAAC,QAAQ,CAAC,YAAY,EAAE,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,UAAU,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;oBAC7J,IAAI,OAAO,EAAE;wBACZ,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAa,OAAO,EAAE,QAAQ,CAAC,YAAY,CAAC,CAAC;wBACpE,OAAO,QAAQ,EAAE,SAAS,CAAC;qBAC3B;iBACD;gBACD,OAAO,SAAS,CAAC;aACjB;YAED,OAAO,IAAA,sBAAG,EAAiB,IAAI,CAAC,CAAC,EAAmB,IAAI,CAAC,CAAC,EAAY,IAAI,CAAC,CAAC,CAAc,CAAC;QAC5F,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,GAAQ;YAC5B,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAU,GAAG,CAAC,CAAC;YACtC,IAAI,CAAC,QAAQ,EAAE;gBACd,OAAO,IAAI,CAAC;aACZ;YAED,IAAI,QAAQ,CAAC,IAAI,KAAK,MAAI,CAAgC,CAAC,EAAsB;gBAChF,OAAO,IAAI,CAAC;aACZ;YAED,IAAI,QAAQ,CAAC,GAAG,EAAE;gBACjB,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,CAAC,CAAmB,QAAQ,CAAC,MAAM,EAAE,QAAQ,CAAC,YAAY,EAAE,QAAQ,CAAC,UAAU,EAAE,QAAQ,CAAC,GAAG,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;gBAC7I,IAAI,QAAQ,CAAC,IAAI,IAAI,OAAO,EAAE;oBAC7B,OAAO,IAAI,CAAC,CAAC,CAAkB,QAAQ,CAAC,YAAY,EAAE,OAAO,EAAE,QAAQ,CAAC,IAAI,CAAC,CAAC;iBAC9E;gBACD,OAAO,OAAO,CAAC;aACf;YAED,IAAI,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE;gBACvC,OAAO,IAAI,CAAC,CAAC,CAAoB,QAAQ,CAAC,YAAY,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC;aAC1E;YAED,OAAO,IAAI,CAAC;QACb,CAAC;QAEO,KAAK,CAAC,CAAC,CAAmB,MAAe,EAAE,YAA0B,EAAE,UAA8B,EAAE,GAAW,EAAE,QAAc;YACzI,IAAI,MAAM,EAAE;gBACX,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,CAAC,CAAC,CAAW,YAAY,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC;gBAC1E,OAAO,OAAO,CAAC;aACf;YACD,OAAO,IAAI,CAAC,CAAC,CAA6B,sBAAsB,CAAC,YAAY,EAAE,GAAG,EAAE,UAAU,EAAE,QAAQ,CAAC,CAAC;QAC3G,CAAC;QAEO,CAAC,CAAkB,YAA0B,EAAE,OAAe,EAAE,IAAY;YACnF,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAa,OAAO,EAAE,YAAY,CAAC,CAAC;YAC3D,QAAQ,YAAY,EAAE;gBACrB,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA0B,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACnF,iDAA6B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA6B,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACzF,qCAAuB,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAuB,QAAQ,EAAE,IAAI,CAAC,CAAC;gBAC7E,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA0B,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACnF,iDAA6B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA6B,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACzF,+CAA4B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA4B,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACvF,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAAyB,QAAQ,EAAE,IAAI,CAAC,CAAC;gBAClF,uDAAgC,CAAC,CAAC,OAAO,IAAI,CAAC;aAC9C;QACF,CAAC;QAEO,KAAK,CAAC,CAAC,CAAoB,YAA0B,EAAE,SAAiB;YAC/E,MAAM,OAAO,GAAG,IAAI,CAAC,CAAC,CAAuB,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC,CAAC;YACpF,IAAI,CAAC,OAAO,EAAE;gBACb,OAAO,IAAI,CAAC;aACZ;YACD,QAAQ,YAAY,EAAE;gBACrB,iDAA6B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA+B,OAAO,CAAC,CAAC;gBACpF,+CAA4B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA8B,OAAO,CAAC,CAAC;gBAClF,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,CAA4B,OAAO,CAAC,CAAC;gBAC9E,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC;gBACxC,iDAA6B,CAAC,CAAC,OAAO,IAAI,CAAC;gBAC3C,qCAAuB,CAAC,CAAC,OAAO,IAAI,CAAC;gBACrC,2CAA0B,CAAC,CAAC,OAAO,IAAI,CAAC;gBACxC,uDAAgC,CAAC,CAAC,OAAO,IAAI,CAAC;aAC9C;QACF,CAAC;QAEO,CAAC,CAA8B,GAAQ,EAAE,OAAqC;YACrF,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC;YAC5D,MAAM,kBAAkB,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,MAAI,CAAgC,CAAC,CAAqB,CAAC;YACrJ,OAAO,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC3C,CAAC;QAEO,CAAC,CAA0B,QAAmB,EAAE,IAAY;YACnE,QAAQ,IAAI,EAAE;gBACb,KAAK,eAAe;oBACnB,OAAO,IAAA,mBAAI,EAAqB,QAAQ,CAAC,OAAO,CAAC,CAAC,QAAQ,CAAC;aAC5D;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEO,CAAC,CAAiC,GAAQ,EAAE,OAAqC;YACxF,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;YAC/D,MAAM,kBAAkB,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,MAAI,CAAgC,CAAC,CAAqB,CAAC;YACxJ,OAAO,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC3C,CAAC;QAEO,CAAC,CAA6B,QAAmB,EAAE,IAAY;YACtE,QAAQ,IAAI,EAAE;gBACb,KAAK,kBAAkB;oBACtB,OAAO,IAAA,sBAAI,EAAiC,QAAQ,CAAC,OAAO,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC,CAAoB,QAAQ,CAAC,mBAAI,CAAiC,EAAE,IAAI,CAAC,CAAC,CAAU,CAAC;aAC5J;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEO,CAAC,CAA2B,GAAQ,EAAE,OAAqC;YAClF,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,YAAY,CAAC,CAAC;YACzD,MAAM,kBAAkB,GAAG,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,MAAI,CAAgC,CAAC,CAAqB,CAAC;YAClJ,OAAO,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC3C,CAAC;QAEO,CAAC,CAAuB,QAAmB,EAAE,IAAY;YAChE,QAAQ,IAAI,EAAE;gBACb,KAAK,YAAY;oBAChB,OAAO,IAAA,gBAAI,EAA2B,QAAQ,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAU,CAAC;aAC1E;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEO,KAAK,CAAC,CAAC,CAA8B,GAAQ,EAAE,OAAqC;YAC3F,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,CAAC;YAC/C,IAAI,OAAO,EAAE;gBACZ,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAa,OAAO,yCAAwB,CAAC;gBACpE,IAAI,QAAQ,EAAE;oBACb,MAAM,QAAQ,GAAG,IAAA,mBAAI,EAAU,QAAQ,CAAC,CAAC;oBACzC,MAAM,MAAM,GAAG,EAAE,CAAC;oBAClB,KAAK,MAAM,OAAO,IAAI,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;wBAC5C,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;wBACpD,MAAM,kBAAkB,GAAG,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,OAAO,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,MAAI,CAAgC,CAAC,CAAqB,CAAC;wBAChL,MAAM,CAAC,IAAI,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAC,CAAC;qBAC9C;oBACD,OAAO,MAAM,CAAC;iBACd;aACD;YACD,OAAO,EAAE,CAAC;QACX,CAAC;QAEO,CAAC,CAA0B,QAAmB,EAAE,IAAY;YACnE,OAAO,IAAA,mBAAI,EAAU,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC;QAC9C,CAAC;QAEO,CAAC,CAAgC,GAAQ,EAAE,OAAqC;YACvF,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,iBAAiB,CAAC,CAAC;YAC9D,MAAM,kBAAkB,GAAG,OAAO;gBACjC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAK;oBACZ,MAAM,EAAE,KAAK;oBACb,YAAY,4CAAyB;oBACrC,OAAO,EAAE,OAAO,CAAC,EAAE;oBACnB,QAAQ,EAAE,SAAS;oBACnB,UAAU,EAAE,SAAS;oBACrB,GAAG,EAAE,SAAS;oBACd,IAAI,EAAE,SAAS;iBACf,CAAC;gBACF,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,MAAI,CAAgC,CAAC,CAAqB,CAAC;YACxF,OAAO,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC3C,CAAC;QAEO,CAAC,CAA4B,QAAmB,EAAE,IAAY;YACrE,QAAQ,IAAI,EAAE;gBACb,KAAK,iBAAiB;oBACrB,OAAO,IAAA,qBAAmB,EAAC,IAAA,qBAAI,EAAY,QAAQ,CAAC,EAAE,IAAI,CAAC,CAAC;aAC7D;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEO,KAAK,CAAC,CAAC,CAA8B,OAAyB;YACrE,MAAM,EAAE,eAAe,EAAE,GAAG,MAAM,IAAI,CAAC,CAAC,CAAoB,cAAc,CAAC,qBAAI,CAAoB,CAAC,kBAAkB,CAAC,OAAO,CAAC,CAAC;YAChI,OAAO,IAAA,qBAAmB,EAAC,eAAe,EAAE,IAAI,CAAC,CAAC;QACnD,CAAC;QAEO,CAAC,CAAiC,GAAQ,EAAE,OAAqC;YACxF,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;YAC/D,MAAM,kBAAkB,GAAG,OAAO;gBACjC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAK;oBACZ,MAAM,EAAE,KAAK;oBACb,YAAY,8CAA0B;oBACtC,OAAO,EAAE,OAAO,CAAC,EAAE;oBACnB,QAAQ,EAAE,SAAS;oBACnB,UAAU,EAAE,SAAS;oBACrB,GAAG,EAAE,SAAS;oBACd,IAAI,EAAE,SAAS;iBACf,CAAC;gBACF,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,MAAI,CAAgC,CAAC,CAAqB,CAAC;YACxF,OAAO,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC3C,CAAC;QAEO,CAAC,CAA6B,QAAmB,EAAE,IAAY;YACtE,QAAQ,IAAI,EAAE;gBACb,KAAK,kBAAkB;oBACtB,OAAO,IAAA,sBAAoB,EAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,IAAI,CAAC,CAAC;aACjE;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEO,KAAK,CAAC,CAAC,CAA+B,OAAyB;YACtE,MAAM,gBAAgB,GAAG,MAAM,IAAI,CAAC,CAAC,CAAoB,cAAc,CAAC,sBAAI,CAAqB,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;YAC/H,OAAO,IAAA,sBAAoB,EAAC,gBAAgB,EAAE,IAAI,CAAC,CAAC;QACrD,CAAC;QAEO,CAAC,CAA8B,GAAQ,EAAE,OAAqC;YACrF,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,EAAE,eAAe,CAAC,CAAC;YAC5D,MAAM,kBAAkB,GAAG,IAAI,CAAC,CAAC,CAAK;gBACrC,MAAM,EAAE,KAAK;gBACb,YAAY,wCAAuB;gBACnC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAuB,cAAc,CAAC,EAAE;gBACvD,QAAQ,EAAE,SAAS;gBACnB,UAAU,EAAE,SAAS;gBACrB,GAAG,EAAE,SAAS;gBACd,IAAI,EAAE,SAAS;aACf,CAAC,CAAC;YACH,OAAO,CAAC,EAAE,QAAQ,EAAE,kBAAkB,EAAE,CAAC,CAAC;QAC3C,CAAC;QAEO,CAAC,CAAyB,QAAmB,EAAE,IAAY;YAClE,QAAQ,IAAI,EAAE;gBACb,KAAK,eAAe;oBACnB,OAAO,IAAA,mBAAG,EAAe,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;aAC5D;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEO,KAAK,CAAC,CAAC,CAA4B,OAAyB;YACnE,OAAO,IAAA,mCAAI,EAAmB,IAAI,CAAC,CAAC,CAAuB,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAS,IAAI,CAAC,CAAC,CAAC,WAAW,CAAC,EAAE,IAAI,CAAC,CAAC;QACxH,CAAC;QAEO,CAAC,CAAK,mBAAyC;YACtD,MAAM,SAAS,GAAG,mBAAmB,CAAC,MAAM,CAAC,CAAC,CAAC,MAAI,CAAgC,CAAC,CAAuB,CAAC,CAAC,MAAI,CAAgC,CAAC,CAAsB;YACxK,MAAM,KAAK,GAAG,EAAE,CAAC;YACjB,IAAI,mBAAmB,CAAC,QAAQ,EAAE;gBACjC,KAAK,CAAC,IAAI,CAAC,UAAU,mBAAmB,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC;gBAC5D,KAAK,CAAC,IAAI,CAAC,aAAa,mBAAmB,CAAC,QAAQ,CAAC,SAAS,EAAE,CAAC,CAAC;gBAClE,KAAK,CAAC,IAAI,CAAC,IAAA,aAAG,EAAE,mBAAmB,CAAC,QAAQ,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC;aACzD;YACD,KAAK,CAAC,IAAI,CAAC,gBAAgB,mBAAmB,CAAC,YAAY,EAAE,CAAC,CAAC;YAC/D,KAAK,CAAC,IAAI,CAAC,WAAW,mBAAmB,CAAC,OAAO,EAAE,CAAC,CAAC;YACrD,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;YACxC,IAAI,mBAAmB,CAAC,UAAU,EAAE;gBACnC,KAAK,CAAC,IAAI,CAAC,cAAc,mBAAmB,CAAC,UAAU,EAAE,CAAC,CAAC;aAC3D;YACD,IAAI,mBAAmB,CAAC,GAAG,EAAE;gBAC5B,KAAK,CAAC,IAAI,CAAC,OAAO,mBAAmB,CAAC,GAAG,EAAE,CAAC,CAAC;aAC7C;YACD,IAAI,mBAAmB,CAAC,IAAI,EAAE;gBAC7B,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;aACrC;YACD,OAAO,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,SAAG,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,mBAAI,EAAmB,SAAS,EAAE,IAAI,EAAE,GAAG,EAAE,KAAK,EAAE,mBAAmB,CAAC,QAAQ,EAAE,KAAK,EAAE,QAAQ,EAAE,mBAAmB,CAAC,QAAQ,EAAE,QAAQ,EAAE,CAAC,EAAE,GAAG,KAAK,CAAC,CAAC;QACxM,CAAC;QAEO,CAAC,CAAU,GAAQ;YAC1B,IAAI,GAAG,CAAC,MAAM,KAAK,mBAAI,EAAmB;gBACzC,OAAO,SAAS,CAAC;aACjB;YACD,MAAM,KAAK,GAAa,EAAE,CAAC;YAC3B,OAAO,GAAG,CAAC,IAAI,KAAK,GAAG,EAAE;gBACxB,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC;gBACzC,GAAG,GAAG,IAAI,CAAC,CAAC,CAAM,OAAO,CAAC,GAAG,CAAC,CAAC;aAC/B;YACD,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;gBACrB,OAAO,SAAS,CAAC;aACjB;YACD,MAAM,MAAM,GAAG,GAAG,CAAC,SAAS,KAAK,MAAI,CAAgC,CAAC,CAAuB;YAC7F,IAAI,MAA0B,CAAC;YAC/B,IAAI,SAA6B,CAAC;YAClC,MAAM,aAAa,GAAa,EAAE,CAAC;YACnC,IAAI,YAAsC,CAAC;YAC3C,IAAI,OAA2B,CAAC;YAChC,IAAI,UAA8B,CAAC;YACnC,IAAI,GAAuB,CAAC;YAC5B,IAAI,IAAwB,CAAC;YAC7B,OAAO,KAAK,CAAC,MAAM,EAAE;gBACpB,MAAM,IAAI,GAAG,KAAK,CAAC,KAAK,EAAG,CAAC;gBAC5B,IAAI,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,EAAE;oBAC/B,MAAM,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;iBAC1C;qBAAM,IAAI,IAAI,CAAC,UAAU,CAAC,YAAY,CAAC,EAAE;oBACzC,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;iBAChD;qBAAM,IAAI,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,EAAE;oBAC5C,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC,eAAe,CAAC,MAAM,CAAiB,CAAC;iBACtE;qBAAM,IAAI,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE;oBACvC,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;iBAC5C;qBAAM,IAAI,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,EAAE;oBAC1C,UAAU,GAAG,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;iBAClD;qBAAM,IAAI,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,EAAE;oBACnC,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;iBACpC;qBAAM,IAAI,CAAC,YAAY,EAAE;oBACzB,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACzB;qBAAM;oBACN,IAAI,GAAG,IAAI,CAAC;iBACZ;aACD;YACD,OAAO;gBACN,MAAM;gBACN,YAAY,EAAE,YAAa;gBAC3B,OAAO,EAAE,OAAQ;gBACjB,UAAU;gBACV,GAAG;gBACH,IAAI;gBACJ,QAAQ,EAAE,MAAM,IAAI,SAAS,KAAK,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAM,QAAQ,CAAC,SAAG,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,SAAS,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,GAAG,CAAC,QAAQ,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,EAAE,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,SAAS;aACtL,CAAC;QACH,CAAC;QAEO,CAAC,CAAa,OAAe,EAAE,YAA0B;YAChE,IAAI;gBACH,MAAM,QAAQ,GAAc,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;gBAChD,IAAI,IAAA,2BAAI,EAAO,QAAQ,CAAC,EAAE;oBACzB,OAAO,QAAQ,CAAC;iBAChB;aACD;YAAC,OAAO,KAAK,EAAE;gBACf,IAAI,CAAC,CAAC,CAAU,KAAK,CAAC,KAAK,CAAC,CAAC;aAC7B;YACD,MAAM,IAAI,mBAAI,CAAc,IAAA,cAAQ,EAAC,CAAwB,EAAE,IAA0E,CAAC,qFAAmD,YAAY,CAAC,CAAC;QAC5M,CAAC;QAEO,KAAK,CAAC,CAAC,CAAW,YAA0B,EAAE,GAAW,EAAE,UAAmB;YACrF,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,CAAC,CAAwB,sBAAsB,CAAC,YAAY,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC;YAC1G,OAAO,EAAE,GAAG,EAAE,OAAO,EAAE,CAAC;QACzB,CAAC;;IA/bW,oBAAI;mBAAJ,IAAI;QAWd,WAAA,mBAAI,CAAA;QACJ,WAAA,mBAAI,CAAA;QACJ,WAAA,mBAAI,CAAA;QACJ,WAAA,iBAAG,CAAA;QACH,WAAA,iBAAG,CAAA;QACH,WAAA,aAAG,CAAA;QACH,WAAA,WAAG,CAAA;QACH,WAAA,qBAAG,CAAA;QACH,WAAA,mBAAG,CAAA;QACH,WAAA,mBAAG,CAAA;OApBO,IAAI,CAichB","file":"userDataSyncResourceProvider.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExtUri } from 'vs/base/common/resources';\nimport { URI } from 'vs/base/common/uri';\nimport { localize } from 'vs/nls';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { getServiceMachineId } from 'vs/platform/externalServices/common/serviceMachineId';\nimport { IStorageService } from 'vs/platform/storage/common/storage';\nimport { IUriIdentityService } from 'vs/platform/uriIdentity/common/uriIdentity';\nimport { ISyncData, ISyncResourceHandle, IUserData, IUserDataSyncLocalStoreService, IUserDataSyncLogService, IUserDataSyncStoreService, SyncResource, UserDataSyncError, UserDataSyncErrorCode, USER_DATA_SYNC_SCHEME, IUserDataSyncResourceProviderService, ISyncUserDataProfile, CONFIG_SYNC_KEYBINDINGS_PER_PLATFORM, IUserDataSyncResource } from 'vs/platform/userDataSync/common/userDataSync';\nimport { IUserDataProfile, IUserDataProfilesService } from 'vs/platform/userDataProfile/common/userDataProfile';\nimport { isSyncData } from 'vs/platform/userDataSync/common/abstractSynchronizer';\nimport { parseSnippets } from 'vs/platform/userDataSync/common/snippetsSync';\nimport { parseSettingsSyncContent } from 'vs/platform/userDataSync/common/settingsSync';\nimport { getKeybindingsContentFromSyncContent } from 'vs/platform/userDataSync/common/keybindingsSync';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { getTasksContentFromSyncContent } from 'vs/platform/userDataSync/common/tasksSync';\nimport { LocalExtensionsProvider, parseExtensions, stringify as stringifyExtensions } from 'vs/platform/userDataSync/common/extensionsSync';\nimport { LocalGlobalStateProvider, stringify as stringifyGlobalState } from 'vs/platform/userDataSync/common/globalStateSync';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { parseUserDataProfilesManifest, stringifyLocalProfiles } from 'vs/platform/userDataSync/common/userDataProfilesManifestSync';\nimport { toFormattedString } from 'vs/base/common/jsonFormatter';\nimport { trim } from 'vs/base/common/strings';\nimport { IMachinesData, IUserDataSyncMachine } from 'vs/platform/userDataSync/common/userDataSyncMachines';\n\ninterface ISyncResourceUriInfo {\n\treadonly remote: boolean;\n\treadonly syncResource: SyncResource;\n\treadonly profile: string;\n\treadonly collection: string | undefined;\n\treadonly ref: string | undefined;\n\treadonly node: string | undefined;\n\treadonly location: URI | undefined;\n}\n\nexport class UserDataSyncResourceProviderService implements IUserDataSyncResourceProviderService {\n\n\t_serviceBrand: any;\n\n\tprivate static readonly NOT_EXISTING_RESOURCE = 'not-existing-resource';\n\tprivate static readonly REMOTE_BACKUP_AUTHORITY = 'remote-backup';\n\tprivate static readonly LOCAL_BACKUP_AUTHORITY = 'local-backup';\n\n\tprivate readonly extUri: IExtUri;\n\n\tconstructor(\n\t\t@IUserDataSyncStoreService private readonly userDataSyncStoreService: IUserDataSyncStoreService,\n\t\t@IUserDataSyncLocalStoreService private readonly userDataSyncLocalStoreService: IUserDataSyncLocalStoreService,\n\t\t@IUserDataSyncLogService protected readonly logService: IUserDataSyncLogService,\n\t\t@IUriIdentityService uriIdentityService: IUriIdentityService,\n\t\t@IEnvironmentService private readonly environmentService: IEnvironmentService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IUserDataProfilesService private readonly userDataProfilesService: IUserDataProfilesService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t) {\n\t\tthis.extUri = uriIdentityService.extUri;\n\t}\n\n\tasync getRemoteSyncedProfiles(): Promise<ISyncUserDataProfile[]> {\n\t\tconst userData = await this.userDataSyncStoreService.readResource(SyncResource.Profiles, null, undefined);\n\t\tif (userData.content) {\n\t\t\tconst syncData = this.parseSyncData(userData.content, SyncResource.Profiles);\n\t\t\treturn parseUserDataProfilesManifest(syncData);\n\t\t}\n\t\treturn [];\n\t}\n\n\tasync getLocalSyncedProfiles(location?: URI): Promise<ISyncUserDataProfile[]> {\n\t\tconst refs = await this.userDataSyncLocalStoreService.getAllResourceRefs(SyncResource.Profiles, undefined, location);\n\t\tif (refs.length) {\n\t\t\tconst content = await this.userDataSyncLocalStoreService.resolveResourceContent(SyncResource.Profiles, refs[0].ref, undefined, location);\n\t\t\tif (content) {\n\t\t\t\tconst syncData = this.parseSyncData(content, SyncResource.Profiles);\n\t\t\t\treturn parseUserDataProfilesManifest(syncData);\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tasync getLocalSyncedMachines(location?: URI): Promise<IUserDataSyncMachine[]> {\n\t\tconst refs = await this.userDataSyncLocalStoreService.getAllResourceRefs('machines', undefined, location);\n\t\tif (refs.length) {\n\t\t\tconst content = await this.userDataSyncLocalStoreService.resolveResourceContent('machines', refs[0].ref, undefined, location);\n\t\t\tif (content) {\n\t\t\t\tconst machinesData: IMachinesData = JSON.parse(content);\n\t\t\t\treturn machinesData.machines.map(m => ({ ...m, isCurrent: false }));\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tasync getRemoteSyncResourceHandles(syncResource: SyncResource, profile?: ISyncUserDataProfile): Promise<ISyncResourceHandle[]> {\n\t\tconst handles = await this.userDataSyncStoreService.getAllResourceRefs(syncResource, profile?.collection);\n\t\treturn handles.map(({ created, ref }) => ({\n\t\t\tcreated,\n\t\t\turi: this.toUri({\n\t\t\t\tremote: true,\n\t\t\t\tsyncResource,\n\t\t\t\tprofile: profile?.id ?? this.userDataProfilesService.defaultProfile.id,\n\t\t\t\tlocation: undefined,\n\t\t\t\tcollection: profile?.collection,\n\t\t\t\tref,\n\t\t\t\tnode: undefined,\n\t\t\t})\n\t\t}));\n\t}\n\n\tasync getLocalSyncResourceHandles(syncResource: SyncResource, profile?: ISyncUserDataProfile, location?: URI): Promise<ISyncResourceHandle[]> {\n\t\tconst handles = await this.userDataSyncLocalStoreService.getAllResourceRefs(syncResource, profile?.collection, location);\n\t\treturn handles.map(({ created, ref }) => ({\n\t\t\tcreated,\n\t\t\turi: this.toUri({\n\t\t\t\tremote: false,\n\t\t\t\tsyncResource,\n\t\t\t\tprofile: profile?.id ?? this.userDataProfilesService.defaultProfile.id,\n\t\t\t\tcollection: profile?.collection,\n\t\t\t\tref,\n\t\t\t\tnode: undefined,\n\t\t\t\tlocation,\n\t\t\t})\n\t\t}));\n\t}\n\n\tresolveUserDataSyncResource({ uri }: ISyncResourceHandle): IUserDataSyncResource | undefined {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tconst profile = resolved ? this.userDataProfilesService.profiles.find(p => p.id === resolved.profile) : undefined;\n\t\treturn resolved && profile ? { profile, syncResource: resolved?.syncResource } : undefined;\n\t}\n\n\tasync getAssociatedResources({ uri }: ISyncResourceHandle): Promise<{ resource: URI; comparableResource: URI }[]> {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tif (!resolved) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst profile = this.userDataProfilesService.profiles.find(p => p.id === resolved.profile);\n\t\tswitch (resolved.syncResource) {\n\t\t\tcase SyncResource.Settings: return this.getSettingsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Keybindings: return this.getKeybindingsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Tasks: return this.getTasksAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Snippets: return this.getSnippetsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.GlobalState: return this.getGlobalStateAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Extensions: return this.getExtensionsAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.Profiles: return this.getProfilesAssociatedResources(uri, profile);\n\t\t\tcase SyncResource.WorkspaceState: return [];\n\t\t}\n\t}\n\n\tasync getMachineId({ uri }: ISyncResourceHandle): Promise<string | undefined> {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tif (!resolved) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (resolved.remote) {\n\t\t\tif (resolved.ref) {\n\t\t\t\tconst { content } = await this.getUserData(resolved.syncResource, resolved.ref, resolved.collection);\n\t\t\t\tif (content) {\n\t\t\t\t\tconst syncData = this.parseSyncData(content, resolved.syncResource);\n\t\t\t\t\treturn syncData?.machineId;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (resolved.location) {\n\t\t\tif (resolved.ref) {\n\t\t\t\tconst content = await this.userDataSyncLocalStoreService.resolveResourceContent(resolved.syncResource, resolved.ref, resolved.collection, resolved.location);\n\t\t\t\tif (content) {\n\t\t\t\t\tconst syncData = this.parseSyncData(content, resolved.syncResource);\n\t\t\t\t\treturn syncData?.machineId;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn getServiceMachineId(this.environmentService, this.fileService, this.storageService);\n\t}\n\n\tasync resolveContent(uri: URI): Promise<string | null> {\n\t\tconst resolved = this.resolveUri(uri);\n\t\tif (!resolved) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (resolved.node === UserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (resolved.ref) {\n\t\t\tconst content = await this.getContentFromStore(resolved.remote, resolved.syncResource, resolved.collection, resolved.ref, resolved.location);\n\t\t\tif (resolved.node && content) {\n\t\t\t\treturn this.resolveNodeContent(resolved.syncResource, content, resolved.node);\n\t\t\t}\n\t\t\treturn content;\n\t\t}\n\n\t\tif (!resolved.remote && !resolved.node) {\n\t\t\treturn this.resolveLatestContent(resolved.syncResource, resolved.profile);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tprivate async getContentFromStore(remote: boolean, syncResource: SyncResource, collection: string | undefined, ref: string, location?: URI): Promise<string | null> {\n\t\tif (remote) {\n\t\t\tconst { content } = await this.getUserData(syncResource, ref, collection);\n\t\t\treturn content;\n\t\t}\n\t\treturn this.userDataSyncLocalStoreService.resolveResourceContent(syncResource, ref, collection, location);\n\t}\n\n\tprivate resolveNodeContent(syncResource: SyncResource, content: string, node: string): string | null {\n\t\tconst syncData = this.parseSyncData(content, syncResource);\n\t\tswitch (syncResource) {\n\t\t\tcase SyncResource.Settings: return this.resolveSettingsNodeContent(syncData, node);\n\t\t\tcase SyncResource.Keybindings: return this.resolveKeybindingsNodeContent(syncData, node);\n\t\t\tcase SyncResource.Tasks: return this.resolveTasksNodeContent(syncData, node);\n\t\t\tcase SyncResource.Snippets: return this.resolveSnippetsNodeContent(syncData, node);\n\t\t\tcase SyncResource.GlobalState: return this.resolveGlobalStateNodeContent(syncData, node);\n\t\t\tcase SyncResource.Extensions: return this.resolveExtensionsNodeContent(syncData, node);\n\t\t\tcase SyncResource.Profiles: return this.resolveProfileNodeContent(syncData, node);\n\t\t\tcase SyncResource.WorkspaceState: return null;\n\t\t}\n\t}\n\n\tprivate async resolveLatestContent(syncResource: SyncResource, profileId: string): Promise<string | null> {\n\t\tconst profile = this.userDataProfilesService.profiles.find(p => p.id === profileId);\n\t\tif (!profile) {\n\t\t\treturn null;\n\t\t}\n\t\tswitch (syncResource) {\n\t\t\tcase SyncResource.GlobalState: return this.resolveLatestGlobalStateContent(profile);\n\t\t\tcase SyncResource.Extensions: return this.resolveLatestExtensionsContent(profile);\n\t\t\tcase SyncResource.Profiles: return this.resolveLatestProfilesContent(profile);\n\t\t\tcase SyncResource.Settings: return null;\n\t\t\tcase SyncResource.Keybindings: return null;\n\t\t\tcase SyncResource.Tasks: return null;\n\t\t\tcase SyncResource.Snippets: return null;\n\t\t\tcase SyncResource.WorkspaceState: return null;\n\t\t}\n\t}\n\n\tprivate getSettingsAssociatedResources(uri: URI, profile: IUserDataProfile | undefined): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, 'settings.json');\n\t\tconst comparableResource = profile ? profile.settingsResource : this.extUri.joinPath(uri, UserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveSettingsNodeContent(syncData: ISyncData, node: string): string | null {\n\t\tswitch (node) {\n\t\t\tcase 'settings.json':\n\t\t\t\treturn parseSettingsSyncContent(syncData.content).settings;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate getKeybindingsAssociatedResources(uri: URI, profile: IUserDataProfile | undefined): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, 'keybindings.json');\n\t\tconst comparableResource = profile ? profile.keybindingsResource : this.extUri.joinPath(uri, UserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveKeybindingsNodeContent(syncData: ISyncData, node: string): string | null {\n\t\tswitch (node) {\n\t\t\tcase 'keybindings.json':\n\t\t\t\treturn getKeybindingsContentFromSyncContent(syncData.content, !!this.configurationService.getValue(CONFIG_SYNC_KEYBINDINGS_PER_PLATFORM), this.logService);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate getTasksAssociatedResources(uri: URI, profile: IUserDataProfile | undefined): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, 'tasks.json');\n\t\tconst comparableResource = profile ? profile.tasksResource : this.extUri.joinPath(uri, UserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveTasksNodeContent(syncData: ISyncData, node: string): string | null {\n\t\tswitch (node) {\n\t\t\tcase 'tasks.json':\n\t\t\t\treturn getTasksContentFromSyncContent(syncData.content, this.logService);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async getSnippetsAssociatedResources(uri: URI, profile: IUserDataProfile | undefined): Promise<{ resource: URI; comparableResource: URI }[]> {\n\t\tconst content = await this.resolveContent(uri);\n\t\tif (content) {\n\t\t\tconst syncData = this.parseSyncData(content, SyncResource.Snippets);\n\t\t\tif (syncData) {\n\t\t\t\tconst snippets = parseSnippets(syncData);\n\t\t\t\tconst result = [];\n\t\t\t\tfor (const snippet of Object.keys(snippets)) {\n\t\t\t\t\tconst resource = this.extUri.joinPath(uri, snippet);\n\t\t\t\t\tconst comparableResource = profile ? this.extUri.joinPath(profile.snippetsHome, snippet) : this.extUri.joinPath(uri, UserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE);\n\t\t\t\t\tresult.push({ resource, comparableResource });\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tprivate resolveSnippetsNodeContent(syncData: ISyncData, node: string): string | null {\n\t\treturn parseSnippets(syncData)[node] || null;\n\t}\n\n\tprivate getExtensionsAssociatedResources(uri: URI, profile: IUserDataProfile | undefined): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, 'extensions.json');\n\t\tconst comparableResource = profile\n\t\t\t? this.toUri({\n\t\t\t\tremote: false,\n\t\t\t\tsyncResource: SyncResource.Extensions,\n\t\t\t\tprofile: profile.id,\n\t\t\t\tlocation: undefined,\n\t\t\t\tcollection: undefined,\n\t\t\t\tref: undefined,\n\t\t\t\tnode: undefined,\n\t\t\t})\n\t\t\t: this.extUri.joinPath(uri, UserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveExtensionsNodeContent(syncData: ISyncData, node: string): string | null {\n\t\tswitch (node) {\n\t\t\tcase 'extensions.json':\n\t\t\t\treturn stringifyExtensions(parseExtensions(syncData), true);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async resolveLatestExtensionsContent(profile: IUserDataProfile): Promise<string | null> {\n\t\tconst { localExtensions } = await this.instantiationService.createInstance(LocalExtensionsProvider).getLocalExtensions(profile);\n\t\treturn stringifyExtensions(localExtensions, true);\n\t}\n\n\tprivate getGlobalStateAssociatedResources(uri: URI, profile: IUserDataProfile | undefined): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, 'globalState.json');\n\t\tconst comparableResource = profile\n\t\t\t? this.toUri({\n\t\t\t\tremote: false,\n\t\t\t\tsyncResource: SyncResource.GlobalState,\n\t\t\t\tprofile: profile.id,\n\t\t\t\tlocation: undefined,\n\t\t\t\tcollection: undefined,\n\t\t\t\tref: undefined,\n\t\t\t\tnode: undefined,\n\t\t\t})\n\t\t\t: this.extUri.joinPath(uri, UserDataSyncResourceProviderService.NOT_EXISTING_RESOURCE);\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveGlobalStateNodeContent(syncData: ISyncData, node: string): string | null {\n\t\tswitch (node) {\n\t\t\tcase 'globalState.json':\n\t\t\t\treturn stringifyGlobalState(JSON.parse(syncData.content), true);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async resolveLatestGlobalStateContent(profile: IUserDataProfile): Promise<string | null> {\n\t\tconst localGlobalState = await this.instantiationService.createInstance(LocalGlobalStateProvider).getLocalGlobalState(profile);\n\t\treturn stringifyGlobalState(localGlobalState, true);\n\t}\n\n\tprivate getProfilesAssociatedResources(uri: URI, profile: IUserDataProfile | undefined): { resource: URI; comparableResource: URI }[] {\n\t\tconst resource = this.extUri.joinPath(uri, 'profiles.json');\n\t\tconst comparableResource = this.toUri({\n\t\t\tremote: false,\n\t\t\tsyncResource: SyncResource.Profiles,\n\t\t\tprofile: this.userDataProfilesService.defaultProfile.id,\n\t\t\tlocation: undefined,\n\t\t\tcollection: undefined,\n\t\t\tref: undefined,\n\t\t\tnode: undefined,\n\t\t});\n\t\treturn [{ resource, comparableResource }];\n\t}\n\n\tprivate resolveProfileNodeContent(syncData: ISyncData, node: string): string | null {\n\t\tswitch (node) {\n\t\t\tcase 'profiles.json':\n\t\t\t\treturn toFormattedString(JSON.parse(syncData.content), {});\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate async resolveLatestProfilesContent(profile: IUserDataProfile): Promise<string | null> {\n\t\treturn stringifyLocalProfiles(this.userDataProfilesService.profiles.filter(p => !p.isDefault && !p.isTransient), true);\n\t}\n\n\tprivate toUri(syncResourceUriInfo: ISyncResourceUriInfo): URI {\n\t\tconst authority = syncResourceUriInfo.remote ? UserDataSyncResourceProviderService.REMOTE_BACKUP_AUTHORITY : UserDataSyncResourceProviderService.LOCAL_BACKUP_AUTHORITY;\n\t\tconst paths = [];\n\t\tif (syncResourceUriInfo.location) {\n\t\t\tpaths.push(`scheme:${syncResourceUriInfo.location.scheme}`);\n\t\t\tpaths.push(`authority:${syncResourceUriInfo.location.authority}`);\n\t\t\tpaths.push(trim(syncResourceUriInfo.location.path, '/'));\n\t\t}\n\t\tpaths.push(`syncResource:${syncResourceUriInfo.syncResource}`);\n\t\tpaths.push(`profile:${syncResourceUriInfo.profile}`);\n\t\tpaths.push(syncResourceUriInfo.profile);\n\t\tif (syncResourceUriInfo.collection) {\n\t\t\tpaths.push(`collection:${syncResourceUriInfo.collection}`);\n\t\t}\n\t\tif (syncResourceUriInfo.ref) {\n\t\t\tpaths.push(`ref:${syncResourceUriInfo.ref}`);\n\t\t}\n\t\tif (syncResourceUriInfo.node) {\n\t\t\tpaths.push(syncResourceUriInfo.node);\n\t\t}\n\t\treturn this.extUri.joinPath(URI.from({ scheme: USER_DATA_SYNC_SCHEME, authority, path: `/`, query: syncResourceUriInfo.location?.query, fragment: syncResourceUriInfo.location?.fragment }), ...paths);\n\t}\n\n\tprivate resolveUri(uri: URI): ISyncResourceUriInfo | undefined {\n\t\tif (uri.scheme !== USER_DATA_SYNC_SCHEME) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst paths: string[] = [];\n\t\twhile (uri.path !== '/') {\n\t\t\tpaths.unshift(this.extUri.basename(uri));\n\t\t\turi = this.extUri.dirname(uri);\n\t\t}\n\t\tif (paths.length < 2) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst remote = uri.authority === UserDataSyncResourceProviderService.REMOTE_BACKUP_AUTHORITY;\n\t\tlet scheme: string | undefined;\n\t\tlet authority: string | undefined;\n\t\tconst locationPaths: string[] = [];\n\t\tlet syncResource: SyncResource | undefined;\n\t\tlet profile: string | undefined;\n\t\tlet collection: string | undefined;\n\t\tlet ref: string | undefined;\n\t\tlet node: string | undefined;\n\t\twhile (paths.length) {\n\t\t\tconst path = paths.shift()!;\n\t\t\tif (path.startsWith('scheme:')) {\n\t\t\t\tscheme = path.substring('scheme:'.length);\n\t\t\t} else if (path.startsWith('authority:')) {\n\t\t\t\tauthority = path.substring('authority:'.length);\n\t\t\t} else if (path.startsWith('syncResource:')) {\n\t\t\t\tsyncResource = path.substring('syncResource:'.length) as SyncResource;\n\t\t\t} else if (path.startsWith('profile:')) {\n\t\t\t\tprofile = path.substring('profile:'.length);\n\t\t\t} else if (path.startsWith('collection:')) {\n\t\t\t\tcollection = path.substring('collection:'.length);\n\t\t\t} else if (path.startsWith('ref:')) {\n\t\t\t\tref = path.substring('ref:'.length);\n\t\t\t} else if (!syncResource) {\n\t\t\t\tlocationPaths.push(path);\n\t\t\t} else {\n\t\t\t\tnode = path;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tremote,\n\t\t\tsyncResource: syncResource!,\n\t\t\tprofile: profile!,\n\t\t\tcollection,\n\t\t\tref,\n\t\t\tnode,\n\t\t\tlocation: scheme && authority !== undefined ? this.extUri.joinPath(URI.from({ scheme, authority, query: uri.query, fragment: uri.fragment, path: '/' }), ...locationPaths) : undefined\n\t\t};\n\t}\n\n\tprivate parseSyncData(content: string, syncResource: SyncResource): ISyncData {\n\t\ttry {\n\t\t\tconst syncData: ISyncData = JSON.parse(content);\n\t\t\tif (isSyncData(syncData)) {\n\t\t\t\treturn syncData;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthis.logService.error(error);\n\t\t}\n\t\tthrow new UserDataSyncError(localize('incompatible sync data', \"Cannot parse sync data as it is not compatible with the current version.\"), UserDataSyncErrorCode.IncompatibleRemoteContent, syncResource);\n\t}\n\n\tprivate async getUserData(syncResource: SyncResource, ref: string, collection?: string): Promise<IUserData> {\n\t\tconst content = await this.userDataSyncStoreService.resolveResourceContent(syncResource, ref, collection);\n\t\treturn { ref, content };\n\t}\n\n}\n"]}