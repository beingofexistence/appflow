{"version":3,"sources":["file:///workspace/appflow/src/vs/platform/extensionManagement/test/common/extensionNls.test.ts"],"names":[],"mappings":"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","file":"extensionNls.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { deepClone } from 'vs/base/common/objects';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from 'vs/base/test/common/utils';\nimport { ILocalizedString } from 'vs/platform/action/common/action';\nimport { localizeManifest } from 'vs/platform/extensionManagement/common/extensionNls';\nimport { IExtensionManifest, IConfiguration } from 'vs/platform/extensions/common/extensions';\nimport { NullLogger } from 'vs/platform/log/common/log';\n\nconst manifest: IExtensionManifest = {\n\tname: 'test',\n\tpublisher: 'test',\n\tversion: '1.0.0',\n\tengines: {\n\t\tvscode: '*'\n\t},\n\tcontributes: {\n\t\tcommands: [\n\t\t\t{\n\t\t\t\tcommand: 'test.command',\n\t\t\t\ttitle: '%test.command.title%',\n\t\t\t\tcategory: '%test.command.category%'\n\t\t\t},\n\t\t],\n\t\tauthentication: [\n\t\t\t{\n\t\t\t\tid: 'test.authentication',\n\t\t\t\tlabel: '%test.authentication.label%',\n\t\t\t}\n\t\t],\n\t\tconfiguration: {\n\t\t\t// to ensure we test another \"title\" property\n\t\t\ttitle: '%test.configuration.title%',\n\t\t\tproperties: {\n\t\t\t\t'test.configuration': {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdescription: 'not important',\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\nsuite('Localize Manifest', () => {\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\ttest('replaces template strings', function () {\n\t\tconst localizedManifest = localizeManifest(\n\t\t\tstore.add(new NullLogger()),\n\t\t\tdeepClone(manifest),\n\t\t\t{\n\t\t\t\t'test.command.title': 'Test Command',\n\t\t\t\t'test.command.category': 'Test Category',\n\t\t\t\t'test.authentication.label': 'Test Authentication',\n\t\t\t\t'test.configuration.title': 'Test Configuration',\n\t\t\t}\n\t\t);\n\n\t\tassert.strictEqual(localizedManifest.contributes?.commands?.[0].title, 'Test Command');\n\t\tassert.strictEqual(localizedManifest.contributes?.commands?.[0].category, 'Test Category');\n\t\tassert.strictEqual(localizedManifest.contributes?.authentication?.[0].label, 'Test Authentication');\n\t\tassert.strictEqual((localizedManifest.contributes?.configuration as IConfiguration).title, 'Test Configuration');\n\t});\n\n\ttest('replaces template strings with fallback if not found in translations', function () {\n\t\tconst localizedManifest = localizeManifest(\n\t\t\tstore.add(new NullLogger()),\n\t\t\tdeepClone(manifest),\n\t\t\t{},\n\t\t\t{\n\t\t\t\t'test.command.title': 'Test Command',\n\t\t\t\t'test.command.category': 'Test Category',\n\t\t\t\t'test.authentication.label': 'Test Authentication',\n\t\t\t\t'test.configuration.title': 'Test Configuration',\n\t\t\t}\n\t\t);\n\n\t\tassert.strictEqual(localizedManifest.contributes?.commands?.[0].title, 'Test Command');\n\t\tassert.strictEqual(localizedManifest.contributes?.commands?.[0].category, 'Test Category');\n\t\tassert.strictEqual(localizedManifest.contributes?.authentication?.[0].label, 'Test Authentication');\n\t\tassert.strictEqual((localizedManifest.contributes?.configuration as IConfiguration).title, 'Test Configuration');\n\t});\n\n\ttest('replaces template strings - command title & categories become ILocalizedString', function () {\n\t\tconst localizedManifest = localizeManifest(\n\t\t\tstore.add(new NullLogger()),\n\t\t\tdeepClone(manifest),\n\t\t\t{\n\t\t\t\t'test.command.title': 'Befehl test',\n\t\t\t\t'test.command.category': 'Testkategorie',\n\t\t\t\t'test.authentication.label': 'Testauthentifizierung',\n\t\t\t\t'test.configuration.title': 'Testkonfiguration',\n\t\t\t},\n\t\t\t{\n\t\t\t\t'test.command.title': 'Test Command',\n\t\t\t\t'test.command.category': 'Test Category',\n\t\t\t\t'test.authentication.label': 'Test Authentication',\n\t\t\t\t'test.configuration.title': 'Test Configuration',\n\t\t\t}\n\t\t);\n\n\t\tconst title = localizedManifest.contributes?.commands?.[0].title as ILocalizedString;\n\t\tconst category = localizedManifest.contributes?.commands?.[0].category as ILocalizedString;\n\t\tassert.strictEqual(title.value, 'Befehl test');\n\t\tassert.strictEqual(title.original, 'Test Command');\n\t\tassert.strictEqual(category.value, 'Testkategorie');\n\t\tassert.strictEqual(category.original, 'Test Category');\n\n\t\t// Everything else stays as a string.\n\t\tassert.strictEqual(localizedManifest.contributes?.authentication?.[0].label, 'Testauthentifizierung');\n\t\tassert.strictEqual((localizedManifest.contributes?.configuration as IConfiguration).title, 'Testkonfiguration');\n\t});\n\n\ttest('replaces template strings - is best effort #164630', function () {\n\t\tconst manifestWithTypo: IExtensionManifest = {\n\t\t\tname: 'test',\n\t\t\tpublisher: 'test',\n\t\t\tversion: '1.0.0',\n\t\t\tengines: {\n\t\t\t\tvscode: '*'\n\t\t\t},\n\t\t\tcontributes: {\n\t\t\t\tauthentication: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'test.authentication',\n\t\t\t\t\t\t// This not existing in the bundle shouldn't cause an error.\n\t\t\t\t\t\tlabel: '%doesnotexist%',\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tcommands: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcommand: 'test.command',\n\t\t\t\t\t\ttitle: '%test.command.title%',\n\t\t\t\t\t\tcategory: '%test.command.category%'\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t}\n\t\t};\n\n\t\tconst localizedManifest = localizeManifest(\n\t\t\tstore.add(new NullLogger()),\n\t\t\tdeepClone(manifestWithTypo),\n\t\t\t{\n\t\t\t\t'test.command.title': 'Test Command',\n\t\t\t\t'test.command.category': 'Test Category'\n\t\t\t});\n\n\t\tassert.strictEqual(localizedManifest.contributes?.commands?.[0].title, 'Test Command');\n\t\tassert.strictEqual(localizedManifest.contributes?.commands?.[0].category, 'Test Category');\n\t\tassert.strictEqual(localizedManifest.contributes?.authentication?.[0].label, '%doesnotexist%');\n\t});\n});\n"]}