{"version":3,"sources":["file:///workspace/appflow/src/vs/amdX.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;IAShG,MAAM,UAAU;QACf,YACiB,EAA6B,EAC7B,YAAyC,EACzC,QAAa;YAFb,OAAE,GAAF,EAAE,CAA2B;YAC7B,iBAAY,GAAZ,YAAY,CAA6B;YACzC,aAAQ,GAAR,QAAQ,CAAK;QAC1B,CAAC;KACL;IAED,MAAM,iBAAiB;iBACR,aAAQ,GAAG,IAAI,iBAAiB,EAAxB,AAA0B,CAAC;QAWjD;YATiB,MAAC,GAAc,CAAC,OAAO,IAAI,KAAK,QAAQ,IAAI,IAAI,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,KAAK,4BAA4B,CAAC,CAAC;YACxH,MAAC,GAAa,OAAO,QAAQ,KAAK,QAAQ,CAAC;YAE3C,MAAC,GAA4B,EAAE,CAAC;YACzC,MAAC,GAAc,KAAK,CAAC;QAKb,CAAC;QAET,CAAC;YACR,IAAI,IAAI,CAAC,CAAC,EAAa;gBACtB,OAAO;aACP;YACD,IAAI,CAAC,CAAC,GAAc,IAAI,CAAC;YAEnB,UAAW,CAAC,MAAM,GAAG,CAAC,EAAO,EAAE,YAAiB,EAAE,QAAa,EAAE,EAAE;gBACxE,IAAI,OAAO,EAAE,KAAK,QAAQ,EAAE;oBAC3B,QAAQ,GAAG,YAAY,CAAC;oBACxB,YAAY,GAAG,EAAE,CAAC;oBAClB,EAAE,GAAG,IAAI,CAAC;iBACV;gBACD,IAAI,OAAO,YAAY,KAAK,QAAQ,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE;oBACrE,QAAQ,GAAG,YAAY,CAAC;oBACxB,YAAY,GAAG,IAAI,CAAC;iBACpB;gBACD,uBAAuB;gBACvB,oDAAoD;gBACpD,IAAI;gBACJ,IAAI,CAAC,CAAC,CAAY,IAAI,CAAC,IAAI,UAAU,CAAC,EAAE,EAAE,YAAY,EAAE,QAAQ,CAAC,CAAC,CAAC;YACpE,CAAC,CAAC;YAEI,UAAW,CAAC,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC;YAEpC,IAAI,IAAI,CAAC,CAAC,EAAY;gBACrB,IAAI,CAAC,CAAC,GAAY,MAAM,CAAC,YAAY,EAAE,YAAY,CAAC,WAAW,EAAE;oBAChE,eAAe,CAAC,KAAK;wBACpB,IAAI,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;4BAC7C,OAAO,KAAK,CAAC;yBACb;wBACD,IAAI,KAAK,CAAC,UAAU,CAAC,0BAA0B,CAAC,EAAE;4BACjD,OAAO,KAAK,CAAC;yBACb;wBACD,MAAM,IAAI,KAAK,CAAC,4CAA4C,KAAK,EAAE,CAAC,CAAC;oBACtE,CAAC;iBACD,CAAC,CAAC;aACH;iBAAM,IAAI,IAAI,CAAC,CAAC,EAAa;gBAC7B,IAAI,CAAC,CAAC,GAAkB,UAAW,CAAC,YAAY,EAAE,YAAY,CAAC,WAAW,EAAE;oBAC3E,eAAe,CAAC,KAAa;wBAC5B,OAAO,KAAK,CAAC;oBACd,CAAC;iBACD,CAAC,CAAC;aACH;QACF,CAAC;QAEM,KAAK,CAAC,IAAI,CAAI,SAAiB;YACrC,IAAI,CAAC,CAAC,EAAY,CAAC;YACnB,MAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC,CAAC,CAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAiB,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAW,CAAC,CAAC,IAAI,CAAC,CAAC,CAAmB,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAiB,SAAS,CAAC,CAAC,CAAC;YAC9K,IAAI,CAAC,UAAU,EAAE;gBAChB,MAAM,IAAI,KAAK,CAAC,6CAA6C,SAAS,EAAE,CAAC,CAAC;aAC1E;YACD,gCAAgC;YAChC,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC,YAAY,CAAC,IAAI,UAAU,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE;gBACjF,MAAM,IAAI,KAAK,CAAC,0CAA0C,SAAS,2BAA2B,UAAU,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACpI;YACD,IAAI,OAAO,UAAU,CAAC,QAAQ,KAAK,UAAU,EAAE;gBAC9C,OAAO,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;aAC/B;iBAAM;gBACN,OAAO,UAAU,CAAC,QAAQ,CAAC;aAC3B;QACF,CAAC;QAEO,CAAC,CAAmB,SAAiB;YAC5C,OAAO,IAAI,OAAO,CAAyB,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC9D,MAAM,aAAa,GAAG,QAAQ,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;gBACvD,aAAa,CAAC,YAAY,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;gBAC7C,aAAa,CAAC,YAAY,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAC;gBAEtD,MAAM,MAAM,GAAG,GAAG,EAAE;oBACnB,aAAa,CAAC,mBAAmB,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAC;oBAC7D,aAAa,CAAC,mBAAmB,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAC;gBAChE,CAAC,CAAC;gBAEF,MAAM,iBAAiB,GAAG,CAAC,CAAM,EAAE,EAAE;oBACpC,MAAM,EAAE,CAAC;oBACT,OAAO,CAAC,IAAI,CAAC,CAAC,CAAY,GAAG,EAAE,CAAC,CAAC;gBAClC,CAAC,CAAC;gBAEF,MAAM,kBAAkB,GAAG,CAAC,CAAM,EAAE,EAAE;oBACrC,MAAM,EAAE,CAAC;oBACT,MAAM,CAAC,CAAC,CAAC,CAAC;gBACX,CAAC,CAAC;gBAEF,aAAa,CAAC,gBAAgB,CAAC,MAAM,EAAE,iBAAiB,CAAC,CAAC;gBAC1D,aAAa,CAAC,gBAAgB,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAC;gBAC5D,IAAI,IAAI,CAAC,CAAC,EAAW;oBACpB,SAAS,GAAG,IAAI,CAAC,CAAC,CAAU,eAAe,CAAC,SAAS,CAAkB,CAAC;iBACxE;gBACD,aAAa,CAAC,YAAY,CAAC,KAAK,EAAE,SAAS,CAAC,CAAC;gBAC7C,QAAQ,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC;YACrE,CAAC,CAAC,CAAC;QACJ,CAAC;QAEO,CAAC,CAAiB,SAAiB;YAC1C,OAAO,IAAI,OAAO,CAAyB,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;gBAC9D,IAAI;oBACH,IAAI,IAAI,CAAC,CAAC,EAAW;wBACpB,SAAS,GAAG,IAAI,CAAC,CAAC,CAAU,eAAe,CAAC,SAAS,CAAkB,CAAC;qBACxE;oBACD,aAAa,CAAC,SAAS,CAAC,CAAC;oBACzB,OAAO,CAAC,IAAI,CAAC,CAAC,CAAY,GAAG,EAAE,CAAC,CAAC;iBACjC;gBAAC,OAAO,GAAG,EAAE;oBACb,MAAM,CAAC,GAAG,CAAC,CAAC;iBACZ;YACF,CAAC,CAAC,CAAC;QACJ,CAAC;QAEO,KAAK,CAAC,CAAC,CAAiB,SAAiB;YAChD,IAAI;gBACH,MAAM,EAAE,GAAwB,UAAU,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;gBACtE,MAAM,EAAE,GAAwB,UAAU,CAAC,oBAAoB,CAAC,IAAI,CAAC,CAAC;gBACtE,MAAM,MAAM,GAA4B,UAAU,CAAC,oBAAoB,CAAC,QAAQ,CAAC,CAAC;gBAElF,MAAM,QAAQ,GAAG,SAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,MAAM,CAAC;gBAC7C,MAAM,OAAO,GAAG,EAAE,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAC;gBACrD,MAAM,YAAY,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC,CAAC;gBAC/D,MAAM,MAAM,GAAG,IAAI,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC;gBAC3C,MAAM,cAAc,GAAG,MAAM,CAAC,gBAAgB,EAAE,CAAC;gBACjD,cAAc,CAAC,KAAK,EAAE,CAAC;gBACvB,OAAO,IAAI,CAAC,CAAC,CAAY,GAAG,EAAE,CAAC;aAE/B;YAAC,OAAO,KAAK,EAAE;gBACf,MAAM,KAAK,CAAC;aACZ;QACF,CAAC;;IAGF,MAAM,KAAK,GAAG,IAAI,GAAG,EAAwB,CAAC;IAE9C,IAAI,MAAM,GAA2B,EAAE,CAAC;IACxC,IAAI,OAAO,UAAU,CAAC,OAAO,KAAK,QAAQ,EAAE;QAC3C,MAAM,GAAyB,UAAU,CAAC,OAAQ,CAAC,KAAK,IAAI,EAAE,CAAC;KAC/D;IAED;;;;;OAKG;IACI,KAAK,UAAU,GAAG,CAAoB,cAAsB,EAAE,oBAA4B,EAAE,OAAiB;QACnH,IAAI,QAAE,EAAK;YAEV,IAAI,OAAO,KAAK,SAAS,EAAE;gBAC1B,MAAM,OAAO,GAAG,UAAU,CAAC,oBAAwD,CAAC;gBACpF,OAAO,GAAG,OAAO,CAAC,CAAC,OAAO,IAAU,UAAW,CAAC,MAAM,EAAE,OAAO,EAAE,aAAa,EAAE,EAAE,OAAO,CAAC,EAAE,MAAM,CAAC,CAAC;aACpG;YAED,IAAI,MAAM,CAAC,cAAc,CAAC,EAAE;gBAC3B,cAAc,GAAG,MAAM,CAAC,cAAc,CAAC,CAAC;aACxC;YAED,MAAM,cAAc,GAAG,GAAG,cAAc,IAAI,oBAAoB,EAAE,CAAC;YACnE,IAAI,KAAK,CAAC,GAAG,CAAC,cAAc,CAAC,EAAE;gBAC9B,OAAO,KAAK,CAAC,GAAG,CAAC,cAAc,CAAE,CAAC;aAClC;YACD,IAAI,SAAiB,CAAC;YACtB,IAAI,oBAAoB,CAAC,IAAI,CAAC,cAAc,CAAC,EAAE;gBAC9C,mBAAmB;gBACnB,kHAAkH;gBAClH,SAAS,GAAG,cAAc,CAAC;aAC3B;iBAAM;gBACN,MAAM,OAAO,GAAG,CAAC,OAAO,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAI,CAAC;gBAC7C,MAAM,qBAAqB,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,aAAG,CAAiB,CAAC,CAAC,aAAG,CAAa,CAAC;gBAChF,MAAM,YAAY,GAAoB,GAAG,qBAAqB,IAAI,cAAc,EAAE,CAAC;gBACnF,SAAS,GAAG,aAAG,CAAQ,YAAY,CAAC,YAAY,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;aACjE;YACD,MAAM,MAAM,GAAG,iBAAiB,CAAC,QAAQ,CAAC,IAAI,CAAI,SAAS,CAAC,CAAC;YAC7D,KAAK,CAAC,GAAG,CAAC,cAAc,EAAE,MAAM,CAAC,CAAC;YAClC,OAAO,MAAM,CAAC;SACd;aAAM;YACN,OAAO,sDAAa,cAAc,2BAAC,CAAC;SACpC;IACF,CAAC;IAjCD,kBAiCC","file":"amdX.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { isESM } from 'vs/base/common/amd';\nimport { AppResourcePath, FileAccess, nodeModulesAsarPath, nodeModulesPath } from 'vs/base/common/network';\nimport * as platform from 'vs/base/common/platform';\nimport { IProductConfiguration } from 'vs/base/common/product';\nimport { URI } from 'vs/base/common/uri';\n\n\nclass DefineCall {\n\tconstructor(\n\t\tpublic readonly id: string | null | undefined,\n\t\tpublic readonly dependencies: string[] | null | undefined,\n\t\tpublic readonly callback: any\n\t) { }\n}\n\nclass AMDModuleImporter {\n\tpublic static INSTANCE = new AMDModuleImporter();\n\n\tprivate readonly _isWebWorker = (typeof self === 'object' && self.constructor && self.constructor.name === 'DedicatedWorkerGlobalScope');\n\tprivate readonly _isRenderer = typeof document === 'object';\n\n\tprivate readonly _defineCalls: DefineCall[] = [];\n\tprivate _initialized = false;\n\tprivate _amdPolicy: Pick<TrustedTypePolicy<{\n\t\tcreateScriptURL(value: string): string;\n\t}>, 'name' | 'createScriptURL'> | undefined;\n\n\tconstructor() { }\n\n\tprivate _initialize(): void {\n\t\tif (this._initialized) {\n\t\t\treturn;\n\t\t}\n\t\tthis._initialized = true;\n\n\t\t(<any>globalThis).define = (id: any, dependencies: any, callback: any) => {\n\t\t\tif (typeof id !== 'string') {\n\t\t\t\tcallback = dependencies;\n\t\t\t\tdependencies = id;\n\t\t\t\tid = null;\n\t\t\t}\n\t\t\tif (typeof dependencies !== 'object' || !Array.isArray(dependencies)) {\n\t\t\t\tcallback = dependencies;\n\t\t\t\tdependencies = null;\n\t\t\t}\n\t\t\t// if (!dependencies) {\n\t\t\t// \tdependencies = ['require', 'exports', 'module'];\n\t\t\t// }\n\t\t\tthis._defineCalls.push(new DefineCall(id, dependencies, callback));\n\t\t};\n\n\t\t(<any>globalThis).define.amd = true;\n\n\t\tif (this._isRenderer) {\n\t\t\tthis._amdPolicy = window.trustedTypes?.createPolicy('amdLoader', {\n\t\t\t\tcreateScriptURL(value) {\n\t\t\t\t\tif (value.startsWith(window.location.origin)) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t\tif (value.startsWith('vscode-file://vscode-app')) {\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t\tthrow new Error(`[trusted_script_src] Invalid script url: ${value}`);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (this._isWebWorker) {\n\t\t\tthis._amdPolicy = (<any>globalThis).trustedTypes?.createPolicy('amdLoader', {\n\t\t\t\tcreateScriptURL(value: string) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic async load<T>(scriptSrc: string): Promise<T> {\n\t\tthis._initialize();\n\t\tconst defineCall = await (this._isWebWorker ? this._workerLoadScript(scriptSrc) : this._isRenderer ? this._rendererLoadScript(scriptSrc) : this._nodeJSLoadScript(scriptSrc));\n\t\tif (!defineCall) {\n\t\t\tthrow new Error(`Did not receive a define call from script ${scriptSrc}`);\n\t\t}\n\t\t// TODO require, exports, module\n\t\tif (Array.isArray(defineCall.dependencies) && defineCall.dependencies.length > 0) {\n\t\t\tthrow new Error(`Cannot resolve dependencies for script ${scriptSrc}. The dependencies are: ${defineCall.dependencies.join(', ')}`);\n\t\t}\n\t\tif (typeof defineCall.callback === 'function') {\n\t\t\treturn defineCall.callback([]);\n\t\t} else {\n\t\t\treturn defineCall.callback;\n\t\t}\n\t}\n\n\tprivate _rendererLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\treturn new Promise<DefineCall | undefined>((resolve, reject) => {\n\t\t\tconst scriptElement = document.createElement('script');\n\t\t\tscriptElement.setAttribute('async', 'async');\n\t\t\tscriptElement.setAttribute('type', 'text/javascript');\n\n\t\t\tconst unbind = () => {\n\t\t\t\tscriptElement.removeEventListener('load', loadEventListener);\n\t\t\t\tscriptElement.removeEventListener('error', errorEventListener);\n\t\t\t};\n\n\t\t\tconst loadEventListener = (e: any) => {\n\t\t\t\tunbind();\n\t\t\t\tresolve(this._defineCalls.pop());\n\t\t\t};\n\n\t\t\tconst errorEventListener = (e: any) => {\n\t\t\t\tunbind();\n\t\t\t\treject(e);\n\t\t\t};\n\n\t\t\tscriptElement.addEventListener('load', loadEventListener);\n\t\t\tscriptElement.addEventListener('error', errorEventListener);\n\t\t\tif (this._amdPolicy) {\n\t\t\t\tscriptSrc = this._amdPolicy.createScriptURL(scriptSrc) as any as string;\n\t\t\t}\n\t\t\tscriptElement.setAttribute('src', scriptSrc);\n\t\t\tdocument.getElementsByTagName('head')[0].appendChild(scriptElement);\n\t\t});\n\t}\n\n\tprivate _workerLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\treturn new Promise<DefineCall | undefined>((resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tif (this._amdPolicy) {\n\t\t\t\t\tscriptSrc = this._amdPolicy.createScriptURL(scriptSrc) as any as string;\n\t\t\t\t}\n\t\t\t\timportScripts(scriptSrc);\n\t\t\t\tresolve(this._defineCalls.pop());\n\t\t\t} catch (err) {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async _nodeJSLoadScript(scriptSrc: string): Promise<DefineCall | undefined> {\n\t\ttry {\n\t\t\tconst fs = <typeof import('fs')>globalThis._VSCODE_NODE_MODULES['fs'];\n\t\t\tconst vm = <typeof import('vm')>globalThis._VSCODE_NODE_MODULES['vm'];\n\t\t\tconst module = <typeof import('module')>globalThis._VSCODE_NODE_MODULES['module'];\n\n\t\t\tconst filePath = URI.parse(scriptSrc).fsPath;\n\t\t\tconst content = fs.readFileSync(filePath).toString();\n\t\t\tconst scriptSource = module.wrap(content.replace(/^#!.*/, ''));\n\t\t\tconst script = new vm.Script(scriptSource);\n\t\t\tconst compileWrapper = script.runInThisContext();\n\t\t\tcompileWrapper.apply();\n\t\t\treturn this._defineCalls.pop();\n\n\t\t} catch (error) {\n\t\t\tthrow error;\n\t\t}\n\t}\n}\n\nconst cache = new Map<string, Promise<any>>();\n\nlet _paths: Record<string, string> = {};\nif (typeof globalThis.require === 'object') {\n\t_paths = (<Record<string, any>>globalThis.require).paths ?? {};\n}\n\n/**\n * Utility for importing an AMD node module. This util supports AMD and ESM contexts and should be used while the ESM adoption\n * is on its way.\n *\n * e.g. pass in `vscode-textmate/release/main.js`\n */\nexport async function importAMDNodeModule<T>(nodeModuleName: string, pathInsideNodeModule: string, isBuilt?: boolean): Promise<T> {\n\tif (isESM) {\n\n\t\tif (isBuilt === undefined) {\n\t\t\tconst product = globalThis._VSCODE_PRODUCT_JSON as unknown as IProductConfiguration;\n\t\t\tisBuilt = Boolean((product ?? (<any>globalThis).vscode?.context?.configuration()?.product)?.commit);\n\t\t}\n\n\t\tif (_paths[nodeModuleName]) {\n\t\t\tnodeModuleName = _paths[nodeModuleName];\n\t\t}\n\n\t\tconst nodeModulePath = `${nodeModuleName}/${pathInsideNodeModule}`;\n\t\tif (cache.has(nodeModulePath)) {\n\t\t\treturn cache.get(nodeModulePath)!;\n\t\t}\n\t\tlet scriptSrc: string;\n\t\tif (/^\\w[\\w\\d+.-]*:\\/\\//.test(nodeModulePath)) {\n\t\t\t// looks like a URL\n\t\t\t// bit of a special case for: src/vs/workbench/services/languageDetection/browser/languageDetectionSimpleWorker.ts\n\t\t\tscriptSrc = nodeModulePath;\n\t\t} else {\n\t\t\tconst useASAR = (isBuilt && !platform.isWeb);\n\t\t\tconst actualNodeModulesPath = (useASAR ? nodeModulesAsarPath : nodeModulesPath);\n\t\t\tconst resourcePath: AppResourcePath = `${actualNodeModulesPath}/${nodeModulePath}`;\n\t\t\tscriptSrc = FileAccess.asBrowserUri(resourcePath).toString(true);\n\t\t}\n\t\tconst result = AMDModuleImporter.INSTANCE.load<T>(scriptSrc);\n\t\tcache.set(nodeModulePath, result);\n\t\treturn result;\n\t} else {\n\t\treturn await import(nodeModuleName);\n\t}\n}\n"]}