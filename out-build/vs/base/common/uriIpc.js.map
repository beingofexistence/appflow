{"version":3,"sources":["file:///workspace/appflow/src/vs/base/common/uriIpc.ts"],"names":[],"mappings":"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","file":"uriIpc.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { MarshalledObject } from 'vs/base/common/marshalling';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { URI, UriComponents } from 'vs/base/common/uri';\n\nexport interface IURITransformer {\n\ttransformIncoming(uri: UriComponents): UriComponents;\n\ttransformOutgoing(uri: UriComponents): UriComponents;\n\ttransformOutgoingURI(uri: URI): URI;\n\ttransformOutgoingScheme(scheme: string): string;\n}\n\nexport interface UriParts {\n\tscheme: string;\n\tauthority?: string;\n\tpath?: string;\n\tquery?: string;\n\tfragment?: string;\n}\n\nexport interface IRawURITransformer {\n\ttransformIncoming(uri: UriParts): UriParts;\n\ttransformOutgoing(uri: UriParts): UriParts;\n\ttransformOutgoingScheme(scheme: string): string;\n}\n\nfunction toJSON(uri: URI): UriComponents {\n\treturn <UriComponents><any>uri.toJSON();\n}\n\nexport class URITransformer implements IURITransformer {\n\n\tprivate readonly _uriTransformer: IRawURITransformer;\n\n\tconstructor(uriTransformer: IRawURITransformer) {\n\t\tthis._uriTransformer = uriTransformer;\n\t}\n\n\tpublic transformIncoming(uri: UriComponents): UriComponents {\n\t\tconst result = this._uriTransformer.transformIncoming(uri);\n\t\treturn (result === uri ? uri : toJSON(URI.from(result)));\n\t}\n\n\tpublic transformOutgoing(uri: UriComponents): UriComponents {\n\t\tconst result = this._uriTransformer.transformOutgoing(uri);\n\t\treturn (result === uri ? uri : toJSON(URI.from(result)));\n\t}\n\n\tpublic transformOutgoingURI(uri: URI): URI {\n\t\tconst result = this._uriTransformer.transformOutgoing(uri);\n\t\treturn (result === uri ? uri : URI.from(result));\n\t}\n\n\tpublic transformOutgoingScheme(scheme: string): string {\n\t\treturn this._uriTransformer.transformOutgoingScheme(scheme);\n\t}\n}\n\nexport const DefaultURITransformer: IURITransformer = new class {\n\ttransformIncoming(uri: UriComponents) {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoing(uri: UriComponents): UriComponents {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoingURI(uri: URI): URI {\n\t\treturn uri;\n\t}\n\n\ttransformOutgoingScheme(scheme: string): string {\n\t\treturn scheme;\n\t}\n};\n\nfunction _transformOutgoingURIs(obj: any, transformer: IURITransformer, depth: number): any {\n\n\tif (!obj || depth > 200) {\n\t\treturn null;\n\t}\n\n\tif (typeof obj === 'object') {\n\t\tif (obj instanceof URI) {\n\t\t\treturn transformer.transformOutgoing(obj);\n\t\t}\n\n\t\t// walk object (or array)\n\t\tfor (const key in obj) {\n\t\t\tif (Object.hasOwnProperty.call(obj, key)) {\n\t\t\t\tconst r = _transformOutgoingURIs(obj[key], transformer, depth + 1);\n\t\t\t\tif (r !== null) {\n\t\t\t\t\tobj[key] = r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function transformOutgoingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformOutgoingURIs(obj, transformer, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n\n\nfunction _transformIncomingURIs(obj: any, transformer: IURITransformer, revive: boolean, depth: number): any {\n\n\tif (!obj || depth > 200) {\n\t\treturn null;\n\t}\n\n\tif (typeof obj === 'object') {\n\n\t\tif ((<MarshalledObject>obj).$mid === MarshalledId.Uri) {\n\t\t\treturn revive ? URI.revive(transformer.transformIncoming(obj)) : transformer.transformIncoming(obj);\n\t\t}\n\n\t\tif (obj instanceof VSBuffer) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// walk object (or array)\n\t\tfor (const key in obj) {\n\t\t\tif (Object.hasOwnProperty.call(obj, key)) {\n\t\t\t\tconst r = _transformIncomingURIs(obj[key], transformer, revive, depth + 1);\n\t\t\t\tif (r !== null) {\n\t\t\t\t\tobj[key] = r;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function transformIncomingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformIncomingURIs(obj, transformer, false, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n\nexport function transformAndReviveIncomingURIs<T>(obj: T, transformer: IURITransformer): T {\n\tconst result = _transformIncomingURIs(obj, transformer, true, 0);\n\tif (result === null) {\n\t\t// no change\n\t\treturn obj;\n\t}\n\treturn result;\n}\n"]}