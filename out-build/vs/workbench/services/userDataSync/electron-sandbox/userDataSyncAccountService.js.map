{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/services/userDataSync/electron-sandbox/userDataSyncAccountService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IASzF,IAAM,IAAI,GAAV,MAAM,IAA2B,SAAQ,eAAG;QAOlD,IAAI,OAAO,KAAuC,OAAO,IAAI,CAAC,CAAC,CAAQ,CAAC,CAAC;QAEzE,IAAI,aAAa,KAAqB,OAAO,IAAI,CAAC,CAAC,CAAO,MAAM,CAAU,eAAe,CAAC,CAAC,CAAC,CAAC;QAK7F,YACwB,oBAA0B;YAEjD,KAAK,EAAE,CAAC;YAND,MAAC,GAAgE,IAAI,CAAC,CAAC,CAAS,IAAI,WAAG,EAAwC,CAAC,CAAC;YAChI,uBAAkB,GAA4C,IAAI,CAAC,CAAC,CAAmB,KAAK,CAAC;YAMrG,IAAI,CAAC,CAAC,GAAS,oBAAoB,CAAC,UAAU,CAAC,qBAAqB,CAAC,CAAC;YACtE,IAAI,CAAC,CAAC,CAAO,IAAI,CAAmC,iBAAiB,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;gBACrF,IAAI,CAAC,CAAC,GAAU,OAAO,CAAC;gBACxB,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAO,MAAM,CAAmC,oBAAoB,CAAC,CAAC,OAAO,CAAC,EAAE;oBACpG,IAAI,CAAC,CAAC,GAAU,OAAO,CAAC;oBACxB,IAAI,CAAC,CAAC,CAAmB,IAAI,CAAC,OAAO,CAAC,CAAC;gBACxC,CAAC,CAAC,CAAC,CAAC;YACL,CAAC,CAAC,CAAC;QACJ,CAAC;QAED,aAAa,CAAC,OAAyC;YACtD,OAAO,IAAI,CAAC,CAAC,CAAO,IAAI,CAAC,eAAe,EAAE,OAAO,CAAC,CAAC;QACpD,CAAC;KAED,CAAA;IAhCY,oBAAI;mBAAJ,IAAI;QAed,WAAA,eAAI,CAAA;OAfM,IAAI,CAgChB;IAED,IAAA,gBAAG,EAAe,0BAAI,EAAyB,IAAI,oCAAkD,CAAC","file":"userDataSyncAccountService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IChannel } from 'vs/base/parts/ipc/common/ipc';\nimport { ISharedProcessService } from 'vs/platform/ipc/electron-sandbox/services';\nimport { InstantiationType, registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { IUserDataSyncAccountService, IUserDataSyncAccount } from 'vs/platform/userDataSync/common/userDataSyncAccount';\n\nexport class UserDataSyncAccountService extends Disposable implements IUserDataSyncAccountService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly channel: IChannel;\n\n\tprivate _account: IUserDataSyncAccount | undefined;\n\tget account(): IUserDataSyncAccount | undefined { return this._account; }\n\n\tget onTokenFailed(): Event<boolean> { return this.channel.listen<boolean>('onTokenFailed'); }\n\n\tprivate _onDidChangeAccount: Emitter<IUserDataSyncAccount | undefined> = this._register(new Emitter<IUserDataSyncAccount | undefined>());\n\treadonly onDidChangeAccount: Event<IUserDataSyncAccount | undefined> = this._onDidChangeAccount.event;\n\n\tconstructor(\n\t\t@ISharedProcessService sharedProcessService: ISharedProcessService,\n\t) {\n\t\tsuper();\n\t\tthis.channel = sharedProcessService.getChannel('userDataSyncAccount');\n\t\tthis.channel.call<IUserDataSyncAccount | undefined>('_getInitialData').then(account => {\n\t\t\tthis._account = account;\n\t\t\tthis._register(this.channel.listen<IUserDataSyncAccount | undefined>('onDidChangeAccount')(account => {\n\t\t\t\tthis._account = account;\n\t\t\t\tthis._onDidChangeAccount.fire(account);\n\t\t\t}));\n\t\t});\n\t}\n\n\tupdateAccount(account: IUserDataSyncAccount | undefined): Promise<undefined> {\n\t\treturn this.channel.call('updateAccount', account);\n\t}\n\n}\n\nregisterSingleton(IUserDataSyncAccountService, UserDataSyncAccountService, InstantiationType.Delayed);\n"]}