{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/services/userActivity/test/browser/domActivityTracker.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;IAQhG,KAAK,CAAC,oBAAoB,EAAE,GAAG,EAAE;QAChC,IAAI,GAAS,CAAgB;QAC7B,IAAI,GAAS,CAAe;QAC5B,IAAI,KAAW,CAAqB;QACpC,IAAI,KAA4B,CAAC;QACjC,MAAM,mBAAmB,GAAG,CAAC,GAAG,KAAM,CAAC,CAAC,yDAAyD;QAEjG,KAAK,CAAC,GAAG,EAAE;YACV,KAAK,GAAG,KAAK,CAAC,aAAa,EAAE,CAAC;YAC9B,KAAK,GAAG,IAAI,+BAAI,EAAsB,CAAC;YACvC,GAAG,GAAG,IAAI,0BAAI,CAAgB,KAAK,CAAC,CAAC;YACrC,GAAG,GAAG,IAAI,yBAAI,CAAe,GAAG,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;QAEH,QAAQ,CAAC,GAAG,EAAE;YACb,GAAG,CAAC,OAAO,EAAE,CAAC;YACd,GAAG,CAAC,OAAO,EAAE,CAAC;YACd,KAAK,CAAC,OAAO,EAAE,CAAC;YAChB,KAAK,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC,CAAC,CAAC;QAGH,IAAI,CAAC,4BAA4B,EAAE,GAAG,EAAE;YACvC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YACjC,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sCAAsC,EAAE,GAAG,EAAE;YACjD,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YAEjC,MAAM,GAAG,GAAG,EAAE,CAAC;YACf,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;gBAC7B,QAAQ,CAAC,aAAa,CAAC,IAAI,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;gBAClD,KAAK,CAAC,IAAI,CAAC,mBAAmB,GAAG,GAAG,CAAC,CAAC;aACtC;YAED,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAClC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,uBAAuB,EAAE,GAAG,EAAE;YAClC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YACjC,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;YAElC,QAAQ,CAAC,aAAa,CAAC,IAAI,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC;YAClD,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;YAEjC,KAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;YAChC,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC","file":"domActivityTracker.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { TestInstantiationService } from 'vs/platform/instantiation/test/common/instantiationServiceMock';\nimport { DomActivityTracker } from 'vs/workbench/services/userActivity/browser/domActivityTracker';\nimport { UserActivityService } from 'vs/workbench/services/userActivity/common/userActivityService';\nimport * as sinon from 'sinon';\nimport * as assert from 'assert';\n\nsuite('DomActivityTracker', () => {\n\tlet uas: UserActivityService;\n\tlet dom: DomActivityTracker;\n\tlet insta: TestInstantiationService;\n\tlet clock: sinon.SinonFakeTimers;\n\tconst maxTimeToBecomeIdle = 3 * 30_000; // (MIN_INTERVALS_WITHOUT_ACTIVITY + 1) * CHECK_INTERVAL;\n\n\tsetup(() => {\n\t\tclock = sinon.useFakeTimers();\n\t\tinsta = new TestInstantiationService();\n\t\tuas = new UserActivityService(insta);\n\t\tdom = new DomActivityTracker(uas);\n\t});\n\n\tteardown(() => {\n\t\tdom.dispose();\n\t\tuas.dispose();\n\t\tclock.restore();\n\t\tinsta.dispose();\n\t});\n\n\n\ttest('marks inactive on no input', () => {\n\t\tassert.equal(uas.isActive, true);\n\t\tclock.tick(maxTimeToBecomeIdle);\n\t\tassert.equal(uas.isActive, false);\n\t});\n\n\ttest('preserves activity state when active', () => {\n\t\tassert.equal(uas.isActive, true);\n\n\t\tconst div = 10;\n\t\tfor (let i = 0; i < div; i++) {\n\t\t\tdocument.dispatchEvent(new MouseEvent('keydown'));\n\t\t\tclock.tick(maxTimeToBecomeIdle / div);\n\t\t}\n\n\t\tassert.equal(uas.isActive, true);\n\t});\n\n\ttest('restores active state', () => {\n\t\tassert.equal(uas.isActive, true);\n\t\tclock.tick(maxTimeToBecomeIdle);\n\t\tassert.equal(uas.isActive, false);\n\n\t\tdocument.dispatchEvent(new MouseEvent('keydown'));\n\t\tassert.equal(uas.isActive, true);\n\n\t\tclock.tick(maxTimeToBecomeIdle);\n\t\tassert.equal(uas.isActive, false);\n\t});\n});\n"]}