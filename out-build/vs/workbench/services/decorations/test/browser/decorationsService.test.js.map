{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/services/decorations/test/browser/decorationsService.test.ts"],"names":[],"mappings":"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","file":"decorationsService.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { DecorationsService } from 'vs/workbench/services/decorations/browser/decorationsService';\nimport { IDecorationsProvider, IDecorationData } from 'vs/workbench/services/decorations/common/decorations';\nimport { URI } from 'vs/base/common/uri';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport * as resources from 'vs/base/common/resources';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { mock } from 'vs/base/test/common/mock';\nimport { IUriIdentityService } from 'vs/platform/uriIdentity/common/uriIdentity';\nimport { TestThemeService } from 'vs/platform/theme/test/common/testThemeService';\nimport { runWithFakedTimers } from 'vs/base/test/common/timeTravelScheduler';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from 'vs/base/test/common/utils';\n\nsuite('DecorationsService', function () {\n\n\tlet service: DecorationsService;\n\n\tsetup(function () {\n\t\tservice = new DecorationsService(\n\t\t\tnew class extends mock<IUriIdentityService>() {\n\t\t\t\toverride extUri = resources.extUri;\n\t\t\t},\n\t\t\tnew TestThemeService()\n\t\t);\n\t});\n\n\tteardown(function () {\n\t\tservice.dispose();\n\t});\n\n\tconst store = ensureNoDisposablesAreLeakedInTestSuite();\n\n\n\ttest('Async provider, async/evented result', function () {\n\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tconst uri = URI.parse('foo:bar');\n\t\t\tlet callCounter = 0;\n\n\t\t\tconst reg = service.registerDecorationsProvider(new class implements IDecorationsProvider {\n\t\t\t\treadonly label: string = 'Test';\n\t\t\t\treadonly onDidChange: Event<readonly URI[]> = Event.None;\n\t\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\t\tcallCounter += 1;\n\t\t\t\t\treturn new Promise<IDecorationData>(resolve => {\n\t\t\t\t\t\tsetTimeout(() => resolve({\n\t\t\t\t\t\t\tcolor: 'someBlue',\n\t\t\t\t\t\t\ttooltip: 'T',\n\t\t\t\t\t\t\tstrikethrough: true\n\t\t\t\t\t\t}));\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// trigger -> async\n\t\t\tassert.strictEqual(service.getDecoration(uri, false), undefined);\n\t\t\tassert.strictEqual(callCounter, 1);\n\n\t\t\t// event when result is computed\n\t\t\tconst e = await Event.toPromise(service.onDidChangeDecorations);\n\t\t\tassert.strictEqual(e.affectsResource(uri), true);\n\t\t\t// sync result\n\t\t\tassert.deepStrictEqual(service.getDecoration(uri, false)!.tooltip, 'T');\n\t\t\tassert.deepStrictEqual(service.getDecoration(uri, false)!.strikethrough, true);\n\t\t\tassert.strictEqual(callCounter, 1);\n\n\t\t\treg.dispose();\n\t\t});\n\t});\n\n\ttest('Sync provider, sync result', function () {\n\n\t\tconst uri = URI.parse('foo:bar');\n\t\tlet callCounter = 0;\n\n\t\tconst reg = service.registerDecorationsProvider(new class implements IDecorationsProvider {\n\t\t\treadonly label: string = 'Test';\n\t\t\treadonly onDidChange: Event<readonly URI[]> = Event.None;\n\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\tcallCounter += 1;\n\t\t\t\treturn { color: 'someBlue', tooltip: 'Z' };\n\t\t\t}\n\t\t});\n\n\t\t// trigger -> sync\n\t\tassert.deepStrictEqual(service.getDecoration(uri, false)!.tooltip, 'Z');\n\t\tassert.deepStrictEqual(service.getDecoration(uri, false)!.strikethrough, false);\n\t\tassert.strictEqual(callCounter, 1);\n\n\t\treg.dispose();\n\t});\n\n\ttest('Clear decorations on provider dispose', async function () {\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tconst uri = URI.parse('foo:bar');\n\t\t\tlet callCounter = 0;\n\n\t\t\tconst reg = service.registerDecorationsProvider(new class implements IDecorationsProvider {\n\t\t\t\treadonly label: string = 'Test';\n\t\t\t\treadonly onDidChange: Event<readonly URI[]> = Event.None;\n\t\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\t\tcallCounter += 1;\n\t\t\t\t\treturn { color: 'someBlue', tooltip: 'J' };\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// trigger -> sync\n\t\t\tassert.deepStrictEqual(service.getDecoration(uri, false)!.tooltip, 'J');\n\t\t\tassert.strictEqual(callCounter, 1);\n\n\t\t\t// un-register -> ensure good event\n\t\t\tlet didSeeEvent = false;\n\t\t\tconst p = new Promise<void>(resolve => {\n\t\t\t\tconst l = service.onDidChangeDecorations(e => {\n\t\t\t\t\tassert.strictEqual(e.affectsResource(uri), true);\n\t\t\t\t\tassert.deepStrictEqual(service.getDecoration(uri, false), undefined);\n\t\t\t\t\tassert.strictEqual(callCounter, 1);\n\t\t\t\t\tdidSeeEvent = true;\n\t\t\t\t\tl.dispose();\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t});\n\t\t\treg.dispose(); // will clear all data\n\t\t\tawait p;\n\t\t\tassert.strictEqual(didSeeEvent, true);\n\n\t\t});\n\t});\n\n\ttest('No default bubbling', function () {\n\n\t\tlet reg = service.registerDecorationsProvider({\n\t\t\tlabel: 'Test',\n\t\t\tonDidChange: Event.None,\n\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\treturn uri.path.match(/\\.txt/)\n\t\t\t\t\t? { tooltip: '.txt', weight: 17 }\n\t\t\t\t\t: undefined;\n\t\t\t}\n\t\t});\n\n\t\tconst childUri = URI.parse('file:///some/path/some/file.txt');\n\n\t\tlet deco = service.getDecoration(childUri, false)!;\n\t\tassert.strictEqual(deco.tooltip, '.txt');\n\n\t\tdeco = service.getDecoration(childUri.with({ path: 'some/path/' }), true)!;\n\t\tassert.strictEqual(deco, undefined);\n\t\treg.dispose();\n\n\t\t// bubble\n\t\treg = service.registerDecorationsProvider({\n\t\t\tlabel: 'Test',\n\t\t\tonDidChange: Event.None,\n\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\treturn uri.path.match(/\\.txt/)\n\t\t\t\t\t? { tooltip: '.txt.bubble', weight: 71, bubble: true }\n\t\t\t\t\t: undefined;\n\t\t\t}\n\t\t});\n\n\t\tdeco = service.getDecoration(childUri, false)!;\n\t\tassert.strictEqual(deco.tooltip, '.txt.bubble');\n\n\t\tdeco = service.getDecoration(childUri.with({ path: 'some/path/' }), true)!;\n\t\tassert.strictEqual(typeof deco.tooltip, 'string');\n\t\treg.dispose();\n\t});\n\n\ttest('Decorations not showing up for second root folder #48502', async function () {\n\n\t\tlet cancelCount = 0;\n\t\tlet callCount = 0;\n\n\t\tconst provider = new class implements IDecorationsProvider {\n\n\t\t\t_onDidChange = new Emitter<URI[]>();\n\t\t\tonDidChange: Event<readonly URI[]> = this._onDidChange.event;\n\n\t\t\tlabel: string = 'foo';\n\n\t\t\tprovideDecorations(uri: URI, token: CancellationToken): Promise<IDecorationData> {\n\n\t\t\t\tstore.add(token.onCancellationRequested(() => {\n\t\t\t\t\tcancelCount += 1;\n\t\t\t\t}));\n\n\t\t\t\treturn new Promise(resolve => {\n\t\t\t\t\tcallCount += 1;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tresolve({ letter: 'foo' });\n\t\t\t\t\t}, 10);\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\t\tconst reg = service.registerDecorationsProvider(provider);\n\n\t\tconst uri = URI.parse('foo://bar');\n\t\tconst d1 = service.getDecoration(uri, false);\n\n\t\tprovider._onDidChange.fire([uri]);\n\t\tconst d2 = service.getDecoration(uri, false);\n\n\t\tassert.strictEqual(cancelCount, 1);\n\t\tassert.strictEqual(callCount, 2);\n\n\t\td1?.dispose();\n\t\td2?.dispose();\n\t\treg.dispose();\n\t});\n\n\ttest('Decorations not bubbling... #48745', function () {\n\n\t\tconst reg = service.registerDecorationsProvider({\n\t\t\tlabel: 'Test',\n\t\t\tonDidChange: Event.None,\n\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\tif (uri.path.match(/hello$/)) {\n\t\t\t\t\treturn { tooltip: 'FOO', weight: 17, bubble: true };\n\t\t\t\t} else {\n\t\t\t\t\treturn new Promise<IDecorationData>(_resolve => { });\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst data1 = service.getDecoration(URI.parse('a:b/'), true);\n\t\tassert.ok(!data1);\n\n\t\tconst data2 = service.getDecoration(URI.parse('a:b/c.hello'), false)!;\n\t\tassert.ok(data2.tooltip);\n\n\t\tconst data3 = service.getDecoration(URI.parse('a:b/'), true);\n\t\tassert.ok(data3);\n\n\n\t\treg.dispose();\n\t});\n\n\ttest('Folder decorations don\\'t go away when file with problems is deleted #61919 (part1)', function () {\n\n\t\tconst emitter = new Emitter<URI[]>();\n\t\tlet gone = false;\n\t\tconst reg = service.registerDecorationsProvider({\n\t\t\tlabel: 'Test',\n\t\t\tonDidChange: emitter.event,\n\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\tif (!gone && uri.path.match(/file.ts$/)) {\n\t\t\t\t\treturn { tooltip: 'FOO', weight: 17, bubble: true };\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\n\t\tconst uri = URI.parse('foo:/folder/file.ts');\n\t\tconst uri2 = URI.parse('foo:/folder/');\n\t\tlet data = service.getDecoration(uri, true)!;\n\t\tassert.strictEqual(data.tooltip, 'FOO');\n\n\t\tdata = service.getDecoration(uri2, true)!;\n\t\tassert.ok(data.tooltip); // emphazied items...\n\n\t\tgone = true;\n\t\temitter.fire([uri]);\n\n\t\tdata = service.getDecoration(uri, true)!;\n\t\tassert.strictEqual(data, undefined);\n\n\t\tdata = service.getDecoration(uri2, true)!;\n\t\tassert.strictEqual(data, undefined);\n\n\t\treg.dispose();\n\t});\n\n\ttest('Folder decorations don\\'t go away when file with problems is deleted #61919 (part2)', function () {\n\n\t\treturn runWithFakedTimers({}, async function () {\n\n\t\t\tconst emitter = new Emitter<URI[]>();\n\t\t\tlet gone = false;\n\t\t\tconst reg = service.registerDecorationsProvider({\n\t\t\t\tlabel: 'Test',\n\t\t\t\tonDidChange: emitter.event,\n\t\t\t\tprovideDecorations(uri: URI) {\n\t\t\t\t\tif (!gone && uri.path.match(/file.ts$/)) {\n\t\t\t\t\t\treturn { tooltip: 'FOO', weight: 17, bubble: true };\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst uri = URI.parse('foo:/folder/file.ts');\n\t\t\tconst uri2 = URI.parse('foo:/folder/');\n\t\t\tlet data = service.getDecoration(uri, true)!;\n\t\t\tassert.strictEqual(data.tooltip, 'FOO');\n\n\t\t\tdata = service.getDecoration(uri2, true)!;\n\t\t\tassert.ok(data.tooltip); // emphazied items...\n\n\t\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\t\tconst l = service.onDidChangeDecorations(e => {\n\t\t\t\t\tl.dispose();\n\t\t\t\t\ttry {\n\t\t\t\t\t\tassert.ok(e.affectsResource(uri));\n\t\t\t\t\t\tassert.ok(e.affectsResource(uri2));\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t\treg.dispose();\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t\treg.dispose();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tgone = true;\n\t\t\t\temitter.fire([uri]);\n\t\t\t});\n\t\t});\n\t});\n\n\ttest('FileDecorationProvider intermittently fails #133210', async function () {\n\n\t\tconst invokeOrder: string[] = [];\n\n\t\tstore.add(service.registerDecorationsProvider(new class {\n\t\t\tlabel = 'Provider-1';\n\t\t\tonDidChange = Event.None;\n\t\t\tprovideDecorations() {\n\t\t\t\tinvokeOrder.push(this.label);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tstore.add(service.registerDecorationsProvider(new class {\n\t\t\tlabel = 'Provider-2';\n\t\t\tonDidChange = Event.None;\n\t\t\tprovideDecorations() {\n\t\t\t\tinvokeOrder.push(this.label);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tservice.getDecoration(URI.parse('test://me/path'), false);\n\n\t\tassert.deepStrictEqual(invokeOrder, ['Provider-2', 'Provider-1']);\n\t});\n});\n"]}