{"version":3,"sources":["vs/workbench/services/language/common/languageService.ts"],"names":[],"mappings":"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","file":"languageService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { clearConfiguredLanguageAssociations, registerConfiguredLanguageAssociation } from 'vs/editor/common/services/languagesAssociations';\nimport { joinPath } from 'vs/base/common/resources';\nimport { URI } from 'vs/base/common/uri';\nimport { ILanguageExtensionPoint, ILanguageService } from 'vs/editor/common/languages/language';\nimport { LanguageService } from 'vs/editor/common/services/languageService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IEnvironmentService } from 'vs/platform/environment/common/environment';\nimport { FILES_ASSOCIATIONS_CONFIG, IFilesConfiguration } from 'vs/platform/files/common/files';\nimport { IExtensionService } from 'vs/workbench/services/extensions/common/extensions';\nimport { ExtensionMessageCollector, ExtensionsRegistry, IExtensionPoint, IExtensionPointUser } from 'vs/workbench/services/extensions/common/extensionsRegistry';\nimport { InstantiationType, registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { ILogService } from 'vs/platform/log/common/log';\n\nexport interface IRawLanguageExtensionPoint {\n\tid: string;\n\textensions: string[];\n\tfilenames: string[];\n\tfilenamePatterns: string[];\n\tfirstLine: string;\n\taliases: string[];\n\tmimetypes: string[];\n\tconfiguration: string;\n\ticon: { light: string; dark: string };\n}\n\nexport const languagesExtPoint: IExtensionPoint<IRawLanguageExtensionPoint[]> = ExtensionsRegistry.registerExtensionPoint<IRawLanguageExtensionPoint[]>({\n\textensionPoint: 'languages',\n\tjsonSchema: {\n\t\tdescription: localize('vscode.extension.contributes.languages', 'Contributes language declarations.'),\n\t\ttype: 'array',\n\t\titems: {\n\t\t\ttype: 'object',\n\t\t\tdefaultSnippets: [{ body: { id: '${1:languageId}', aliases: ['${2:label}'], extensions: ['${3:extension}'], configuration: './language-configuration.json' } }],\n\t\t\tproperties: {\n\t\t\t\tid: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.id', 'ID of the language.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\taliases: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.aliases', 'Name aliases for the language.'),\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\textensions: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.extensions', 'File extensions associated to the language.'),\n\t\t\t\t\tdefault: ['.foo'],\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfilenames: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.filenames', 'File names associated to the language.'),\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfilenamePatterns: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.filenamePatterns', 'File name glob patterns associated to the language.'),\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmimetypes: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.mimetypes', 'Mime types associated to the language.'),\n\t\t\t\t\ttype: 'array',\n\t\t\t\t\titems: {\n\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfirstLine: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.firstLine', 'A regular expression matching the first line of a file of the language.'),\n\t\t\t\t\ttype: 'string'\n\t\t\t\t},\n\t\t\t\tconfiguration: {\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.configuration', 'A relative path to a file containing configuration options for the language.'),\n\t\t\t\t\ttype: 'string',\n\t\t\t\t\tdefault: './language-configuration.json'\n\t\t\t\t},\n\t\t\t\ticon: {\n\t\t\t\t\ttype: 'object',\n\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.icon', 'A icon to use as file icon, if no icon theme provides one for the language.'),\n\t\t\t\t\tproperties: {\n\t\t\t\t\t\tlight: {\n\t\t\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.icon.light', 'Icon path when a light theme is used'),\n\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdark: {\n\t\t\t\t\t\t\tdescription: localize('vscode.extension.contributes.languages.icon.dark', 'Icon path when a dark theme is used'),\n\t\t\t\t\t\t\ttype: 'string'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\tactivationEventsGenerator: (languageContributions, result) => {\n\t\tfor (const languageContribution of languageContributions) {\n\t\t\tif (languageContribution.id && languageContribution.configuration) {\n\t\t\t\tresult.push(`onLanguage:${languageContribution.id}`);\n\t\t\t}\n\t\t}\n\t}\n});\n\nexport class WorkbenchLanguageService extends LanguageService {\n\tprivate _configurationService: IConfigurationService;\n\tprivate _extensionService: IExtensionService;\n\n\tconstructor(\n\t\t@IExtensionService extensionService: IExtensionService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IEnvironmentService environmentService: IEnvironmentService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tsuper(environmentService.verbose || environmentService.isExtensionDevelopment || !environmentService.isBuilt);\n\t\tthis._configurationService = configurationService;\n\t\tthis._extensionService = extensionService;\n\n\t\tlanguagesExtPoint.setHandler((extensions: readonly IExtensionPointUser<IRawLanguageExtensionPoint[]>[]) => {\n\t\t\tconst allValidLanguages: ILanguageExtensionPoint[] = [];\n\n\t\t\tfor (let i = 0, len = extensions.length; i < len; i++) {\n\t\t\t\tconst extension = extensions[i];\n\n\t\t\t\tif (!Array.isArray(extension.value)) {\n\t\t\t\t\textension.collector.error(localize('invalid', \"Invalid `contributes.{0}`. Expected an array.\", languagesExtPoint.name));\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tfor (let j = 0, lenJ = extension.value.length; j < lenJ; j++) {\n\t\t\t\t\tconst ext = extension.value[j];\n\t\t\t\t\tif (isValidLanguageExtensionPoint(ext, extension.description, extension.collector)) {\n\t\t\t\t\t\tlet configuration: URI | undefined = undefined;\n\t\t\t\t\t\tif (ext.configuration) {\n\t\t\t\t\t\t\tconfiguration = joinPath(extension.description.extensionLocation, ext.configuration);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tallValidLanguages.push({\n\t\t\t\t\t\t\tid: ext.id,\n\t\t\t\t\t\t\textensions: ext.extensions,\n\t\t\t\t\t\t\tfilenames: ext.filenames,\n\t\t\t\t\t\t\tfilenamePatterns: ext.filenamePatterns,\n\t\t\t\t\t\t\tfirstLine: ext.firstLine,\n\t\t\t\t\t\t\taliases: ext.aliases,\n\t\t\t\t\t\t\tmimetypes: ext.mimetypes,\n\t\t\t\t\t\t\tconfiguration: configuration,\n\t\t\t\t\t\t\ticon: ext.icon && {\n\t\t\t\t\t\t\t\tlight: joinPath(extension.description.extensionLocation, ext.icon.light),\n\t\t\t\t\t\t\t\tdark: joinPath(extension.description.extensionLocation, ext.icon.dark)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._registry.setDynamicLanguages(allValidLanguages);\n\n\t\t});\n\n\t\tthis.updateMime();\n\t\tthis._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(FILES_ASSOCIATIONS_CONFIG)) {\n\t\t\t\tthis.updateMime();\n\t\t\t}\n\t\t});\n\t\tthis._extensionService.whenInstalledExtensionsRegistered().then(() => {\n\t\t\tthis.updateMime();\n\t\t});\n\n\t\tthis._register(this.onDidRequestRichLanguageFeatures((languageId) => {\n\t\t\t// extension activation\n\t\t\tthis._extensionService.activateByEvent(`onLanguage:${languageId}`);\n\t\t\tthis._extensionService.activateByEvent(`onLanguage`);\n\t\t}));\n\t}\n\n\tprivate updateMime(): void {\n\t\tconst configuration = this._configurationService.getValue<IFilesConfiguration>();\n\n\t\t// Clear user configured mime associations\n\t\tclearConfiguredLanguageAssociations();\n\n\t\t// Register based on settings\n\t\tif (configuration.files?.associations) {\n\t\t\tObject.keys(configuration.files.associations).forEach(pattern => {\n\t\t\t\tconst langId = configuration.files.associations[pattern];\n\t\t\t\tif (typeof langId !== 'string') {\n\t\t\t\t\tthis.logService.warn(`Ignoring configured 'files.associations' for '${pattern}' because its type is not a string but '${typeof langId}'`);\n\n\t\t\t\t\treturn; // https://github.com/microsoft/vscode/issues/147284\n\t\t\t\t}\n\n\t\t\t\tconst mimeType = this.getMimeType(langId) || `text/x-${langId}`;\n\n\t\t\t\tregisterConfiguredLanguageAssociation({ id: langId, mime: mimeType, filepattern: pattern });\n\t\t\t});\n\t\t}\n\n\t\tthis._onDidChange.fire();\n\t}\n}\n\nfunction isUndefinedOrStringArray(value: string[]): boolean {\n\tif (typeof value === 'undefined') {\n\t\treturn true;\n\t}\n\tif (!Array.isArray(value)) {\n\t\treturn false;\n\t}\n\treturn value.every(item => typeof item === 'string');\n}\n\nfunction isValidLanguageExtensionPoint(value: IRawLanguageExtensionPoint, extension: IExtensionDescription, collector: ExtensionMessageCollector): boolean {\n\tif (!value) {\n\t\tcollector.error(localize('invalid.empty', \"Empty value for `contributes.{0}`\", languagesExtPoint.name));\n\t\treturn false;\n\t}\n\tif (typeof value.id !== 'string') {\n\t\tcollector.error(localize('require.id', \"property `{0}` is mandatory and must be of type `string`\", 'id'));\n\t\treturn false;\n\t}\n\tif (!isUndefinedOrStringArray(value.extensions)) {\n\t\tcollector.error(localize('opt.extensions', \"property `{0}` can be omitted and must be of type `string[]`\", 'extensions'));\n\t\treturn false;\n\t}\n\tif (!isUndefinedOrStringArray(value.filenames)) {\n\t\tcollector.error(localize('opt.filenames', \"property `{0}` can be omitted and must be of type `string[]`\", 'filenames'));\n\t\treturn false;\n\t}\n\tif (typeof value.firstLine !== 'undefined' && typeof value.firstLine !== 'string') {\n\t\tcollector.error(localize('opt.firstLine', \"property `{0}` can be omitted and must be of type `string`\", 'firstLine'));\n\t\treturn false;\n\t}\n\tif (typeof value.configuration !== 'undefined' && typeof value.configuration !== 'string') {\n\t\tcollector.error(localize('opt.configuration', \"property `{0}` can be omitted and must be of type `string`\", 'configuration'));\n\t\treturn false;\n\t}\n\tif (!isUndefinedOrStringArray(value.aliases)) {\n\t\tcollector.error(localize('opt.aliases', \"property `{0}` can be omitted and must be of type `string[]`\", 'aliases'));\n\t\treturn false;\n\t}\n\tif (!isUndefinedOrStringArray(value.mimetypes)) {\n\t\tcollector.error(localize('opt.mimetypes', \"property `{0}` can be omitted and must be of type `string[]`\", 'mimetypes'));\n\t\treturn false;\n\t}\n\tif (typeof value.icon !== 'undefined') {\n\t\tif (typeof value.icon !== 'object' || typeof value.icon.light !== 'string' || typeof value.icon.dark !== 'string') {\n\t\t\tcollector.error(localize('opt.icon', \"property `{0}` can be omitted and must be of type `object` with properties `{1}` and `{2}` of type `string`\", 'icon', 'light', 'dark'));\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nregisterSingleton(ILanguageService, WorkbenchLanguageService, InstantiationType.Eager);\n"]}