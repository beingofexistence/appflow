{"version":3,"sources":["vs/workbench/services/dialogs/browser/fileDialogService.ts"],"names":[],"mappings":"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","file":"fileDialogService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IPickAndOpenOptions, ISaveDialogOptions, IOpenDialogOptions, IFileDialogService, FileFilter, IPromptButton } from 'vs/platform/dialogs/common/dialogs';\nimport { URI } from 'vs/base/common/uri';\nimport { InstantiationType, registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { AbstractFileDialogService } from 'vs/workbench/services/dialogs/browser/abstractFileDialogService';\nimport { Schemas } from 'vs/base/common/network';\nimport { memoize } from 'vs/base/common/decorators';\nimport { HTMLFileSystemProvider } from 'vs/platform/files/browser/htmlFileSystemProvider';\nimport { localize } from 'vs/nls';\nimport { getMediaOrTextMime } from 'vs/base/common/mime';\nimport { basename } from 'vs/base/common/resources';\nimport { triggerDownload, triggerUpload } from 'vs/base/browser/dom';\nimport Severity from 'vs/base/common/severity';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { extractFileListData } from 'vs/platform/dnd/browser/dnd';\nimport { Iterable } from 'vs/base/common/iterator';\nimport { WebFileSystemAccess } from 'vs/platform/files/browser/webFileSystemAccess';\n\nexport class FileDialogService extends AbstractFileDialogService implements IFileDialogService {\n\n\t@memoize\n\tprivate get fileSystemProvider(): HTMLFileSystemProvider {\n\t\treturn this.fileService.getProvider(Schemas.file) as HTMLFileSystemProvider;\n\t}\n\n\tasync pickFileFolderAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFilePath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn super.pickFileFolderAndOpenSimplified(schema, options, false);\n\t\t}\n\n\t\tthrow new Error(localize('pickFolderAndOpen', \"Can't open folders, try adding a folder to the workspace instead.\"));\n\t}\n\n\tprotected override addFileSchemaIfNeeded(schema: string, isFolder: boolean): string[] {\n\t\treturn (schema === Schemas.untitled) ? [Schemas.file]\n\t\t\t: (((schema !== Schemas.file) && (!isFolder || (schema !== Schemas.vscodeRemote))) ? [schema, Schemas.file] : [schema]);\n\t}\n\n\tasync pickFileAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFilePath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn super.pickFileAndOpenSimplified(schema, options, false);\n\t\t}\n\n\t\tif (!WebFileSystemAccess.supported(window)) {\n\t\t\treturn this.showUnsupportedBrowserWarning('open');\n\t\t}\n\n\t\tlet fileHandle: FileSystemHandle | undefined = undefined;\n\t\ttry {\n\t\t\t([fileHandle] = await window.showOpenFilePicker({ multiple: false }));\n\t\t} catch (error) {\n\t\t\treturn; // `showOpenFilePicker` will throw an error when the user cancels\n\t\t}\n\n\t\tif (!WebFileSystemAccess.isFileSystemFileHandle(fileHandle)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst uri = await this.fileSystemProvider.registerFileHandle(fileHandle);\n\n\t\tthis.addFileToRecentlyOpened(uri);\n\n\t\tawait this.openerService.open(uri, { fromUserGesture: true, editorOptions: { pinned: true } });\n\t}\n\n\tasync pickFolderAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFolderPath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn super.pickFolderAndOpenSimplified(schema, options);\n\t\t}\n\n\t\tthrow new Error(localize('pickFolderAndOpen', \"Can't open folders, try adding a folder to the workspace instead.\"));\n\t}\n\n\tasync pickWorkspaceAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\toptions.availableFileSystems = this.getWorkspaceAvailableFileSystems(options);\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultWorkspacePath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn super.pickWorkspaceAndOpenSimplified(schema, options);\n\t\t}\n\n\t\tthrow new Error(localize('pickWorkspaceAndOpen', \"Can't open workspaces, try adding a folder to the workspace instead.\"));\n\t}\n\n\tasync pickFileToSave(defaultUri: URI, availableFileSystems?: string[]): Promise<URI | undefined> {\n\t\tconst schema = this.getFileSystemSchema({ defaultUri, availableFileSystems });\n\n\t\tconst options = this.getPickFileToSaveDialogOptions(defaultUri, availableFileSystems);\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn super.pickFileToSaveSimplified(schema, options);\n\t\t}\n\n\t\tif (!WebFileSystemAccess.supported(window)) {\n\t\t\treturn this.showUnsupportedBrowserWarning('save');\n\t\t}\n\n\t\tlet fileHandle: FileSystemHandle | undefined = undefined;\n\t\tconst startIn = Iterable.first(this.fileSystemProvider.directories);\n\n\t\ttry {\n\t\t\tfileHandle = await window.showSaveFilePicker({ types: this.getFilePickerTypes(options.filters), ...{ suggestedName: basename(defaultUri), startIn } });\n\t\t} catch (error) {\n\t\t\treturn; // `showSaveFilePicker` will throw an error when the user cancels\n\t\t}\n\n\t\tif (!WebFileSystemAccess.isFileSystemFileHandle(fileHandle)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this.fileSystemProvider.registerFileHandle(fileHandle);\n\t}\n\n\tprivate getFilePickerTypes(filters?: FileFilter[]): FilePickerAcceptType[] | undefined {\n\t\treturn filters?.filter(filter => {\n\t\t\treturn !((filter.extensions.length === 1) && ((filter.extensions[0] === '*') || filter.extensions[0] === ''));\n\t\t}).map(filter => {\n\t\t\tconst accept: Record<string, string[]> = {};\n\t\t\tconst extensions = filter.extensions.filter(ext => (ext.indexOf('-') < 0) && (ext.indexOf('*') < 0) && (ext.indexOf('_') < 0));\n\t\t\taccept[getMediaOrTextMime(`fileName.${filter.extensions[0]}`) ?? 'text/plain'] = extensions.map(ext => ext.startsWith('.') ? ext : `.${ext}`);\n\t\t\treturn {\n\t\t\t\tdescription: filter.name,\n\t\t\t\taccept\n\t\t\t};\n\t\t});\n\t}\n\n\tasync showSaveDialog(options: ISaveDialogOptions): Promise<URI | undefined> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn super.showSaveDialogSimplified(schema, options);\n\t\t}\n\n\t\tif (!WebFileSystemAccess.supported(window)) {\n\t\t\treturn this.showUnsupportedBrowserWarning('save');\n\t\t}\n\n\t\tlet fileHandle: FileSystemHandle | undefined = undefined;\n\t\tconst startIn = Iterable.first(this.fileSystemProvider.directories);\n\n\t\ttry {\n\t\t\tfileHandle = await window.showSaveFilePicker({ types: this.getFilePickerTypes(options.filters), ...options.defaultUri ? { suggestedName: basename(options.defaultUri) } : undefined, ...{ startIn } });\n\t\t} catch (error) {\n\t\t\treturn undefined; // `showSaveFilePicker` will throw an error when the user cancels\n\t\t}\n\n\t\tif (!WebFileSystemAccess.isFileSystemFileHandle(fileHandle)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this.fileSystemProvider.registerFileHandle(fileHandle);\n\t}\n\n\tasync showOpenDialog(options: IOpenDialogOptions): Promise<URI[] | undefined> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn super.showOpenDialogSimplified(schema, options);\n\t\t}\n\n\t\tif (!WebFileSystemAccess.supported(window)) {\n\t\t\treturn this.showUnsupportedBrowserWarning('open');\n\t\t}\n\n\t\tlet uri: URI | undefined;\n\t\tconst startIn = Iterable.first(this.fileSystemProvider.directories) ?? 'documents';\n\n\t\ttry {\n\t\t\tif (options.canSelectFiles) {\n\t\t\t\tconst handle = await window.showOpenFilePicker({ multiple: false, types: this.getFilePickerTypes(options.filters), ...{ startIn } });\n\t\t\t\tif (handle.length === 1 && WebFileSystemAccess.isFileSystemFileHandle(handle[0])) {\n\t\t\t\t\turi = await this.fileSystemProvider.registerFileHandle(handle[0]);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst handle = await window.showDirectoryPicker({ ...{ startIn } });\n\t\t\t\turi = await this.fileSystemProvider.registerDirectoryHandle(handle);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\t// ignore - `showOpenFilePicker` / `showDirectoryPicker` will throw an error when the user cancels\n\t\t}\n\n\t\treturn uri ? [uri] : undefined;\n\t}\n\n\tprivate async showUnsupportedBrowserWarning(context: 'save' | 'open'): Promise<undefined> {\n\n\t\t// When saving, try to just download the contents\n\t\t// of the active text editor if any as a workaround\n\t\tif (context === 'save') {\n\t\t\tconst activeTextModel = this.codeEditorService.getActiveCodeEditor()?.getModel();\n\t\t\tif (activeTextModel) {\n\t\t\t\ttriggerDownload(VSBuffer.fromString(activeTextModel.getValue()).buffer, basename(activeTextModel.uri));\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Otherwise inform the user about options\n\n\t\tconst buttons: IPromptButton<void>[] = [\n\t\t\t{\n\t\t\t\tlabel: localize({ key: 'openRemote', comment: ['&& denotes a mnemonic'] }, \"&&Open Remote...\"),\n\t\t\t\trun: async () => { await this.commandService.executeCommand('workbench.action.remote.showMenu'); }\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: localize({ key: 'learnMore', comment: ['&& denotes a mnemonic'] }, \"&&Learn More\"),\n\t\t\t\trun: async () => { await this.openerService.open('https://aka.ms/VSCodeWebLocalFileSystemAccess'); }\n\t\t\t}\n\t\t];\n\t\tif (context === 'open') {\n\t\t\tbuttons.push({\n\t\t\t\tlabel: localize({ key: 'openFiles', comment: ['&& denotes a mnemonic'] }, \"Open &&Files...\"),\n\t\t\t\trun: async () => {\n\t\t\t\t\tconst files = await triggerUpload();\n\t\t\t\t\tif (files) {\n\t\t\t\t\t\tconst filesData = (await this.instantiationService.invokeFunction(accessor => extractFileListData(accessor, files))).filter(fileData => !fileData.isDirectory);\n\t\t\t\t\t\tif (filesData.length > 0) {\n\t\t\t\t\t\t\tthis.editorService.openEditors(filesData.map(fileData => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tresource: fileData.resource,\n\t\t\t\t\t\t\t\t\tcontents: fileData.contents?.toString(),\n\t\t\t\t\t\t\t\t\toptions: { pinned: true }\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tawait this.dialogService.prompt({\n\t\t\ttype: Severity.Warning,\n\t\t\tmessage: localize('unsupportedBrowserMessage', \"Opening Local Folders is Unsupported\"),\n\t\t\tdetail: localize('unsupportedBrowserDetail', \"Your browser doesn't support opening local folders.\\nYou can either open single files or open a remote repository.\"),\n\t\t\tbuttons\n\t\t});\n\n\t\treturn undefined;\n\t}\n\n\tprivate shouldUseSimplified(scheme: string): boolean {\n\t\treturn ![Schemas.file, Schemas.vscodeUserData, Schemas.tmp].includes(scheme);\n\t}\n}\n\nregisterSingleton(IFileDialogService, FileDialogService, InstantiationType.Delayed);\n"]}