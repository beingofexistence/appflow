{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/services/textresourceProperties/common/textResourcePropertiesService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAazF,IAAM,IAAI,GAAV,MAAM,IAAI;QAMhB,YACwB,CAA0C,EAC5C,kBAAuB,EACd,CAAwC,EACrD,CAAoC;YAHb,MAAC,GAAD,CAAC,CAAwB;YAElB,MAAC,GAAD,CAAC,CAAsB;YACpC,MAAC,GAAD,CAAC,CAAkB;YAN9C,MAAC,GAAmD,IAAI,CAAC;YAQhE,kBAAkB,CAAC,cAAc,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC,GAAmB,SAAS,CAAC,CAAC;QAC3F,CAAC;QAED,MAAM,CAAC,QAAc,EAAE,QAAiB;YACvC,MAAM,GAAG,GAAG,IAAI,CAAC,CAAC,CAAoB,QAAQ,CAAC,WAAW,EAAE,EAAE,kBAAkB,EAAE,QAAQ,EAAE,QAAQ,EAAE,CAAC,CAAC;YACxG,IAAI,GAAG,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,MAAM,EAAE;gBACrD,OAAO,GAAG,CAAC;aACX;YACD,MAAM,EAAE,GAAG,IAAI,CAAC,CAAC,CAAK,QAAQ,CAAC,CAAC;YAChC,OAAO,EAAE,kCAA0B,IAAI,EAAE,sCAA8B,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,MAAM,CAAC;QACzF,CAAC;QAEO,CAAC,CAAK,QAAc;YAC3B,IAAI,EAAE,GAAG,aAAE,CAAC;YAEZ,MAAM,eAAe,GAAG,IAAI,CAAC,CAAC,CAAkB,eAAe,CAAC;YAChE,IAAI,eAAe,EAAE;gBACpB,IAAI,QAAQ,IAAI,QAAQ,CAAC,MAAM,KAAK,iBAAO,CAAC,IAAI,EAAE;oBACjD,MAAM,UAAU,GAAG,yBAAyB,eAAe,EAAE,CAAC;oBAC9D,EAAE,GAAG,IAAI,CAAC,CAAC,CAAiB,CAAC,CAAC,IAAI,CAAC,CAAC,CAAiB,EAAE,CAAC,CAAC,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC,CAAc,SAAS,CAAC,UAAU,kCAA0B,aAAE,CAAC,CAAC;oBACxJ,IAAI,CAAC,CAAC,CAAc,KAAK,CAAC,UAAU,EAAE,EAAE,gEAAgD,CAAC;iBACzF;aACD;YAED,OAAO,EAAE,CAAC;QACX,CAAC;KACD,CAAA;IAtCY,oBAAI;mBAAJ,IAAI;QAOd,WAAA,mBAAG,CAAA;QACH,WAAA,wBAAG,CAAA;QACH,WAAA,wBAAG,CAAA;QACH,WAAA,aAAG,CAAA;OAVO,IAAI,CAsChB;IAED,IAAA,gBAAG,EAAe,+BAAG,EAA6B,IAAI,oCAAqD,CAAC","file":"textResourcePropertiesService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { ITextResourcePropertiesService } from 'vs/editor/common/services/textResourceConfiguration';\nimport { OperatingSystem, OS } from 'vs/base/common/platform';\nimport { Schemas } from 'vs/base/common/network';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\nimport { InstantiationType, registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { IRemoteAgentEnvironment } from 'vs/platform/remote/common/remoteAgentEnvironment';\nimport { IRemoteAgentService } from 'vs/workbench/services/remote/common/remoteAgentService';\n\nexport class TextResourcePropertiesService implements ITextResourcePropertiesService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate remoteEnvironment: IRemoteAgentEnvironment | null = null;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tremoteAgentService.getEnvironment().then(remoteEnv => this.remoteEnvironment = remoteEnv);\n\t}\n\n\tgetEOL(resource?: URI, language?: string): string {\n\t\tconst eol = this.configurationService.getValue('files.eol', { overrideIdentifier: language, resource });\n\t\tif (eol && typeof eol === 'string' && eol !== 'auto') {\n\t\t\treturn eol;\n\t\t}\n\t\tconst os = this.getOS(resource);\n\t\treturn os === OperatingSystem.Linux || os === OperatingSystem.Macintosh ? '\\n' : '\\r\\n';\n\t}\n\n\tprivate getOS(resource?: URI): OperatingSystem {\n\t\tlet os = OS;\n\n\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\tif (remoteAuthority) {\n\t\t\tif (resource && resource.scheme !== Schemas.file) {\n\t\t\t\tconst osCacheKey = `resource.authority.os.${remoteAuthority}`;\n\t\t\t\tos = this.remoteEnvironment ? this.remoteEnvironment.os : /* Get it from cache */ this.storageService.getNumber(osCacheKey, StorageScope.WORKSPACE, OS);\n\t\t\t\tthis.storageService.store(osCacheKey, os, StorageScope.WORKSPACE, StorageTarget.MACHINE);\n\t\t\t}\n\t\t}\n\n\t\treturn os;\n\t}\n}\n\nregisterSingleton(ITextResourcePropertiesService, TextResourcePropertiesService, InstantiationType.Delayed);\n"]}