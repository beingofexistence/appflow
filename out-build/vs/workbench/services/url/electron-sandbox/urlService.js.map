{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/services/url/electron-sandbox/urlService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAmBzF,IAAM,IAAI,GAAV,MAAM,IAAgB,SAAQ,gBAAG;QAIvC,YACsB,kBAAwB,EAC7B,aAAkB,EACG,CAAuB,EAC3C,cAAmB,EACN,CAAe;YAE7C,KAAK,CAAC,cAAc,CAAC,CAAC;YAJe,MAAC,GAAD,CAAC,CAAsB;YAE9B,MAAC,GAAD,CAAC,CAAc;YAI7C,IAAI,CAAC,CAAC,GAAY,kBAAY,CAAC,SAAS,CAAc,kBAAkB,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC,CAAC;YAE5F,kBAAkB,CAAC,eAAe,CAAC,YAAY,EAAE,IAAI,aAAI,CAAc,IAAI,CAAC,CAAC,CAAC;YAC9E,aAAa,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QACpC,CAAC;QAEQ,MAAM,CAAC,OAAgC;YAC/C,MAAM,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAElC,IAAI,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;YACtB,IAAI,CAAC,KAAK,EAAE;gBACX,KAAK,GAAG,YAAY,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAiB,QAAQ,CAAC,EAAE,CAAC;aAC1E;iBAAM;gBACN,KAAK,IAAI,aAAa,kBAAkB,CAAC,IAAI,CAAC,CAAC,CAAiB,QAAQ,CAAC,EAAE,CAAC;aAC5E;YAED,OAAO,GAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;QAC5B,CAAC;QAEQ,KAAK,CAAC,IAAI,CAAC,QAAsB,EAAE,OAA8B;YAEzE,IAAI,CAAC,IAAA,YAAG,EAAW,QAAQ,EAAE,IAAI,CAAC,CAAC,CAAc,WAAW,CAAC,EAAE;gBAC9D,OAAO,KAAK,CAAC;aACb;YAED,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;gBACjC,QAAQ,GAAG,SAAG,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;aAC/B;YACD,OAAO,MAAM,IAAI,CAAC,CAAC,CAAU,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACtD,CAAC;QAED,KAAK,CAAC,SAAS,CAAC,GAAQ,EAAE,OAAyB;YAClD,MAAM,MAAM,GAAG,MAAM,KAAK,CAAC,IAAI,CAAC,GAAG,EAAE,OAAO,CAAC,CAAC;YAE9C,IAAI,MAAM,EAAE;gBACX,IAAI,CAAC,CAAC,CAAU,KAAK,CAAC,iCAAiC,EAAE,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;gBAE7E,MAAM,IAAI,CAAC,CAAC,CAAiB,WAAW,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,mCAAmC,EAAE,CAAC,CAAC;aAC9F;iBAAM;gBACN,IAAI,CAAC,CAAC,CAAU,KAAK,CAAC,qCAAqC,EAAE,GAAG,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC;aACjF;YAED,OAAO,MAAM,CAAC;QACf,CAAC;KACD,CAAA;IAzDY,oBAAI;mBAAJ,IAAI;QAKd,WAAA,yBAAI,CAAA;QACJ,WAAA,YAAG,CAAA;QACH,WAAA,aAAI,CAAA;QACJ,WAAA,oBAAG,CAAA;QACH,WAAA,SAAG,CAAA;OATO,IAAI,CAyDhB;IAED,IAAA,gBAAG,EAAe,SAAG,EAAU,IAAI,kCAAqC,CAAC","file":"urlService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IURLService, IURLHandler, IOpenURLOptions } from 'vs/platform/url/common/url';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IMainProcessService } from 'vs/platform/ipc/common/mainProcessService';\nimport { URLHandlerChannel } from 'vs/platform/url/common/urlIpc';\nimport { IOpenerService, IOpener, matchesScheme } from 'vs/platform/opener/common/opener';\nimport { IProductService } from 'vs/platform/product/common/productService';\nimport { InstantiationType, registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { ProxyChannel } from 'vs/base/parts/ipc/common/ipc';\nimport { INativeHostService } from 'vs/platform/native/common/native';\nimport { NativeURLService } from 'vs/platform/url/common/urlService';\nimport { ILogService } from 'vs/platform/log/common/log';\n\nexport interface IRelayOpenURLOptions extends IOpenURLOptions {\n\topenToSide?: boolean;\n\topenExternal?: boolean;\n}\n\nexport class RelayURLService extends NativeURLService implements IURLHandler, IOpener {\n\n\tprivate urlService: IURLService;\n\n\tconstructor(\n\t\t@IMainProcessService mainProcessService: IMainProcessService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@INativeHostService private readonly nativeHostService: INativeHostService,\n\t\t@IProductService productService: IProductService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tsuper(productService);\n\n\t\tthis.urlService = ProxyChannel.toService<IURLService>(mainProcessService.getChannel('url'));\n\n\t\tmainProcessService.registerChannel('urlHandler', new URLHandlerChannel(this));\n\t\topenerService.registerOpener(this);\n\t}\n\n\toverride create(options?: Partial<UriComponents>): URI {\n\t\tconst uri = super.create(options);\n\n\t\tlet query = uri.query;\n\t\tif (!query) {\n\t\t\tquery = `windowId=${encodeURIComponent(this.nativeHostService.windowId)}`;\n\t\t} else {\n\t\t\tquery += `&windowId=${encodeURIComponent(this.nativeHostService.windowId)}`;\n\t\t}\n\n\t\treturn uri.with({ query });\n\t}\n\n\toverride async open(resource: URI | string, options?: IRelayOpenURLOptions): Promise<boolean> {\n\n\t\tif (!matchesScheme(resource, this.productService.urlProtocol)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (typeof resource === 'string') {\n\t\t\tresource = URI.parse(resource);\n\t\t}\n\t\treturn await this.urlService.open(resource, options);\n\t}\n\n\tasync handleURL(uri: URI, options?: IOpenURLOptions): Promise<boolean> {\n\t\tconst result = await super.open(uri, options);\n\n\t\tif (result) {\n\t\t\tthis.logService.trace('URLService#handleURL(): handled', uri.toString(true));\n\n\t\t\tawait this.nativeHostService.focusWindow({ force: true /* Application may not be active */ });\n\t\t} else {\n\t\t\tthis.logService.trace('URLService#handleURL(): not handled', uri.toString(true));\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nregisterSingleton(IURLService, RelayURLService, InstantiationType.Eager);\n"]}