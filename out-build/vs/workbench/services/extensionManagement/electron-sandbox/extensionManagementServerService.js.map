{"version":3,"sources":["vs/workbench/services/extensionManagement/electron-sandbox/extensionManagementServerService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAkBzF,IAAM,IAAI,GAAV,MAAM,IAAiC,SAAQ,eAAG;QAQxD,YACwB,oBAA0B,EAC5B,kBAAuB,EAC7B,YAAiB,EACN,uBAA4B,EAC7B,sBAA2B,EAC7B,oBAAyB;YAEhD,KAAK,EAAE,CAAC;YAXA,oCAA+B,GAAsC,IAAI,CAAC;YAC1E,iCAA4B,GAAsC,IAAI,CAAC;YAW/E,MAAM,+BAA+B,GAAG,IAAI,CAAC,CAAC,CAAS,oBAAoB,CAAC,cAAc,CAAC,uCAAI,EAA8B,oBAAoB,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAC7K,IAAI,CAAC,8BAA8B,GAAG,EAAE,0BAA0B,EAAE,+BAA+B,EAAE,EAAE,EAAE,OAAO,EAAE,KAAK,EAAE,IAAA,cAAQ,EAAC,CAAO,EAAE,IAAO,CAAC,EAAE,CAAC;YACtJ,MAAM,qBAAqB,GAAG,kBAAkB,CAAC,aAAa,EAAE,CAAC;YACjE,IAAI,qBAAqB,EAAE;gBAC1B,MAAM,0BAA0B,GAAG,oBAAoB,CAAC,cAAc,CAAC,uCAAI,EAAoC,qBAAqB,CAAC,UAAU,CAAW,YAAY,CAAC,EAAE,IAAI,CAAC,8BAA8B,CAAC,CAAC;gBAC9M,IAAI,CAAC,+BAA+B,GAAG;oBACtC,EAAE,EAAE,QAAQ;oBACZ,0BAA0B;oBAC1B,IAAI,KAAK,KAAK,OAAO,YAAY,CAAC,YAAY,CAAC,iBAAO,CAAC,YAAY,EAAE,qBAAsB,CAAC,eAAe,CAAC,IAAI,IAAA,cAAQ,EAAC,CAAQ,EAAE,IAAQ,CAAC,CAAC,CAAC,CAAC;iBAC/I,CAAC;aACF;QAEF,CAAC;QAED,4BAA4B,CAAC,SAAqB;YACjD,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,KAAK,iBAAO,CAAC,IAAI,EAAE;gBAC/C,OAAO,IAAI,CAAC,8BAA8B,CAAC;aAC3C;YACD,IAAI,IAAI,CAAC,+BAA+B,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,KAAK,iBAAO,CAAC,YAAY,EAAE;gBAC/F,OAAO,IAAI,CAAC,+BAA+B,CAAC;aAC5C;YACD,MAAM,IAAI,KAAK,CAAC,qBAAqB,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC5D,CAAC;QAED,2BAA2B,CAAC,SAAqB;YAChD,MAAM,MAAM,GAAG,IAAI,CAAC,4BAA4B,CAAC,SAAS,CAAC,CAAC;YAC5D,OAAO,MAAM,KAAK,IAAI,CAAC,+BAA+B,CAAC,CAAC,yCAAiC,CAAC,uCAA+B,CAAC;QAC3H,CAAC;KACD,CAAA;IA7CY,oBAAI;mBAAJ,IAAI;QASd,WAAA,eAAI,CAAA;QACJ,WAAA,wBAAG,CAAA;QACH,WAAA,WAAG,CAAA;QACH,WAAA,qBAAG,CAAA;QACH,WAAA,qBAAG,CAAA;QACH,WAAA,mBAAG,CAAA;OAdO,IAAI,CA6ChB;IAED,IAAA,gBAAG,EAAe,0BAAI,EAA+B,IAAI,oCAAwD,CAAC","file":"extensionManagementServerService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { Schemas } from 'vs/base/common/network';\nimport { ExtensionInstallLocation, IExtensionManagementServer, IExtensionManagementServerService } from 'vs/workbench/services/extensionManagement/common/extensionManagement';\nimport { IRemoteAgentService } from 'vs/workbench/services/remote/common/remoteAgentService';\nimport { IChannel } from 'vs/base/parts/ipc/common/ipc';\nimport { ISharedProcessService } from 'vs/platform/ipc/electron-sandbox/services';\nimport { InstantiationType, registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { NativeRemoteExtensionManagementService } from 'vs/workbench/services/extensionManagement/electron-sandbox/remoteExtensionManagementService';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { IExtension } from 'vs/platform/extensions/common/extensions';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IUserDataProfileService } from 'vs/workbench/services/userDataProfile/common/userDataProfile';\nimport { NativeExtensionManagementService } from 'vs/workbench/services/extensionManagement/electron-sandbox/nativeExtensionManagementService';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { IUserDataProfilesService } from 'vs/platform/userDataProfile/common/userDataProfile';\n\nexport class ExtensionManagementServerService extends Disposable implements IExtensionManagementServerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\treadonly localExtensionManagementServer: IExtensionManagementServer;\n\treadonly remoteExtensionManagementServer: IExtensionManagementServer | null = null;\n\treadonly webExtensionManagementServer: IExtensionManagementServer | null = null;\n\n\tconstructor(\n\t\t@ISharedProcessService sharedProcessService: ISharedProcessService,\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUserDataProfilesService userDataProfilesService: IUserDataProfilesService,\n\t\t@IUserDataProfileService userDataProfileService: IUserDataProfileService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t\tconst localExtensionManagementService = this._register(instantiationService.createInstance(NativeExtensionManagementService, sharedProcessService.getChannel('extensions')));\n\t\tthis.localExtensionManagementServer = { extensionManagementService: localExtensionManagementService, id: 'local', label: localize('local', \"Local\") };\n\t\tconst remoteAgentConnection = remoteAgentService.getConnection();\n\t\tif (remoteAgentConnection) {\n\t\t\tconst extensionManagementService = instantiationService.createInstance(NativeRemoteExtensionManagementService, remoteAgentConnection.getChannel<IChannel>('extensions'), this.localExtensionManagementServer);\n\t\t\tthis.remoteExtensionManagementServer = {\n\t\t\t\tid: 'remote',\n\t\t\t\textensionManagementService,\n\t\t\t\tget label() { return labelService.getHostLabel(Schemas.vscodeRemote, remoteAgentConnection!.remoteAuthority) || localize('remote', \"Remote\"); },\n\t\t\t};\n\t\t}\n\n\t}\n\n\tgetExtensionManagementServer(extension: IExtension): IExtensionManagementServer {\n\t\tif (extension.location.scheme === Schemas.file) {\n\t\t\treturn this.localExtensionManagementServer;\n\t\t}\n\t\tif (this.remoteExtensionManagementServer && extension.location.scheme === Schemas.vscodeRemote) {\n\t\t\treturn this.remoteExtensionManagementServer;\n\t\t}\n\t\tthrow new Error(`Invalid Extension ${extension.location}`);\n\t}\n\n\tgetExtensionInstallLocation(extension: IExtension): ExtensionInstallLocation | null {\n\t\tconst server = this.getExtensionManagementServer(extension);\n\t\treturn server === this.remoteExtensionManagementServer ? ExtensionInstallLocation.Remote : ExtensionInstallLocation.Local;\n\t}\n}\n\nregisterSingleton(IExtensionManagementServerService, ExtensionManagementServerService, InstantiationType.Delayed);\n"]}