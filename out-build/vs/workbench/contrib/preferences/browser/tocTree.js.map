{"version":3,"sources":["vs/workbench/contrib/preferences/browser/tocTree.ts"],"names":[],"mappings":"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","file":"tocTree.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from 'vs/base/browser/dom';\nimport { IListVirtualDelegate } from 'vs/base/browser/ui/list/list';\nimport { DefaultStyleController, IListAccessibilityProvider } from 'vs/base/browser/ui/list/listWidget';\nimport { RenderIndentGuides } from 'vs/base/browser/ui/tree/abstractTree';\nimport { ITreeElement, ITreeNode, ITreeRenderer } from 'vs/base/browser/ui/tree/tree';\nimport { Iterable } from 'vs/base/common/iterator';\nimport { localize } from 'vs/nls';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IListService, IWorkbenchObjectTreeOptions, WorkbenchObjectTree } from 'vs/platform/list/browser/listService';\nimport { getListStyles } from 'vs/platform/theme/browser/defaultStyles';\nimport { editorBackground, focusBorder } from 'vs/platform/theme/common/colorRegistry';\nimport { SettingsTreeFilter } from 'vs/workbench/contrib/preferences/browser/settingsTree';\nimport { ISettingsEditorViewState, SearchResultModel, SettingsTreeElement, SettingsTreeGroupElement, SettingsTreeSettingElement } from 'vs/workbench/contrib/preferences/browser/settingsTreeModels';\nimport { settingsHeaderForeground, settingsHeaderHoverForeground } from 'vs/workbench/contrib/preferences/common/settingsEditorColorRegistry';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\n\nconst $ = DOM.$;\n\nexport class TOCTreeModel {\n\n\tprivate _currentSearchModel: SearchResultModel | null = null;\n\tprivate _settingsTreeRoot!: SettingsTreeGroupElement;\n\n\tconstructor(\n\t\tprivate _viewState: ISettingsEditorViewState,\n\t\t@IWorkbenchEnvironmentService private environmentService: IWorkbenchEnvironmentService\n\t) {\n\t}\n\n\tget settingsTreeRoot(): SettingsTreeGroupElement {\n\t\treturn this._settingsTreeRoot;\n\t}\n\n\tset settingsTreeRoot(value: SettingsTreeGroupElement) {\n\t\tthis._settingsTreeRoot = value;\n\t\tthis.update();\n\t}\n\n\tget currentSearchModel(): SearchResultModel | null {\n\t\treturn this._currentSearchModel;\n\t}\n\n\tset currentSearchModel(model: SearchResultModel | null) {\n\t\tthis._currentSearchModel = model;\n\t\tthis.update();\n\t}\n\n\tget children(): SettingsTreeElement[] {\n\t\treturn this._settingsTreeRoot.children;\n\t}\n\n\tupdate(): void {\n\t\tif (this._settingsTreeRoot) {\n\t\t\tthis.updateGroupCount(this._settingsTreeRoot);\n\t\t}\n\t}\n\n\tprivate updateGroupCount(group: SettingsTreeGroupElement): void {\n\t\tgroup.children.forEach(child => {\n\t\t\tif (child instanceof SettingsTreeGroupElement) {\n\t\t\t\tthis.updateGroupCount(child);\n\t\t\t}\n\t\t});\n\n\t\tconst childCount = group.children\n\t\t\t.filter(child => child instanceof SettingsTreeGroupElement)\n\t\t\t.reduce((acc, cur) => acc + (<SettingsTreeGroupElement>cur).count!, 0);\n\n\t\tgroup.count = childCount + this.getGroupCount(group);\n\t}\n\n\tprivate getGroupCount(group: SettingsTreeGroupElement): number {\n\t\treturn group.children.filter(child => {\n\t\t\tif (!(child instanceof SettingsTreeSettingElement)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (this._currentSearchModel && !this._currentSearchModel.root.containsSetting(child.setting.key)) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Check everything that the SettingsFilter checks except whether it's filtered by a category\n\t\t\tconst isRemote = !!this.environmentService.remoteAuthority;\n\t\t\treturn child.matchesScope(this._viewState.settingsTarget, isRemote) &&\n\t\t\t\tchild.matchesAllTags(this._viewState.tagFilters) &&\n\t\t\t\tchild.matchesAnyFeature(this._viewState.featureFilters) &&\n\t\t\t\tchild.matchesAnyExtension(this._viewState.extensionFilters) &&\n\t\t\t\tchild.matchesAnyId(this._viewState.idFilters);\n\t\t}).length;\n\t}\n}\n\nconst TOC_ENTRY_TEMPLATE_ID = 'settings.toc.entry';\n\ninterface ITOCEntryTemplate {\n\tlabelElement: HTMLElement;\n\tcountElement: HTMLElement;\n}\n\nexport class TOCRenderer implements ITreeRenderer<SettingsTreeGroupElement, never, ITOCEntryTemplate> {\n\n\ttemplateId = TOC_ENTRY_TEMPLATE_ID;\n\n\trenderTemplate(container: HTMLElement): ITOCEntryTemplate {\n\t\treturn {\n\t\t\tlabelElement: DOM.append(container, $('.settings-toc-entry')),\n\t\t\tcountElement: DOM.append(container, $('.settings-toc-count'))\n\t\t};\n\t}\n\n\trenderElement(node: ITreeNode<SettingsTreeGroupElement>, index: number, template: ITOCEntryTemplate): void {\n\t\tconst element = node.element;\n\t\tconst count = element.count;\n\t\tconst label = element.label;\n\n\t\ttemplate.labelElement.textContent = label;\n\t\ttemplate.labelElement.title = label;\n\n\t\tif (count) {\n\t\t\ttemplate.countElement.textContent = ` (${count})`;\n\t\t} else {\n\t\t\ttemplate.countElement.textContent = '';\n\t\t}\n\t}\n\n\tdisposeTemplate(templateData: ITOCEntryTemplate): void {\n\t}\n}\n\nclass TOCTreeDelegate implements IListVirtualDelegate<SettingsTreeElement> {\n\tgetTemplateId(element: SettingsTreeElement): string {\n\t\treturn TOC_ENTRY_TEMPLATE_ID;\n\t}\n\n\tgetHeight(element: SettingsTreeElement): number {\n\t\treturn 22;\n\t}\n}\n\nexport function createTOCIterator(model: TOCTreeModel | SettingsTreeGroupElement, tree: TOCTree): Iterable<ITreeElement<SettingsTreeGroupElement>> {\n\tconst groupChildren = <SettingsTreeGroupElement[]>model.children.filter(c => c instanceof SettingsTreeGroupElement);\n\n\treturn Iterable.map(groupChildren, g => {\n\t\tconst hasGroupChildren = g.children.some(c => c instanceof SettingsTreeGroupElement);\n\n\t\treturn {\n\t\t\telement: g,\n\t\t\tcollapsed: undefined,\n\t\t\tcollapsible: hasGroupChildren,\n\t\t\tchildren: g instanceof SettingsTreeGroupElement ?\n\t\t\t\tcreateTOCIterator(g, tree) :\n\t\t\t\tundefined\n\t\t};\n\t});\n}\n\nclass SettingsAccessibilityProvider implements IListAccessibilityProvider<SettingsTreeGroupElement> {\n\tgetWidgetAriaLabel(): string {\n\t\treturn localize({\n\t\t\tkey: 'settingsTOC',\n\t\t\tcomment: ['A label for the table of contents for the full settings list']\n\t\t},\n\t\t\t\"Settings Table of Contents\");\n\t}\n\n\tgetAriaLabel(element: SettingsTreeElement): string {\n\t\tif (!element) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (element instanceof SettingsTreeGroupElement) {\n\t\t\treturn localize('groupRowAriaLabel', \"{0}, group\", element.label);\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tgetAriaLevel(element: SettingsTreeGroupElement): number {\n\t\tlet i = 1;\n\t\twhile (element instanceof SettingsTreeGroupElement && element.parent) {\n\t\t\ti++;\n\t\t\telement = element.parent;\n\t\t}\n\n\t\treturn i;\n\t}\n}\n\nexport class TOCTree extends WorkbenchObjectTree<SettingsTreeGroupElement> {\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tviewState: ISettingsEditorViewState,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IListService listService: IListService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\t// test open mode\n\n\t\tconst filter = instantiationService.createInstance(SettingsTreeFilter, viewState);\n\t\tconst options: IWorkbenchObjectTreeOptions<SettingsTreeGroupElement, void> = {\n\t\t\tfilter,\n\t\t\tmultipleSelectionSupport: false,\n\t\t\tidentityProvider: {\n\t\t\t\tgetId(e) {\n\t\t\t\t\treturn e.id;\n\t\t\t\t}\n\t\t\t},\n\t\t\tstyleController: id => new DefaultStyleController(DOM.createStyleSheet(container), id),\n\t\t\taccessibilityProvider: instantiationService.createInstance(SettingsAccessibilityProvider),\n\t\t\tcollapseByDefault: true,\n\t\t\thorizontalScrolling: false,\n\t\t\thideTwistiesOfChildlessElements: true,\n\t\t\trenderIndentGuides: RenderIndentGuides.None\n\t\t};\n\n\t\tsuper(\n\t\t\t'SettingsTOC',\n\t\t\tcontainer,\n\t\t\tnew TOCTreeDelegate(),\n\t\t\t[new TOCRenderer()],\n\t\t\toptions,\n\t\t\tinstantiationService,\n\t\t\tcontextKeyService,\n\t\t\tlistService,\n\t\t\tconfigurationService,\n\t\t);\n\n\t\tthis.style(getListStyles({\n\t\t\tlistBackground: editorBackground,\n\t\t\tlistFocusOutline: focusBorder,\n\t\t\tlistActiveSelectionBackground: editorBackground,\n\t\t\tlistActiveSelectionForeground: settingsHeaderForeground,\n\t\t\tlistFocusAndSelectionBackground: editorBackground,\n\t\t\tlistFocusAndSelectionForeground: settingsHeaderForeground,\n\t\t\tlistFocusBackground: editorBackground,\n\t\t\tlistFocusForeground: settingsHeaderHoverForeground,\n\t\t\tlistHoverForeground: settingsHeaderHoverForeground,\n\t\t\tlistHoverBackground: editorBackground,\n\t\t\tlistInactiveSelectionBackground: editorBackground,\n\t\t\tlistInactiveSelectionForeground: settingsHeaderForeground,\n\t\t\tlistInactiveFocusBackground: editorBackground,\n\t\t\tlistInactiveFocusOutline: editorBackground,\n\t\t\ttreeIndentGuidesStroke: undefined,\n\t\t\ttreeInactiveIndentGuidesStroke: undefined\n\t\t}));\n\t}\n}\n"]}