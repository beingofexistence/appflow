{"version":3,"sources":["vs/workbench/contrib/interactive/browser/interactiveEditor.ts"],"names":[],"mappings":"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","file":"interactiveEditor.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/interactive';\nimport * as nls from 'vs/nls';\nimport * as DOM from 'vs/base/browser/dom';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { CodeEditorWidget } from 'vs/editor/browser/widget/codeEditorWidget';\nimport { ICodeEditorViewState, IDecorationOptions } from 'vs/editor/common/editorCommon';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IStorageService } from 'vs/platform/storage/common/storage';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { editorForeground, resolveColorValue } from 'vs/platform/theme/common/colorRegistry';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { EditorPane } from 'vs/workbench/browser/parts/editor/editorPane';\nimport { EditorPaneSelectionChangeReason, IEditorMemento, IEditorOpenContext, IEditorPaneSelectionChangeEvent } from 'vs/workbench/common/editor';\nimport { getSimpleEditorOptions } from 'vs/workbench/contrib/codeEditor/browser/simpleEditorOptions';\nimport { InteractiveEditorInput } from 'vs/workbench/contrib/interactive/browser/interactiveEditorInput';\nimport { ICellViewModel, INotebookEditorOptions, INotebookEditorViewState } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { NotebookEditorExtensionsRegistry } from 'vs/workbench/contrib/notebook/browser/notebookEditorExtensions';\nimport { IBorrowValue, INotebookEditorService } from 'vs/workbench/contrib/notebook/browser/services/notebookEditorService';\nimport { NotebookEditorWidget } from 'vs/workbench/contrib/notebook/browser/notebookEditorWidget';\nimport { GroupsOrder, IEditorGroup, IEditorGroupsService } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { ExecutionStateCellStatusBarContrib, TimerCellStatusBarContrib } from 'vs/workbench/contrib/notebook/browser/contrib/cellStatusBar/executionStatusBarItemController';\nimport { INotebookKernelService } from 'vs/workbench/contrib/notebook/common/notebookKernelService';\nimport { PLAINTEXT_LANGUAGE_ID } from 'vs/editor/common/languages/modesRegistry';\nimport { ILanguageService } from 'vs/editor/common/languages/language';\nimport { IMenuService, MenuId } from 'vs/platform/actions/common/actions';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { InteractiveWindowSetting, INTERACTIVE_INPUT_CURSOR_BOUNDARY } from 'vs/workbench/contrib/interactive/browser/interactiveCommon';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { NotebookOptions } from 'vs/workbench/contrib/notebook/browser/notebookOptions';\nimport { ToolBar } from 'vs/base/browser/ui/toolbar/toolbar';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { createActionViewItem, createAndFillInActionBarActions } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { IAction } from 'vs/base/common/actions';\nimport { EditorExtensionsRegistry } from 'vs/editor/browser/editorExtensions';\nimport { ParameterHintsController } from 'vs/editor/contrib/parameterHints/browser/parameterHints';\nimport { MenuPreventer } from 'vs/workbench/contrib/codeEditor/browser/menuPreventer';\nimport { SelectionClipboardContributionID } from 'vs/workbench/contrib/codeEditor/browser/selectionClipboard';\nimport { ContextMenuController } from 'vs/editor/contrib/contextmenu/browser/contextmenu';\nimport { SuggestController } from 'vs/editor/contrib/suggest/browser/suggestController';\nimport { SnippetController2 } from 'vs/editor/contrib/snippet/browser/snippetController2';\nimport { TabCompletionController } from 'vs/workbench/contrib/snippets/browser/tabCompletion';\nimport { ModesHoverController } from 'vs/editor/contrib/hover/browser/hover';\nimport { MarkerController } from 'vs/editor/contrib/gotoError/browser/gotoError';\nimport { EditorInput } from 'vs/workbench/common/editor/editorInput';\nimport { ITextResourceConfigurationService } from 'vs/editor/common/services/textResourceConfiguration';\nimport { ITextEditorOptions, TextEditorSelectionSource } from 'vs/platform/editor/common/editor';\nimport { INotebookExecutionStateService, NotebookExecutionType } from 'vs/workbench/contrib/notebook/common/notebookExecutionStateService';\nimport { NOTEBOOK_KERNEL } from 'vs/workbench/contrib/notebook/common/notebookContextKeys';\nimport { ICursorPositionChangedEvent } from 'vs/editor/common/cursorEvents';\nimport { IExtensionService } from 'vs/workbench/services/extensions/common/extensions';\nimport { isEqual } from 'vs/base/common/resources';\nimport { NotebookFindContrib } from 'vs/workbench/contrib/notebook/browser/contrib/find/notebookFindWidget';\nimport { INTERACTIVE_WINDOW_EDITOR_ID } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport 'vs/css!./interactiveEditor';\nimport { IEditorOptions } from 'vs/editor/common/config/editorOptions';\nimport { deepClone } from 'vs/base/common/objects';\n\nconst DECORATION_KEY = 'interactiveInputDecoration';\nconst INTERACTIVE_EDITOR_VIEW_STATE_PREFERENCE_KEY = 'InteractiveEditorViewState';\n\nconst INPUT_CELL_VERTICAL_PADDING = 8;\nconst INPUT_CELL_HORIZONTAL_PADDING_RIGHT = 10;\nconst INPUT_EDITOR_PADDING = 8;\n\nexport interface InteractiveEditorViewState {\n\treadonly notebook?: INotebookEditorViewState;\n\treadonly input?: ICodeEditorViewState | null;\n}\n\nexport interface InteractiveEditorOptions extends ITextEditorOptions {\n\treadonly viewState?: InteractiveEditorViewState;\n}\n\nexport class InteractiveEditor extends EditorPane {\n\tprivate _rootElement!: HTMLElement;\n\tprivate _styleElement!: HTMLStyleElement;\n\tprivate _notebookEditorContainer!: HTMLElement;\n\tprivate _notebookWidget: IBorrowValue<NotebookEditorWidget> = { value: undefined };\n\tprivate _inputCellContainer!: HTMLElement;\n\tprivate _inputFocusIndicator!: HTMLElement;\n\tprivate _inputRunButtonContainer!: HTMLElement;\n\tprivate _inputEditorContainer!: HTMLElement;\n\tprivate _codeEditorWidget!: CodeEditorWidget;\n\tprivate _notebookWidgetService: INotebookEditorService;\n\tprivate _instantiationService: IInstantiationService;\n\tprivate _languageService: ILanguageService;\n\tprivate _contextKeyService: IContextKeyService;\n\tprivate _configurationService: IConfigurationService;\n\tprivate _notebookKernelService: INotebookKernelService;\n\tprivate _keybindingService: IKeybindingService;\n\tprivate _menuService: IMenuService;\n\tprivate _contextMenuService: IContextMenuService;\n\tprivate _editorGroupService: IEditorGroupsService;\n\tprivate _notebookExecutionStateService: INotebookExecutionStateService;\n\tprivate _extensionService: IExtensionService;\n\tprivate _widgetDisposableStore: DisposableStore = this._register(new DisposableStore());\n\tprivate _lastLayoutDimensions?: { readonly dimension: DOM.Dimension; readonly position: DOM.IDomPosition };\n\tprivate _editorOptions: IEditorOptions;\n\tprivate _notebookOptions: NotebookOptions;\n\tprivate _editorMemento: IEditorMemento<InteractiveEditorViewState>;\n\tprivate _groupListener = this._register(new DisposableStore());\n\tprivate _runbuttonToolbar: ToolBar | undefined;\n\n\tprivate _onDidFocusWidget = this._register(new Emitter<void>());\n\toverride get onDidFocus(): Event<void> { return this._onDidFocusWidget.event; }\n\tprivate _onDidChangeSelection = this._register(new Emitter<IEditorPaneSelectionChangeEvent>());\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\n\tconstructor(\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@INotebookEditorService notebookWidgetService: INotebookEditorService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@ICodeEditorService codeEditorService: ICodeEditorService,\n\t\t@INotebookKernelService notebookKernelService: INotebookKernelService,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IEditorGroupsService editorGroupService: IEditorGroupsService,\n\t\t@ITextResourceConfigurationService textResourceConfigurationService: ITextResourceConfigurationService,\n\t\t@INotebookExecutionStateService notebookExecutionStateService: INotebookExecutionStateService,\n\t\t@IExtensionService extensionService: IExtensionService,\n\t) {\n\t\tsuper(\n\t\t\tINTERACTIVE_WINDOW_EDITOR_ID,\n\t\t\ttelemetryService,\n\t\t\tthemeService,\n\t\t\tstorageService\n\t\t);\n\t\tthis._instantiationService = instantiationService;\n\t\tthis._notebookWidgetService = notebookWidgetService;\n\t\tthis._contextKeyService = contextKeyService;\n\t\tthis._configurationService = configurationService;\n\t\tthis._notebookKernelService = notebookKernelService;\n\t\tthis._languageService = languageService;\n\t\tthis._keybindingService = keybindingService;\n\t\tthis._menuService = menuService;\n\t\tthis._contextMenuService = contextMenuService;\n\t\tthis._editorGroupService = editorGroupService;\n\t\tthis._notebookExecutionStateService = notebookExecutionStateService;\n\t\tthis._extensionService = extensionService;\n\n\t\tthis._editorOptions = this._computeEditorOptions();\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('editor') || e.affectsConfiguration('notebook')) {\n\t\t\t\tthis._editorOptions = this._computeEditorOptions();\n\t\t\t}\n\t\t}));\n\t\tthis._notebookOptions = new NotebookOptions(configurationService, notebookExecutionStateService, true, { cellToolbarInteraction: 'hover', globalToolbar: true, stickyScroll: false, dragAndDropEnabled: false });\n\t\tthis._editorMemento = this.getEditorMemento<InteractiveEditorViewState>(editorGroupService, textResourceConfigurationService, INTERACTIVE_EDITOR_VIEW_STATE_PREFERENCE_KEY);\n\n\t\tcodeEditorService.registerDecorationType('interactive-decoration', DECORATION_KEY, {});\n\t\tthis._register(this._keybindingService.onDidUpdateKeybindings(this._updateInputDecoration, this));\n\t\tthis._register(this._notebookExecutionStateService.onDidChangeExecution((e) => {\n\t\t\tif (e.type === NotebookExecutionType.cell && isEqual(e.notebook, this._notebookWidget.value?.viewModel?.notebookDocument.uri)) {\n\t\t\t\tconst cell = this._notebookWidget.value?.getCellByHandle(e.cellHandle);\n\t\t\t\tif (cell && e.changed?.state) {\n\t\t\t\t\tthis._scrollIfNecessary(cell);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate get inputCellContainerHeight() {\n\t\treturn 19 + 2 + INPUT_CELL_VERTICAL_PADDING * 2 + INPUT_EDITOR_PADDING * 2;\n\t}\n\n\tprivate get inputCellEditorHeight() {\n\t\treturn 19 + INPUT_EDITOR_PADDING * 2;\n\t}\n\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._rootElement = DOM.append(parent, DOM.$('.interactive-editor'));\n\t\tthis._rootElement.style.position = 'relative';\n\t\tthis._notebookEditorContainer = DOM.append(this._rootElement, DOM.$('.notebook-editor-container'));\n\t\tthis._inputCellContainer = DOM.append(this._rootElement, DOM.$('.input-cell-container'));\n\t\tthis._inputCellContainer.style.position = 'absolute';\n\t\tthis._inputCellContainer.style.height = `${this.inputCellContainerHeight}px`;\n\t\tthis._inputFocusIndicator = DOM.append(this._inputCellContainer, DOM.$('.input-focus-indicator'));\n\t\tthis._inputRunButtonContainer = DOM.append(this._inputCellContainer, DOM.$('.run-button-container'));\n\t\tthis._setupRunButtonToolbar(this._inputRunButtonContainer);\n\t\tthis._inputEditorContainer = DOM.append(this._inputCellContainer, DOM.$('.input-editor-container'));\n\t\tthis._createLayoutStyles();\n\t}\n\n\tprivate _setupRunButtonToolbar(runButtonContainer: HTMLElement) {\n\t\tconst menu = this._register(this._menuService.createMenu(MenuId.InteractiveInputExecute, this._contextKeyService));\n\t\tthis._runbuttonToolbar = this._register(new ToolBar(runButtonContainer, this._contextMenuService, {\n\t\t\tgetKeyBinding: action => this._keybindingService.lookupKeybinding(action.id),\n\t\t\tactionViewItemProvider: action => {\n\t\t\t\treturn createActionViewItem(this._instantiationService, action);\n\t\t\t},\n\t\t\trenderDropdownAsChildElement: true\n\t\t}));\n\n\t\tconst primary: IAction[] = [];\n\t\tconst secondary: IAction[] = [];\n\t\tconst result = { primary, secondary };\n\n\t\tcreateAndFillInActionBarActions(menu, { shouldForwardArgs: true }, result);\n\t\tthis._runbuttonToolbar.setActions([...primary, ...secondary]);\n\t}\n\n\tprivate _createLayoutStyles(): void {\n\t\tthis._styleElement = DOM.createStyleSheet(this._rootElement);\n\t\tconst styleSheets: string[] = [];\n\n\t\tconst {\n\t\t\tfocusIndicator,\n\t\t\tcodeCellLeftMargin,\n\t\t\tcellRunGutter\n\t\t} = this._notebookOptions.getLayoutConfiguration();\n\t\tconst leftMargin = codeCellLeftMargin + cellRunGutter;\n\n\t\tstyleSheets.push(`\n\t\t\t.interactive-editor .input-cell-container {\n\t\t\t\tpadding: ${INPUT_CELL_VERTICAL_PADDING}px ${INPUT_CELL_HORIZONTAL_PADDING_RIGHT}px ${INPUT_CELL_VERTICAL_PADDING}px ${leftMargin}px;\n\t\t\t}\n\t\t`);\n\t\tif (focusIndicator === 'gutter') {\n\t\t\tstyleSheets.push(`\n\t\t\t\t.interactive-editor .input-cell-container:focus-within .input-focus-indicator::before {\n\t\t\t\t\tborder-color: var(--vscode-notebook-focusedCellBorder) !important;\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-focus-indicator::before {\n\t\t\t\t\tborder-color: var(--vscode-notebook-inactiveFocusedCellBorder) !important;\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-cell-container .input-focus-indicator {\n\t\t\t\t\tdisplay: block;\n\t\t\t\t\ttop: ${INPUT_CELL_VERTICAL_PADDING}px;\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-cell-container {\n\t\t\t\t\tborder-top: 1px solid var(--vscode-notebook-inactiveFocusedCellBorder);\n\t\t\t\t}\n\t\t\t`);\n\t\t} else {\n\t\t\t// border\n\t\t\tstyleSheets.push(`\n\t\t\t\t.interactive-editor .input-cell-container {\n\t\t\t\t\tborder-top: 1px solid var(--vscode-notebook-inactiveFocusedCellBorder);\n\t\t\t\t}\n\t\t\t\t.interactive-editor .input-cell-container .input-focus-indicator {\n\t\t\t\t\tdisplay: none;\n\t\t\t\t}\n\t\t\t`);\n\t\t}\n\n\t\tstyleSheets.push(`\n\t\t\t.interactive-editor .input-cell-container .run-button-container {\n\t\t\t\twidth: ${cellRunGutter}px;\n\t\t\t\tleft: ${codeCellLeftMargin}px;\n\t\t\t\tmargin-top: ${INPUT_EDITOR_PADDING - 2}px;\n\t\t\t}\n\t\t`);\n\n\t\tthis._styleElement.textContent = styleSheets.join('\\n');\n\t}\n\n\tprivate _computeEditorOptions(): IEditorOptions {\n\t\tlet overrideIdentifier: string | undefined = undefined;\n\t\tif (this._codeEditorWidget) {\n\t\t\toverrideIdentifier = this._codeEditorWidget.getModel()?.getLanguageId();\n\t\t}\n\t\tconst editorOptions = deepClone(this._configurationService.getValue<IEditorOptions>('editor', { overrideIdentifier }));\n\t\tconst editorOptionsOverride = getSimpleEditorOptions(this._configurationService);\n\t\tconst computed = Object.freeze({\n\t\t\t...editorOptions,\n\t\t\t...editorOptionsOverride,\n\t\t\t...{\n\t\t\t\tglyphMargin: true,\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: INPUT_EDITOR_PADDING,\n\t\t\t\t\tbottom: INPUT_EDITOR_PADDING\n\t\t\t\t},\n\t\t\t\thover: {\n\t\t\t\t\tenabled: true\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn computed;\n\t}\n\n\tprotected override saveState(): void {\n\t\tthis._saveEditorViewState(this.input);\n\t\tsuper.saveState();\n\t}\n\n\toverride getViewState(): InteractiveEditorViewState | undefined {\n\t\tconst input = this.input;\n\t\tif (!(input instanceof InteractiveEditorInput)) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tthis._saveEditorViewState(input);\n\t\treturn this._loadNotebookEditorViewState(input);\n\t}\n\n\tprivate _saveEditorViewState(input: EditorInput | undefined): void {\n\t\tif (this.group && this._notebookWidget.value && input instanceof InteractiveEditorInput) {\n\t\t\tif (this._notebookWidget.value.isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst state = this._notebookWidget.value.getEditorViewState();\n\t\t\tconst editorState = this._codeEditorWidget.saveViewState();\n\t\t\tthis._editorMemento.saveEditorState(this.group, input.notebookEditorInput.resource, {\n\t\t\t\tnotebook: state,\n\t\t\t\tinput: editorState\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _loadNotebookEditorViewState(input: InteractiveEditorInput): InteractiveEditorViewState | undefined {\n\t\tlet result: InteractiveEditorViewState | undefined;\n\t\tif (this.group) {\n\t\t\tresult = this._editorMemento.loadEditorState(this.group, input.notebookEditorInput.resource);\n\t\t}\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t\t// when we don't have a view state for the group/input-tuple then we try to use an existing\n\t\t// editor for the same resource.\n\t\tfor (const group of this._editorGroupService.getGroups(GroupsOrder.MOST_RECENTLY_ACTIVE)) {\n\t\t\tif (group.activeEditorPane !== this && group.activeEditorPane === this && group.activeEditor?.matches(input)) {\n\t\t\t\tconst notebook = this._notebookWidget.value?.getEditorViewState();\n\t\t\t\tconst input = this._codeEditorWidget.saveViewState();\n\t\t\t\treturn {\n\t\t\t\t\tnotebook,\n\t\t\t\t\tinput\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\n\toverride async setInput(input: InteractiveEditorInput, options: InteractiveEditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken): Promise<void> {\n\t\tconst group = this.group!;\n\t\tconst notebookInput = input.notebookEditorInput;\n\n\t\t// there currently is a widget which we still own so\n\t\t// we need to hide it before getting a new widget\n\t\tthis._notebookWidget.value?.onWillHide();\n\n\t\tthis._codeEditorWidget?.dispose();\n\n\t\tthis._widgetDisposableStore.clear();\n\n\t\tthis._notebookWidget = <IBorrowValue<NotebookEditorWidget>>this._instantiationService.invokeFunction(this._notebookWidgetService.retrieveWidget, group, notebookInput, {\n\t\t\tisEmbedded: true,\n\t\t\tisReadOnly: true,\n\t\t\tcontributions: NotebookEditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tExecutionStateCellStatusBarContrib.id,\n\t\t\t\tTimerCellStatusBarContrib.id,\n\t\t\t\tNotebookFindContrib.id\n\t\t\t]),\n\t\t\tmenuIds: {\n\t\t\t\tnotebookToolbar: MenuId.InteractiveToolbar,\n\t\t\t\tcellTitleToolbar: MenuId.InteractiveCellTitle,\n\t\t\t\tcellDeleteToolbar: MenuId.InteractiveCellDelete,\n\t\t\t\tcellInsertToolbar: MenuId.NotebookCellBetween,\n\t\t\t\tcellTopInsertToolbar: MenuId.NotebookCellListTop,\n\t\t\t\tcellExecuteToolbar: MenuId.InteractiveCellExecute,\n\t\t\t\tcellExecutePrimary: undefined\n\t\t\t},\n\t\t\tcellEditorContributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\tContextMenuController.ID,\n\t\t\t\tModesHoverController.ID,\n\t\t\t\tMarkerController.ID\n\t\t\t]),\n\t\t\toptions: this._notebookOptions\n\t\t});\n\n\t\tthis._codeEditorWidget = this._instantiationService.createInstance(CodeEditorWidget, this._inputEditorContainer, this._editorOptions, {\n\t\t\t...{\n\t\t\t\tisSimpleWidget: false,\n\t\t\t\tcontributions: EditorExtensionsRegistry.getSomeEditorContributions([\n\t\t\t\t\tMenuPreventer.ID,\n\t\t\t\t\tSelectionClipboardContributionID,\n\t\t\t\t\tContextMenuController.ID,\n\t\t\t\t\tSuggestController.ID,\n\t\t\t\t\tParameterHintsController.ID,\n\t\t\t\t\tSnippetController2.ID,\n\t\t\t\t\tTabCompletionController.ID,\n\t\t\t\t\tModesHoverController.ID,\n\t\t\t\t\tMarkerController.ID\n\t\t\t\t])\n\t\t\t}\n\t\t});\n\n\t\tif (this._lastLayoutDimensions) {\n\t\t\tthis._notebookEditorContainer.style.height = `${this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight}px`;\n\t\t\tthis._notebookWidget.value!.layout(new DOM.Dimension(this._lastLayoutDimensions.dimension.width, this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight), this._notebookEditorContainer);\n\t\t\tconst {\n\t\t\t\tcodeCellLeftMargin,\n\t\t\t\tcellRunGutter\n\t\t\t} = this._notebookOptions.getLayoutConfiguration();\n\t\t\tconst leftMargin = codeCellLeftMargin + cellRunGutter;\n\t\t\tconst maxHeight = Math.min(this._lastLayoutDimensions.dimension.height / 2, this.inputCellEditorHeight);\n\t\t\tthis._codeEditorWidget.layout(this._validateDimension(this._lastLayoutDimensions.dimension.width - leftMargin - INPUT_CELL_HORIZONTAL_PADDING_RIGHT, maxHeight));\n\t\t\tthis._inputFocusIndicator.style.height = `${this.inputCellEditorHeight}px`;\n\t\t\tthis._inputCellContainer.style.top = `${this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight}px`;\n\t\t\tthis._inputCellContainer.style.width = `${this._lastLayoutDimensions.dimension.width}px`;\n\t\t}\n\n\t\tawait super.setInput(input, options, context, token);\n\t\tconst model = await input.resolve();\n\t\tif (this._runbuttonToolbar) {\n\t\t\tthis._runbuttonToolbar.context = input.resource;\n\t\t}\n\n\t\tif (model === null) {\n\t\t\tthrow new Error('The Interactive Window model could not be resolved');\n\t\t}\n\n\t\tthis._notebookWidget.value?.setParentContextKeyService(this._contextKeyService);\n\n\t\tconst viewState = options?.viewState ?? this._loadNotebookEditorViewState(input);\n\t\tawait this._extensionService.whenInstalledExtensionsRegistered();\n\t\tawait this._notebookWidget.value!.setModel(model.notebook, viewState?.notebook);\n\t\tmodel.notebook.setCellCollapseDefault(this._notebookOptions.getCellCollapseDefault());\n\t\tthis._notebookWidget.value!.setOptions({\n\t\t\tisReadOnly: true\n\t\t});\n\t\tthis._widgetDisposableStore.add(this._notebookWidget.value!.onDidResizeOutput((cvm) => {\n\t\t\tthis._scrollIfNecessary(cvm);\n\t\t}));\n\t\tthis._widgetDisposableStore.add(this._notebookWidget.value!.onDidFocusWidget(() => this._onDidFocusWidget.fire()));\n\t\tthis._widgetDisposableStore.add(this._notebookOptions.onDidChangeOptions(e => {\n\t\t\tif (e.compactView || e.focusIndicator) {\n\t\t\t\t// update the styling\n\t\t\t\tthis._styleElement?.remove();\n\t\t\t\tthis._createLayoutStyles();\n\t\t\t}\n\n\t\t\tif (this._lastLayoutDimensions && this.isVisible()) {\n\t\t\t\tthis.layout(this._lastLayoutDimensions.dimension, this._lastLayoutDimensions.position);\n\t\t\t}\n\n\t\t\tif (e.interactiveWindowCollapseCodeCells) {\n\t\t\t\tmodel.notebook.setCellCollapseDefault(this._notebookOptions.getCellCollapseDefault());\n\t\t\t}\n\t\t}));\n\n\t\tconst languageId = this._notebookWidget.value?.activeKernel?.supportedLanguages[0] ?? input.language ?? PLAINTEXT_LANGUAGE_ID;\n\t\tconst editorModel = await input.resolveInput(languageId);\n\t\teditorModel.setLanguage(languageId);\n\t\tthis._codeEditorWidget.setModel(editorModel);\n\t\tif (viewState?.input) {\n\t\t\tthis._codeEditorWidget.restoreViewState(viewState.input);\n\t\t}\n\t\tthis._editorOptions = this._computeEditorOptions();\n\t\tthis._codeEditorWidget.updateOptions(this._editorOptions);\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidFocusEditorWidget(() => this._onDidFocusWidget.fire()));\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidContentSizeChange(e => {\n\t\t\tif (!e.contentHeightChanged) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._lastLayoutDimensions) {\n\t\t\t\tthis._layoutWidgets(this._lastLayoutDimensions.dimension, this._lastLayoutDimensions.position);\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeCursorPosition(e => this._onDidChangeSelection.fire({ reason: this._toEditorPaneSelectionChangeReason(e) })));\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeModelContent(() => this._onDidChangeSelection.fire({ reason: EditorPaneSelectionChangeReason.EDIT })));\n\n\n\t\tthis._widgetDisposableStore.add(this._notebookKernelService.onDidChangeNotebookAffinity(this._syncWithKernel, this));\n\t\tthis._widgetDisposableStore.add(this._notebookKernelService.onDidChangeSelectedNotebooks(this._syncWithKernel, this));\n\n\t\tthis._widgetDisposableStore.add(this.themeService.onDidColorThemeChange(() => {\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis._updateInputDecoration();\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeModelContent(() => {\n\t\t\tif (this.isVisible()) {\n\t\t\t\tthis._updateInputDecoration();\n\t\t\t}\n\t\t}));\n\n\t\tconst cursorAtBoundaryContext = INTERACTIVE_INPUT_CURSOR_BOUNDARY.bindTo(this._contextKeyService);\n\t\tif (input.resource && input.historyService.has(input.resource)) {\n\t\t\tcursorAtBoundaryContext.set('top');\n\t\t} else {\n\t\t\tcursorAtBoundaryContext.set('none');\n\t\t}\n\n\t\tthis._widgetDisposableStore.add(this._codeEditorWidget.onDidChangeCursorPosition(({ position }) => {\n\t\t\tconst viewModel = this._codeEditorWidget._getViewModel()!;\n\t\t\tconst lastLineNumber = viewModel.getLineCount();\n\t\t\tconst lastLineCol = viewModel.getLineContent(lastLineNumber).length + 1;\n\t\t\tconst viewPosition = viewModel.coordinatesConverter.convertModelPositionToViewPosition(position);\n\t\t\tconst firstLine = viewPosition.lineNumber === 1 && viewPosition.column === 1;\n\t\t\tconst lastLine = viewPosition.lineNumber === lastLineNumber && viewPosition.column === lastLineCol;\n\n\t\t\tif (firstLine) {\n\t\t\t\tif (lastLine) {\n\t\t\t\t\tcursorAtBoundaryContext.set('both');\n\t\t\t\t} else {\n\t\t\t\t\tcursorAtBoundaryContext.set('top');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (lastLine) {\n\t\t\t\t\tcursorAtBoundaryContext.set('bottom');\n\t\t\t\t} else {\n\t\t\t\t\tcursorAtBoundaryContext.set('none');\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._widgetDisposableStore.add(editorModel.onDidChangeContent(() => {\n\t\t\tconst value = editorModel!.getValue();\n\t\t\tif (this.input?.resource && value !== '') {\n\t\t\t\t(this.input as InteractiveEditorInput).historyService.replaceLast(this.input.resource, value);\n\t\t\t}\n\t\t}));\n\n\t\tthis._syncWithKernel();\n\t}\n\n\toverride setOptions(options: INotebookEditorOptions | undefined): void {\n\t\tthis._notebookWidget.value?.setOptions(options);\n\t\tsuper.setOptions(options);\n\t}\n\n\tprivate _toEditorPaneSelectionChangeReason(e: ICursorPositionChangedEvent): EditorPaneSelectionChangeReason {\n\t\tswitch (e.source) {\n\t\t\tcase TextEditorSelectionSource.PROGRAMMATIC: return EditorPaneSelectionChangeReason.PROGRAMMATIC;\n\t\t\tcase TextEditorSelectionSource.NAVIGATION: return EditorPaneSelectionChangeReason.NAVIGATION;\n\t\t\tcase TextEditorSelectionSource.JUMP: return EditorPaneSelectionChangeReason.JUMP;\n\t\t\tdefault: return EditorPaneSelectionChangeReason.USER;\n\t\t}\n\t}\n\n\tprivate _cellAtBottom(cell: ICellViewModel): boolean {\n\t\tconst visibleRanges = this._notebookWidget.value?.visibleRanges || [];\n\t\tconst cellIndex = this._notebookWidget.value?.getCellIndex(cell);\n\t\tif (cellIndex === Math.max(...visibleRanges.map(range => range.end - 1))) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _scrollIfNecessary(cvm: ICellViewModel) {\n\t\tconst index = this._notebookWidget.value!.getCellIndex(cvm);\n\t\tif (index === this._notebookWidget.value!.getLength() - 1) {\n\t\t\t// If we're already at the bottom or auto scroll is enabled, scroll to the bottom\n\t\t\tif (this._configurationService.getValue<boolean>(InteractiveWindowSetting.interactiveWindowAlwaysScrollOnNewCell) || this._cellAtBottom(cvm)) {\n\t\t\t\tthis._notebookWidget.value!.scrollToBottom();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _syncWithKernel() {\n\t\tconst notebook = this._notebookWidget.value?.textModel;\n\t\tconst textModel = this._codeEditorWidget.getModel();\n\n\t\tif (notebook && textModel) {\n\t\t\tconst info = this._notebookKernelService.getMatchingKernel(notebook);\n\t\t\tconst selectedOrSuggested = info.selected\n\t\t\t\t?? (info.suggestions.length === 1 ? info.suggestions[0] : undefined)\n\t\t\t\t?? (info.all.length === 1 ? info.all[0] : undefined);\n\n\t\t\tif (selectedOrSuggested) {\n\t\t\t\tconst language = selectedOrSuggested.supportedLanguages[0];\n\t\t\t\t// All kernels will initially list plaintext as the supported language before they properly initialized.\n\t\t\t\tif (language && language !== 'plaintext') {\n\t\t\t\t\tconst newMode = this._languageService.createById(language).languageId;\n\t\t\t\t\ttextModel.setLanguage(newMode);\n\t\t\t\t}\n\n\t\t\t\tNOTEBOOK_KERNEL.bindTo(this._contextKeyService).set(selectedOrSuggested.id);\n\t\t\t}\n\t\t}\n\n\t\tthis._updateInputDecoration();\n\t}\n\n\tlayout(dimension: DOM.Dimension, position: DOM.IDomPosition): void {\n\t\tthis._rootElement.classList.toggle('mid-width', dimension.width < 1000 && dimension.width >= 600);\n\t\tthis._rootElement.classList.toggle('narrow-width', dimension.width < 600);\n\t\tconst editorHeightChanged = dimension.height !== this._lastLayoutDimensions?.dimension.height;\n\t\tthis._lastLayoutDimensions = { dimension, position };\n\n\t\tif (!this._notebookWidget.value) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (editorHeightChanged && this._codeEditorWidget) {\n\t\t\tSuggestController.get(this._codeEditorWidget)?.cancelSuggestWidget();\n\t\t}\n\n\t\tthis._notebookEditorContainer.style.height = `${this._lastLayoutDimensions.dimension.height - this.inputCellContainerHeight}px`;\n\t\tthis._layoutWidgets(dimension, position);\n\t}\n\n\tprivate _layoutWidgets(dimension: DOM.Dimension, position: DOM.IDomPosition) {\n\t\tconst contentHeight = this._codeEditorWidget.hasModel() ? this._codeEditorWidget.getContentHeight() : this.inputCellEditorHeight;\n\t\tconst maxHeight = Math.min(dimension.height / 2, contentHeight);\n\t\tconst {\n\t\t\tcodeCellLeftMargin,\n\t\t\tcellRunGutter\n\t\t} = this._notebookOptions.getLayoutConfiguration();\n\t\tconst leftMargin = codeCellLeftMargin + cellRunGutter;\n\n\t\tconst inputCellContainerHeight = maxHeight + INPUT_CELL_VERTICAL_PADDING * 2;\n\t\tthis._notebookEditorContainer.style.height = `${dimension.height - inputCellContainerHeight}px`;\n\n\t\tthis._notebookWidget.value!.layout(dimension.with(dimension.width, dimension.height - inputCellContainerHeight), this._notebookEditorContainer, position);\n\t\tthis._codeEditorWidget.layout(this._validateDimension(dimension.width - leftMargin - INPUT_CELL_HORIZONTAL_PADDING_RIGHT, maxHeight));\n\t\tthis._inputFocusIndicator.style.height = `${contentHeight}px`;\n\t\tthis._inputCellContainer.style.top = `${dimension.height - inputCellContainerHeight}px`;\n\t\tthis._inputCellContainer.style.width = `${dimension.width}px`;\n\t}\n\n\tprivate _validateDimension(width: number, height: number) {\n\t\treturn new DOM.Dimension(Math.max(0, width), Math.max(0, height));\n\t}\n\n\tprivate _updateInputDecoration(): void {\n\t\tif (!this._codeEditorWidget) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._codeEditorWidget.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst model = this._codeEditorWidget.getModel();\n\n\t\tconst decorations: IDecorationOptions[] = [];\n\n\t\tif (model?.getValueLength() === 0) {\n\t\t\tconst transparentForeground = resolveColorValue(editorForeground, this.themeService.getColorTheme())?.transparent(0.4);\n\t\t\tconst languageId = model.getLanguageId();\n\t\t\tconst keybinding = this._keybindingService.lookupKeybinding('interactive.execute', this._contextKeyService)?.getLabel();\n\t\t\tconst text = nls.localize('interactiveInputPlaceHolder', \"Type '{0}' code here and press {1} to run\", languageId, keybinding ?? 'ctrl+enter');\n\t\t\tdecorations.push({\n\t\t\t\trange: {\n\t\t\t\t\tstartLineNumber: 0,\n\t\t\t\t\tendLineNumber: 0,\n\t\t\t\t\tstartColumn: 0,\n\t\t\t\t\tendColumn: 1\n\t\t\t\t},\n\t\t\t\trenderOptions: {\n\t\t\t\t\tafter: {\n\t\t\t\t\t\tcontentText: text,\n\t\t\t\t\t\tcolor: transparentForeground ? transparentForeground.toString() : undefined\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tthis._codeEditorWidget.setDecorationsByType('interactive-decoration', DECORATION_KEY, decorations);\n\t}\n\n\toverride focus() {\n\t\tthis._notebookWidget.value?.onShow();\n\t\tthis._codeEditorWidget.focus();\n\t}\n\n\tfocusHistory() {\n\t\tthis._notebookWidget.value!.focus();\n\t}\n\n\tprotected override setEditorVisible(visible: boolean, group: IEditorGroup | undefined): void {\n\t\tsuper.setEditorVisible(visible, group);\n\t\tif (group) {\n\t\t\tthis._groupListener.clear();\n\t\t\tthis._groupListener.add(group.onWillCloseEditor(e => this._saveEditorViewState(e.editor)));\n\t\t}\n\n\t\tif (!visible) {\n\t\t\tthis._saveEditorViewState(this.input);\n\t\t\tif (this.input && this._notebookWidget.value) {\n\t\t\t\tthis._notebookWidget.value.onWillHide();\n\t\t\t}\n\t\t}\n\t}\n\n\toverride clearInput() {\n\t\tif (this._notebookWidget.value) {\n\t\t\tthis._saveEditorViewState(this.input);\n\t\t\tthis._notebookWidget.value.onWillHide();\n\t\t}\n\n\t\tthis._codeEditorWidget?.dispose();\n\n\t\tthis._notebookWidget = { value: undefined };\n\t\tthis._widgetDisposableStore.clear();\n\n\t\tsuper.clearInput();\n\t}\n\n\toverride getControl(): { notebookEditor: NotebookEditorWidget | undefined; codeEditor: CodeEditorWidget } {\n\t\treturn {\n\t\t\tnotebookEditor: this._notebookWidget.value,\n\t\t\tcodeEditor: this._codeEditorWidget\n\t\t};\n\t}\n}\n"]}