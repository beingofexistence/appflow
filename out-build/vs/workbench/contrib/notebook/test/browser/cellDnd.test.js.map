{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/test/browser/cellDnd.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;IA0BhG,KAAK,UAAU,WAAW,CAAC,SAA0B,EAAE,UAAuB,EAAE,GAAc;QAC7F,MAAM,IAAA,yBAAI,EACT,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,EAAE,WAAW,EAAE,yBAAQ,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,EACxE,CAAC,MAAM,EAAE,SAAS,EAAE,EAAE;YACrB,MAAM,CAAC,aAAa,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;YAC3C,MAAM,CAAC,QAAQ,CAAC,EAAE,KAAK,EAAE,SAAS,CAAC,KAAK,EAAE,GAAG,EAAE,SAAS,CAAC,KAAK,GAAG,CAAC,EAAE,CAAC,CAAC;YACtE,IAAA,cAAI,EAAiB,MAAM,EAAE,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,OAAO,CAAE,EAAE,UAAU,CAAC,SAAS,EAAE,SAAS,CAAC,MAAM,CAAC,UAAU,CAAC,WAAW,CAAE,CAAC,CAAC;YAErI,KAAK,MAAM,CAAC,IAAI,GAAG,CAAC,QAAQ,EAAE;gBAC7B,MAAM,CAAC,KAAK,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,EAAE,EAAE,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;aAChE;YAED,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAC/C,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC,EAAE,GAAG,CAAC,SAAS,CAAC,CAAC;YACjE,MAAM,CAAC,eAAe,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE,EAAE,KAAK,EAAE,GAAG,CAAC,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC,KAAK,GAAG,CAAC,EAAE,CAAC,CAAC;QACrF,CAAC,CAAC,CAAC;IACL,CAAC;IAED,KAAK,CAAC,SAAS,EAAE,GAAG,EAAE;QACrB,IAAI,CAAC,aAAa,EAAE,KAAK,IAAI,EAAE;YAC9B,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBAClC,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;YACtD,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBAClC,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE;YACpD,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBAClC,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,kBAAkB,EAAE,KAAK,IAAI,EAAE;YACnC,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBACxD,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,gBAAgB,EAAE,KAAK,IAAI,EAAE;YACjC,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBACxD,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,4BAA4B,EAAE,KAAK,IAAI,EAAE;YAC7C,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBACxD,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YACjD,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBACxD,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,4BAA4B,EAAE,KAAK,IAAI,EAAE;YAC7C,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBACxD,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YAC1D,MAAM,WAAW,CAChB;gBACC,UAAU,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAChC,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC;gBAClC,KAAK,EAAE,CAAC;aACR,EACD;gBACC,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,SAAS,EAAE,OAAO;aAClB,EACD;gBACC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;gBAC9B,SAAS,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE;gBAC/B,KAAK,EAAE,CAAC;aACR,CACD,CAAC;QACH,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC","file":"cellDnd.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { performCellDropEdits } from 'vs/workbench/contrib/notebook/browser/view/cellParts/cellDnd';\nimport { CellKind } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { withTestNotebook } from 'vs/workbench/contrib/notebook/test/browser/testNotebookEditor';\nimport * as assert from 'assert';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\n\ninterface IBeginningState {\n\tstartOrder: string[];\n\tselections: ICellRange[];\n\tfocus: number;\n}\n\ninterface IDragAction {\n\tdragIdx: number;\n\tdragOverIdx: number;\n\tdirection: 'above' | 'below';\n}\n\ninterface IEndState {\n\tendOrder: string[];\n\tselection: ICellRange;\n\tfocus: number;\n}\n\nasync function testCellDnd(beginning: IBeginningState, dragAction: IDragAction, end: IEndState) {\n\tawait withTestNotebook(\n\t\tbeginning.startOrder.map(text => [text, 'plaintext', CellKind.Code, []]),\n\t\t(editor, viewModel) => {\n\t\t\teditor.setSelections(beginning.selections);\n\t\t\teditor.setFocus({ start: beginning.focus, end: beginning.focus + 1 });\n\t\t\tperformCellDropEdits(editor, viewModel.cellAt(dragAction.dragIdx)!, dragAction.direction, viewModel.cellAt(dragAction.dragOverIdx)!);\n\n\t\t\tfor (const i in end.endOrder) {\n\t\t\t\tassert.equal(viewModel.viewCells[i].getText(), end.endOrder[i]);\n\t\t\t}\n\n\t\t\tassert.equal(editor.getSelections().length, 1);\n\t\t\tassert.deepStrictEqual(editor.getSelections()[0], end.selection);\n\t\t\tassert.deepStrictEqual(editor.getFocus(), { start: end.focus, end: end.focus + 1 });\n\t\t});\n}\n\nsuite('cellDND', () => {\n\ttest('drag 1 cell', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 0, end: 1 }],\n\t\t\t\tfocus: 0\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 0,\n\t\t\t\tdragOverIdx: 1,\n\t\t\t\tdirection: 'below'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['1', '0', '2', '3'],\n\t\t\t\tselection: { start: 1, end: 2 },\n\t\t\t\tfocus: 1\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('drag multiple contiguous cells down', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 1, end: 3 }],\n\t\t\t\tfocus: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 1,\n\t\t\t\tdragOverIdx: 3,\n\t\t\t\tdirection: 'below'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['0', '3', '1', '2'],\n\t\t\t\tselection: { start: 2, end: 4 },\n\t\t\t\tfocus: 2\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('drag multiple contiguous cells up', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 2, end: 4 }],\n\t\t\t\tfocus: 2\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 3,\n\t\t\t\tdragOverIdx: 0,\n\t\t\t\tdirection: 'above'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['2', '3', '0', '1'],\n\t\t\t\tselection: { start: 0, end: 2 },\n\t\t\t\tfocus: 0\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('drag ranges down', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 0, end: 1 }, { start: 2, end: 3 }],\n\t\t\t\tfocus: 0\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 0,\n\t\t\t\tdragOverIdx: 3,\n\t\t\t\tdirection: 'below'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['1', '3', '0', '2'],\n\t\t\t\tselection: { start: 2, end: 4 },\n\t\t\t\tfocus: 2\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('drag ranges up', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 1, end: 2 }, { start: 3, end: 4 }],\n\t\t\t\tfocus: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 1,\n\t\t\t\tdragOverIdx: 0,\n\t\t\t\tdirection: 'above'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['1', '3', '0', '2'],\n\t\t\t\tselection: { start: 0, end: 2 },\n\t\t\t\tfocus: 0\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('drag ranges between ranges', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 0, end: 1 }, { start: 3, end: 4 }],\n\t\t\t\tfocus: 0\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 0,\n\t\t\t\tdragOverIdx: 1,\n\t\t\t\tdirection: 'below'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['1', '0', '3', '2'],\n\t\t\t\tselection: { start: 1, end: 3 },\n\t\t\t\tfocus: 1\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('drag ranges just above a range', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 1, end: 2 }, { start: 3, end: 4 }],\n\t\t\t\tfocus: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 1,\n\t\t\t\tdragOverIdx: 1,\n\t\t\t\tdirection: 'above'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['0', '1', '3', '2'],\n\t\t\t\tselection: { start: 1, end: 3 },\n\t\t\t\tfocus: 1\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('drag ranges inside a range', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 0, end: 2 }, { start: 3, end: 4 }],\n\t\t\t\tfocus: 0\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 0,\n\t\t\t\tdragOverIdx: 0,\n\t\t\t\tdirection: 'below'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['0', '1', '3', '2'],\n\t\t\t\tselection: { start: 0, end: 3 },\n\t\t\t\tfocus: 0\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('dragged cell is not focused or selected', async () => {\n\t\tawait testCellDnd(\n\t\t\t{\n\t\t\t\tstartOrder: ['0', '1', '2', '3'],\n\t\t\t\tselections: [{ start: 1, end: 2 }],\n\t\t\t\tfocus: 1\n\t\t\t},\n\t\t\t{\n\t\t\t\tdragIdx: 2,\n\t\t\t\tdragOverIdx: 3,\n\t\t\t\tdirection: 'below'\n\t\t\t},\n\t\t\t{\n\t\t\t\tendOrder: ['0', '1', '3', '2'],\n\t\t\t\tselection: { start: 3, end: 4 },\n\t\t\t\tfocus: 3\n\t\t\t}\n\t\t);\n\t});\n});\n"]}