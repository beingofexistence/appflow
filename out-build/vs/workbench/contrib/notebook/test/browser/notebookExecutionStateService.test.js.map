{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/test/browser/notebookExecutionStateService.test.ts"],"names":[],"mappings":"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","file":"notebookExecutionStateService.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { DeferredPromise } from 'vs/base/common/async';\nimport { Event } from 'vs/base/common/event';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { mock } from 'vs/base/test/common/mock';\nimport { PLAINTEXT_LANGUAGE_ID } from 'vs/editor/common/languages/modesRegistry';\nimport { IMenu, IMenuService } from 'vs/platform/actions/common/actions';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { TestInstantiationService } from 'vs/platform/instantiation/test/common/instantiationServiceMock';\nimport { insertCellAtIndex } from 'vs/workbench/contrib/notebook/browser/controller/cellOperations';\nimport { NotebookExecutionService } from 'vs/workbench/contrib/notebook/browser/services/notebookExecutionServiceImpl';\nimport { NotebookExecutionStateService } from 'vs/workbench/contrib/notebook/browser/services/notebookExecutionStateServiceImpl';\nimport { NotebookKernelService } from 'vs/workbench/contrib/notebook/browser/services/notebookKernelServiceImpl';\nimport { NotebookViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookViewModelImpl';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\nimport { CellEditType, CellKind, CellUri, IOutputDto, NotebookCellMetadata, NotebookExecutionState } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { CellExecutionUpdateType, INotebookExecutionService } from 'vs/workbench/contrib/notebook/common/notebookExecutionService';\nimport { INotebookExecutionStateService, NotebookExecutionType } from 'vs/workbench/contrib/notebook/common/notebookExecutionStateService';\nimport { INotebookKernel, INotebookKernelService } from 'vs/workbench/contrib/notebook/common/notebookKernelService';\nimport { INotebookService } from 'vs/workbench/contrib/notebook/common/notebookService';\nimport { setupInstantiationService, withTestNotebook as _withTestNotebook } from 'vs/workbench/contrib/notebook/test/browser/testNotebookEditor';\n\nsuite('NotebookExecutionStateService', () => {\n\n\tlet instantiationService: TestInstantiationService;\n\tlet kernelService: INotebookKernelService;\n\tlet disposables: DisposableStore;\n\tlet testNotebookModel: NotebookTextModel | undefined;\n\n\tsetup(function () {\n\n\t\tdisposables = new DisposableStore();\n\n\t\tinstantiationService = setupInstantiationService(disposables);\n\n\t\tinstantiationService.stub(INotebookService, new class extends mock<INotebookService>() {\n\t\t\toverride onDidAddNotebookDocument = Event.None;\n\t\t\toverride onWillRemoveNotebookDocument = Event.None;\n\t\t\toverride getNotebookTextModels() { return []; }\n\t\t\toverride getNotebookTextModel(uri: URI): NotebookTextModel | undefined {\n\t\t\t\treturn testNotebookModel;\n\t\t\t}\n\t\t});\n\n\t\tinstantiationService.stub(IMenuService, new class extends mock<IMenuService>() {\n\t\t\toverride createMenu() {\n\t\t\t\treturn new class extends mock<IMenu>() {\n\t\t\t\t\toverride onDidChange = Event.None;\n\t\t\t\t\toverride getActions() { return []; }\n\t\t\t\t\toverride dispose() { }\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tkernelService = instantiationService.createInstance(NotebookKernelService);\n\t\tinstantiationService.set(INotebookKernelService, kernelService);\n\t\tinstantiationService.set(INotebookExecutionService, instantiationService.createInstance(NotebookExecutionService));\n\t\tinstantiationService.set(INotebookExecutionStateService, instantiationService.createInstance(NotebookExecutionStateService));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.dispose();\n\t});\n\n\tasync function withTestNotebook(cells: [string, string, CellKind, IOutputDto[], NotebookCellMetadata][], callback: (viewModel: NotebookViewModel, textModel: NotebookTextModel) => void | Promise<void>) {\n\t\treturn _withTestNotebook(cells, (editor, viewModel) => callback(viewModel, viewModel.notebookDocument));\n\t}\n\n\tfunction testCancelOnDelete(expectedCancels: number, implementsInterrupt: boolean) {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tlet cancels = 0;\n\t\t\tconst kernel = new class extends TestNotebookKernel {\n\t\t\t\timplementsInterrupt = implementsInterrupt;\n\n\t\t\t\tconstructor() {\n\t\t\t\t\tsuper({ languages: ['javascript'] });\n\t\t\t\t}\n\n\t\t\t\toverride async executeNotebookCellsRequest(): Promise<void> { }\n\n\t\t\t\toverride async cancelNotebookCellExecution(_uri: URI, handles: number[]): Promise<void> {\n\t\t\t\t\tcancels += handles.length;\n\t\t\t\t}\n\t\t\t};\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\n\t\t\t// Should cancel executing and pending cells, when kernel does not implement interrupt\n\t\t\tconst cell = insertCellAtIndex(viewModel, 0, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true);\n\t\t\tconst cell2 = insertCellAtIndex(viewModel, 1, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true);\n\t\t\tconst cell3 = insertCellAtIndex(viewModel, 2, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true);\n\t\t\tinsertCellAtIndex(viewModel, 3, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true); // Not deleted\n\t\t\tconst exe = executionStateService.createCellExecution(viewModel.uri, cell.handle); // Executing\n\t\t\texe.confirm();\n\t\t\texe.update([{ editType: CellExecutionUpdateType.ExecutionState, executionOrder: 1 }]);\n\t\t\tconst exe2 = executionStateService.createCellExecution(viewModel.uri, cell2.handle); // Pending\n\t\t\texe2.confirm();\n\t\t\texecutionStateService.createCellExecution(viewModel.uri, cell3.handle); // Unconfirmed\n\t\t\tassert.strictEqual(cancels, 0);\n\t\t\tviewModel.notebookDocument.applyEdits([{\n\t\t\t\teditType: CellEditType.Replace, index: 0, count: 3, cells: []\n\t\t\t}], true, undefined, () => undefined, undefined, false);\n\t\t\tassert.strictEqual(cancels, expectedCancels);\n\t\t});\n\n\t}\n\n\t// TODO@roblou Could be a test just for NotebookExecutionListeners, which can be a standalone contribution\n\ttest('cancel execution when cell is deleted', async function () {\n\t\treturn testCancelOnDelete(3, false);\n\t});\n\n\ttest('cancel execution when cell is deleted in interrupt-type kernel', async function () {\n\t\treturn testCancelOnDelete(1, true);\n\t});\n\n\ttest('fires onDidChangeCellExecution when cell is completed while deleted', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\t\t\tconst cell = insertCellAtIndex(viewModel, 0, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true);\n\t\t\tconst exe = executionStateService.createCellExecution(viewModel.uri, cell.handle);\n\n\t\t\tlet didFire = false;\n\t\t\tdisposables.add(executionStateService.onDidChangeExecution(e => {\n\t\t\t\tif (e.type === NotebookExecutionType.cell) {\n\t\t\t\t\tdidFire = !e.changed;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tviewModel.notebookDocument.applyEdits([{\n\t\t\t\teditType: CellEditType.Replace, index: 0, count: 1, cells: []\n\t\t\t}], true, undefined, () => undefined, undefined, false);\n\t\t\texe.complete({});\n\t\t\tassert.strictEqual(didFire, true);\n\t\t});\n\t});\n\n\ttest('does not fire onDidChangeCellExecution for output updates', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\t\t\tconst cell = insertCellAtIndex(viewModel, 0, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true);\n\t\t\tconst exe = executionStateService.createCellExecution(viewModel.uri, cell.handle);\n\n\t\t\tlet didFire = false;\n\t\t\tdisposables.add(executionStateService.onDidChangeExecution(e => {\n\t\t\t\tif (e.type === NotebookExecutionType.cell) {\n\t\t\t\t\tdidFire = true;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\texe.update([{ editType: CellExecutionUpdateType.OutputItems, items: [], outputId: '1' }]);\n\t\t\tassert.strictEqual(didFire, false);\n\t\t\texe.update([{ editType: CellExecutionUpdateType.ExecutionState, executionOrder: 123 }]);\n\t\t\tassert.strictEqual(didFire, true);\n\t\t\texe.complete({});\n\t\t});\n\t});\n\n\t// #142466\n\ttest('getCellExecution and onDidChangeCellExecution', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\t\t\tconst cell = insertCellAtIndex(viewModel, 0, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true);\n\n\t\t\tconst deferred = new DeferredPromise<void>();\n\t\t\tdisposables.add(executionStateService.onDidChangeExecution(e => {\n\t\t\t\tif (e.type === NotebookExecutionType.cell) {\n\t\t\t\t\tconst cellUri = CellUri.generate(e.notebook, e.cellHandle);\n\t\t\t\t\tconst exe = executionStateService.getCellExecution(cellUri);\n\t\t\t\t\tassert.ok(exe);\n\t\t\t\t\tassert.strictEqual(e.notebook.toString(), exe.notebook.toString());\n\t\t\t\t\tassert.strictEqual(e.cellHandle, exe.cellHandle);\n\n\t\t\t\t\tassert.strictEqual(exe.notebook.toString(), e.changed?.notebook.toString());\n\t\t\t\t\tassert.strictEqual(exe.cellHandle, e.changed?.cellHandle);\n\n\t\t\t\t\tdeferred.complete();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\texecutionStateService.createCellExecution(viewModel.uri, cell.handle);\n\n\t\t\treturn deferred.p;\n\t\t});\n\t});\n\ttest('getExecution and onDidChangeExecution', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst eventRaisedWithExecution: boolean[] = [];\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\t\t\texecutionStateService.onDidChangeExecution(e => eventRaisedWithExecution.push(e.type === NotebookExecutionType.notebook && !!e.changed), this, disposables);\n\n\t\t\tconst deferred = new DeferredPromise<void>();\n\t\t\tdisposables.add(executionStateService.onDidChangeExecution(e => {\n\t\t\t\tif (e.type === NotebookExecutionType.notebook) {\n\t\t\t\t\tconst exe = executionStateService.getExecution(viewModel.uri);\n\t\t\t\t\tassert.ok(exe);\n\t\t\t\t\tassert.strictEqual(e.notebook.toString(), exe.notebook.toString());\n\t\t\t\t\tassert.ok(e.affectsNotebook(viewModel.uri));\n\t\t\t\t\tassert.deepStrictEqual(eventRaisedWithExecution, [true]);\n\t\t\t\t\tdeferred.complete();\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\texecutionStateService.createExecution(viewModel.uri);\n\n\t\t\treturn deferred.p;\n\t\t});\n\t});\n\n\ttest('getExecution and onDidChangeExecution 2', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\n\t\t\tconst deferred = new DeferredPromise<void>();\n\t\t\tconst expectedNotebookEventStates: (NotebookExecutionState | undefined)[] = [NotebookExecutionState.Unconfirmed, NotebookExecutionState.Pending, NotebookExecutionState.Executing, undefined];\n\t\t\texecutionStateService.onDidChangeExecution(e => {\n\t\t\t\tif (e.type === NotebookExecutionType.notebook) {\n\t\t\t\t\tconst expectedState = expectedNotebookEventStates.shift();\n\t\t\t\t\tif (typeof expectedState === 'number') {\n\t\t\t\t\t\tconst exe = executionStateService.getExecution(viewModel.uri);\n\t\t\t\t\t\tassert.ok(exe);\n\t\t\t\t\t\tassert.strictEqual(e.notebook.toString(), exe.notebook.toString());\n\t\t\t\t\t\tassert.strictEqual(e.changed?.state, expectedState);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tassert.ok(e.changed === undefined);\n\t\t\t\t\t}\n\n\t\t\t\t\tassert.ok(e.affectsNotebook(viewModel.uri));\n\t\t\t\t\tif (expectedNotebookEventStates.length === 0) {\n\t\t\t\t\t\tdeferred.complete();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this, disposables);\n\n\t\t\tconst execution = executionStateService.createExecution(viewModel.uri);\n\t\t\texecution.confirm();\n\t\t\texecution.begin();\n\t\t\texecution.complete();\n\n\t\t\treturn deferred.p;\n\t\t});\n\t});\n\n\ttest('force-cancel works for Cell Execution', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\t\t\tconst cell = insertCellAtIndex(viewModel, 0, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true);\n\t\t\texecutionStateService.createCellExecution(viewModel.uri, cell.handle);\n\t\t\tconst exe = executionStateService.getCellExecution(cell.uri);\n\t\t\tassert.ok(exe);\n\n\t\t\texecutionStateService.forceCancelNotebookExecutions(viewModel.uri);\n\t\t\tconst exe2 = executionStateService.getCellExecution(cell.uri);\n\t\t\tassert.strictEqual(exe2, undefined);\n\t\t});\n\t});\n\ttest('force-cancel works for Notebook Execution', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\t\t\tconst eventRaisedWithExecution: boolean[] = [];\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\t\t\texecutionStateService.onDidChangeExecution(e => eventRaisedWithExecution.push(e.type === NotebookExecutionType.notebook && !!e.changed), this, disposables);\n\t\t\texecutionStateService.createExecution(viewModel.uri);\n\t\t\tconst exe = executionStateService.getExecution(viewModel.uri);\n\t\t\tassert.ok(exe);\n\t\t\tassert.deepStrictEqual(eventRaisedWithExecution, [true]);\n\n\t\t\texecutionStateService.forceCancelNotebookExecutions(viewModel.uri);\n\t\t\tconst exe2 = executionStateService.getExecution(viewModel.uri);\n\t\t\tassert.deepStrictEqual(eventRaisedWithExecution, [true, false]);\n\t\t\tassert.strictEqual(exe2, undefined);\n\t\t});\n\t});\n\ttest('force-cancel works for Cell and Notebook Execution', async function () {\n\t\treturn withTestNotebook([], async viewModel => {\n\t\t\ttestNotebookModel = viewModel.notebookDocument;\n\n\t\t\tconst kernel = new TestNotebookKernel();\n\t\t\tkernelService.registerKernel(kernel);\n\t\t\tkernelService.selectKernelForNotebook(kernel, viewModel.notebookDocument);\n\n\t\t\tconst executionStateService: INotebookExecutionStateService = instantiationService.get(INotebookExecutionStateService);\n\t\t\texecutionStateService.createExecution(viewModel.uri);\n\t\t\texecutionStateService.createExecution(viewModel.uri);\n\t\t\tconst cellExe = executionStateService.getExecution(viewModel.uri);\n\t\t\tconst exe = executionStateService.getExecution(viewModel.uri);\n\t\t\tassert.ok(cellExe);\n\t\t\tassert.ok(exe);\n\n\t\t\texecutionStateService.forceCancelNotebookExecutions(viewModel.uri);\n\t\t\tconst cellExe2 = executionStateService.getExecution(viewModel.uri);\n\t\t\tconst exe2 = executionStateService.getExecution(viewModel.uri);\n\t\t\tassert.strictEqual(cellExe2, undefined);\n\t\t\tassert.strictEqual(exe2, undefined);\n\t\t});\n\t});\n});\n\nclass TestNotebookKernel implements INotebookKernel {\n\tid: string = 'test';\n\tlabel: string = '';\n\tviewType = '*';\n\tonDidChange = Event.None;\n\textension: ExtensionIdentifier = new ExtensionIdentifier('test');\n\tlocalResourceRoot: URI = URI.file('/test');\n\tdescription?: string | undefined;\n\tdetail?: string | undefined;\n\tpreloadUris: URI[] = [];\n\tpreloadProvides: string[] = [];\n\tsupportedLanguages: string[] = [];\n\tasync executeNotebookCellsRequest(): Promise<void> { }\n\tasync cancelNotebookCellExecution(uri: URI, cellHandles: number[]): Promise<void> { }\n\n\tconstructor(opts?: { languages?: string[]; id?: string }) {\n\t\tthis.supportedLanguages = opts?.languages ?? [PLAINTEXT_LANGUAGE_ID];\n\t\tif (opts?.id) {\n\t\t\tthis.id = opts?.id;\n\t\t}\n\t}\n}\n"]}