{"version":3,"sources":["vs/workbench/contrib/notebook/browser/diff/notebookDiffEditor.ts"],"names":[],"mappings":"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","file":"notebookDiffEditor.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as DOM from 'vs/base/browser/dom';\nimport { findLastIdx } from 'vs/base/common/arraysFind';\nimport { IStorageService } from 'vs/platform/storage/common/storage';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IThemeService, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { EditorPaneSelectionChangeReason, EditorPaneSelectionCompareResult, IEditorOpenContext, IEditorPaneSelection, IEditorPaneSelectionChangeEvent, IEditorPaneWithSelection } from 'vs/workbench/common/editor';\nimport { getDefaultNotebookCreationOptions } from 'vs/workbench/contrib/notebook/browser/notebookEditorWidget';\nimport { IEditorGroup } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { NotebookDiffEditorInput } from '../../common/notebookDiffEditorInput';\nimport { CancellationToken, CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { DiffElementViewModelBase, SideBySideDiffElementViewModel, SingleSideDiffElementViewModel } from 'vs/workbench/contrib/notebook/browser/diff/diffElementViewModel';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { CellDiffSideBySideRenderer, CellDiffSingleSideRenderer, NotebookCellTextDiffListDelegate, NotebookTextDiffList } from 'vs/workbench/contrib/notebook/browser/diff/notebookDiffList';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { diffDiagonalFill, editorBackground, focusBorder, foreground } from 'vs/platform/theme/common/colorRegistry';\nimport { INotebookEditorWorkerService } from 'vs/workbench/contrib/notebook/common/services/notebookWorkerService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IEditorOptions as ICodeEditorOptions } from 'vs/editor/common/config/editorOptions';\nimport { BareFontInfo, FontInfo } from 'vs/editor/common/config/fontInfo';\nimport { PixelRatio } from 'vs/base/browser/browser';\nimport { CellEditState, ICellOutputViewModel, IDisplayOutputLayoutUpdateRequest, IGenericCellViewModel, IInsetRenderOutput, INotebookEditorCreationOptions, INotebookEditorOptions } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { DiffSide, DIFF_CELL_MARGIN, IDiffCellInfo, INotebookTextDiffEditor } from 'vs/workbench/contrib/notebook/browser/diff/notebookDiffEditorBrowser';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { DisposableStore, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { EditorPane } from 'vs/workbench/browser/parts/editor/editorPane';\nimport { CellUri, INotebookDiffEditorModel, INotebookDiffResult, NOTEBOOK_DIFF_EDITOR_ID, NotebookSetting } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { URI } from 'vs/base/common/uri';\nimport { IDiffChange, IDiffResult } from 'vs/base/common/diff/diff';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\nimport { SequencerByKey } from 'vs/base/common/async';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { IMouseWheelEvent, StandardMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { DiffNestedCellViewModel } from 'vs/workbench/contrib/notebook/browser/diff/diffNestedCellViewModel';\nimport { BackLayerWebView, INotebookDelegateForWebview } from 'vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView';\nimport { NotebookDiffEditorEventDispatcher, NotebookDiffLayoutChangedEvent } from 'vs/workbench/contrib/notebook/browser/diff/eventDispatcher';\nimport { FontMeasurements } from 'vs/editor/browser/config/fontMeasurements';\nimport { NotebookOptions } from 'vs/workbench/contrib/notebook/browser/notebookOptions';\nimport { INotebookExecutionStateService } from 'vs/workbench/contrib/notebook/common/notebookExecutionStateService';\nimport { NotebookLayoutInfo } from 'vs/workbench/contrib/notebook/browser/notebookViewEvents';\nimport { IEditorOptions } from 'vs/platform/editor/common/editor';\nimport { cellIndexesToRanges, cellRangesToIndexes } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { NotebookDiffOverviewRuler } from 'vs/workbench/contrib/notebook/browser/diff/notebookDiffOverviewRuler';\nimport { registerZIndex, ZIndex } from 'vs/platform/layout/browser/zIndexRegistry';\n\nconst $ = DOM.$;\n\nclass NotebookDiffEditorSelection implements IEditorPaneSelection {\n\n\tconstructor(\n\t\tprivate readonly selections: number[]\n\t) { }\n\n\tcompare(other: IEditorPaneSelection): EditorPaneSelectionCompareResult {\n\t\tif (!(other instanceof NotebookDiffEditorSelection)) {\n\t\t\treturn EditorPaneSelectionCompareResult.DIFFERENT;\n\t\t}\n\n\t\tif (this.selections.length !== other.selections.length) {\n\t\t\treturn EditorPaneSelectionCompareResult.DIFFERENT;\n\t\t}\n\n\t\tfor (let i = 0; i < this.selections.length; i++) {\n\t\t\tif (this.selections[i] !== other.selections[i]) {\n\t\t\t\treturn EditorPaneSelectionCompareResult.DIFFERENT;\n\t\t\t}\n\t\t}\n\n\t\treturn EditorPaneSelectionCompareResult.IDENTICAL;\n\t}\n\n\trestore(options: IEditorOptions): INotebookEditorOptions {\n\t\tconst notebookOptions: INotebookEditorOptions = {\n\t\t\tcellSelections: cellIndexesToRanges(this.selections)\n\t\t};\n\n\t\tObject.assign(notebookOptions, options);\n\t\treturn notebookOptions;\n\t}\n}\n\nexport class NotebookTextDiffEditor extends EditorPane implements INotebookTextDiffEditor, INotebookDelegateForWebview, IEditorPaneWithSelection {\n\tpublic static readonly ENTIRE_DIFF_OVERVIEW_WIDTH = 30;\n\tcreationOptions: INotebookEditorCreationOptions = getDefaultNotebookCreationOptions();\n\tstatic readonly ID: string = NOTEBOOK_DIFF_EDITOR_ID;\n\n\tprivate _rootElement!: HTMLElement;\n\tprivate _listViewContainer!: HTMLElement;\n\tprivate _overflowContainer!: HTMLElement;\n\tprivate _overviewRulerContainer!: HTMLElement;\n\tprivate _overviewRuler!: NotebookDiffOverviewRuler;\n\tprivate _dimension: DOM.Dimension | null = null;\n\tprivate _diffElementViewModels: DiffElementViewModelBase[] = [];\n\tprivate _list!: NotebookTextDiffList;\n\tprivate _modifiedWebview: BackLayerWebView<IDiffCellInfo> | null = null;\n\tprivate _originalWebview: BackLayerWebView<IDiffCellInfo> | null = null;\n\tprivate _webviewTransparentCover: HTMLElement | null = null;\n\tprivate _fontInfo: FontInfo | undefined;\n\n\tprivate readonly _onMouseUp = this._register(new Emitter<{ readonly event: MouseEvent; readonly target: DiffElementViewModelBase }>());\n\tpublic readonly onMouseUp = this._onMouseUp.event;\n\tprivate readonly _onDidScroll = this._register(new Emitter<void>());\n\treadonly onDidScroll: Event<void> = this._onDidScroll.event;\n\tprivate _eventDispatcher: NotebookDiffEditorEventDispatcher | undefined;\n\tprotected _scopeContextKeyService!: IContextKeyService;\n\tprivate _model: INotebookDiffEditorModel | null = null;\n\tprivate readonly _modifiedResourceDisposableStore = this._register(new DisposableStore());\n\n\tget textModel() {\n\t\treturn this._model?.modified.notebook;\n\t}\n\n\tprivate _revealFirst: boolean;\n\tprivate readonly _insetModifyQueueByOutputId = new SequencerByKey<string>();\n\n\tprotected _onDidDynamicOutputRendered = this._register(new Emitter<{ cell: IGenericCellViewModel; output: ICellOutputViewModel }>());\n\tonDidDynamicOutputRendered = this._onDidDynamicOutputRendered.event;\n\n\tprivate _notebookOptions: NotebookOptions;\n\n\tget notebookOptions() {\n\t\treturn this._notebookOptions;\n\t}\n\n\tprivate readonly _localStore = this._register(new DisposableStore());\n\n\tprivate _layoutCancellationTokenSource?: CancellationTokenSource;\n\n\tprivate readonly _onDidChangeSelection = this._register(new Emitter<IEditorPaneSelectionChangeEvent>());\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\n\tprivate _isDisposed: boolean = false;\n\n\tget isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n\n\tconstructor(\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@INotebookEditorWorkerService private readonly notebookEditorWorkerService: INotebookEditorWorkerService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@INotebookExecutionStateService notebookExecutionStateService: INotebookExecutionStateService,\n\t) {\n\t\tsuper(NotebookTextDiffEditor.ID, telemetryService, themeService, storageService);\n\t\tthis._notebookOptions = new NotebookOptions(this.configurationService, notebookExecutionStateService, false);\n\t\tthis._register(this._notebookOptions);\n\t\tconst editorOptions = this.configurationService.getValue<ICodeEditorOptions>('editor');\n\t\tthis._fontInfo = FontMeasurements.readFontInfo(BareFontInfo.createFromRawSettings(editorOptions, PixelRatio.value));\n\t\tthis._revealFirst = true;\n\t}\n\n\tprivate isOverviewRulerEnabled(): boolean {\n\t\treturn this.configurationService.getValue(NotebookSetting.diffOverviewRuler) ?? false;\n\t}\n\n\tgetSelection(): IEditorPaneSelection | undefined {\n\t\tconst selections = this._list.getFocus();\n\t\treturn new NotebookDiffEditorSelection(selections);\n\t}\n\n\ttoggleNotebookCellSelection(cell: IGenericCellViewModel) {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tupdatePerformanceMetadata(cellId: string, executionId: string, duration: number, rendererId: string): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tasync focusNotebookCell(cell: IGenericCellViewModel, focus: 'output' | 'editor' | 'container'): Promise<void> {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tasync focusNextNotebookCell(cell: IGenericCellViewModel, focus: 'output' | 'editor' | 'container'): Promise<void> {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tdidFocusOutputInputChange(inputFocused: boolean): void {\n\t\t// noop\n\t}\n\n\tgetScrollTop() {\n\t\treturn this._list?.scrollTop ?? 0;\n\t}\n\n\tgetScrollHeight() {\n\t\treturn this._list?.scrollHeight ?? 0;\n\t}\n\n\tdelegateVerticalScrollbarPointerDown(browserEvent: PointerEvent) {\n\t\tthis._list?.delegateVerticalScrollbarPointerDown(browserEvent);\n\t}\n\n\tupdateOutputHeight(cellInfo: IDiffCellInfo, output: ICellOutputViewModel, outputHeight: number, isInit: boolean): void {\n\t\tconst diffElement = cellInfo.diffElement;\n\t\tconst cell = this.getCellByInfo(cellInfo);\n\t\tconst outputIndex = cell.outputsViewModels.indexOf(output);\n\n\t\tif (diffElement instanceof SideBySideDiffElementViewModel) {\n\t\t\tconst info = CellUri.parse(cellInfo.cellUri);\n\t\t\tif (!info) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdiffElement.updateOutputHeight(info.notebook.toString() === this._model?.original.resource.toString() ? DiffSide.Original : DiffSide.Modified, outputIndex, outputHeight);\n\t\t} else {\n\t\t\tdiffElement.updateOutputHeight(diffElement.type === 'insert' ? DiffSide.Modified : DiffSide.Original, outputIndex, outputHeight);\n\t\t}\n\n\t\tif (isInit) {\n\t\t\tthis._onDidDynamicOutputRendered.fire({ cell, output });\n\t\t}\n\t}\n\n\tsetMarkupCellEditState(cellId: string, editState: CellEditState): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tdidStartDragMarkupCell(cellId: string, event: { dragOffsetY: number }): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tdidDragMarkupCell(cellId: string, event: { dragOffsetY: number }): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tdidEndDragMarkupCell(cellId: string): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tdidDropMarkupCell(cellId: string) {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tdidResizeOutput(cellId: string): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._rootElement = DOM.append(parent, DOM.$('.notebook-text-diff-editor'));\n\t\tthis._overflowContainer = document.createElement('div');\n\t\tthis._overflowContainer.classList.add('notebook-overflow-widget-container', 'monaco-editor');\n\t\tDOM.append(parent, this._overflowContainer);\n\n\t\tconst renderers = [\n\t\t\tthis.instantiationService.createInstance(CellDiffSingleSideRenderer, this),\n\t\t\tthis.instantiationService.createInstance(CellDiffSideBySideRenderer, this),\n\t\t];\n\n\t\tthis._listViewContainer = DOM.append(this._rootElement, DOM.$('.notebook-diff-list-view'));\n\n\t\tthis._list = this.instantiationService.createInstance(\n\t\t\tNotebookTextDiffList,\n\t\t\t'NotebookTextDiff',\n\t\t\tthis._listViewContainer,\n\t\t\tthis.instantiationService.createInstance(NotebookCellTextDiffListDelegate),\n\t\t\trenderers,\n\t\t\tthis.contextKeyService,\n\t\t\t{\n\t\t\t\tsetRowLineHeight: false,\n\t\t\t\tsetRowHeight: false,\n\t\t\t\tsupportDynamicHeights: true,\n\t\t\t\thorizontalScrolling: false,\n\t\t\t\tkeyboardSupport: false,\n\t\t\t\tmouseSupport: true,\n\t\t\t\tmultipleSelectionSupport: false,\n\t\t\t\ttypeNavigationEnabled: true,\n\t\t\t\tpaddingBottom: 0,\n\t\t\t\t// transformOptimization: (isMacintosh && isNative) || getTitleBarStyle(this.configurationService, this.environmentService) === 'native',\n\t\t\t\tstyleController: (_suffix: string) => { return this._list!; },\n\t\t\t\toverrideStyles: {\n\t\t\t\t\tlistBackground: editorBackground,\n\t\t\t\t\tlistActiveSelectionBackground: editorBackground,\n\t\t\t\t\tlistActiveSelectionForeground: foreground,\n\t\t\t\t\tlistFocusAndSelectionBackground: editorBackground,\n\t\t\t\t\tlistFocusAndSelectionForeground: foreground,\n\t\t\t\t\tlistFocusBackground: editorBackground,\n\t\t\t\t\tlistFocusForeground: foreground,\n\t\t\t\t\tlistHoverForeground: foreground,\n\t\t\t\t\tlistHoverBackground: editorBackground,\n\t\t\t\t\tlistHoverOutline: focusBorder,\n\t\t\t\t\tlistFocusOutline: focusBorder,\n\t\t\t\t\tlistInactiveSelectionBackground: editorBackground,\n\t\t\t\t\tlistInactiveSelectionForeground: foreground,\n\t\t\t\t\tlistInactiveFocusBackground: editorBackground,\n\t\t\t\t\tlistInactiveFocusOutline: editorBackground,\n\t\t\t\t},\n\t\t\t\taccessibilityProvider: {\n\t\t\t\t\tgetAriaLabel() { return null; },\n\t\t\t\t\tgetWidgetAriaLabel() {\n\t\t\t\t\t\treturn nls.localize('notebookTreeAriaLabel', \"Notebook Text Diff\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// focusNextPreviousDelegate: {\n\t\t\t\t// \tonFocusNext: (applyFocusNext: () => void) => this._updateForCursorNavigationMode(applyFocusNext),\n\t\t\t\t// \tonFocusPrevious: (applyFocusPrevious: () => void) => this._updateForCursorNavigationMode(applyFocusPrevious),\n\t\t\t\t// }\n\t\t\t}\n\t\t);\n\n\t\tthis._register(this._list);\n\n\t\tthis._register(this._list.onMouseUp(e => {\n\t\t\tif (e.element) {\n\t\t\t\tthis._onMouseUp.fire({ event: e.browserEvent, target: e.element });\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onDidScroll(() => {\n\t\t\tthis._onDidScroll.fire();\n\t\t}));\n\n\t\tthis._register(this._list.onDidChangeFocus(() => this._onDidChangeSelection.fire({ reason: EditorPaneSelectionChangeReason.USER })));\n\n\t\tthis._overviewRulerContainer = document.createElement('div');\n\t\tthis._overviewRulerContainer.classList.add('notebook-overview-ruler-container');\n\t\tthis._rootElement.appendChild(this._overviewRulerContainer);\n\t\tthis._registerOverviewRuler();\n\n\t\t// transparent cover\n\t\tthis._webviewTransparentCover = DOM.append(this._list.rowsContainer, $('.webview-cover'));\n\t\tthis._webviewTransparentCover.style.display = 'none';\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseDownListener(this._overflowContainer, (e: StandardMouseEvent) => {\n\t\t\tif (e.target.classList.contains('slider') && this._webviewTransparentCover) {\n\t\t\t\tthis._webviewTransparentCover.style.display = 'block';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseUpListener(this._overflowContainer, () => {\n\t\t\tif (this._webviewTransparentCover) {\n\t\t\t\t// no matter when\n\t\t\t\tthis._webviewTransparentCover.style.display = 'none';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onDidScroll(e => {\n\t\t\tthis._webviewTransparentCover!.style.top = `${e.scrollTop}px`;\n\t\t}));\n\t}\n\n\tprivate _registerOverviewRuler() {\n\t\tthis._overviewRuler = this._register(this.instantiationService.createInstance(NotebookDiffOverviewRuler, this, NotebookTextDiffEditor.ENTIRE_DIFF_OVERVIEW_WIDTH, this._overviewRulerContainer!));\n\t}\n\n\tprivate _updateOutputsOffsetsInWebview(scrollTop: number, scrollHeight: number, activeWebview: BackLayerWebView<IDiffCellInfo>, getActiveNestedCell: (diffElement: DiffElementViewModelBase) => DiffNestedCellViewModel | undefined, diffSide: DiffSide) {\n\t\tactiveWebview.element.style.height = `${scrollHeight}px`;\n\n\t\tif (activeWebview.insetMapping) {\n\t\t\tconst updateItems: IDisplayOutputLayoutUpdateRequest[] = [];\n\t\t\tconst removedItems: ICellOutputViewModel[] = [];\n\t\t\tactiveWebview.insetMapping.forEach((value, key) => {\n\t\t\t\tconst cell = getActiveNestedCell(value.cellInfo.diffElement);\n\t\t\t\tif (!cell) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst viewIndex = this._list.indexOf(value.cellInfo.diffElement);\n\n\t\t\t\tif (viewIndex === undefined) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (cell.outputsViewModels.indexOf(key) < 0) {\n\t\t\t\t\t// output is already gone\n\t\t\t\t\tremovedItems.push(key);\n\t\t\t\t} else {\n\t\t\t\t\tconst cellTop = this._list.getCellViewScrollTop(value.cellInfo.diffElement);\n\t\t\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(key);\n\t\t\t\t\tconst outputOffset = value.cellInfo.diffElement.getOutputOffsetInCell(diffSide, outputIndex);\n\t\t\t\t\tupdateItems.push({\n\t\t\t\t\t\tcell,\n\t\t\t\t\t\toutput: key,\n\t\t\t\t\t\tcellTop: cellTop,\n\t\t\t\t\t\toutputOffset: outputOffset,\n\t\t\t\t\t\tforceDisplay: false\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\tactiveWebview.removeInsets(removedItems);\n\n\t\t\tif (updateItems.length) {\n\t\t\t\tactiveWebview.updateScrollTops(updateItems, []);\n\t\t\t}\n\t\t}\n\t}\n\n\toverride async setInput(input: NotebookDiffEditorInput, options: INotebookEditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken): Promise<void> {\n\t\tawait super.setInput(input, options, context, token);\n\n\t\tconst model = await input.resolve();\n\t\tif (this._model !== model) {\n\t\t\tthis._detachModel();\n\t\t\tthis._model = model;\n\t\t\tthis._attachModel();\n\t\t}\n\n\t\tthis._model = model;\n\t\tif (this._model === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._revealFirst = true;\n\n\t\tthis._modifiedResourceDisposableStore.clear();\n\n\t\tthis._layoutCancellationTokenSource = new CancellationTokenSource();\n\n\t\tthis._modifiedResourceDisposableStore.add(Event.any(this._model.original.notebook.onDidChangeContent, this._model.modified.notebook.onDidChangeContent)(e => {\n\t\t\tif (this._model !== null) {\n\t\t\t\tthis._layoutCancellationTokenSource?.dispose();\n\t\t\t\tthis._layoutCancellationTokenSource = new CancellationTokenSource();\n\t\t\t\tthis.updateLayout(this._layoutCancellationTokenSource.token);\n\t\t\t}\n\t\t}));\n\n\t\tawait this._createOriginalWebview(generateUuid(), this._model.original.viewType, this._model.original.resource);\n\t\tif (this._originalWebview) {\n\t\t\tthis._modifiedResourceDisposableStore.add(this._originalWebview);\n\t\t}\n\t\tawait this._createModifiedWebview(generateUuid(), this._model.modified.viewType, this._model.modified.resource);\n\t\tif (this._modifiedWebview) {\n\t\t\tthis._modifiedResourceDisposableStore.add(this._modifiedWebview);\n\t\t}\n\n\t\tawait this.updateLayout(this._layoutCancellationTokenSource.token, options?.cellSelections ? cellRangesToIndexes(options.cellSelections) : undefined);\n\t}\n\n\tprivate _detachModel() {\n\t\tthis._localStore.clear();\n\t\tthis._originalWebview?.dispose();\n\t\tthis._originalWebview?.element.remove();\n\t\tthis._originalWebview = null;\n\t\tthis._modifiedWebview?.dispose();\n\t\tthis._modifiedWebview?.element.remove();\n\t\tthis._modifiedWebview = null;\n\n\t\tthis._modifiedResourceDisposableStore.clear();\n\t\tthis._list.clear();\n\n\t}\n\tprivate _attachModel() {\n\t\tthis._eventDispatcher = new NotebookDiffEditorEventDispatcher();\n\t\tconst updateInsets = () => {\n\t\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this._modifiedWebview) {\n\t\t\t\t\tthis._updateOutputsOffsetsInWebview(this._list.scrollTop, this._list.scrollHeight, this._modifiedWebview, (diffElement: DiffElementViewModelBase) => {\n\t\t\t\t\t\treturn diffElement.modified;\n\t\t\t\t\t}, DiffSide.Modified);\n\t\t\t\t}\n\n\t\t\t\tif (this._originalWebview) {\n\t\t\t\t\tthis._updateOutputsOffsetsInWebview(this._list.scrollTop, this._list.scrollHeight, this._originalWebview, (diffElement: DiffElementViewModelBase) => {\n\t\t\t\t\t\treturn diffElement.original;\n\t\t\t\t\t}, DiffSide.Original);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tthis._localStore.add(this._list.onDidChangeContentHeight(() => {\n\t\t\tupdateInsets();\n\t\t}));\n\n\t\tthis._localStore.add(this._eventDispatcher.onDidChangeCellLayout(() => {\n\t\t\tupdateInsets();\n\t\t}));\n\t}\n\n\tprivate async _createModifiedWebview(id: string, viewType: string, resource: URI): Promise<void> {\n\t\tthis._modifiedWebview?.dispose();\n\n\t\tthis._modifiedWebview = this.instantiationService.createInstance(BackLayerWebView, this, id, viewType, resource, {\n\t\t\t...this._notebookOptions.computeDiffWebviewOptions(),\n\t\t\tfontFamily: this._generateFontFamily()\n\t\t}, undefined) as BackLayerWebView<IDiffCellInfo>;\n\t\t// attach the webview container to the DOM tree first\n\t\tthis._list.rowsContainer.insertAdjacentElement('afterbegin', this._modifiedWebview.element);\n\t\tthis._modifiedWebview.createWebview();\n\t\tthis._modifiedWebview.element.style.width = `calc(50% - 16px)`;\n\t\tthis._modifiedWebview.element.style.left = `calc(50%)`;\n\t}\n\t_generateFontFamily(): string {\n\t\treturn this._fontInfo?.fontFamily ?? `\"SF Mono\", Monaco, Menlo, Consolas, \"Ubuntu Mono\", \"Liberation Mono\", \"DejaVu Sans Mono\", \"Courier New\", monospace`;\n\t}\n\n\tprivate async _createOriginalWebview(id: string, viewType: string, resource: URI): Promise<void> {\n\t\tthis._originalWebview?.dispose();\n\n\t\tthis._originalWebview = this.instantiationService.createInstance(BackLayerWebView, this, id, viewType, resource, {\n\t\t\t...this._notebookOptions.computeDiffWebviewOptions(),\n\t\t\tfontFamily: this._generateFontFamily()\n\t\t}, undefined) as BackLayerWebView<IDiffCellInfo>;\n\t\t// attach the webview container to the DOM tree first\n\t\tthis._list.rowsContainer.insertAdjacentElement('afterbegin', this._originalWebview.element);\n\t\tthis._originalWebview.createWebview();\n\t\tthis._originalWebview.element.style.width = `calc(50% - 16px)`;\n\t\tthis._originalWebview.element.style.left = `16px`;\n\t}\n\n\toverride setOptions(options: INotebookEditorOptions | undefined): void {\n\t\tconst selections = options?.cellSelections ? cellRangesToIndexes(options.cellSelections) : undefined;\n\t\tif (selections) {\n\t\t\tthis._list.setFocus(selections);\n\t\t}\n\t}\n\n\tasync updateLayout(token: CancellationToken, selections?: number[]) {\n\t\tif (!this._model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst diffResult = await this.notebookEditorWorkerService.computeDiff(this._model.original.resource, this._model.modified.resource);\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// after await the editor might be disposed.\n\t\t\treturn;\n\t\t}\n\n\t\tNotebookTextDiffEditor.prettyChanges(this._model, diffResult.cellsDiff);\n\t\tconst { viewModels, firstChangeIndex } = NotebookTextDiffEditor.computeDiff(this.instantiationService, this.configurationService, this._model, this._eventDispatcher!, diffResult, this._fontInfo);\n\t\tconst isSame = this._isViewModelTheSame(viewModels);\n\n\t\tif (!isSame) {\n\t\t\tthis._originalWebview?.removeInsets([...this._originalWebview?.insetMapping.keys()]);\n\t\t\tthis._modifiedWebview?.removeInsets([...this._modifiedWebview?.insetMapping.keys()]);\n\t\t\tthis._setViewModel(viewModels);\n\t\t}\n\n\t\t// this._diffElementViewModels = viewModels;\n\t\t// this._list.splice(0, this._list.length, this._diffElementViewModels);\n\n\t\tif (this._revealFirst && firstChangeIndex !== -1 && firstChangeIndex < this._list.length) {\n\t\t\tthis._revealFirst = false;\n\t\t\tthis._list.setFocus([firstChangeIndex]);\n\t\t\tthis._list.reveal(firstChangeIndex, 0.3);\n\t\t}\n\n\t\tif (selections) {\n\t\t\tthis._list.setFocus(selections);\n\t\t}\n\t}\n\n\tprivate _isViewModelTheSame(viewModels: DiffElementViewModelBase[]) {\n\t\tlet isSame = true;\n\t\tif (this._diffElementViewModels.length === viewModels.length) {\n\t\t\tfor (let i = 0; i < viewModels.length; i++) {\n\t\t\t\tconst a = this._diffElementViewModels[i];\n\t\t\t\tconst b = viewModels[i];\n\n\t\t\t\tif (a.original?.textModel.getHashValue() !== b.original?.textModel.getHashValue()\n\t\t\t\t\t|| a.modified?.textModel.getHashValue() !== b.modified?.textModel.getHashValue()) {\n\t\t\t\t\tisSame = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tisSame = false;\n\t\t}\n\n\t\treturn isSame;\n\t}\n\n\tprivate _setViewModel(viewModels: DiffElementViewModelBase[]) {\n\t\tthis._diffElementViewModels = viewModels;\n\t\tthis._list.splice(0, this._list.length, this._diffElementViewModels);\n\t\tif (this.isOverviewRulerEnabled()) {\n\t\t\tthis._overviewRuler.updateViewModels(this._diffElementViewModels, this._eventDispatcher);\n\t\t}\n\t}\n\n\t/**\n\t * making sure that swapping cells are always translated to `insert+delete`.\n\t */\n\tstatic prettyChanges(model: INotebookDiffEditorModel, diffResult: IDiffResult) {\n\t\tconst changes = diffResult.changes;\n\t\tfor (let i = 0; i < diffResult.changes.length - 1; i++) {\n\t\t\t// then we know there is another change after current one\n\t\t\tconst curr = changes[i];\n\t\t\tconst next = changes[i + 1];\n\t\t\tconst x = curr.originalStart;\n\t\t\tconst y = curr.modifiedStart;\n\n\t\t\tif (\n\t\t\t\tcurr.originalLength === 1\n\t\t\t\t&& curr.modifiedLength === 0\n\t\t\t\t&& next.originalStart === x + 2\n\t\t\t\t&& next.originalLength === 0\n\t\t\t\t&& next.modifiedStart === y + 1\n\t\t\t\t&& next.modifiedLength === 1\n\t\t\t\t&& model.original.notebook.cells[x].getHashValue() === model.modified.notebook.cells[y + 1].getHashValue()\n\t\t\t\t&& model.original.notebook.cells[x + 1].getHashValue() === model.modified.notebook.cells[y].getHashValue()\n\t\t\t) {\n\t\t\t\t// this is a swap\n\t\t\t\tcurr.originalStart = x;\n\t\t\t\tcurr.originalLength = 0;\n\t\t\t\tcurr.modifiedStart = y;\n\t\t\t\tcurr.modifiedLength = 1;\n\n\t\t\t\tnext.originalStart = x + 1;\n\t\t\t\tnext.originalLength = 1;\n\t\t\t\tnext.modifiedStart = y + 2;\n\t\t\t\tnext.modifiedLength = 0;\n\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic computeDiff(instantiationService: IInstantiationService, configurationService: IConfigurationService, model: INotebookDiffEditorModel, eventDispatcher: NotebookDiffEditorEventDispatcher, diffResult: INotebookDiffResult, fontInfo: FontInfo | undefined) {\n\t\tconst cellChanges = diffResult.cellsDiff.changes;\n\t\tconst diffElementViewModels: DiffElementViewModelBase[] = [];\n\t\tconst originalModel = model.original.notebook;\n\t\tconst modifiedModel = model.modified.notebook;\n\t\tlet originalCellIndex = 0;\n\t\tlet modifiedCellIndex = 0;\n\n\t\tlet firstChangeIndex = -1;\n\t\tconst initData = {\n\t\t\tmetadataStatusHeight: configurationService.getValue('notebook.diff.ignoreMetadata') ? 0 : 25,\n\t\t\toutputStatusHeight: configurationService.getValue<boolean>('notebook.diff.ignoreOutputs') || !!(modifiedModel.transientOptions.transientOutputs) ? 0 : 25,\n\t\t\tfontInfo\n\t\t};\n\n\t\tfor (let i = 0; i < cellChanges.length; i++) {\n\t\t\tconst change = cellChanges[i];\n\t\t\t// common cells\n\n\t\t\tfor (let j = 0; j < change.originalStart - originalCellIndex; j++) {\n\t\t\t\tconst originalCell = originalModel.cells[originalCellIndex + j];\n\t\t\t\tconst modifiedCell = modifiedModel.cells[modifiedCellIndex + j];\n\t\t\t\tif (originalCell.getHashValue() === modifiedCell.getHashValue()) {\n\t\t\t\t\tdiffElementViewModels.push(new SideBySideDiffElementViewModel(\n\t\t\t\t\t\tmodel.modified.notebook,\n\t\t\t\t\t\tmodel.original.notebook,\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalCell),\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedCell),\n\t\t\t\t\t\t'unchanged',\n\t\t\t\t\t\teventDispatcher,\n\t\t\t\t\t\tinitData\n\t\t\t\t\t));\n\t\t\t\t} else {\n\t\t\t\t\tif (firstChangeIndex === -1) {\n\t\t\t\t\t\tfirstChangeIndex = diffElementViewModels.length;\n\t\t\t\t\t}\n\n\t\t\t\t\tdiffElementViewModels.push(new SideBySideDiffElementViewModel(\n\t\t\t\t\t\tmodel.modified.notebook,\n\t\t\t\t\t\tmodel.original.notebook,\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalCell),\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedCell),\n\t\t\t\t\t\t'modified',\n\t\t\t\t\t\teventDispatcher!,\n\t\t\t\t\t\tinitData\n\t\t\t\t\t));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst modifiedLCS = NotebookTextDiffEditor.computeModifiedLCS(instantiationService, change, originalModel, modifiedModel, eventDispatcher, initData);\n\t\t\tif (modifiedLCS.length && firstChangeIndex === -1) {\n\t\t\t\tfirstChangeIndex = diffElementViewModels.length;\n\t\t\t}\n\n\t\t\tdiffElementViewModels.push(...modifiedLCS);\n\t\t\toriginalCellIndex = change.originalStart + change.originalLength;\n\t\t\tmodifiedCellIndex = change.modifiedStart + change.modifiedLength;\n\t\t}\n\n\t\tfor (let i = originalCellIndex; i < originalModel.cells.length; i++) {\n\t\t\tdiffElementViewModels.push(new SideBySideDiffElementViewModel(\n\t\t\t\tmodel.modified.notebook,\n\t\t\t\tmodel.original.notebook,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalModel.cells[i]),\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedModel.cells[i - originalCellIndex + modifiedCellIndex]),\n\t\t\t\t'unchanged',\n\t\t\t\teventDispatcher,\n\t\t\t\tinitData\n\t\t\t));\n\t\t}\n\n\t\treturn {\n\t\t\tviewModels: diffElementViewModels,\n\t\t\tfirstChangeIndex\n\t\t};\n\t}\n\n\tstatic computeModifiedLCS(instantiationService: IInstantiationService, change: IDiffChange, originalModel: NotebookTextModel, modifiedModel: NotebookTextModel, eventDispatcher: NotebookDiffEditorEventDispatcher, initData: {\n\t\tmetadataStatusHeight: number;\n\t\toutputStatusHeight: number;\n\t\tfontInfo: FontInfo | undefined;\n\t}) {\n\t\tconst result: DiffElementViewModelBase[] = [];\n\t\t// modified cells\n\t\tconst modifiedLen = Math.min(change.originalLength, change.modifiedLength);\n\n\t\tfor (let j = 0; j < modifiedLen; j++) {\n\t\t\tconst isTheSame = originalModel.cells[change.originalStart + j].equal(modifiedModel.cells[change.modifiedStart + j]);\n\t\t\tresult.push(new SideBySideDiffElementViewModel(\n\t\t\t\tmodifiedModel,\n\t\t\t\toriginalModel,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalModel.cells[change.originalStart + j]),\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedModel.cells[change.modifiedStart + j]),\n\t\t\t\tisTheSame ? 'unchanged' : 'modified',\n\t\t\t\teventDispatcher,\n\t\t\t\tinitData\n\t\t\t));\n\t\t}\n\n\t\tfor (let j = modifiedLen; j < change.originalLength; j++) {\n\t\t\t// deletion\n\t\t\tresult.push(new SingleSideDiffElementViewModel(\n\t\t\t\toriginalModel,\n\t\t\t\tmodifiedModel,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalModel.cells[change.originalStart + j]),\n\t\t\t\tundefined,\n\t\t\t\t'delete',\n\t\t\t\teventDispatcher,\n\t\t\t\tinitData\n\t\t\t));\n\t\t}\n\n\t\tfor (let j = modifiedLen; j < change.modifiedLength; j++) {\n\t\t\t// insertion\n\t\t\tresult.push(new SingleSideDiffElementViewModel(\n\t\t\t\tmodifiedModel,\n\t\t\t\toriginalModel,\n\t\t\t\tundefined,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedModel.cells[change.modifiedStart + j]),\n\t\t\t\t'insert',\n\t\t\t\teventDispatcher,\n\t\t\t\tinitData\n\t\t\t));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tscheduleOutputHeightAck(cellInfo: IDiffCellInfo, outputId: string, height: number) {\n\t\tconst diffElement = cellInfo.diffElement;\n\t\t// const activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\tlet diffSide = DiffSide.Original;\n\n\t\tif (diffElement instanceof SideBySideDiffElementViewModel) {\n\t\t\tconst info = CellUri.parse(cellInfo.cellUri);\n\t\t\tif (!info) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdiffSide = info.notebook.toString() === this._model?.original.resource.toString() ? DiffSide.Original : DiffSide.Modified;\n\t\t} else {\n\t\t\tdiffSide = diffElement.type === 'insert' ? DiffSide.Modified : DiffSide.Original;\n\t\t}\n\n\t\tconst webview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\n\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\twebview?.ackHeight([{ cellId: cellInfo.cellId, outputId, height }]);\n\t\t}, 10);\n\t}\n\n\tprivate pendingLayouts = new WeakMap<DiffElementViewModelBase, IDisposable>();\n\n\n\tlayoutNotebookCell(cell: DiffElementViewModelBase, height: number) {\n\t\tconst relayout = (cell: DiffElementViewModelBase, height: number) => {\n\t\t\tthis._list.updateElementHeight2(cell, height);\n\t\t};\n\n\t\tif (this.pendingLayouts.has(cell)) {\n\t\t\tthis.pendingLayouts.get(cell)!.dispose();\n\t\t}\n\n\t\tlet r: () => void;\n\t\tconst layoutDisposable = DOM.scheduleAtNextAnimationFrame(() => {\n\t\t\tthis.pendingLayouts.delete(cell);\n\n\t\t\trelayout(cell, height);\n\t\t\tr();\n\t\t});\n\n\t\tthis.pendingLayouts.set(cell, toDisposable(() => {\n\t\t\tlayoutDisposable.dispose();\n\t\t\tr();\n\t\t}));\n\n\t\treturn new Promise<void>(resolve => { r = resolve; });\n\t}\n\n\tsetScrollTop(scrollTop: number): void {\n\t\tthis._list.scrollTop = scrollTop;\n\t}\n\n\ttriggerScroll(event: IMouseWheelEvent) {\n\t\tthis._list.triggerScrollFromMouseWheelEvent(event);\n\t}\n\n\tpreviousChange(): void {\n\t\tlet currFocus = this._list.getFocus()[0];\n\n\t\tif (isNaN(currFocus) || currFocus < 0) {\n\t\t\tcurrFocus = 0;\n\t\t}\n\n\t\t// find the index of previous change\n\t\tlet prevChangeIndex = currFocus - 1;\n\t\twhile (prevChangeIndex >= 0) {\n\t\t\tconst vm = this._diffElementViewModels[prevChangeIndex];\n\t\t\tif (vm.type !== 'unchanged') {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tprevChangeIndex--;\n\t\t}\n\n\t\tif (prevChangeIndex >= 0) {\n\t\t\tthis._list.setFocus([prevChangeIndex]);\n\t\t\tthis._list.reveal(prevChangeIndex);\n\t\t} else {\n\t\t\t// go to the last one\n\t\t\tconst index = findLastIdx(this._diffElementViewModels, vm => vm.type !== 'unchanged');\n\t\t\tif (index >= 0) {\n\t\t\t\tthis._list.setFocus([index]);\n\t\t\t\tthis._list.reveal(index);\n\t\t\t}\n\t\t}\n\t}\n\n\tnextChange(): void {\n\t\tlet currFocus = this._list.getFocus()[0];\n\n\t\tif (isNaN(currFocus) || currFocus < 0) {\n\t\t\tcurrFocus = 0;\n\t\t}\n\n\t\t// find the index of next change\n\t\tlet nextChangeIndex = currFocus + 1;\n\t\twhile (nextChangeIndex < this._diffElementViewModels.length) {\n\t\t\tconst vm = this._diffElementViewModels[nextChangeIndex];\n\t\t\tif (vm.type !== 'unchanged') {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnextChangeIndex++;\n\t\t}\n\n\t\tif (nextChangeIndex < this._diffElementViewModels.length) {\n\t\t\tthis._list.setFocus([nextChangeIndex]);\n\t\t\tthis._list.reveal(nextChangeIndex);\n\t\t} else {\n\t\t\t// go to the first one\n\t\t\tconst index = this._diffElementViewModels.findIndex(vm => vm.type !== 'unchanged');\n\t\t\tif (index >= 0) {\n\t\t\t\tthis._list.setFocus([index]);\n\t\t\t\tthis._list.reveal(index);\n\t\t\t}\n\t\t}\n\t}\n\n\tcreateOutput(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, output: IInsetRenderOutput, getOffset: () => number, diffSide: DiffSide): void {\n\t\tthis._insetModifyQueueByOutputId.queue(output.source.model.outputId + (diffSide === DiffSide.Modified ? '-right' : 'left'), async () => {\n\t\t\tconst activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\t\tif (!activeWebview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeWebview.insetMapping.has(output.source)) {\n\t\t\t\tconst cellTop = this._list.getCellViewScrollTop(cellDiffViewModel);\n\t\t\t\tawait activeWebview.createOutput({ diffElement: cellDiffViewModel, cellHandle: cellViewModel.handle, cellId: cellViewModel.id, cellUri: cellViewModel.uri }, output, cellTop, getOffset());\n\t\t\t} else {\n\t\t\t\tconst cellTop = this._list.getCellViewScrollTop(cellDiffViewModel);\n\t\t\t\tconst outputIndex = cellViewModel.outputsViewModels.indexOf(output.source);\n\t\t\t\tconst outputOffset = cellDiffViewModel.getOutputOffsetInCell(diffSide, outputIndex);\n\t\t\t\tactiveWebview.updateScrollTops([{\n\t\t\t\t\tcell: cellViewModel,\n\t\t\t\t\toutput: output.source,\n\t\t\t\t\tcellTop,\n\t\t\t\t\toutputOffset,\n\t\t\t\t\tforceDisplay: true\n\t\t\t\t}], []);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateMarkupCellHeight() {\n\t\t// TODO\n\t}\n\n\tgetCellByInfo(cellInfo: IDiffCellInfo): IGenericCellViewModel {\n\t\treturn cellInfo.diffElement.getCellByUri(cellInfo.cellUri);\n\t}\n\n\tgetCellById(cellId: string): IGenericCellViewModel | undefined {\n\t\tthrow new Error('Not implemented');\n\t}\n\n\tremoveInset(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, displayOutput: ICellOutputViewModel, diffSide: DiffSide) {\n\t\tthis._insetModifyQueueByOutputId.queue(displayOutput.model.outputId + (diffSide === DiffSide.Modified ? '-right' : 'left'), async () => {\n\t\t\tconst activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\t\tif (!activeWebview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeWebview.insetMapping.has(displayOutput)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tactiveWebview.removeInsets([displayOutput]);\n\t\t});\n\t}\n\n\tshowInset(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, displayOutput: ICellOutputViewModel, diffSide: DiffSide) {\n\t\tthis._insetModifyQueueByOutputId.queue(displayOutput.model.outputId + (diffSide === DiffSide.Modified ? '-right' : 'left'), async () => {\n\t\t\tconst activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\t\tif (!activeWebview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeWebview.insetMapping.has(displayOutput)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst cellTop = this._list.getCellViewScrollTop(cellDiffViewModel);\n\t\t\tconst outputIndex = cellViewModel.outputsViewModels.indexOf(displayOutput);\n\t\t\tconst outputOffset = cellDiffViewModel.getOutputOffsetInCell(diffSide, outputIndex);\n\t\t\tactiveWebview.updateScrollTops([{\n\t\t\t\tcell: cellViewModel,\n\t\t\t\toutput: displayOutput,\n\t\t\t\tcellTop,\n\t\t\t\toutputOffset,\n\t\t\t\tforceDisplay: true,\n\t\t\t}], []);\n\t\t});\n\t}\n\n\thideInset(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, output: ICellOutputViewModel) {\n\t\tthis._modifiedWebview?.hideInset(output);\n\t\tthis._originalWebview?.hideInset(output);\n\t}\n\n\t// private async _resolveWebview(rightEditor: boolean): Promise<BackLayerWebView | null> {\n\t// \tif (rightEditor) {\n\n\t// \t}\n\t// }\n\n\tgetDomNode() {\n\t\treturn this._rootElement;\n\t}\n\n\tgetOverflowContainerDomNode(): HTMLElement {\n\t\treturn this._overflowContainer;\n\t}\n\n\toverride getControl(): INotebookTextDiffEditor | undefined {\n\t\treturn this;\n\t}\n\n\tprotected override setEditorVisible(visible: boolean, group: IEditorGroup | undefined): void {\n\t\tsuper.setEditorVisible(visible, group);\n\t}\n\n\toverride focus() {\n\t\tsuper.focus();\n\t}\n\n\toverride clearInput(): void {\n\t\tsuper.clearInput();\n\n\t\tthis._modifiedResourceDisposableStore.clear();\n\t\tthis._list?.splice(0, this._list?.length || 0);\n\t\tthis._model = null;\n\t\tthis._diffElementViewModels.forEach(vm => vm.dispose());\n\t\tthis._diffElementViewModels = [];\n\t}\n\n\tdeltaCellOutputContainerClassNames(diffSide: DiffSide, cellId: string, added: string[], removed: string[]) {\n\t\tif (diffSide === DiffSide.Original) {\n\t\t\tthis._originalWebview?.deltaCellContainerClassNames(cellId, added, removed);\n\t\t} else {\n\t\t\tthis._modifiedWebview?.deltaCellContainerClassNames(cellId, added, removed);\n\t\t}\n\t}\n\n\tgetLayoutInfo(): NotebookLayoutInfo {\n\t\tif (!this._list) {\n\t\t\tthrow new Error('Editor is not initalized successfully');\n\t\t}\n\n\t\treturn {\n\t\t\twidth: this._dimension!.width,\n\t\t\theight: this._dimension!.height,\n\t\t\tfontInfo: this._fontInfo!,\n\t\t\tscrollHeight: this._list?.getScrollHeight() ?? 0,\n\t\t\tstickyHeight: 0,\n\t\t};\n\t}\n\n\tgetCellOutputLayoutInfo(nestedCell: DiffNestedCellViewModel) {\n\t\tif (!this._model) {\n\t\t\tthrow new Error('Editor is not attached to model yet');\n\t\t}\n\t\tconst documentModel = CellUri.parse(nestedCell.uri);\n\t\tif (!documentModel) {\n\t\t\tthrow new Error('Nested cell in the diff editor has wrong Uri');\n\t\t}\n\n\t\tconst belongToOriginalDocument = this._model.original.notebook.uri.toString() === documentModel.notebook.toString();\n\t\tconst viewModel = this._diffElementViewModels.find(element => {\n\t\t\tconst textModel = belongToOriginalDocument ? element.original : element.modified;\n\t\t\tif (!textModel) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (textModel.uri.toString() === nestedCell.uri.toString()) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t});\n\n\t\tif (!viewModel) {\n\t\t\tthrow new Error('Nested cell in the diff editor does not match any diff element');\n\t\t}\n\n\t\tif (viewModel.type === 'unchanged') {\n\t\t\treturn this.getLayoutInfo();\n\t\t}\n\n\t\tif (viewModel.type === 'insert' || viewModel.type === 'delete') {\n\t\t\treturn {\n\t\t\t\twidth: this._dimension!.width / 2,\n\t\t\t\theight: this._dimension!.height / 2,\n\t\t\t\tfontInfo: this._fontInfo!\n\t\t\t};\n\t\t}\n\n\t\tif (viewModel.checkIfOutputsModified()) {\n\t\t\treturn {\n\t\t\t\twidth: this._dimension!.width / 2,\n\t\t\t\theight: this._dimension!.height / 2,\n\t\t\t\tfontInfo: this._fontInfo!\n\t\t\t};\n\t\t} else {\n\t\t\treturn this.getLayoutInfo();\n\t\t}\n\t}\n\n\tlayout(dimension: DOM.Dimension, _position: DOM.IDomPosition): void {\n\t\tthis._rootElement.classList.toggle('mid-width', dimension.width < 1000 && dimension.width >= 600);\n\t\tthis._rootElement.classList.toggle('narrow-width', dimension.width < 600);\n\t\tconst overviewRulerEnabled = this.isOverviewRulerEnabled();\n\t\tthis._dimension = dimension.with(dimension.width - (overviewRulerEnabled ? NotebookTextDiffEditor.ENTIRE_DIFF_OVERVIEW_WIDTH : 0));\n\n\t\tthis._listViewContainer.style.height = `${dimension.height}px`;\n\t\tthis._listViewContainer.style.width = `${this._dimension.width}px`;\n\n\t\tthis._list?.layout(this._dimension.height, this._dimension.width);\n\n\t\tif (this._modifiedWebview) {\n\t\t\tthis._modifiedWebview.element.style.width = `calc(50% - 16px)`;\n\t\t\tthis._modifiedWebview.element.style.left = `calc(50%)`;\n\t\t}\n\n\t\tif (this._originalWebview) {\n\t\t\tthis._originalWebview.element.style.width = `calc(50% - 16px)`;\n\t\t\tthis._originalWebview.element.style.left = `16px`;\n\t\t}\n\n\t\tif (this._webviewTransparentCover) {\n\t\t\tthis._webviewTransparentCover.style.height = `${this._dimension.height}px`;\n\t\t\tthis._webviewTransparentCover.style.width = `${this._dimension.width}px`;\n\t\t}\n\n\t\tif (overviewRulerEnabled) {\n\t\t\tthis._overviewRuler.layout();\n\t\t}\n\n\t\tthis._eventDispatcher?.emit([new NotebookDiffLayoutChangedEvent({ width: true, fontInfo: true }, this.getLayoutInfo())]);\n\t}\n\n\toverride dispose() {\n\t\tthis._isDisposed = true;\n\t\tthis._layoutCancellationTokenSource?.dispose();\n\t\tthis._detachModel();\n\t\tsuper.dispose();\n\t}\n}\n\nregisterZIndex(ZIndex.Base, 10, 'notebook-diff-view-viewport-slider');\n\nregisterThemingParticipant((theme, collector) => {\n\tconst diffDiagonalFillColor = theme.getColor(diffDiagonalFill);\n\tcollector.addRule(`\n\t.notebook-text-diff-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${diffDiagonalFillColor} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${diffDiagonalFillColor} 50%, ${diffDiagonalFillColor} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`);\n\n\tcollector.addRule(`.notebook-text-diff-editor .cell-body { margin: ${DIFF_CELL_MARGIN}px; }`);\n});\n"]}