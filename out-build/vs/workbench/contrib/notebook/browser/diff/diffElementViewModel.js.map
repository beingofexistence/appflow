{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/browser/diff/diffElementViewModel.ts"],"names":[],"mappings":"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","file":"diffElementViewModel.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from 'vs/base/common/event';\nimport { hash } from 'vs/base/common/hash';\nimport { toFormattedString } from 'vs/base/common/jsonFormatter';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { DiffEditorWidget } from 'vs/editor/browser/widget/diffEditor/diffEditorWidget';\nimport { FontInfo } from 'vs/editor/common/config/fontInfo';\nimport * as editorCommon from 'vs/editor/common/editorCommon';\nimport { fixedEditorPadding } from 'vs/workbench/contrib/notebook/browser/diff/diffCellEditorOptions';\nimport { DiffNestedCellViewModel } from 'vs/workbench/contrib/notebook/browser/diff/diffNestedCellViewModel';\nimport { NotebookDiffEditorEventDispatcher, NotebookDiffViewEventType } from 'vs/workbench/contrib/notebook/browser/diff/eventDispatcher';\nimport { CellDiffViewModelLayoutChangeEvent, DIFF_CELL_MARGIN, DiffSide, IDiffElementLayoutInfo } from 'vs/workbench/contrib/notebook/browser/diff/notebookDiffEditorBrowser';\nimport { CellLayoutState, IGenericCellViewModel } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { NotebookLayoutInfo } from 'vs/workbench/contrib/notebook/browser/notebookViewEvents';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\nimport { ICellOutput, INotebookTextModel, IOutputDto, IOutputItemDto, NotebookCellMetadata } from 'vs/workbench/contrib/notebook/common/notebookCommon';\n\nexport enum PropertyFoldingState {\n\tExpanded,\n\tCollapsed\n}\n\nexport const OUTPUT_EDITOR_HEIGHT_MAGIC = 1440;\n\ntype ILayoutInfoDelta0 = { [K in keyof IDiffElementLayoutInfo]?: number; };\ninterface ILayoutInfoDelta extends ILayoutInfoDelta0 {\n\trawOutputHeight?: number;\n\trecomputeOutput?: boolean;\n}\n\nexport abstract class DiffElementViewModelBase extends Disposable {\n\tpublic metadataFoldingState: PropertyFoldingState;\n\tpublic outputFoldingState: PropertyFoldingState;\n\tprotected _layoutInfoEmitter = this._register(new Emitter<CellDiffViewModelLayoutChangeEvent>());\n\tonDidLayoutChange = this._layoutInfoEmitter.event;\n\tprotected _stateChangeEmitter = this._register(new Emitter<{ renderOutput: boolean }>());\n\tonDidStateChange = this._stateChangeEmitter.event;\n\tprotected _layoutInfo!: IDiffElementLayoutInfo;\n\n\tset rawOutputHeight(height: number) {\n\t\tthis._layout({ rawOutputHeight: Math.min(OUTPUT_EDITOR_HEIGHT_MAGIC, height) });\n\t}\n\n\tget rawOutputHeight() {\n\t\tthrow new Error('Use Cell.layoutInfo.rawOutputHeight');\n\t}\n\n\tset outputStatusHeight(height: number) {\n\t\tthis._layout({ outputStatusHeight: height });\n\t}\n\n\tget outputStatusHeight() {\n\t\tthrow new Error('Use Cell.layoutInfo.outputStatusHeight');\n\t}\n\n\tset outputMetadataHeight(height: number) {\n\t\tthis._layout({ outputMetadataHeight: height });\n\t}\n\n\tget outputMetadataHeight() {\n\t\tthrow new Error('Use Cell.layoutInfo.outputStatusHeight');\n\t}\n\n\tset editorHeight(height: number) {\n\t\tthis._layout({ editorHeight: height });\n\t}\n\n\tget editorHeight() {\n\t\tthrow new Error('Use Cell.layoutInfo.editorHeight');\n\t}\n\n\tset editorMargin(margin: number) {\n\t\tthis._layout({ editorMargin: margin });\n\t}\n\n\tget editorMargin() {\n\t\tthrow new Error('Use Cell.layoutInfo.editorMargin');\n\t}\n\n\tset metadataStatusHeight(height: number) {\n\t\tthis._layout({ metadataStatusHeight: height });\n\t}\n\n\tget metadataStatusHeight() {\n\t\tthrow new Error('Use Cell.layoutInfo.outputStatusHeight');\n\t}\n\n\tset metadataHeight(height: number) {\n\t\tthis._layout({ metadataHeight: height });\n\t}\n\n\tget metadataHeight() {\n\t\tthrow new Error('Use Cell.layoutInfo.metadataHeight');\n\t}\n\n\tprivate _renderOutput = true;\n\n\tset renderOutput(value: boolean) {\n\t\tthis._renderOutput = value;\n\t\tthis._layout({ recomputeOutput: true });\n\t\tthis._stateChangeEmitter.fire({ renderOutput: this._renderOutput });\n\t}\n\n\tget renderOutput() {\n\t\treturn this._renderOutput;\n\t}\n\n\tget layoutInfo(): IDiffElementLayoutInfo {\n\t\treturn this._layoutInfo;\n\t}\n\n\tprivate _sourceEditorViewState: editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null = null;\n\tprivate _outputEditorViewState: editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null = null;\n\tprivate _metadataEditorViewState: editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null = null;\n\n\tconstructor(\n\t\treadonly mainDocumentTextModel: INotebookTextModel,\n\t\treadonly original: DiffNestedCellViewModel | undefined,\n\t\treadonly modified: DiffNestedCellViewModel | undefined,\n\t\treadonly type: 'unchanged' | 'insert' | 'delete' | 'modified',\n\t\treadonly editorEventDispatcher: NotebookDiffEditorEventDispatcher,\n\t\treadonly initData: {\n\t\t\tmetadataStatusHeight: number;\n\t\t\toutputStatusHeight: number;\n\t\t\tfontInfo: FontInfo | undefined;\n\t\t}\n\t) {\n\t\tsuper();\n\t\tconst editorHeight = this._estimateEditorHeight(initData.fontInfo);\n\t\tthis._layoutInfo = {\n\t\t\twidth: 0,\n\t\t\teditorHeight: editorHeight,\n\t\t\teditorMargin: 0,\n\t\t\tmetadataHeight: 0,\n\t\t\tmetadataStatusHeight: 25,\n\t\t\trawOutputHeight: 0,\n\t\t\toutputTotalHeight: 0,\n\t\t\toutputStatusHeight: 25,\n\t\t\toutputMetadataHeight: 0,\n\t\t\tbodyMargin: 32,\n\t\t\ttotalHeight: 82 + editorHeight,\n\t\t\tlayoutState: CellLayoutState.Uninitialized\n\t\t};\n\n\t\tthis.metadataFoldingState = PropertyFoldingState.Collapsed;\n\t\tthis.outputFoldingState = PropertyFoldingState.Collapsed;\n\n\t\tthis._register(this.editorEventDispatcher.onDidChangeLayout(e => {\n\t\t\tthis._layoutInfoEmitter.fire({ outerWidth: true });\n\t\t}));\n\t}\n\n\tlayoutChange() {\n\t\tthis._layout({ recomputeOutput: true });\n\t}\n\n\tprivate _estimateEditorHeight(fontInfo: FontInfo | undefined) {\n\t\tconst lineHeight = fontInfo?.lineHeight ?? 17;\n\n\t\tswitch (this.type) {\n\t\t\tcase 'unchanged':\n\t\t\tcase 'insert':\n\t\t\t\t{\n\t\t\t\t\tconst lineCount = this.modified!.textModel.textBuffer.getLineCount();\n\t\t\t\t\tconst editorHeight = lineCount * lineHeight + fixedEditorPadding.top + fixedEditorPadding.bottom;\n\t\t\t\t\treturn editorHeight;\n\t\t\t\t}\n\t\t\tcase 'delete':\n\t\t\tcase 'modified':\n\t\t\t\t{\n\t\t\t\t\tconst lineCount = this.original!.textModel.textBuffer.getLineCount();\n\t\t\t\t\tconst editorHeight = lineCount * lineHeight + fixedEditorPadding.top + fixedEditorPadding.bottom;\n\t\t\t\t\treturn editorHeight;\n\t\t\t\t}\n\t\t}\n\t}\n\n\tprotected _layout(delta: ILayoutInfoDelta) {\n\t\tconst width = delta.width !== undefined ? delta.width : this._layoutInfo.width;\n\t\tconst editorHeight = delta.editorHeight !== undefined ? delta.editorHeight : this._layoutInfo.editorHeight;\n\t\tconst editorMargin = delta.editorMargin !== undefined ? delta.editorMargin : this._layoutInfo.editorMargin;\n\t\tconst metadataHeight = delta.metadataHeight !== undefined ? delta.metadataHeight : this._layoutInfo.metadataHeight;\n\t\tconst metadataStatusHeight = delta.metadataStatusHeight !== undefined ? delta.metadataStatusHeight : this._layoutInfo.metadataStatusHeight;\n\t\tconst rawOutputHeight = delta.rawOutputHeight !== undefined ? delta.rawOutputHeight : this._layoutInfo.rawOutputHeight;\n\t\tconst outputStatusHeight = delta.outputStatusHeight !== undefined ? delta.outputStatusHeight : this._layoutInfo.outputStatusHeight;\n\t\tconst bodyMargin = delta.bodyMargin !== undefined ? delta.bodyMargin : this._layoutInfo.bodyMargin;\n\t\tconst outputMetadataHeight = delta.outputMetadataHeight !== undefined ? delta.outputMetadataHeight : this._layoutInfo.outputMetadataHeight;\n\t\tconst outputHeight = (delta.recomputeOutput || delta.rawOutputHeight !== undefined || delta.outputMetadataHeight !== undefined) ? this._getOutputTotalHeight(rawOutputHeight, outputMetadataHeight) : this._layoutInfo.outputTotalHeight;\n\n\t\tconst totalHeight = editorHeight\n\t\t\t+ editorMargin\n\t\t\t+ metadataHeight\n\t\t\t+ metadataStatusHeight\n\t\t\t+ outputHeight\n\t\t\t+ outputStatusHeight\n\t\t\t+ bodyMargin;\n\n\t\tconst newLayout: IDiffElementLayoutInfo = {\n\t\t\twidth: width,\n\t\t\teditorHeight: editorHeight,\n\t\t\teditorMargin: editorMargin,\n\t\t\tmetadataHeight: metadataHeight,\n\t\t\tmetadataStatusHeight: metadataStatusHeight,\n\t\t\toutputTotalHeight: outputHeight,\n\t\t\toutputStatusHeight: outputStatusHeight,\n\t\t\tbodyMargin: bodyMargin,\n\t\t\trawOutputHeight: rawOutputHeight,\n\t\t\toutputMetadataHeight: outputMetadataHeight,\n\t\t\ttotalHeight: totalHeight,\n\t\t\tlayoutState: CellLayoutState.Measured\n\t\t};\n\n\t\tlet somethingChanged = false;\n\n\t\tconst changeEvent: CellDiffViewModelLayoutChangeEvent = {};\n\n\t\tif (newLayout.width !== this._layoutInfo.width) {\n\t\t\tchangeEvent.width = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.editorHeight !== this._layoutInfo.editorHeight) {\n\t\t\tchangeEvent.editorHeight = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.editorMargin !== this._layoutInfo.editorMargin) {\n\t\t\tchangeEvent.editorMargin = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.metadataHeight !== this._layoutInfo.metadataHeight) {\n\t\t\tchangeEvent.metadataHeight = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.metadataStatusHeight !== this._layoutInfo.metadataStatusHeight) {\n\t\t\tchangeEvent.metadataStatusHeight = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.outputTotalHeight !== this._layoutInfo.outputTotalHeight) {\n\t\t\tchangeEvent.outputTotalHeight = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.outputStatusHeight !== this._layoutInfo.outputStatusHeight) {\n\t\t\tchangeEvent.outputStatusHeight = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.bodyMargin !== this._layoutInfo.bodyMargin) {\n\t\t\tchangeEvent.bodyMargin = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.outputMetadataHeight !== this._layoutInfo.outputMetadataHeight) {\n\t\t\tchangeEvent.outputMetadataHeight = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (newLayout.totalHeight !== this._layoutInfo.totalHeight) {\n\t\t\tchangeEvent.totalHeight = true;\n\t\t\tsomethingChanged = true;\n\t\t}\n\n\t\tif (somethingChanged) {\n\t\t\tthis._layoutInfo = newLayout;\n\t\t\tthis._fireLayoutChangeEvent(changeEvent);\n\t\t}\n\t}\n\n\tgetHeight(lineHeight: number) {\n\t\tif (this._layoutInfo.layoutState === CellLayoutState.Uninitialized) {\n\t\t\tconst editorHeight = this.estimateEditorHeight(lineHeight);\n\t\t\treturn this._computeTotalHeight(editorHeight);\n\t\t} else {\n\t\t\treturn this._layoutInfo.totalHeight;\n\t\t}\n\t}\n\n\tprivate _computeTotalHeight(editorHeight: number) {\n\t\tconst totalHeight = editorHeight\n\t\t\t+ this._layoutInfo.editorMargin\n\t\t\t+ this._layoutInfo.metadataHeight\n\t\t\t+ this._layoutInfo.metadataStatusHeight\n\t\t\t+ this._layoutInfo.outputTotalHeight\n\t\t\t+ this._layoutInfo.outputStatusHeight\n\t\t\t+ this._layoutInfo.outputMetadataHeight\n\t\t\t+ this._layoutInfo.bodyMargin;\n\n\t\treturn totalHeight;\n\t}\n\n\tprivate estimateEditorHeight(lineHeight: number | undefined = 20): number {\n\t\tconst hasScrolling = false;\n\t\tconst verticalScrollbarHeight = hasScrolling ? 12 : 0; // take zoom level into account\n\t\t// const editorPadding = this.viewContext.notebookOptions.computeEditorPadding(this.internalMetadata);\n\t\tconst lineCount = Math.max(this.original?.textModel.textBuffer.getLineCount() ?? 1, this.modified?.textModel.textBuffer.getLineCount() ?? 1);\n\t\treturn lineCount * lineHeight\n\t\t\t+ 24 // Top padding\n\t\t\t+ 12 // Bottom padding\n\t\t\t+ verticalScrollbarHeight;\n\t}\n\n\tprivate _getOutputTotalHeight(rawOutputHeight: number, metadataHeight: number) {\n\t\tif (this.outputFoldingState === PropertyFoldingState.Collapsed) {\n\t\t\treturn 0;\n\t\t}\n\n\t\tif (this.renderOutput) {\n\t\t\tif (this.isOutputEmpty()) {\n\t\t\t\t// single line;\n\t\t\t\treturn 24;\n\t\t\t}\n\t\t\treturn this.getRichOutputTotalHeight() + metadataHeight;\n\t\t} else {\n\t\t\treturn rawOutputHeight;\n\t\t}\n\t}\n\n\tprivate _fireLayoutChangeEvent(state: CellDiffViewModelLayoutChangeEvent) {\n\t\tthis._layoutInfoEmitter.fire(state);\n\t\tthis.editorEventDispatcher.emit([{ type: NotebookDiffViewEventType.CellLayoutChanged, source: this._layoutInfo }]);\n\t}\n\n\tabstract checkIfOutputsModified(): false | { reason: string | undefined };\n\tabstract checkMetadataIfModified(): false | { reason: string | undefined };\n\tabstract isOutputEmpty(): boolean;\n\tabstract getRichOutputTotalHeight(): number;\n\tabstract getCellByUri(cellUri: URI): IGenericCellViewModel;\n\tabstract getOutputOffsetInCell(diffSide: DiffSide, index: number): number;\n\tabstract getOutputOffsetInContainer(diffSide: DiffSide, index: number): number;\n\tabstract updateOutputHeight(diffSide: DiffSide, index: number, height: number): void;\n\tabstract getNestedCellViewModel(diffSide: DiffSide): DiffNestedCellViewModel;\n\n\tgetComputedCellContainerWidth(layoutInfo: NotebookLayoutInfo, diffEditor: boolean, fullWidth: boolean) {\n\t\tif (fullWidth) {\n\t\t\treturn layoutInfo.width - 2 * DIFF_CELL_MARGIN + (diffEditor ? DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH : 0) - 2;\n\t\t}\n\n\t\treturn (layoutInfo.width - 2 * DIFF_CELL_MARGIN + (diffEditor ? DiffEditorWidget.ENTIRE_DIFF_OVERVIEW_WIDTH : 0)) / 2 - 18 - 2;\n\t}\n\n\tgetOutputEditorViewState(): editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null {\n\t\treturn this._outputEditorViewState;\n\t}\n\n\tsaveOutputEditorViewState(viewState: editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null) {\n\t\tthis._outputEditorViewState = viewState;\n\t}\n\n\tgetMetadataEditorViewState(): editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null {\n\t\treturn this._metadataEditorViewState;\n\t}\n\n\tsaveMetadataEditorViewState(viewState: editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null) {\n\t\tthis._metadataEditorViewState = viewState;\n\t}\n\n\tgetSourceEditorViewState(): editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null {\n\t\treturn this._sourceEditorViewState;\n\t}\n\n\tsaveSpirceEditorViewState(viewState: editorCommon.ICodeEditorViewState | editorCommon.IDiffEditorViewState | null) {\n\t\tthis._sourceEditorViewState = viewState;\n\t}\n}\n\nexport class SideBySideDiffElementViewModel extends DiffElementViewModelBase {\n\tget originalDocument() {\n\t\treturn this.otherDocumentTextModel;\n\t}\n\n\tget modifiedDocument() {\n\t\treturn this.mainDocumentTextModel;\n\t}\n\n\toverride readonly original: DiffNestedCellViewModel;\n\toverride readonly modified: DiffNestedCellViewModel;\n\toverride readonly type: 'unchanged' | 'modified';\n\n\tconstructor(\n\t\tmainDocumentTextModel: NotebookTextModel,\n\t\treadonly otherDocumentTextModel: NotebookTextModel,\n\t\toriginal: DiffNestedCellViewModel,\n\t\tmodified: DiffNestedCellViewModel,\n\t\ttype: 'unchanged' | 'modified',\n\t\teditorEventDispatcher: NotebookDiffEditorEventDispatcher,\n\t\tinitData: {\n\t\t\tmetadataStatusHeight: number;\n\t\t\toutputStatusHeight: number;\n\t\t\tfontInfo: FontInfo | undefined;\n\t\t}\n\t) {\n\t\tsuper(\n\t\t\tmainDocumentTextModel,\n\t\t\toriginal,\n\t\t\tmodified,\n\t\t\ttype,\n\t\t\teditorEventDispatcher,\n\t\t\tinitData);\n\n\t\tthis.original = original;\n\t\tthis.modified = modified;\n\t\tthis.type = type;\n\n\t\tthis.metadataFoldingState = PropertyFoldingState.Collapsed;\n\t\tthis.outputFoldingState = PropertyFoldingState.Collapsed;\n\n\t\tif (this.checkMetadataIfModified()) {\n\t\t\tthis.metadataFoldingState = PropertyFoldingState.Expanded;\n\t\t}\n\n\t\tif (this.checkIfOutputsModified()) {\n\t\t\tthis.outputFoldingState = PropertyFoldingState.Expanded;\n\t\t}\n\n\t\tthis._register(this.original.onDidChangeOutputLayout(() => {\n\t\t\tthis._layout({ recomputeOutput: true });\n\t\t}));\n\n\t\tthis._register(this.modified.onDidChangeOutputLayout(() => {\n\t\t\tthis._layout({ recomputeOutput: true });\n\t\t}));\n\n\t\tthis._register(this.modified.textModel.onDidChangeContent(() => {\n\t\t\tif (mainDocumentTextModel.transientOptions.cellContentMetadata) {\n\t\t\t\tconst cellMetadataKeys = [...Object.keys(mainDocumentTextModel.transientOptions.cellContentMetadata)];\n\t\t\t\tconst modifiedMedataRaw = Object.assign({}, this.modified.metadata);\n\t\t\t\tconst originalCellMetadata = this.original.metadata;\n\t\t\t\tfor (const key of cellMetadataKeys) {\n\t\t\t\t\tmodifiedMedataRaw[key] = originalCellMetadata[key];\n\t\t\t\t}\n\n\t\t\t\tthis.modified.textModel.metadata = modifiedMedataRaw;\n\t\t\t}\n\t\t}));\n\t}\n\n\tcheckIfOutputsModified() {\n\t\tif (this.mainDocumentTextModel.transientOptions.transientOutputs) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst ret = outputsEqual(this.original?.outputs ?? [], this.modified?.outputs ?? []);\n\n\t\tif (ret === OutputComparison.Unchanged) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn {\n\t\t\treason: ret === OutputComparison.Metadata ? 'Output metadata is changed' : undefined,\n\t\t\tkind: ret\n\t\t};\n\t}\n\n\tcheckMetadataIfModified() {\n\t\tconst modified = hash(getFormattedMetadataJSON(this.mainDocumentTextModel, this.original?.metadata || {}, this.original?.language)) !== hash(getFormattedMetadataJSON(this.mainDocumentTextModel, this.modified?.metadata ?? {}, this.modified?.language));\n\t\tif (modified) {\n\t\t\treturn { reason: undefined };\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tupdateOutputHeight(diffSide: DiffSide, index: number, height: number) {\n\t\tif (diffSide === DiffSide.Original) {\n\t\t\tthis.original.updateOutputHeight(index, height);\n\t\t} else {\n\t\t\tthis.modified.updateOutputHeight(index, height);\n\t\t}\n\t}\n\n\tgetOutputOffsetInContainer(diffSide: DiffSide, index: number) {\n\t\tif (diffSide === DiffSide.Original) {\n\t\t\treturn this.original.getOutputOffset(index);\n\t\t} else {\n\t\t\treturn this.modified.getOutputOffset(index);\n\t\t}\n\t}\n\n\tgetOutputOffsetInCell(diffSide: DiffSide, index: number) {\n\t\tconst offsetInOutputsContainer = this.getOutputOffsetInContainer(diffSide, index);\n\n\t\treturn this._layoutInfo.editorHeight\n\t\t\t+ this._layoutInfo.editorMargin\n\t\t\t+ this._layoutInfo.metadataHeight\n\t\t\t+ this._layoutInfo.metadataStatusHeight\n\t\t\t+ this._layoutInfo.outputStatusHeight\n\t\t\t+ this._layoutInfo.bodyMargin / 2\n\t\t\t+ offsetInOutputsContainer;\n\t}\n\n\tisOutputEmpty() {\n\t\tif (this.mainDocumentTextModel.transientOptions.transientOutputs) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.checkIfOutputsModified()) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// outputs are not changed\n\n\t\treturn (this.original?.outputs || []).length === 0;\n\t}\n\n\tgetRichOutputTotalHeight() {\n\t\treturn Math.max(this.original.getOutputTotalHeight(), this.modified.getOutputTotalHeight());\n\t}\n\n\tgetNestedCellViewModel(diffSide: DiffSide): DiffNestedCellViewModel {\n\t\treturn diffSide === DiffSide.Original ? this.original : this.modified;\n\t}\n\n\tgetCellByUri(cellUri: URI): IGenericCellViewModel {\n\t\tif (cellUri.toString() === this.original.uri.toString()) {\n\t\t\treturn this.original;\n\t\t} else {\n\t\t\treturn this.modified;\n\t\t}\n\t}\n}\n\nexport class SingleSideDiffElementViewModel extends DiffElementViewModelBase {\n\tget cellViewModel() {\n\t\treturn this.type === 'insert' ? this.modified! : this.original!;\n\t}\n\n\tget originalDocument() {\n\t\tif (this.type === 'insert') {\n\t\t\treturn this.otherDocumentTextModel;\n\t\t} else {\n\t\t\treturn this.mainDocumentTextModel;\n\t\t}\n\t}\n\n\tget modifiedDocument() {\n\t\tif (this.type === 'insert') {\n\t\t\treturn this.mainDocumentTextModel;\n\t\t} else {\n\t\t\treturn this.otherDocumentTextModel;\n\t\t}\n\t}\n\n\toverride readonly type: 'insert' | 'delete';\n\n\tconstructor(\n\t\tmainDocumentTextModel: NotebookTextModel,\n\t\treadonly otherDocumentTextModel: NotebookTextModel,\n\t\toriginal: DiffNestedCellViewModel | undefined,\n\t\tmodified: DiffNestedCellViewModel | undefined,\n\t\ttype: 'insert' | 'delete',\n\t\teditorEventDispatcher: NotebookDiffEditorEventDispatcher,\n\t\tinitData: {\n\t\t\tmetadataStatusHeight: number;\n\t\t\toutputStatusHeight: number;\n\t\t\tfontInfo: FontInfo | undefined;\n\t\t}\n\t) {\n\t\tsuper(mainDocumentTextModel, original, modified, type, editorEventDispatcher, initData);\n\t\tthis.type = type;\n\n\t\tthis._register(this.cellViewModel!.onDidChangeOutputLayout(() => {\n\t\t\tthis._layout({ recomputeOutput: true });\n\t\t}));\n\t}\n\n\tgetNestedCellViewModel(diffSide: DiffSide): DiffNestedCellViewModel {\n\t\treturn this.type === 'insert' ? this.modified! : this.original!;\n\t}\n\n\n\tcheckIfOutputsModified(): false | { reason: string | undefined } {\n\t\treturn false;\n\t}\n\n\tcheckMetadataIfModified(): false | { reason: string | undefined } {\n\t\treturn false;\n\t}\n\n\tupdateOutputHeight(diffSide: DiffSide, index: number, height: number) {\n\t\tthis.cellViewModel?.updateOutputHeight(index, height);\n\t}\n\n\tgetOutputOffsetInContainer(diffSide: DiffSide, index: number) {\n\t\treturn this.cellViewModel!.getOutputOffset(index);\n\t}\n\n\tgetOutputOffsetInCell(diffSide: DiffSide, index: number) {\n\t\tconst offsetInOutputsContainer = this.cellViewModel!.getOutputOffset(index);\n\n\t\treturn this._layoutInfo.editorHeight\n\t\t\t+ this._layoutInfo.editorMargin\n\t\t\t+ this._layoutInfo.metadataHeight\n\t\t\t+ this._layoutInfo.metadataStatusHeight\n\t\t\t+ this._layoutInfo.outputStatusHeight\n\t\t\t+ this._layoutInfo.bodyMargin / 2\n\t\t\t+ offsetInOutputsContainer;\n\t}\n\n\tisOutputEmpty() {\n\t\tif (this.mainDocumentTextModel.transientOptions.transientOutputs) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// outputs are not changed\n\n\t\treturn (this.original?.outputs || this.modified?.outputs || []).length === 0;\n\t}\n\n\tgetRichOutputTotalHeight() {\n\t\treturn this.cellViewModel?.getOutputTotalHeight() ?? 0;\n\t}\n\n\tgetCellByUri(cellUri: URI): IGenericCellViewModel {\n\t\treturn this.cellViewModel!;\n\t}\n}\n\nexport const enum OutputComparison {\n\tUnchanged = 0,\n\tMetadata = 1,\n\tOther = 2\n}\n\nexport function outputEqual(a: ICellOutput, b: ICellOutput): OutputComparison {\n\tif (hash(a.metadata) === hash(b.metadata)) {\n\t\treturn OutputComparison.Other;\n\t}\n\n\t// metadata not equal\n\tfor (let j = 0; j < a.outputs.length; j++) {\n\t\tconst aOutputItem = a.outputs[j];\n\t\tconst bOutputItem = b.outputs[j];\n\n\t\tif (aOutputItem.mime !== bOutputItem.mime) {\n\t\t\treturn OutputComparison.Other;\n\t\t}\n\n\t\tif (aOutputItem.data.buffer.length !== bOutputItem.data.buffer.length) {\n\t\t\treturn OutputComparison.Other;\n\t\t}\n\n\t\tfor (let k = 0; k < aOutputItem.data.buffer.length; k++) {\n\t\t\tif (aOutputItem.data.buffer[k] !== bOutputItem.data.buffer[k]) {\n\t\t\t\treturn OutputComparison.Other;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn OutputComparison.Metadata;\n}\n\nfunction outputsEqual(original: ICellOutput[], modified: ICellOutput[]) {\n\tif (original.length !== modified.length) {\n\t\treturn OutputComparison.Other;\n\t}\n\n\tconst len = original.length;\n\tfor (let i = 0; i < len; i++) {\n\t\tconst a = original[i];\n\t\tconst b = modified[i];\n\n\t\tif (hash(a.metadata) !== hash(b.metadata)) {\n\t\t\treturn OutputComparison.Metadata;\n\t\t}\n\n\t\tif (a.outputs.length !== b.outputs.length) {\n\t\t\treturn OutputComparison.Other;\n\t\t}\n\n\t\tfor (let j = 0; j < a.outputs.length; j++) {\n\t\t\tconst aOutputItem = a.outputs[j];\n\t\t\tconst bOutputItem = b.outputs[j];\n\n\t\t\tif (aOutputItem.mime !== bOutputItem.mime) {\n\t\t\t\treturn OutputComparison.Other;\n\t\t\t}\n\n\t\t\tif (aOutputItem.data.buffer.length !== bOutputItem.data.buffer.length) {\n\t\t\t\treturn OutputComparison.Other;\n\t\t\t}\n\n\t\t\tfor (let k = 0; k < aOutputItem.data.buffer.length; k++) {\n\t\t\t\tif (aOutputItem.data.buffer[k] !== bOutputItem.data.buffer[k]) {\n\t\t\t\t\treturn OutputComparison.Other;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn OutputComparison.Unchanged;\n}\n\nexport function getFormattedMetadataJSON(documentTextModel: INotebookTextModel, metadata: NotebookCellMetadata, language?: string) {\n\tlet filteredMetadata: { [key: string]: any } = {};\n\n\tif (documentTextModel) {\n\t\tconst transientCellMetadata = documentTextModel.transientOptions.transientCellMetadata;\n\n\t\tconst keys = new Set([...Object.keys(metadata)]);\n\t\tfor (const key of keys) {\n\t\t\tif (!(transientCellMetadata[key as keyof NotebookCellMetadata])\n\t\t\t) {\n\t\t\t\tfilteredMetadata[key] = metadata[key as keyof NotebookCellMetadata];\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfilteredMetadata = metadata;\n\t}\n\n\tconst obj = {\n\t\tlanguage,\n\t\t...filteredMetadata\n\t};\n\n\tconst metadataSource = toFormattedString(obj, {});\n\n\treturn metadataSource;\n}\n\nexport function getStreamOutputData(outputs: IOutputItemDto[]) {\n\tif (!outputs.length) {\n\t\treturn null;\n\t}\n\n\tconst first = outputs[0];\n\tconst mime = first.mime;\n\tconst sameStream = !outputs.find(op => op.mime !== mime);\n\n\tif (sameStream) {\n\t\treturn outputs.map(opit => opit.data.toString()).join('');\n\t} else {\n\t\treturn null;\n\t}\n}\n\nexport function getFormattedOutputJSON(outputs: IOutputDto[]) {\n\tif (outputs.length === 1) {\n\t\tconst streamOutputData = getStreamOutputData(outputs[0].outputs);\n\t\tif (streamOutputData) {\n\t\t\treturn streamOutputData;\n\t\t}\n\t}\n\n\treturn JSON.stringify(outputs.map(output => {\n\t\treturn ({\n\t\t\tmetadata: output.metadata,\n\t\t\toutputItems: output.outputs.map(opit => ({\n\t\t\t\tmimeType: opit.mime,\n\t\t\t\tdata: opit.data.toString()\n\t\t\t}))\n\t\t});\n\t}), undefined, '\\t');\n}\n"]}