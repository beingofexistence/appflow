{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/browser/diff/notebookDiffOverviewRuler.ts"],"names":[],"mappings":"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","file":"notebookDiffOverviewRuler.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as browser from 'vs/base/browser/browser';\nimport * as DOM from 'vs/base/browser/dom';\nimport { createFastDomNode, FastDomNode } from 'vs/base/browser/fastDomNode';\nimport { Color } from 'vs/base/common/color';\nimport { DisposableStore, IDisposable } from 'vs/base/common/lifecycle';\nimport { defaultInsertColor, defaultRemoveColor, diffInserted, diffOverviewRulerInserted, diffOverviewRulerRemoved, diffRemoved } from 'vs/platform/theme/common/colorRegistry';\nimport { IColorTheme, IThemeService, Themable } from 'vs/platform/theme/common/themeService';\nimport { DiffElementViewModelBase } from 'vs/workbench/contrib/notebook/browser/diff/diffElementViewModel';\nimport { NotebookDiffEditorEventDispatcher } from 'vs/workbench/contrib/notebook/browser/diff/eventDispatcher';\nimport { INotebookTextDiffEditor } from 'vs/workbench/contrib/notebook/browser/diff/notebookDiffEditorBrowser';\n\nconst MINIMUM_SLIDER_SIZE = 20;\n\nexport class NotebookDiffOverviewRuler extends Themable {\n\tprivate readonly _domNode: FastDomNode<HTMLCanvasElement>;\n\tprivate readonly _overviewViewportDomElement: FastDomNode<HTMLElement>;\n\n\tprivate _diffElementViewModels: DiffElementViewModelBase[] = [];\n\tprivate _lanes = 2;\n\n\tprivate _insertColor: Color | null;\n\tprivate _insertColorHex: string | null;\n\tprivate _removeColor: Color | null;\n\tprivate _removeColorHex: string | null;\n\n\tprivate _disposables: DisposableStore;\n\tprivate _renderAnimationFrame: IDisposable | null;\n\n\tconstructor(readonly notebookEditor: INotebookTextDiffEditor, readonly width: number, container: HTMLElement, @IThemeService themeService: IThemeService) {\n\t\tsuper(themeService);\n\t\tthis._insertColor = null;\n\t\tthis._removeColor = null;\n\t\tthis._insertColorHex = null;\n\t\tthis._removeColorHex = null;\n\t\tthis._disposables = this._register(new DisposableStore());\n\t\tthis._renderAnimationFrame = null;\n\t\tthis._domNode = createFastDomNode(document.createElement('canvas'));\n\t\tthis._domNode.setPosition('relative');\n\t\tthis._domNode.setLayerHinting(true);\n\t\tthis._domNode.setContain('strict');\n\n\t\tcontainer.appendChild(this._domNode.domNode);\n\n\t\tthis._overviewViewportDomElement = createFastDomNode(document.createElement('div'));\n\t\tthis._overviewViewportDomElement.setClassName('diffViewport');\n\t\tthis._overviewViewportDomElement.setPosition('absolute');\n\t\tthis._overviewViewportDomElement.setWidth(width);\n\t\tcontainer.appendChild(this._overviewViewportDomElement.domNode);\n\n\t\tthis._register(browser.PixelRatio.onDidChange(() => {\n\t\t\tthis._scheduleRender();\n\t\t}));\n\n\t\tthis._register(this.themeService.onDidColorThemeChange(e => {\n\t\t\tconst colorChanged = this.applyColors(e);\n\t\t\tif (colorChanged) {\n\t\t\t\tthis._scheduleRender();\n\t\t\t}\n\t\t}));\n\t\tthis.applyColors(this.themeService.getColorTheme());\n\n\t\tthis._register(this.notebookEditor.onDidScroll(() => {\n\t\t\tthis._renderOverviewViewport();\n\t\t}));\n\n\t\tthis._register(DOM.addStandardDisposableListener(container, DOM.EventType.POINTER_DOWN, (e) => {\n\t\t\tthis.notebookEditor.delegateVerticalScrollbarPointerDown(e);\n\t\t}));\n\t}\n\n\tprivate applyColors(theme: IColorTheme): boolean {\n\t\tconst newInsertColor = theme.getColor(diffOverviewRulerInserted) || (theme.getColor(diffInserted) || defaultInsertColor).transparent(2);\n\t\tconst newRemoveColor = theme.getColor(diffOverviewRulerRemoved) || (theme.getColor(diffRemoved) || defaultRemoveColor).transparent(2);\n\t\tconst hasChanges = !newInsertColor.equals(this._insertColor) || !newRemoveColor.equals(this._removeColor);\n\t\tthis._insertColor = newInsertColor;\n\t\tthis._removeColor = newRemoveColor;\n\t\tif (this._insertColor) {\n\t\t\tthis._insertColorHex = Color.Format.CSS.formatHexA(this._insertColor);\n\t\t}\n\n\t\tif (this._removeColor) {\n\t\t\tthis._removeColorHex = Color.Format.CSS.formatHexA(this._removeColor);\n\t\t}\n\n\t\treturn hasChanges;\n\t}\n\n\tlayout() {\n\t\tthis._layoutNow();\n\t}\n\n\tupdateViewModels(elements: DiffElementViewModelBase[], eventDispatcher: NotebookDiffEditorEventDispatcher | undefined) {\n\t\tthis._disposables.clear();\n\n\t\tthis._diffElementViewModels = elements;\n\n\t\tif (eventDispatcher) {\n\t\t\tthis._disposables.add(eventDispatcher.onDidChangeLayout(() => {\n\t\t\t\tthis._scheduleRender();\n\t\t\t}));\n\n\t\t\tthis._disposables.add(eventDispatcher.onDidChangeCellLayout(() => {\n\t\t\t\tthis._scheduleRender();\n\t\t\t}));\n\t\t}\n\n\t\tthis._scheduleRender();\n\t}\n\n\tprivate _scheduleRender(): void {\n\t\tif (this._renderAnimationFrame === null) {\n\t\t\tthis._renderAnimationFrame = DOM.runAtThisOrScheduleAtNextAnimationFrame(this._onRenderScheduled.bind(this), 16);\n\t\t}\n\t}\n\n\tprivate _onRenderScheduled(): void {\n\t\tthis._renderAnimationFrame = null;\n\t\tthis._layoutNow();\n\t}\n\n\tprivate _layoutNow() {\n\t\tconst layoutInfo = this.notebookEditor.getLayoutInfo();\n\t\tconst height = layoutInfo.height;\n\t\tconst contentHeight = this._diffElementViewModels.map(view => view.layoutInfo.totalHeight).reduce((a, b) => a + b, 0);\n\t\tconst ratio = browser.PixelRatio.value;\n\t\tthis._domNode.setWidth(this.width);\n\t\tthis._domNode.setHeight(height);\n\t\tthis._domNode.domNode.width = this.width * ratio;\n\t\tthis._domNode.domNode.height = height * ratio;\n\t\tconst ctx = this._domNode.domNode.getContext('2d')!;\n\t\tctx.clearRect(0, 0, this.width * ratio, height * ratio);\n\t\tthis._renderCanvas(ctx, this.width * ratio, height * ratio, contentHeight * ratio, ratio);\n\t\tthis._renderOverviewViewport();\n\t}\n\n\tprivate _renderOverviewViewport(): void {\n\t\tconst layout = this._computeOverviewViewport();\n\t\tif (!layout) {\n\t\t\tthis._overviewViewportDomElement.setTop(0);\n\t\t\tthis._overviewViewportDomElement.setHeight(0);\n\t\t} else {\n\t\t\tthis._overviewViewportDomElement.setTop(layout.top);\n\t\t\tthis._overviewViewportDomElement.setHeight(layout.height);\n\t\t}\n\t}\n\n\tprivate _computeOverviewViewport(): { height: number; top: number } | null {\n\t\tconst layoutInfo = this.notebookEditor.getLayoutInfo();\n\t\tif (!layoutInfo) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst scrollTop = this.notebookEditor.getScrollTop();\n\t\tconst scrollHeight = this.notebookEditor.getScrollHeight();\n\n\t\tconst computedAvailableSize = Math.max(0, layoutInfo.height);\n\t\tconst computedRepresentableSize = Math.max(0, computedAvailableSize - 2 * 0);\n\t\tconst visibleSize = layoutInfo.height;\n\t\tconst computedSliderSize = Math.round(Math.max(MINIMUM_SLIDER_SIZE, Math.floor(visibleSize * computedRepresentableSize / scrollHeight)));\n\t\tconst computedSliderRatio = (computedRepresentableSize - computedSliderSize) / (scrollHeight - visibleSize);\n\t\tconst computedSliderPosition = Math.round(scrollTop * computedSliderRatio);\n\n\t\treturn {\n\t\t\theight: computedSliderSize,\n\t\t\ttop: computedSliderPosition\n\t\t};\n\t}\n\n\tprivate _renderCanvas(ctx: CanvasRenderingContext2D, width: number, height: number, scrollHeight: number, ratio: number) {\n\t\tif (!this._insertColorHex || !this._removeColorHex) {\n\t\t\t// no op when colors are not yet known\n\t\t\treturn;\n\t\t}\n\n\t\tconst laneWidth = width / this._lanes;\n\t\tlet currentFrom = 0;\n\t\tfor (let i = 0; i < this._diffElementViewModels.length; i++) {\n\t\t\tconst element = this._diffElementViewModels[i];\n\n\t\t\tconst cellHeight = Math.round((element.layoutInfo.totalHeight / scrollHeight) * ratio * height);\n\n\t\t\tswitch (element.type) {\n\t\t\t\tcase 'insert':\n\t\t\t\t\tctx.fillStyle = this._insertColorHex;\n\t\t\t\t\tctx.fillRect(laneWidth, currentFrom, laneWidth, cellHeight);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\tctx.fillStyle = this._removeColorHex;\n\t\t\t\t\tctx.fillRect(0, currentFrom, laneWidth, cellHeight);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'unchanged':\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'modified':\n\t\t\t\t\tctx.fillStyle = this._removeColorHex;\n\t\t\t\t\tctx.fillRect(0, currentFrom, laneWidth, cellHeight);\n\t\t\t\t\tctx.fillStyle = this._insertColorHex;\n\t\t\t\t\tctx.fillRect(laneWidth, currentFrom, laneWidth, cellHeight);\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcurrentFrom += cellHeight;\n\t\t}\n\t}\n\n\toverride dispose() {\n\t\tif (this._renderAnimationFrame !== null) {\n\t\t\tthis._renderAnimationFrame.dispose();\n\t\t\tthis._renderAnimationFrame = null;\n\t\t}\n\n\t\tsuper.dispose();\n\t}\n}\n"]}