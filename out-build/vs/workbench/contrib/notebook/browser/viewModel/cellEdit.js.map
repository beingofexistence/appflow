{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/browser/viewModel/cellEdit.ts"],"names":[],"mappings":"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","file":"cellEdit.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Range } from 'vs/editor/common/core/range';\nimport { Selection } from 'vs/editor/common/core/selection';\nimport { CellKind, IOutputDto, NotebookCellMetadata, SelectionStateType } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { IResourceUndoRedoElement, UndoRedoElementType } from 'vs/platform/undoRedo/common/undoRedo';\nimport { URI } from 'vs/base/common/uri';\nimport { BaseCellViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/baseCellViewModel';\nimport { CellFocusMode } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { NotebookCellTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookCellTextModel';\nimport { ITextCellEditingDelegate } from 'vs/workbench/contrib/notebook/common/model/cellEdit';\n\n\nexport interface IViewCellEditingDelegate extends ITextCellEditingDelegate {\n\tcreateCellViewModel?(cell: NotebookCellTextModel): BaseCellViewModel;\n\tcreateCell?(index: number, source: string, language: string, type: CellKind, metadata: NotebookCellMetadata | undefined, outputs: IOutputDto[]): BaseCellViewModel;\n}\n\nexport class JoinCellEdit implements IResourceUndoRedoElement {\n\ttype: UndoRedoElementType.Resource = UndoRedoElementType.Resource;\n\tlabel: string = 'Join Cell';\n\tcode: string = 'undoredo.notebooks.joinCell';\n\tprivate _deletedRawCell: NotebookCellTextModel;\n\tconstructor(\n\t\tpublic resource: URI,\n\t\tprivate index: number,\n\t\tprivate direction: 'above' | 'below',\n\t\tprivate cell: BaseCellViewModel,\n\t\tprivate selections: Selection[],\n\t\tprivate inverseRange: Range,\n\t\tprivate insertContent: string,\n\t\tprivate removedCell: BaseCellViewModel,\n\t\tprivate editingDelegate: IViewCellEditingDelegate,\n\t) {\n\t\tthis._deletedRawCell = this.removedCell.model;\n\t}\n\n\tasync undo(): Promise<void> {\n\t\tif (!this.editingDelegate.insertCell || !this.editingDelegate.createCellViewModel) {\n\t\t\tthrow new Error('Notebook Insert Cell not implemented for Undo/Redo');\n\t\t}\n\n\t\tawait this.cell.resolveTextModel();\n\n\t\tthis.cell.textModel?.applyEdits([\n\t\t\t{ range: this.inverseRange, text: '' }\n\t\t]);\n\n\t\tthis.cell.setSelections(this.selections);\n\n\t\tconst cell = this.editingDelegate.createCellViewModel(this._deletedRawCell);\n\t\tif (this.direction === 'above') {\n\t\t\tthis.editingDelegate.insertCell(this.index, this._deletedRawCell, { kind: SelectionStateType.Handle, primary: cell.handle, selections: [cell.handle] });\n\t\t\tcell.focusMode = CellFocusMode.Editor;\n\t\t} else {\n\t\t\tthis.editingDelegate.insertCell(this.index, cell.model, { kind: SelectionStateType.Handle, primary: this.cell.handle, selections: [this.cell.handle] });\n\t\t\tthis.cell.focusMode = CellFocusMode.Editor;\n\t\t}\n\t}\n\n\tasync redo(): Promise<void> {\n\t\tif (!this.editingDelegate.deleteCell) {\n\t\t\tthrow new Error('Notebook Delete Cell not implemented for Undo/Redo');\n\t\t}\n\n\t\tawait this.cell.resolveTextModel();\n\t\tthis.cell.textModel?.applyEdits([\n\t\t\t{ range: this.inverseRange, text: this.insertContent }\n\t\t]);\n\n\t\tthis.editingDelegate.deleteCell(this.index, { kind: SelectionStateType.Handle, primary: this.cell.handle, selections: [this.cell.handle] });\n\t\tthis.cell.focusMode = CellFocusMode.Editor;\n\t}\n}\n"]}