{"version":3,"sources":["vs/workbench/contrib/notebook/browser/viewParts/notebookEditorStickyScroll.ts"],"names":[],"mappings":"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","file":"notebookEditorStickyScroll.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport * as DOM from 'vs/base/browser/dom';\nimport { StandardMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { ServicesAccessor } from 'vs/editor/browser/editorExtensions';\nimport { Categories } from 'vs/platform/action/common/actionCommonCategories';\nimport { Action2, MenuId, registerAction2 } from 'vs/platform/actions/common/actions';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { ContextKeyExpr } from 'vs/platform/contextkey/common/contextkey';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { INotebookEditor } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { INotebookCellList } from 'vs/workbench/contrib/notebook/browser/view/notebookRenderingCommon';\nimport { NotebookCellOutlineProvider } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookOutlineProvider';\n\nimport { CellKind } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { OutlineEntry } from 'vs/workbench/contrib/notebook/browser/viewModel/OutlineEntry';\n\nexport class ToggleNotebookStickyScroll extends Action2 {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'notebook.action.toggleNotebookStickyScroll',\n\t\t\ttitle: {\n\t\t\t\tvalue: localize('toggleStickyScroll', \"Toggle Notebook Sticky Scroll\"),\n\t\t\t\tmnemonicTitle: localize({ key: 'mitoggleStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Toggle Notebook Sticky Scroll\"),\n\t\t\t\toriginal: 'Toggle Notebook Sticky Scroll',\n\t\t\t},\n\t\t\tcategory: Categories.View,\n\t\t\ttoggled: {\n\t\t\t\tcondition: ContextKeyExpr.equals('config.notebook.stickyScroll.enabled', true),\n\t\t\t\ttitle: localize('notebookStickyScroll', \"Notebook Sticky Scroll\"),\n\t\t\t\tmnemonicTitle: localize({ key: 'miNotebookStickyScroll', comment: ['&& denotes a mnemonic'] }, \"&&Notebook Sticky Scroll\"),\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{ id: MenuId.CommandPalette },\n\t\t\t\t{ id: MenuId.NotebookStickyScrollContext }\n\t\t\t]\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor): Promise<void> {\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\t\tconst newValue = !configurationService.getValue('notebook.stickyScroll.enabled');\n\t\treturn configurationService.updateValue('notebook.stickyScroll.enabled', newValue);\n\t}\n}\n\nexport class NotebookStickyLine extends Disposable {\n\tconstructor(\n\t\tpublic readonly element: HTMLElement,\n\t\tpublic readonly entry: OutlineEntry,\n\t\tpublic readonly notebookEditor: INotebookEditor,\n\t) {\n\t\tsuper();\n\t\tthis._register(DOM.addDisposableListener(this.element, DOM.EventType.CLICK, () => {\n\t\t\tthis.focusCell();\n\t\t}));\n\t}\n\n\tprivate focusCell() {\n\t\tthis.notebookEditor.focusNotebookCell(this.entry.cell, 'container');\n\t\tconst cellScrollTop = this.notebookEditor.getAbsoluteTopOfElement(this.entry.cell);\n\t\tconst parentCount = this.getParentCount();\n\t\t// 1.1 addresses visible cell padding, to make sure we don't focus md cell and also render its sticky line\n\t\tthis.notebookEditor.setScrollTop(cellScrollTop - (parentCount + 1.1) * 22);\n\t}\n\n\tprivate getParentCount() {\n\t\tlet count = 0;\n\t\tlet entry = this.entry;\n\t\twhile (entry.parent) {\n\t\t\tcount++;\n\t\t\tentry = entry.parent;\n\t\t}\n\t\treturn count;\n\t}\n}\n\n// TODO @Yoyokrazy:\n// BEHAVIOR\n// - [ ] bug with some popping around the cell transition\n// - [ ] bug with only bottom most sticky being partially transitioned\n// \t\t- partial rendering/transition only occuring when the headers shrink against a new section\n//\t\t- **and only for BOTTOM of that initial sticky tree**\n//\t\t- issues with HC themes\n// UX\n// - [ ] render symbols instead of #'s?\n// \t\t- maybe 'Hx >' where x is the level\nexport class NotebookStickyScroll extends Disposable {\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate currentStickyLines = new Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }>();\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this.domNode;\n\t}\n\n\tgetCurrentStickyHeight() {\n\t\treturn this.currentStickyLines.size * 22;\n\t}\n\n\tprivate setCurrentStickyLines(newStickyLines: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }>) {\n\t\tthis.currentStickyLines = newStickyLines;\n\t}\n\n\tconstructor(\n\t\tprivate readonly domNode: HTMLElement,\n\t\tprivate readonly notebookEditor: INotebookEditor,\n\t\tprivate readonly notebookOutline: NotebookCellOutlineProvider,\n\t\tprivate readonly notebookCellList: INotebookCellList,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t) {\n\t\tsuper();\n\n\t\tif (this.notebookEditor.notebookOptions.getLayoutConfiguration().stickyScroll) {\n\t\t\tthis.init();\n\t\t}\n\n\t\tthis._register(this.notebookEditor.notebookOptions.onDidChangeOptions((e) => {\n\t\t\tif (e.stickyScroll) {\n\t\t\t\tthis.updateConfig();\n\t\t\t}\n\t\t\tif (e.globalToolbar) {\n\t\t\t\tthis.setTop();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this.domNode, DOM.EventType.CONTEXT_MENU, async (event: MouseEvent) => {\n\t\t\tthis.onContextMenu(event);\n\t\t}));\n\t}\n\n\tprivate onContextMenu(e: MouseEvent) {\n\t\tconst event = new StandardMouseEvent(e);\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tmenuId: MenuId.NotebookStickyScrollContext,\n\t\t\tgetAnchor: () => event,\n\t\t});\n\t}\n\n\tprivate updateConfig() {\n\t\tif (this.notebookEditor.notebookOptions.getLayoutConfiguration().stickyScroll) {\n\t\t\tthis.init();\n\t\t} else {\n\t\t\tthis._disposables.clear();\n\t\t\tthis.disposeCurrentStickyLines();\n\t\t\tDOM.clearNode(this.domNode);\n\t\t\tthis.updateDisplay();\n\t\t}\n\t}\n\n\tprivate setTop() {\n\t\tif (this.notebookEditor.notebookOptions.getLayoutConfiguration().globalToolbar) {\n\t\t\tthis.domNode.style.top = '26px';\n\t\t} else {\n\t\t\tthis.domNode.style.top = '0px';\n\t\t}\n\t}\n\n\tprivate init() {\n\t\tthis.notebookOutline.init();\n\t\tthis.initializeContent();\n\n\t\tthis._disposables.add(this.notebookOutline.onDidChange(() => {\n\t\t\tDOM.clearNode(this.domNode);\n\t\t\tthis.disposeCurrentStickyLines();\n\t\t\tthis.updateContent(computeContent(this.domNode, this.notebookEditor, this.notebookCellList, this.notebookOutline.entries));\n\t\t}));\n\n\t\tthis._disposables.add(this.notebookEditor.onDidAttachViewModel(() => {\n\t\t\tthis.notebookOutline.init();\n\t\t\tthis.initializeContent();\n\t\t}));\n\n\t\tthis._disposables.add(this.notebookEditor.onDidScroll(() => {\n\t\t\tDOM.clearNode(this.domNode);\n\t\t\tthis.disposeCurrentStickyLines();\n\t\t\tthis.updateContent(computeContent(this.domNode, this.notebookEditor, this.notebookCellList, this.notebookOutline.entries));\n\t\t}));\n\t}\n\n\tstatic getVisibleOutlineEntry(visibleIndex: number, notebookOutlineEntries: OutlineEntry[]): OutlineEntry | undefined {\n\t\tlet left = 0;\n\t\tlet right = notebookOutlineEntries.length - 1;\n\t\tlet bucket = -1;\n\n\t\twhile (left <= right) {\n\t\t\tconst mid = Math.floor((left + right) / 2);\n\t\t\tif (notebookOutlineEntries[mid].index === visibleIndex) {\n\t\t\t\tbucket = mid;\n\t\t\t\tbreak;\n\t\t\t} else if (notebookOutlineEntries[mid].index < visibleIndex) {\n\t\t\t\tbucket = mid;\n\t\t\t\tleft = mid + 1;\n\t\t\t} else {\n\t\t\t\tright = mid - 1;\n\t\t\t}\n\t\t}\n\n\t\tif (bucket !== -1) {\n\t\t\tconst rootEntry = notebookOutlineEntries[bucket];\n\t\t\tconst flatList: OutlineEntry[] = [];\n\t\t\trootEntry.asFlatList(flatList);\n\t\t\treturn flatList.find(entry => entry.index === visibleIndex);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate initializeContent() {\n\n\t\t// find last code cell of section, store bottom scroll position in sectionBottom\n\t\tconst visibleRange = this.notebookEditor.visibleRanges[0];\n\t\tif (!visibleRange) {\n\t\t\treturn;\n\t\t}\n\n\t\tDOM.clearNode(this.domNode);\n\t\tconst editorScrollTop = this.notebookEditor.scrollTop;\n\n\t\tlet trackedEntry = undefined;\n\t\tlet sectionBottom = 0;\n\t\tfor (let i = visibleRange.start; i < visibleRange.end; i++) {\n\t\t\tif (i === 0) { // don't show headers when you're viewing the top cell\n\t\t\t\tthis.updateDisplay();\n\t\t\t\tthis.setCurrentStickyLines(new Map());\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst cell = this.notebookEditor.cellAt(i);\n\t\t\tif (!cell) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// if we are here, the cell is a code cell.\n\t\t\t// check next cell, if markdown, that means this is the end of the section\n\t\t\t// check if cell is within visible range\n\t\t\tconst nextCell = this.notebookEditor.cellAt(i + 1);\n\t\t\tif (nextCell && i + 1 < visibleRange.end) {\n\t\t\t\tif (nextCell.cellKind === CellKind.Markup) {\n\t\t\t\t\t// this is the end of the section\n\t\t\t\t\t// store the bottom scroll position of this cell\n\t\t\t\t\tsectionBottom = this.notebookCellList.getCellViewScrollBottom(cell);\n\t\t\t\t\t// compute sticky scroll height\n\t\t\t\t\tconst entry = NotebookStickyScroll.getVisibleOutlineEntry(i, this.notebookOutline.entries);\n\t\t\t\t\tif (!entry) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// using 22 instead of stickyscrollheight, as we don't necessarily render each line. 22 starts rendering sticky when we have space for at least 1 of them\n\t\t\t\t\tconst newStickyHeight = NotebookStickyScroll.computeStickyHeight(entry!);\n\t\t\t\t\tif (editorScrollTop + newStickyHeight < sectionBottom) {\n\t\t\t\t\t\ttrackedEntry = entry;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// if (editorScrollTop + stickyScrollHeight > sectionBottom), then continue to next section\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// there is no next cell, so use the bottom of the editor as the sectionBottom, using scrolltop + height\n\t\t\t\tsectionBottom = this.notebookEditor.scrollTop + this.notebookEditor.getLayoutInfo().scrollHeight;\n\t\t\t\ttrackedEntry = NotebookStickyScroll.getVisibleOutlineEntry(i, this.notebookOutline.entries);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} // cell loop close\n\n\t\t// -------------------------------------------------------------------------------------\n\t\t// we now know the cell which the sticky is determined by, and the sectionBottom value to determine how many sticky lines to render\n\t\t// compute the space available for sticky lines, and render sticky lines\n\n\t\tconst linesToRender = Math.floor((sectionBottom - editorScrollTop) / 22);\n\t\tlet newMap: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }> = new Map();\n\t\tnewMap = NotebookStickyScroll.renderStickyLines(trackedEntry?.parent, this.domNode, linesToRender, newMap, this.notebookEditor);\n\t\tthis.setCurrentStickyLines(newMap);\n\t\tthis.updateDisplay();\n\t}\n\n\tprivate updateContent(newMap: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }>) {\n\t\tthis.setCurrentStickyLines(newMap);\n\t\tthis.updateDisplay();\n\t}\n\n\tprivate updateDisplay() {\n\t\tconst hasSticky = this.currentStickyLines.size > 0;\n\t\tif (!hasSticky) {\n\t\t\tthis.domNode.style.display = 'none';\n\t\t} else {\n\t\t\tthis.domNode.style.display = 'block';\n\t\t}\n\t\tthis.setTop();\n\t}\n\n\tstatic computeStickyHeight(entry: OutlineEntry) {\n\t\tlet height = 0;\n\t\tif (entry.cell.cellKind === CellKind.Markup) {\n\t\t\theight += 22;\n\t\t}\n\t\twhile (entry.parent) {\n\t\t\theight += 22;\n\t\t\tentry = entry.parent;\n\t\t}\n\t\treturn height;\n\t}\n\n\tstatic renderStickyLines(entry: OutlineEntry | undefined, containerElement: HTMLElement, numLinesToRender: number, newMap: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }>, notebookEditor: INotebookEditor) {\n\t\tlet currentEntry = entry;\n\n\t\tconst elementsToRender = [];\n\t\twhile (currentEntry) {\n\t\t\tif (currentEntry.level === 7) {\n\t\t\t\t// level 7 represents a non-header entry, which we don't want to render\n\t\t\t\tcurrentEntry = currentEntry.parent;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst lineToRender = NotebookStickyScroll.createStickyElement(currentEntry, notebookEditor);\n\t\t\tnewMap.set(currentEntry, { line: lineToRender, rendered: false });\n\t\t\telementsToRender.unshift(lineToRender);\n\t\t\tcurrentEntry = currentEntry.parent;\n\t\t}\n\n\t\t// TODO: clean up partial cell animation\n\t\t// [ ] slight pop as lines finish disappearing\n\t\t// [ ] only actually works when shrunk against new section. **and only for BOTTOM of that initial sticky tree**\n\t\t// [ ] issues with HC themes\n\t\t// use negative margins to render the bottom sticky line as a partial element\n\t\t// todo: partial render logic here\n\t\t// if (numLinesToRender % 1 !== 0) {\n\t\t// \tconst partialHeight = 22 - Math.floor((numLinesToRender % 1) * 22);\n\t\t// \telementsToRender[elementsToRender.length - 1].element.style.zIndex = '-1';\n\t\t// \telementsToRender[elementsToRender.length - 1].element.style.marginTop = `-${partialHeight}px`;\n\t\t// }\n\n\t\t// iterate over elements to render, and append to container\n\t\t// break when we reach numLinesToRender\n\t\tfor (let i = 0; i < elementsToRender.length; i++) {\n\t\t\tif (i >= numLinesToRender) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcontainerElement.append(elementsToRender[i].element);\n\t\t\tnewMap.set(elementsToRender[i].entry, { line: elementsToRender[i], rendered: true });\n\t\t}\n\n\t\tcontainerElement.append(DOM.$('div', { class: 'notebook-shadow' })); // ensure we have dropShadow at base of sticky scroll\n\t\treturn newMap;\n\t}\n\n\tstatic createStickyElement(entry: OutlineEntry, notebookEditor: INotebookEditor) {\n\t\tconst stickyElement = document.createElement('div');\n\t\tstickyElement.classList.add('notebook-sticky-scroll-line');\n\t\tstickyElement.innerText = '#'.repeat(entry.level) + ' ' + entry.label;\n\t\treturn new NotebookStickyLine(stickyElement, entry, notebookEditor);\n\t}\n\n\tprivate disposeCurrentStickyLines() {\n\t\tthis.currentStickyLines.forEach((value) => {\n\t\t\tvalue.line.dispose();\n\t\t});\n\t}\n\n\toverride dispose() {\n\t\tthis._disposables.dispose();\n\t\tthis.disposeCurrentStickyLines();\n\t\tsuper.dispose();\n\t}\n}\n\nexport function computeContent(domNode: HTMLElement, notebookEditor: INotebookEditor, notebookCellList: INotebookCellList, notebookOutlineEntries: OutlineEntry[]): Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }> {\n\t// find first code cell in visible range. this marks the start of the first section\n\t// find the last code cell in the first section of the visible range, store the bottom scroll position in a const sectionBottom\n\t// compute sticky scroll height, and check if editorScrolltop + stickyScrollHeight < sectionBottom\n\t// if that condition is true, break out of the loop with that cell as the tracked cell\n\t// if that condition is false, continue to next cell\n\n\tconst editorScrollTop = notebookEditor.scrollTop;\n\n\t// find last code cell of section, store bottom scroll position in sectionBottom\n\tconst visibleRange = notebookEditor.visibleRanges[0];\n\tif (!visibleRange) {\n\t\treturn new Map();\n\t}\n\n\tlet trackedEntry = undefined;\n\tlet sectionBottom = 0;\n\tfor (let i = visibleRange.start; i < visibleRange.end; i++) {\n\t\tconst cell = notebookEditor.cellAt(i);\n\t\tif (!cell) {\n\t\t\treturn new Map();\n\t\t}\n\n\t\tconst nextCell = notebookEditor.cellAt(i + 1);\n\n\t\t// account for transitions between top level headers\n\t\tif (cell.cellKind === CellKind.Markup) {\n\t\t\tsectionBottom = notebookCellList.getCellViewScrollBottom(cell);\n\t\t\tconst entry = NotebookStickyScroll.getVisibleOutlineEntry(i, notebookOutlineEntries);\n\t\t\tif (!entry) {\n\t\t\t\treturn new Map();\n\t\t\t}\n\n\t\t\tif (!entry.parent) {\n\t\t\t\t// if the cell is a top level header, only render once we have scrolled past the bottom of the cell\n\t\t\t\t// todo: (polish) figure out what padding value to use here. need to account properly for bottom insert cell toolbar, cell toolbar, and md cell bottom padding\n\t\t\t\tif (sectionBottom > editorScrollTop) {\n\t\t\t\t\treturn new Map();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// if we are here, the cell is a code cell.\n\t\t// check next cell, if markdown, that means this is the end of the section\n\t\tif (nextCell && i + 1 < visibleRange.end) {\n\t\t\tif (nextCell.cellKind === CellKind.Markup) {\n\t\t\t\t// this is the end of the section\n\t\t\t\t// store the bottom scroll position of this cell\n\t\t\t\tsectionBottom = notebookCellList.getCellViewScrollBottom(cell);\n\t\t\t\t// compute sticky scroll height\n\t\t\t\tconst entry = NotebookStickyScroll.getVisibleOutlineEntry(i, notebookOutlineEntries);\n\t\t\t\tif (!entry) {\n\t\t\t\t\treturn new Map();\n\t\t\t\t}\n\t\t\t\t// check if we can render this section of sticky\n\t\t\t\tconst currentSectionStickyHeight = NotebookStickyScroll.computeStickyHeight(entry!);\n\t\t\t\tif (editorScrollTop + currentSectionStickyHeight < sectionBottom) {\n\t\t\t\t\tconst linesToRender = Math.floor((sectionBottom - editorScrollTop) / 22);\n\t\t\t\t\tlet newMap: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }> = new Map();\n\t\t\t\t\tnewMap = NotebookStickyScroll.renderStickyLines(entry, domNode, linesToRender, newMap, notebookEditor);\n\t\t\t\t\treturn newMap;\n\t\t\t\t}\n\n\t\t\t\tlet nextSectionEntry = undefined;\n\t\t\t\tfor (let j = 1; j < visibleRange.end - i; j++) {\n\t\t\t\t\t// find next section after this one\n\t\t\t\t\tconst cellCheck = notebookEditor.cellAt(i + j);\n\t\t\t\t\tif (cellCheck) {\n\t\t\t\t\t\tnextSectionEntry = NotebookStickyScroll.getVisibleOutlineEntry(i + j, notebookOutlineEntries);\n\t\t\t\t\t\tif (nextSectionEntry) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst nextSectionStickyHeight = NotebookStickyScroll.computeStickyHeight(nextSectionEntry!);\n\n\t\t\t\t// recompute section bottom based on the top of the next section\n\t\t\t\tsectionBottom = notebookCellList.getCellViewScrollTop(nextSectionEntry!.cell) - 10;\n\n\t\t\t\t// this block of logic cleans transitions between two sections that share a parent.\n\t\t\t\t// if the current section and the next section share a parent, then we can render the next section's sticky lines to avoid pop-in between\n\t\t\t\tif (entry?.parent?.parent === nextSectionEntry?.parent) {\n\t\t\t\t\tconst linesToRender = Math.floor((sectionBottom - editorScrollTop) / 22) + 100;\n\t\t\t\t\tlet newMap: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }> = new Map();\n\t\t\t\t\tnewMap = NotebookStickyScroll.renderStickyLines(nextSectionEntry?.parent, domNode, linesToRender, newMap, notebookEditor);\n\t\t\t\t\treturn newMap;\n\t\t\t\t} else if (Math.abs(currentSectionStickyHeight - nextSectionStickyHeight) > 22) { // only shrink sticky\n\t\t\t\t\tconst linesToRender = (sectionBottom - editorScrollTop) / 22;\n\t\t\t\t\tlet newMap: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }> = new Map();\n\t\t\t\t\tnewMap = NotebookStickyScroll.renderStickyLines(entry?.parent, domNode, linesToRender, newMap, notebookEditor);\n\t\t\t\t\treturn newMap;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// there is no next visible cell, so use the bottom of the editor as the sectionBottom, using scrolltop + height\n\t\t\tsectionBottom = notebookEditor.getLayoutInfo().scrollHeight;\n\t\t\ttrackedEntry = NotebookStickyScroll.getVisibleOutlineEntry(i, notebookOutlineEntries);\n\t\t\tconst linesToRender = Math.floor((sectionBottom - editorScrollTop) / 22);\n\n\t\t\tlet newMap: Map<OutlineEntry, { line: NotebookStickyLine; rendered: boolean }> = new Map();\n\t\t\tnewMap = NotebookStickyScroll.renderStickyLines(trackedEntry?.parent, domNode, linesToRender, newMap, notebookEditor);\n\t\t\treturn newMap;\n\t\t}\n\t} // for cell loop close\n\treturn new Map();\n}\n\nregisterAction2(ToggleNotebookStickyScroll);\n"]}