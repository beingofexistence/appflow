{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/browser/view/cellParts/cellFocusIndicator.ts"],"names":[],"mappings":"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","file":"cellFocusIndicator.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from 'vs/base/browser/dom';\nimport { FastDomNode } from 'vs/base/browser/fastDomNode';\nimport { CodeCellLayoutInfo, ICellViewModel, INotebookEditorDelegate } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { CellContentPart } from 'vs/workbench/contrib/notebook/browser/view/cellPart';\nimport { CellTitleToolbarPart } from 'vs/workbench/contrib/notebook/browser/view/cellParts/cellToolbars';\nimport { CodeCellViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel';\nimport { MarkupCellViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel';\nimport { CellKind } from 'vs/workbench/contrib/notebook/common/notebookCommon';\n\nexport class CellFocusIndicator extends CellContentPart {\n\tpublic codeFocusIndicator: FastDomNode<HTMLElement>;\n\tpublic outputFocusIndicator: FastDomNode<HTMLElement>;\n\n\tconstructor(\n\t\treadonly notebookEditor: INotebookEditorDelegate,\n\t\treadonly titleToolbar: CellTitleToolbarPart,\n\t\treadonly top: FastDomNode<HTMLElement>,\n\t\treadonly left: FastDomNode<HTMLElement>,\n\t\treadonly right: FastDomNode<HTMLElement>,\n\t\treadonly bottom: FastDomNode<HTMLElement>\n\t) {\n\t\tsuper();\n\n\t\tthis.codeFocusIndicator = new FastDomNode(DOM.append(\n\t\t\tthis.left.domNode,\n\t\t\tDOM.$(\n\t\t\t\t'.codeOutput-focus-indicator-container',\n\t\t\t\tundefined,\n\t\t\t\tDOM.$('.codeOutput-focus-indicator.code-focus-indicator'))));\n\n\t\tthis.outputFocusIndicator = new FastDomNode(DOM.append(\n\t\t\tthis.left.domNode,\n\t\t\tDOM.$(\n\t\t\t\t'.codeOutput-focus-indicator-container',\n\t\t\t\tundefined,\n\t\t\t\tDOM.$('.codeOutput-focus-indicator.output-focus-indicator'))));\n\n\t\tthis._register(DOM.addDisposableListener(this.codeFocusIndicator.domNode, DOM.EventType.CLICK, () => {\n\t\t\tif (this.currentCell) {\n\t\t\t\tthis.currentCell.isInputCollapsed = !this.currentCell.isInputCollapsed;\n\t\t\t}\n\t\t}));\n\t\tthis._register(DOM.addDisposableListener(this.outputFocusIndicator.domNode, DOM.EventType.CLICK, () => {\n\t\t\tif (this.currentCell) {\n\t\t\t\tthis.currentCell.isOutputCollapsed = !this.currentCell.isOutputCollapsed;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addDisposableListener(this.left.domNode, DOM.EventType.DBLCLICK, e => {\n\t\t\tif (!this.currentCell || !this.notebookEditor.hasModel()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (e.target !== this.left.domNode) {\n\t\t\t\t// Don't allow dblclick on the codeFocusIndicator/outputFocusIndicator\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst clickedOnInput = e.offsetY < (this.currentCell.layoutInfo as CodeCellLayoutInfo).outputContainerOffset;\n\t\t\tif (clickedOnInput) {\n\t\t\t\tthis.currentCell.isInputCollapsed = !this.currentCell.isInputCollapsed;\n\t\t\t} else {\n\t\t\t\tthis.currentCell.isOutputCollapsed = !this.currentCell.isOutputCollapsed;\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.titleToolbar.onDidUpdateActions(() => {\n\t\t\tthis.updateFocusIndicatorsForTitleMenu();\n\t\t}));\n\t}\n\n\toverride updateInternalLayoutNow(element: ICellViewModel): void {\n\t\tif (element.cellKind === CellKind.Markup) {\n\t\t\tconst indicatorPostion = this.notebookEditor.notebookOptions.computeIndicatorPosition(element.layoutInfo.totalHeight, (element as MarkupCellViewModel).layoutInfo.foldHintHeight, this.notebookEditor.textModel?.viewType);\n\t\t\tthis.bottom.domNode.style.transform = `translateY(${indicatorPostion.bottomIndicatorTop}px)`;\n\t\t\tthis.left.setHeight(indicatorPostion.verticalIndicatorHeight);\n\t\t\tthis.right.setHeight(indicatorPostion.verticalIndicatorHeight);\n\t\t\tthis.codeFocusIndicator.setHeight(indicatorPostion.verticalIndicatorHeight - this.getIndicatorTopMargin() * 2);\n\t\t} else {\n\t\t\tconst cell = element as CodeCellViewModel;\n\t\t\tconst layoutInfo = this.notebookEditor.notebookOptions.getLayoutConfiguration();\n\t\t\tconst bottomToolbarDimensions = this.notebookEditor.notebookOptions.computeBottomToolbarDimensions(this.notebookEditor.textModel?.viewType);\n\t\t\tconst indicatorHeight = cell.layoutInfo.codeIndicatorHeight + cell.layoutInfo.outputIndicatorHeight + cell.layoutInfo.commentHeight;\n\t\t\tthis.left.setHeight(indicatorHeight);\n\t\t\tthis.right.setHeight(indicatorHeight);\n\t\t\tthis.codeFocusIndicator.setHeight(cell.layoutInfo.codeIndicatorHeight);\n\t\t\tthis.outputFocusIndicator.setHeight(Math.max(cell.layoutInfo.outputIndicatorHeight - cell.viewContext.notebookOptions.getLayoutConfiguration().focusIndicatorGap, 0));\n\t\t\tthis.bottom.domNode.style.transform = `translateY(${cell.layoutInfo.totalHeight - bottomToolbarDimensions.bottomToolbarGap - layoutInfo.cellBottomMargin}px)`;\n\t\t}\n\n\t\tthis.updateFocusIndicatorsForTitleMenu();\n\t}\n\n\tprivate updateFocusIndicatorsForTitleMenu(): void {\n\t\tthis.left.domNode.style.transform = `translateY(${this.getIndicatorTopMargin()}px)`;\n\t\tthis.right.domNode.style.transform = `translateY(${this.getIndicatorTopMargin()}px)`;\n\t}\n\n\tprivate getIndicatorTopMargin() {\n\t\tconst layoutInfo = this.notebookEditor.notebookOptions.getLayoutConfiguration();\n\n\t\tif (this.titleToolbar.hasActions) {\n\t\t\treturn layoutInfo.editorToolbarHeight + layoutInfo.cellTopMargin;\n\t\t} else {\n\t\t\treturn layoutInfo.cellTopMargin;\n\t\t}\n\t}\n}\n"]}