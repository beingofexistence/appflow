{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/browser/view/cellParts/cellToolbars.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAsBzF,IAAM,IAAI,GAAV,MAAM,IAAmB,SAAQ,eAAI;QAG3C,YACkB,CAAwC,EACzD,sBAAmC,EAClB,CAAwC,EACjB,CAAyB,EAC3B,CAAuB,EACxB,CAAsB,EAC5B,CAAgB;YAE/C,KAAK,EAAE,CAAC;YARS,MAAC,GAAD,CAAC,CAAuC;YAExC,MAAC,GAAD,CAAC,CAAuC;YACjB,MAAC,GAAD,CAAC,CAAwB;YAC3B,MAAC,GAAD,CAAC,CAAsB;YACxB,MAAC,GAAD,CAAC,CAAqB;YAC5B,MAAC,GAAD,CAAC,CAAe;QAGhD,CAAC;QAEO,CAAC;YACR,IAAI,IAAI,CAAC,CAAC,EAAoB;gBAC7B,OAAO,IAAI,CAAC,CAAC,CAAmB;aAChC;YAED,MAAM,kBAAkB,GAAG,IAAI,CAAC,CAAC,CAAS,IAAI,aAAG,CAAK,IAAI,CAAC,CAAC,EAA4B,IAAI,CAAC,CAAC,EAAmB;gBAChH,sBAAsB,EAAE,MAAM,CAAC,EAAE;oBAChC,IAAI,MAAM,YAAY,aAAG,EAAa;wBACrC,IAAI,IAAI,CAAC,CAAC,CAAe,eAAe,CAAC,sBAAsB,EAAE,CAAC,sBAAsB,KAAK,QAAQ,EAAE;4BACtG,OAAO,IAAI,CAAC,CAAC,CAAoB,cAAc,CAAC,qBAAI,EAAmB,MAAM,EAAE,SAAS,CAAC,CAAC;yBAC1F;6BAAM;4BACN,OAAO,IAAI,CAAC,CAAC,CAAoB,cAAc,CAAC,6BAAG,EAAsB,MAAM,EAAE,SAAS,CAAC,CAAC;yBAC5F;qBACD;oBAED,OAAO,SAAS,CAAC;gBAClB,CAAC;aACD,CAAC,CAAC,CAAC;YAEJ,IAAI,CAAC,CAAC,GAAqB,kBAAkB,CAAC;YAC9C,MAAM,IAAI,GAAG,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAW,UAAU,CAAC,IAAI,CAAC,CAAC,CAAe,eAAe,CAAC,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC,CAAiB,CAAC,CAAC;YACjJ,MAAM,aAAa,GAAG,GAAG,EAAE;gBAC1B,MAAM,OAAO,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAC5C,kBAAkB,CAAC,UAAU,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;YACnE,CAAC,CAAC;YAEF,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC,aAAa,EAAE,CAAC,CAAC,CAAC;YACxD,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAe,eAAe,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAAE,EAAE;gBAC5E,IAAI,CAAC,CAAC,sBAAsB,EAAE;oBAC7B,aAAa,EAAE,CAAC;iBAChB;YACF,CAAC,CAAC,CAAC,CAAC;YAEJ,aAAa,EAAE,CAAC;YAEhB,OAAO,kBAAkB,CAAC;QAC3B,CAAC;QAEQ,aAAa,CAAC,OAAuB;YAC7C,MAAM,kBAAkB,GAAG,IAAI,CAAC,CAAC,EAAY,CAAC;YAC9C,kBAAkB,CAAC,OAAO,GAA+B;gBACxD,EAAE,EAAE,IAAI;gBACR,IAAI,EAAE,OAAO;gBACb,cAAc,EAAE,IAAI,CAAC,CAAC;gBACtB,IAAI,iDAAwC;aAC5C,CAAC;YACF,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;QACvC,CAAC;QAEQ,uBAAuB,CAAC,OAAuB;YACvD,MAAM,mBAAmB,GAAG,OAAO,CAAC,UAAU,CAAC,mBAAmB,CAAC;YACnE,IAAI,CAAC,CAAC,CAA2B,KAAK,CAAC,SAAS,GAAG,cAAc,mBAAmB,KAAK,CAAC;QAC3F,CAAC;KACD,CAAA;IApEY,oBAAI;mBAAJ,IAAI;QAOd,WAAA,mBAAG,CAAA;QACH,WAAA,iBAAG,CAAA;QACH,WAAA,gBAAG,CAAA;QACH,WAAA,aAAG,CAAA;OAVO,IAAI,CAoEhB;IAmBM,IAAM,IAAI,GAAV,MAAM,IAAqB,SAAQ,eAAI;QAM7C,IAAI,UAAU;YACb,IAAI,CAAC,IAAI,CAAC,CAAC,EAAO;gBACjB,OAAO,KAAK,CAAC;aACb;YAED,OAAO,IAAI,CAAC,CAAC,CAAM,OAAO,CAAC,OAAO,CAAC,MAAM;kBACtC,IAAI,CAAC,CAAC,CAAM,OAAO,CAAC,SAAS,CAAC,MAAM;kBACpC,IAAI,CAAC,CAAC,CAAM,aAAa,CAAC,OAAO,CAAC,MAAM;kBACxC,IAAI,CAAC,CAAC,CAAM,aAAa,CAAC,SAAS,CAAC,MAAM;kBAC1C,CAAC,CAAC;QACN,CAAC;QAED,YACkB,CAA6B,EAC7B,CAAqC,EACrC,CAAc,EACd,CAAoB,EACpB,CAAwC,EACrC,CAAuC,EAC7C,CAAiC,EACxB,CAA0C;YAEjE,KAAK,EAAE,CAAC;YATS,MAAC,GAAD,CAAC,CAA4B;YAC7B,MAAC,GAAD,CAAC,CAAoC;YACrC,MAAC,GAAD,CAAC,CAAa;YACd,MAAC,GAAD,CAAC,CAAmB;YACpB,MAAC,GAAD,CAAC,CAAuC;YACpB,MAAC,GAAD,CAAC,CAAqB;YAC5B,MAAC,GAAD,CAAC,CAAe;YACP,MAAC,GAAD,CAAC,CAAwB;YAvBjD,MAAC,GAAoC,IAAI,CAAC,CAAC,CAAS,IAAI,WAAG,EAAY,CAAC,CAAC;YACjF,uBAAkB,GAAgB,IAAI,CAAC,CAAC,CAAmB,KAAK,CAAC;QAyB1E,CAAC;QAEO,CAAC;YACR,IAAI,IAAI,CAAC,CAAC,EAAO;gBAChB,OAAO,IAAI,CAAC,CAAC,CAAM;aACnB;YAED,MAAM,SAAS,GAAG,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAW,UAAU,CAAC,IAAI,CAAC,CAAC,EAAU,IAAI,CAAC,CAAC,CAAiB,CAAC,CAAC;YACtG,MAAM,UAAU,GAAG,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAW,UAAU,CAAC,IAAI,CAAC,CAAC,EAAgB,IAAI,CAAC,CAAC,CAAiB,CAAC,CAAC;YAC7G,MAAM,OAAO,GAAG,qBAAqB,CAAC,SAAS,CAAC,CAAC;YACjD,MAAM,aAAa,GAAG,qBAAqB,CAAC,UAAU,CAAC,CAAC;YAExD,IAAI,CAAC,CAAC,GAAQ;gBACb,SAAS;gBACT,OAAO;gBACP,UAAU;gBACV,aAAa;aACb,CAAC;YAEF,OAAO,IAAI,CAAC,CAAC,CAAM;QACpB,CAAC;QAEO,CAAC,CAAW,KAA4B,EAAE,OAAuB;YACxE,IAAI,IAAI,CAAC,CAAC,EAAM;gBACf,OAAO,IAAI,CAAC,CAAC,CAAK;aAClB;YAED,MAAM,OAAO,GAAG,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAoB,cAAc,CAAC,aAAG,EAAe,IAAI,CAAC,CAAC,EAAiB;gBAChH,sBAAsB,EAAE,MAAM,CAAC,EAAE;oBAChC,OAAO,IAAA,6BAAG,EAAkB,IAAI,CAAC,CAAC,EAAqB,MAAM,CAAC,CAAC;gBAChE,CAAC;gBACD,4BAA4B,EAAE,IAAI;aAClC,CAAC,CAAC,CAAC;YAEJ,MAAM,aAAa,GAAG,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,CAAC,CAAoB,cAAc,CAAC,QAAQ,CAAC,EAAE,CAAC,mBAAmB,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,EAAiB,qBAAqB,CAAC,CAAC,CAAC,CAAC;YACxK,IAAI,KAAK,CAAC,aAAa,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,KAAK,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC3F,aAAa,CAAC,UAAU,CAAC,KAAK,CAAC,aAAa,CAAC,OAAO,EAAE,KAAK,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC;aACrF;YAED,IAAI,CAAC,CAAC,CAAoB,OAAO,EAAE,KAAK,CAAC,SAAS,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;YACnE,IAAI,CAAC,CAAC,CAAoB,aAAa,EAAE,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,aAAa,CAAC,CAAC;YAEhF,IAAI,CAAC,CAAC,GAAO;gBACZ,OAAO;gBACP,aAAa;aACb,CAAC;YAEF,OAAO,IAAI,CAAC,CAAC,CAAK;QACnB,CAAC;QAEQ,iBAAiB,CAAC,OAAuB;YACjD,IAAI,CAAC,CAAC,EAAiB,CAAC;QACzB,CAAC;QAEQ,aAAa,CAAC,OAAuB;YAC7C,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,EAAiB,CAAC;YACtC,MAAM,IAAI,GAAG,IAAI,CAAC,CAAC,CAAW,KAAK,EAAE,OAAO,CAAC,CAAC;YAC9C,IAAI,CAAC,CAAC,CAAe,GAAG,CAAC,IAAA,8BAAI,EAA4B,IAAI,CAAC,CAAC,EAAgB,OAAO,EAAE,IAAI,CAAC,CAAC,EAAiB,EAAE,WAAW,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;YAE9I,IAAI,CAAC,CAAC,CAAa,IAAI,EAA8B;gBACpD,EAAE,EAAE,IAAI;gBACR,IAAI,EAAE,OAAO;gBACb,cAAc,EAAE,IAAI,CAAC,CAAC;gBACtB,IAAI,iDAAwC;aAC5C,CAAC,CAAC;QACJ,CAAC;QAEO,CAAC,CAAa,IAA0B,EAAE,cAA0C;YAC3F,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,cAAc,CAAC;YACtC,IAAI,CAAC,aAAa,CAAC,OAAO,GAAG,cAAc,CAAC;QAC7C,CAAC;QAEO,CAAC,CAAoB,OAAY,EAAM,IAAW,EAAE,WAAyD;YACpH,UAAU;YACV,IAAI,iBAAiB,GAAG,KAAK,CAAC;YAC9B,IAAI,cAAwC,CAAC;YAE7C,IAAI,CAAC,CAAC,CAAa,OAAO,EAAE,WAAW,CAAC,CAAC;YACzC,IAAI,CAAC,CAAC,CAAS,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE;gBACpC,IAAI,iBAAiB,EAAE;oBACtB,MAAM,OAAO,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC;oBAC5C,cAAc,GAAG,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAa,OAAO,EAAE,OAAO,CAAC,CAAC;oBAC5D,OAAO;iBACP;gBAED,MAAM,OAAO,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAC5C,IAAI,CAAC,CAAC,CAAa,OAAO,EAAE,OAAO,CAAC,CAAC;YACtC,CAAC,CAAC,CAAC,CAAC;YACJ,IAAI,CAAC,CAAC,CAAkB,MAAM,CAAC,8BAA8B,EAAE,KAAK,CAAC,CAAC;YACtE,IAAI,CAAC,CAAC,CAAS,OAAO,CAAC,6BAA6B,CAAC,OAAO,CAAC,EAAE;gBAC9D,iBAAiB,GAAG,OAAO,CAAC;gBAC5B,IAAI,CAAC,CAAC,CAAkB,MAAM,CAAC,8BAA8B,EAAE,OAAO,CAAC,CAAC;gBAExE,IAAI,cAAc,IAAI,CAAC,OAAO,EAAE;oBAC/B,IAAI,CAAC,CAAC,CAAS,IAAA,WAAG,EAAe,GAAG,EAAE;wBACrC,cAAc,EAAE,EAAE,CAAC;oBACpB,CAAC,CAAC,CAAC,CAAC;oBAEJ,cAAc,GAAG,SAAS,CAAC;iBAC3B;YACF,CAAC,CAAC,CAAC,CAAC;QACL,CAAC;QAEO,CAAC,CAAa,OAAY,EAAM,OAAqD;YAC5F,MAAM,QAAQ,GAAG,GAAG,CAAC,GAAG,CAAQ,QAAQ,CAAC,aAAa,EAAE,OAAO,CAAC,UAAU,EAAE,CAAC,CAAC;YAC9E,OAAO,CAAC,UAAU,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;YACvD,IAAI,QAAQ,EAAE;gBACb,IAAI,CAAC,CAAC,CAAe,KAAK,EAAE,CAAC;aAC7B;YAED,IAAI,OAAO,CAAC,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE;gBACvD,IAAI,CAAC,CAAC,CAAkB,MAAM,CAAC,0BAA0B,EAAE,IAAI,CAAC,CAAC;gBACjE,IAAI,CAAC,CAAC,CAAmB,IAAI,EAAE,CAAC;aAChC;iBAAM;gBACN,IAAI,CAAC,CAAC,CAAkB,MAAM,CAAC,0BAA0B,EAAE,KAAK,CAAC,CAAC;gBAClE,IAAI,CAAC,CAAC,CAAmB,IAAI,EAAE,CAAC;aAChC;QACF,CAAC;KACD,CAAA;IAnJY,oBAAI;mBAAJ,IAAI;QAwBd,WAAA,gBAAG,CAAA;QACH,WAAA,aAAG,CAAA;QACH,WAAA,mBAAG,CAAA;OA1BO,IAAI,CAmJhB;IAED,SAAS,qBAAqB,CAAC,IAAW;QACzC,MAAM,OAAO,GAAc,EAAE,CAAC;QAC9B,MAAM,SAAS,GAAc,EAAE,CAAC;QAChC,MAAM,MAAM,GAAG,EAAE,OAAO,EAAE,SAAS,EAAE,CAAC;QAEtC,IAAA,6BAAG,EAA6B,IAAI,EAAE,EAAE,iBAAiB,EAAE,IAAI,EAAE,EAAE,MAAM,EAAE,CAAC,CAAC,EAAE,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QAEnG,OAAO,MAAM,CAAC;IACf,CAAC;IAED,SAAS,mBAAmB,CAAC,QAA0B,EAAE,SAAsB,EAAE,YAAqB;QACrG,MAAM,kBAAkB,GAAG,QAAQ,CAAC,GAAG,CAAC,iBAAG,CAAiB,CAAC;QAC7D,MAAM,iBAAiB,GAAG,QAAQ,CAAC,GAAG,CAAC,gBAAG,CAAgB,CAAC;QAC3D,MAAM,oBAAoB,GAAG,QAAQ,CAAC,GAAG,CAAC,mBAAG,CAAmB,CAAC;QACjE,MAAM,OAAO,GAAG,IAAI,aAAG,CAAK,SAAS,EAAE,kBAAkB,EAAE;YAC1D,aAAa,EAAE,MAAM,CAAC,EAAE,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAE,CAAC;YACtE,sBAAsB,EAAE,MAAM,CAAC,EAAE;gBAChC,OAAO,IAAA,6BAAG,EAAkB,oBAAoB,EAAE,MAAM,CAAC,CAAC;YAC3D,CAAC;YACD,4BAA4B,EAAE,IAAI;SAClC,CAAC,CAAC;QAEH,IAAI,YAAY,EAAE;YACjB,OAAO,CAAC,UAAU,EAAE,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;SACjD;QAED,OAAO,OAAO,CAAC;IAChB,CAAC","file":"cellToolbars.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from 'vs/base/browser/dom';\nimport { ToolBar } from 'vs/base/browser/ui/toolbar/toolbar';\nimport { IAction } from 'vs/base/common/actions';\nimport { disposableTimeout } from 'vs/base/common/async';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { ServicesAccessor } from 'vs/editor/browser/editorExtensions';\nimport { createActionViewItem, createAndFillInActionBarActions, MenuEntryActionViewItem } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { IMenu, IMenuService, MenuId, MenuItemAction } from 'vs/platform/actions/common/actions';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { INotebookCellActionContext } from 'vs/workbench/contrib/notebook/browser/controller/coreActions';\nimport { ICellViewModel, INotebookEditorDelegate } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { CodiconActionViewItem } from 'vs/workbench/contrib/notebook/browser/view/cellParts/cellActionView';\nimport { CellOverlayPart } from 'vs/workbench/contrib/notebook/browser/view/cellPart';\nimport { registerCellToolbarStickyScroll } from 'vs/workbench/contrib/notebook/browser/view/cellParts/cellToolbarStickyScroll';\nimport { WorkbenchToolBar } from 'vs/platform/actions/browser/toolbar';\n\nexport class BetweenCellToolbar extends CellOverlayPart {\n\tprivate _betweenCellToolbar: ToolBar | undefined;\n\n\tconstructor(\n\t\tprivate readonly _notebookEditor: INotebookEditorDelegate,\n\t\t_titleToolbarContainer: HTMLElement,\n\t\tprivate readonly _bottomCellToolbarContainer: HTMLElement,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IMenuService private readonly menuService: IMenuService\n\t) {\n\t\tsuper();\n\t}\n\n\tprivate _initialize(): ToolBar {\n\t\tif (this._betweenCellToolbar) {\n\t\t\treturn this._betweenCellToolbar;\n\t\t}\n\n\t\tconst betweenCellToolbar = this._register(new ToolBar(this._bottomCellToolbarContainer, this.contextMenuService, {\n\t\t\tactionViewItemProvider: action => {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tif (this._notebookEditor.notebookOptions.getLayoutConfiguration().insertToolbarAlignment === 'center') {\n\t\t\t\t\t\treturn this.instantiationService.createInstance(CodiconActionViewItem, action, undefined);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn this.instantiationService.createInstance(MenuEntryActionViewItem, action, undefined);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\n\t\tthis._betweenCellToolbar = betweenCellToolbar;\n\t\tconst menu = this._register(this.menuService.createMenu(this._notebookEditor.creationOptions.menuIds.cellInsertToolbar, this.contextKeyService));\n\t\tconst updateActions = () => {\n\t\t\tconst actions = getCellToolbarActions(menu);\n\t\t\tbetweenCellToolbar.setActions(actions.primary, actions.secondary);\n\t\t};\n\n\t\tthis._register(menu.onDidChange(() => updateActions()));\n\t\tthis._register(this._notebookEditor.notebookOptions.onDidChangeOptions((e) => {\n\t\t\tif (e.insertToolbarAlignment) {\n\t\t\t\tupdateActions();\n\t\t\t}\n\t\t}));\n\n\t\tupdateActions();\n\n\t\treturn betweenCellToolbar;\n\t}\n\n\toverride didRenderCell(element: ICellViewModel): void {\n\t\tconst betweenCellToolbar = this._initialize();\n\t\tbetweenCellToolbar.context = <INotebookCellActionContext>{\n\t\t\tui: true,\n\t\t\tcell: element,\n\t\t\tnotebookEditor: this._notebookEditor,\n\t\t\t$mid: MarshalledId.NotebookCellActionContext\n\t\t};\n\t\tthis.updateInternalLayoutNow(element);\n\t}\n\n\toverride updateInternalLayoutNow(element: ICellViewModel) {\n\t\tconst bottomToolbarOffset = element.layoutInfo.bottomToolbarOffset;\n\t\tthis._bottomCellToolbarContainer.style.transform = `translateY(${bottomToolbarOffset}px)`;\n\t}\n}\n\n\nexport interface ICssClassDelegate {\n\ttoggle: (className: string, force?: boolean) => void;\n}\n\ninterface CellTitleToolbarModel {\n\ttitleMenu: IMenu;\n\tactions: { primary: IAction[]; secondary: IAction[] };\n\tdeleteMenu: IMenu;\n\tdeleteActions: { primary: IAction[]; secondary: IAction[] };\n}\n\ninterface CellTitleToolbarView {\n\ttoolbar: ToolBar;\n\tdeleteToolbar: ToolBar;\n}\n\nexport class CellTitleToolbarPart extends CellOverlayPart {\n\tprivate _model: CellTitleToolbarModel | undefined;\n\tprivate _view: CellTitleToolbarView | undefined;\n\tprivate readonly _onDidUpdateActions: Emitter<void> = this._register(new Emitter<void>());\n\treadonly onDidUpdateActions: Event<void> = this._onDidUpdateActions.event;\n\n\tget hasActions(): boolean {\n\t\tif (!this._model) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this._model.actions.primary.length\n\t\t\t+ this._model.actions.secondary.length\n\t\t\t+ this._model.deleteActions.primary.length\n\t\t\t+ this._model.deleteActions.secondary.length\n\t\t\t> 0;\n\t}\n\n\tconstructor(\n\t\tprivate readonly toolbarContainer: HTMLElement,\n\t\tprivate readonly _rootClassDelegate: ICssClassDelegate,\n\t\tprivate readonly toolbarId: MenuId,\n\t\tprivate readonly deleteToolbarId: MenuId,\n\t\tprivate readonly _notebookEditor: INotebookEditorDelegate,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\t}\n\n\tprivate _initializeModel(): CellTitleToolbarModel {\n\t\tif (this._model) {\n\t\t\treturn this._model;\n\t\t}\n\n\t\tconst titleMenu = this._register(this.menuService.createMenu(this.toolbarId, this.contextKeyService));\n\t\tconst deleteMenu = this._register(this.menuService.createMenu(this.deleteToolbarId, this.contextKeyService));\n\t\tconst actions = getCellToolbarActions(titleMenu);\n\t\tconst deleteActions = getCellToolbarActions(deleteMenu);\n\n\t\tthis._model = {\n\t\t\ttitleMenu,\n\t\t\tactions,\n\t\t\tdeleteMenu,\n\t\t\tdeleteActions\n\t\t};\n\n\t\treturn this._model;\n\t}\n\n\tprivate _initialize(model: CellTitleToolbarModel, element: ICellViewModel): CellTitleToolbarView {\n\t\tif (this._view) {\n\t\t\treturn this._view;\n\t\t}\n\n\t\tconst toolbar = this._register(this.instantiationService.createInstance(WorkbenchToolBar, this.toolbarContainer, {\n\t\t\tactionViewItemProvider: action => {\n\t\t\t\treturn createActionViewItem(this.instantiationService, action);\n\t\t\t},\n\t\t\trenderDropdownAsChildElement: true\n\t\t}));\n\n\t\tconst deleteToolbar = this._register(this.instantiationService.invokeFunction(accessor => createDeleteToolbar(accessor, this.toolbarContainer, 'cell-delete-toolbar')));\n\t\tif (model.deleteActions.primary.length !== 0 || model.deleteActions.secondary.length !== 0) {\n\t\t\tdeleteToolbar.setActions(model.deleteActions.primary, model.deleteActions.secondary);\n\t\t}\n\n\t\tthis.setupChangeListeners(toolbar, model.titleMenu, model.actions);\n\t\tthis.setupChangeListeners(deleteToolbar, model.deleteMenu, model.deleteActions);\n\n\t\tthis._view = {\n\t\t\ttoolbar,\n\t\t\tdeleteToolbar\n\t\t};\n\n\t\treturn this._view;\n\t}\n\n\toverride prepareRenderCell(element: ICellViewModel): void {\n\t\tthis._initializeModel();\n\t}\n\n\toverride didRenderCell(element: ICellViewModel): void {\n\t\tconst model = this._initializeModel();\n\t\tconst view = this._initialize(model, element);\n\t\tthis.cellDisposables.add(registerCellToolbarStickyScroll(this._notebookEditor, element, this.toolbarContainer, { extraOffset: 4, min: -14 }));\n\n\t\tthis.updateContext(view, <INotebookCellActionContext>{\n\t\t\tui: true,\n\t\t\tcell: element,\n\t\t\tnotebookEditor: this._notebookEditor,\n\t\t\t$mid: MarshalledId.NotebookCellActionContext\n\t\t});\n\t}\n\n\tprivate updateContext(view: CellTitleToolbarView, toolbarContext: INotebookCellActionContext) {\n\t\tview.toolbar.context = toolbarContext;\n\t\tview.deleteToolbar.context = toolbarContext;\n\t}\n\n\tprivate setupChangeListeners(toolbar: ToolBar, menu: IMenu, initActions: { primary: IAction[]; secondary: IAction[] }): void {\n\t\t// #103926\n\t\tlet dropdownIsVisible = false;\n\t\tlet deferredUpdate: (() => void) | undefined;\n\n\t\tthis.updateActions(toolbar, initActions);\n\t\tthis._register(menu.onDidChange(() => {\n\t\t\tif (dropdownIsVisible) {\n\t\t\t\tconst actions = getCellToolbarActions(menu);\n\t\t\t\tdeferredUpdate = () => this.updateActions(toolbar, actions);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst actions = getCellToolbarActions(menu);\n\t\t\tthis.updateActions(toolbar, actions);\n\t\t}));\n\t\tthis._rootClassDelegate.toggle('cell-toolbar-dropdown-active', false);\n\t\tthis._register(toolbar.onDidChangeDropdownVisibility(visible => {\n\t\t\tdropdownIsVisible = visible;\n\t\t\tthis._rootClassDelegate.toggle('cell-toolbar-dropdown-active', visible);\n\n\t\t\tif (deferredUpdate && !visible) {\n\t\t\t\tthis._register(disposableTimeout(() => {\n\t\t\t\t\tdeferredUpdate?.();\n\t\t\t\t}));\n\n\t\t\t\tdeferredUpdate = undefined;\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate updateActions(toolbar: ToolBar, actions: { primary: IAction[]; secondary: IAction[] }) {\n\t\tconst hadFocus = DOM.isAncestor(document.activeElement, toolbar.getElement());\n\t\ttoolbar.setActions(actions.primary, actions.secondary);\n\t\tif (hadFocus) {\n\t\t\tthis._notebookEditor.focus();\n\t\t}\n\n\t\tif (actions.primary.length || actions.secondary.length) {\n\t\t\tthis._rootClassDelegate.toggle('cell-has-toolbar-actions', true);\n\t\t\tthis._onDidUpdateActions.fire();\n\t\t} else {\n\t\t\tthis._rootClassDelegate.toggle('cell-has-toolbar-actions', false);\n\t\t\tthis._onDidUpdateActions.fire();\n\t\t}\n\t}\n}\n\nfunction getCellToolbarActions(menu: IMenu): { primary: IAction[]; secondary: IAction[] } {\n\tconst primary: IAction[] = [];\n\tconst secondary: IAction[] = [];\n\tconst result = { primary, secondary };\n\n\tcreateAndFillInActionBarActions(menu, { shouldForwardArgs: true }, result, g => /^inline/.test(g));\n\n\treturn result;\n}\n\nfunction createDeleteToolbar(accessor: ServicesAccessor, container: HTMLElement, elementClass?: string): ToolBar {\n\tconst contextMenuService = accessor.get(IContextMenuService);\n\tconst keybindingService = accessor.get(IKeybindingService);\n\tconst instantiationService = accessor.get(IInstantiationService);\n\tconst toolbar = new ToolBar(container, contextMenuService, {\n\t\tgetKeyBinding: action => keybindingService.lookupKeybinding(action.id),\n\t\tactionViewItemProvider: action => {\n\t\t\treturn createActionViewItem(instantiationService, action);\n\t\t},\n\t\trenderDropdownAsChildElement: true\n\t});\n\n\tif (elementClass) {\n\t\ttoolbar.getElement().classList.add(elementClass);\n\t}\n\n\treturn toolbar;\n}\n"]}