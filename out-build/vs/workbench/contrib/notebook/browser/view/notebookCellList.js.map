{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/browser/view/notebookCellList.ts"],"names":[],"mappings":"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","file":"notebookCellList.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from 'vs/base/browser/dom';\nimport { IMouseWheelEvent } from 'vs/base/browser/mouseEvent';\nimport { IListRenderer, IListVirtualDelegate, ListError } from 'vs/base/browser/ui/list/list';\nimport { IListStyles, IStyleController } from 'vs/base/browser/ui/list/listWidget';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable, DisposableStore, IDisposable, MutableDisposable } from 'vs/base/common/lifecycle';\nimport { isMacintosh } from 'vs/base/common/platform';\nimport { ScrollEvent } from 'vs/base/common/scrollable';\nimport { Range } from 'vs/editor/common/core/range';\nimport { Selection } from 'vs/editor/common/core/selection';\nimport { TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { PrefixSumComputer } from 'vs/editor/common/model/prefixSumComputer';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IListService, IWorkbenchListOptions, WorkbenchList } from 'vs/platform/list/browser/listService';\nimport { CursorAtBoundary, ICellViewModel, CellEditState, CellFocusMode, ICellOutputViewModel, CellRevealType, CellRevealSyncType, CellRevealRangeType, CursorAtLineBoundary } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { CellViewModel, NotebookViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookViewModelImpl';\nimport { diff, NOTEBOOK_EDITOR_CURSOR_BOUNDARY, CellKind, SelectionStateType, NOTEBOOK_EDITOR_CURSOR_LINE_BOUNDARY } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ICellRange, cellRangesToIndexes, reduceCellRanges, cellRangesEqual } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { NOTEBOOK_CELL_LIST_FOCUSED } from 'vs/workbench/contrib/notebook/common/notebookContextKeys';\nimport { clamp } from 'vs/base/common/numbers';\nimport { ISplice } from 'vs/base/common/sequence';\nimport { BaseCellRenderTemplate, INotebookCellList } from 'vs/workbench/contrib/notebook/browser/view/notebookRenderingCommon';\nimport { FastDomNode } from 'vs/base/browser/fastDomNode';\nimport { MarkupCellViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/markupCellViewModel';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IListViewOptions, IListView } from 'vs/base/browser/ui/list/listView';\nimport { NotebookCellListView } from 'vs/workbench/contrib/notebook/browser/view/notebookCellListView';\nimport { NotebookOptions } from 'vs/workbench/contrib/notebook/browser/notebookOptions';\n\nconst enum CellEditorRevealType {\n\tLine,\n\tRange\n}\n\nconst enum CellRevealPosition {\n\tTop,\n\tCenter,\n\tBottom,\n\tNearTop\n}\n\nfunction getVisibleCells(cells: CellViewModel[], hiddenRanges: ICellRange[]) {\n\tif (!hiddenRanges.length) {\n\t\treturn cells;\n\t}\n\n\tlet start = 0;\n\tlet hiddenRangeIndex = 0;\n\tconst result: CellViewModel[] = [];\n\n\twhile (start < cells.length && hiddenRangeIndex < hiddenRanges.length) {\n\t\tif (start < hiddenRanges[hiddenRangeIndex].start) {\n\t\t\tresult.push(...cells.slice(start, hiddenRanges[hiddenRangeIndex].start));\n\t\t}\n\n\t\tstart = hiddenRanges[hiddenRangeIndex].end + 1;\n\t\thiddenRangeIndex++;\n\t}\n\n\tif (start < cells.length) {\n\t\tresult.push(...cells.slice(start));\n\t}\n\n\treturn result;\n}\n\nexport const NOTEBOOK_WEBVIEW_BOUNDARY = 5000;\n\nfunction validateWebviewBoundary(element: HTMLElement) {\n\tconst webviewTop = 0 - (parseInt(element.style.top, 10) || 0);\n\treturn webviewTop >= 0 && webviewTop <= NOTEBOOK_WEBVIEW_BOUNDARY * 2;\n}\n\nexport class NotebookCellList extends WorkbenchList<CellViewModel> implements IDisposable, IStyleController, INotebookCellList {\n\tprotected override readonly view!: NotebookCellListView<CellViewModel>;\n\tget onWillScroll(): Event<ScrollEvent> { return this.view.onWillScroll; }\n\n\tget rowsContainer(): HTMLElement {\n\t\treturn this.view.containerDomNode;\n\t}\n\n\tget scrollableElement(): HTMLElement {\n\t\treturn this.view.scrollableElementDomNode;\n\t}\n\tprivate _previousFocusedElements: readonly CellViewModel[] = [];\n\tprivate readonly _localDisposableStore = new DisposableStore();\n\tprivate readonly _viewModelStore = new DisposableStore();\n\tprivate styleElement?: HTMLStyleElement;\n\n\tprivate readonly _onDidRemoveOutputs = this._localDisposableStore.add(new Emitter<readonly ICellOutputViewModel[]>());\n\treadonly onDidRemoveOutputs = this._onDidRemoveOutputs.event;\n\n\tprivate readonly _onDidHideOutputs = this._localDisposableStore.add(new Emitter<readonly ICellOutputViewModel[]>());\n\treadonly onDidHideOutputs = this._onDidHideOutputs.event;\n\n\tprivate readonly _onDidRemoveCellsFromView = this._localDisposableStore.add(new Emitter<readonly ICellViewModel[]>());\n\treadonly onDidRemoveCellsFromView = this._onDidRemoveCellsFromView.event;\n\n\tprivate _viewModel: NotebookViewModel | null = null;\n\tget viewModel(): NotebookViewModel | null {\n\t\treturn this._viewModel;\n\t}\n\tprivate _hiddenRangeIds: string[] = [];\n\tprivate hiddenRangesPrefixSum: PrefixSumComputer | null = null;\n\n\tprivate readonly _onDidChangeVisibleRanges = this._localDisposableStore.add(new Emitter<void>());\n\n\tonDidChangeVisibleRanges: Event<void> = this._onDidChangeVisibleRanges.event;\n\tprivate _visibleRanges: ICellRange[] = [];\n\n\tget visibleRanges() {\n\t\treturn this._visibleRanges;\n\t}\n\n\tset visibleRanges(ranges: ICellRange[]) {\n\t\tif (cellRangesEqual(this._visibleRanges, ranges)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._visibleRanges = ranges;\n\t\tthis._onDidChangeVisibleRanges.fire();\n\t}\n\n\tprivate _isDisposed = false;\n\n\tget isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n\n\tprivate _isInLayout: boolean = false;\n\n\tprivate _webviewElement: FastDomNode<HTMLElement> | null = null;\n\n\tget webviewElement() {\n\t\treturn this._webviewElement;\n\t}\n\n\tget inRenderingTransaction() {\n\t\treturn this.view.inRenderingTransaction;\n\t}\n\n\tconstructor(\n\t\tprivate listUser: string,\n\t\tcontainer: HTMLElement,\n\t\tprivate readonly notebookOptions: NotebookOptions,\n\t\tdelegate: IListVirtualDelegate<CellViewModel>,\n\t\trenderers: IListRenderer<CellViewModel, BaseCellRenderTemplate>[],\n\t\tcontextKeyService: IContextKeyService,\n\t\toptions: IWorkbenchListOptions<CellViewModel>,\n\t\t@IListService listService: IListService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService\n\t) {\n\t\tsuper(listUser, container, delegate, renderers, options, contextKeyService, listService, configurationService, instantiationService);\n\t\tNOTEBOOK_CELL_LIST_FOCUSED.bindTo(this.contextKeyService).set(true);\n\t\tthis._previousFocusedElements = this.getFocusedElements();\n\t\tthis._localDisposableStore.add(this.onDidChangeFocus((e) => {\n\t\t\tthis._previousFocusedElements.forEach(element => {\n\t\t\t\tif (e.elements.indexOf(element) < 0) {\n\t\t\t\t\telement.onDeselect();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._previousFocusedElements = e.elements;\n\t\t}));\n\n\t\tconst notebookEditorCursorAtBoundaryContext = NOTEBOOK_EDITOR_CURSOR_BOUNDARY.bindTo(contextKeyService);\n\t\tnotebookEditorCursorAtBoundaryContext.set('none');\n\n\t\tconst notebookEditorCursorAtLineBoundaryContext = NOTEBOOK_EDITOR_CURSOR_LINE_BOUNDARY.bindTo(contextKeyService);\n\t\tnotebookEditorCursorAtLineBoundaryContext.set('none');\n\n\t\tconst cursorSelectionListener = this._localDisposableStore.add(new MutableDisposable());\n\t\tconst textEditorAttachListener = this._localDisposableStore.add(new MutableDisposable());\n\n\t\tconst recomputeContext = (element: CellViewModel) => {\n\t\t\tswitch (element.cursorAtBoundary()) {\n\t\t\t\tcase CursorAtBoundary.Both:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('both');\n\t\t\t\t\tbreak;\n\t\t\t\tcase CursorAtBoundary.Top:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('top');\n\t\t\t\t\tbreak;\n\t\t\t\tcase CursorAtBoundary.Bottom:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('bottom');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('none');\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tswitch (element.cursorAtLineBoundary()) {\n\t\t\t\tcase CursorAtLineBoundary.Both:\n\t\t\t\t\tnotebookEditorCursorAtLineBoundaryContext.set('both');\n\t\t\t\t\tbreak;\n\t\t\t\tcase CursorAtLineBoundary.Start:\n\t\t\t\t\tnotebookEditorCursorAtLineBoundaryContext.set('start');\n\t\t\t\t\tbreak;\n\t\t\t\tcase CursorAtLineBoundary.End:\n\t\t\t\t\tnotebookEditorCursorAtLineBoundaryContext.set('end');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnotebookEditorCursorAtLineBoundaryContext.set('none');\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn;\n\t\t};\n\n\t\t// Cursor Boundary context\n\t\tthis._localDisposableStore.add(this.onDidChangeFocus((e) => {\n\t\t\tif (e.elements.length) {\n\t\t\t\t// we only validate the first focused element\n\t\t\t\tconst focusedElement = e.elements[0];\n\n\t\t\t\tcursorSelectionListener.value = focusedElement.onDidChangeState((e) => {\n\t\t\t\t\tif (e.selectionChanged) {\n\t\t\t\t\t\trecomputeContext(focusedElement);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\ttextEditorAttachListener.value = focusedElement.onDidChangeEditorAttachState(() => {\n\t\t\t\t\tif (focusedElement.editorAttached) {\n\t\t\t\t\t\trecomputeContext(focusedElement);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trecomputeContext(focusedElement);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// reset context\n\t\t\tnotebookEditorCursorAtBoundaryContext.set('none');\n\t\t}));\n\n\t\tthis._localDisposableStore.add(this.view.onMouseDblClick(() => {\n\t\t\tconst focus = this.getFocusedElements()[0];\n\n\t\t\tif (focus && focus.cellKind === CellKind.Markup && !focus.isInputCollapsed && !this._viewModel?.options.isReadOnly) {\n\t\t\t\t// scroll the cell into view if out of viewport\n\t\t\t\tconst focusedCellIndex = this._getViewIndexUpperBound(focus);\n\n\t\t\t\tif (focusedCellIndex >= 0) {\n\t\t\t\t\tthis._revealInViewWithMinimalScrolling(focusedCellIndex);\n\t\t\t\t}\n\t\t\t\tfocus.updateEditState(CellEditState.Editing, 'dbclick');\n\t\t\t\tfocus.focusMode = CellFocusMode.Editor;\n\t\t\t}\n\t\t}));\n\n\t\t// update visibleRanges\n\t\tconst updateVisibleRanges = () => {\n\t\t\tif (!this.view.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst top = this.getViewScrollTop();\n\t\t\tconst bottom = this.getViewScrollBottom();\n\t\t\tif (top >= bottom) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst topViewIndex = clamp(this.view.indexAt(top), 0, this.view.length - 1);\n\t\t\tconst topElement = this.view.element(topViewIndex);\n\t\t\tconst topModelIndex = this._viewModel!.getCellIndex(topElement);\n\t\t\tconst bottomViewIndex = clamp(this.view.indexAt(bottom), 0, this.view.length - 1);\n\t\t\tconst bottomElement = this.view.element(bottomViewIndex);\n\t\t\tconst bottomModelIndex = this._viewModel!.getCellIndex(bottomElement);\n\n\t\t\tif (bottomModelIndex - topModelIndex === bottomViewIndex - topViewIndex) {\n\t\t\t\tthis.visibleRanges = [{ start: topModelIndex, end: bottomModelIndex + 1 }];\n\t\t\t} else {\n\t\t\t\tthis.visibleRanges = this._getVisibleRangesFromIndex(topViewIndex, topModelIndex, bottomViewIndex, bottomModelIndex);\n\t\t\t}\n\t\t};\n\n\t\tthis._localDisposableStore.add(this.view.onDidChangeContentHeight(() => {\n\t\t\tif (this._isInLayout) {\n\t\t\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\t\tupdateVisibleRanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\tupdateVisibleRanges();\n\t\t}));\n\t\tthis._localDisposableStore.add(this.view.onDidScroll(() => {\n\t\t\tif (this._isInLayout) {\n\t\t\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\t\tupdateVisibleRanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\tupdateVisibleRanges();\n\t\t}));\n\t}\n\n\tprotected override createListView(container: HTMLElement, virtualDelegate: IListVirtualDelegate<CellViewModel>, renderers: IListRenderer<any, any>[], viewOptions: IListViewOptions<CellViewModel>): IListView<CellViewModel> {\n\t\treturn new NotebookCellListView(container, virtualDelegate, renderers, viewOptions);\n\t}\n\n\tattachWebview(element: HTMLElement) {\n\t\telement.style.top = `-${NOTEBOOK_WEBVIEW_BOUNDARY}px`;\n\t\tthis.rowsContainer.insertAdjacentElement('afterbegin', element);\n\t\tthis._webviewElement = new FastDomNode<HTMLElement>(element);\n\t}\n\n\telementAt(position: number): ICellViewModel | undefined {\n\t\tif (!this.view.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst idx = this.view.indexAt(position);\n\t\tconst clamped = clamp(idx, 0, this.view.length - 1);\n\t\treturn this.element(clamped);\n\t}\n\n\telementHeight(element: ICellViewModel): number {\n\t\tconst index = this._getViewIndexUpperBound(element);\n\t\tif (index === undefined || index < 0 || index >= this.length) {\n\t\t\tthis._getViewIndexUpperBound(element);\n\t\t\tthrow new ListError(this.listUser, `Invalid index ${index}`);\n\t\t}\n\n\t\treturn this.view.elementHeight(index);\n\t}\n\n\tdetachViewModel() {\n\t\tthis._viewModelStore.clear();\n\t\tthis._viewModel = null;\n\t\tthis.hiddenRangesPrefixSum = null;\n\t}\n\n\tattachViewModel(model: NotebookViewModel) {\n\t\tthis._viewModel = model;\n\t\tthis._viewModelStore.add(model.onDidChangeViewCells((e) => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentRanges = this._hiddenRangeIds.map(id => this._viewModel!.getTrackedRange(id)).filter(range => range !== null) as ICellRange[];\n\t\t\tconst newVisibleViewCells: CellViewModel[] = getVisibleCells(this._viewModel!.viewCells as CellViewModel[], currentRanges);\n\n\t\t\tconst oldVisibleViewCells: CellViewModel[] = [];\n\t\t\tconst oldViewCellMapping = new Set<string>();\n\t\t\tfor (let i = 0; i < this.length; i++) {\n\t\t\t\toldVisibleViewCells.push(this.element(i));\n\t\t\t\toldViewCellMapping.add(this.element(i).uri.toString());\n\t\t\t}\n\n\t\t\tconst viewDiffs = diff<CellViewModel>(oldVisibleViewCells, newVisibleViewCells, a => {\n\t\t\t\treturn oldViewCellMapping.has(a.uri.toString());\n\t\t\t});\n\n\t\t\tif (e.synchronous) {\n\t\t\t\tthis._updateElementsInWebview(viewDiffs);\n\t\t\t} else {\n\t\t\t\tthis._viewModelStore.add(DOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._updateElementsInWebview(viewDiffs);\n\t\t\t\t}));\n\t\t\t}\n\t\t}));\n\n\t\tthis._viewModelStore.add(model.onDidChangeSelection((e) => {\n\t\t\tif (e === 'view') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// convert model selections to view selections\n\t\t\tconst viewSelections = cellRangesToIndexes(model.getSelections()).map(index => model.cellAt(index)).filter(cell => !!cell).map(cell => this._getViewIndexUpperBound(cell!));\n\t\t\tthis.setSelection(viewSelections, undefined, true);\n\t\t\tconst primary = cellRangesToIndexes([model.getFocus()]).map(index => model.cellAt(index)).filter(cell => !!cell).map(cell => this._getViewIndexUpperBound(cell!));\n\n\t\t\tif (primary.length) {\n\t\t\t\tthis.setFocus(primary, undefined, true);\n\t\t\t}\n\t\t}));\n\n\t\tconst hiddenRanges = model.getHiddenRanges();\n\t\tthis.setHiddenAreas(hiddenRanges, false);\n\t\tconst newRanges = reduceCellRanges(hiddenRanges);\n\t\tconst viewCells = model.viewCells.slice(0) as CellViewModel[];\n\t\tnewRanges.reverse().forEach(range => {\n\t\t\tconst removedCells = viewCells.splice(range.start, range.end - range.start + 1);\n\t\t\tthis._onDidRemoveCellsFromView.fire(removedCells);\n\t\t});\n\n\t\tthis.splice2(0, 0, viewCells);\n\t}\n\n\tprivate _updateElementsInWebview(viewDiffs: ISplice<CellViewModel>[]) {\n\t\tviewDiffs.reverse().forEach((diff) => {\n\t\t\tconst hiddenOutputs: ICellOutputViewModel[] = [];\n\t\t\tconst deletedOutputs: ICellOutputViewModel[] = [];\n\t\t\tconst removedMarkdownCells: ICellViewModel[] = [];\n\n\t\t\tfor (let i = diff.start; i < diff.start + diff.deleteCount; i++) {\n\t\t\t\tconst cell = this.element(i);\n\t\t\t\tif (cell.cellKind === CellKind.Code) {\n\t\t\t\t\tif (this._viewModel!.hasCell(cell)) {\n\t\t\t\t\t\thiddenOutputs.push(...cell?.outputsViewModels);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeletedOutputs.push(...cell?.outputsViewModels);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tremovedMarkdownCells.push(cell);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.splice2(diff.start, diff.deleteCount, diff.toInsert);\n\n\t\t\tthis._onDidHideOutputs.fire(hiddenOutputs);\n\t\t\tthis._onDidRemoveOutputs.fire(deletedOutputs);\n\t\t\tthis._onDidRemoveCellsFromView.fire(removedMarkdownCells);\n\t\t});\n\t}\n\n\tclear() {\n\t\tsuper.splice(0, this.length);\n\t}\n\n\tsetHiddenAreas(_ranges: ICellRange[], triggerViewUpdate: boolean): boolean {\n\t\tif (!this._viewModel) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newRanges = reduceCellRanges(_ranges);\n\t\t// delete old tracking ranges\n\t\tconst oldRanges = this._hiddenRangeIds.map(id => this._viewModel!.getTrackedRange(id)).filter(range => range !== null) as ICellRange[];\n\t\tif (newRanges.length === oldRanges.length) {\n\t\t\tlet hasDifference = false;\n\t\t\tfor (let i = 0; i < newRanges.length; i++) {\n\t\t\t\tif (!(newRanges[i].start === oldRanges[i].start && newRanges[i].end === oldRanges[i].end)) {\n\t\t\t\t\thasDifference = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!hasDifference) {\n\t\t\t\t// they call 'setHiddenAreas' for a reason, even if the ranges are still the same, it's possible that the hiddenRangeSum is not update to date\n\t\t\t\tthis._updateHiddenRangePrefixSum(newRanges);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tthis._hiddenRangeIds.forEach(id => this._viewModel!.setTrackedRange(id, null, TrackedRangeStickiness.GrowsOnlyWhenTypingAfter));\n\t\tconst hiddenAreaIds = newRanges.map(range => this._viewModel!.setTrackedRange(null, range, TrackedRangeStickiness.GrowsOnlyWhenTypingAfter)).filter(id => id !== null) as string[];\n\n\t\tthis._hiddenRangeIds = hiddenAreaIds;\n\n\t\t// set hidden ranges prefix sum\n\t\tthis._updateHiddenRangePrefixSum(newRanges);\n\n\t\tif (triggerViewUpdate) {\n\t\t\tthis.updateHiddenAreasInView(oldRanges, newRanges);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate _updateHiddenRangePrefixSum(newRanges: ICellRange[]) {\n\t\tlet start = 0;\n\t\tlet index = 0;\n\t\tconst ret: number[] = [];\n\n\t\twhile (index < newRanges.length) {\n\t\t\tfor (let j = start; j < newRanges[index].start - 1; j++) {\n\t\t\t\tret.push(1);\n\t\t\t}\n\n\t\t\tret.push(newRanges[index].end - newRanges[index].start + 1 + 1);\n\t\t\tstart = newRanges[index].end + 1;\n\t\t\tindex++;\n\t\t}\n\n\t\tfor (let i = start; i < this._viewModel!.length; i++) {\n\t\t\tret.push(1);\n\t\t}\n\n\t\tconst values = new Uint32Array(ret.length);\n\t\tfor (let i = 0; i < ret.length; i++) {\n\t\t\tvalues[i] = ret[i];\n\t\t}\n\n\t\tthis.hiddenRangesPrefixSum = new PrefixSumComputer(values);\n\t}\n\n\t/**\n\t * oldRanges and newRanges are all reduced and sorted.\n\t */\n\tupdateHiddenAreasInView(oldRanges: ICellRange[], newRanges: ICellRange[]) {\n\t\tconst oldViewCellEntries: CellViewModel[] = getVisibleCells(this._viewModel!.viewCells as CellViewModel[], oldRanges);\n\t\tconst oldViewCellMapping = new Set<string>();\n\t\toldViewCellEntries.forEach(cell => {\n\t\t\toldViewCellMapping.add(cell.uri.toString());\n\t\t});\n\n\t\tconst newViewCellEntries: CellViewModel[] = getVisibleCells(this._viewModel!.viewCells as CellViewModel[], newRanges);\n\n\t\tconst viewDiffs = diff<CellViewModel>(oldViewCellEntries, newViewCellEntries, a => {\n\t\t\treturn oldViewCellMapping.has(a.uri.toString());\n\t\t});\n\n\t\tthis._updateElementsInWebview(viewDiffs);\n\t}\n\n\tsplice2(start: number, deleteCount: number, elements: readonly CellViewModel[] = []): void {\n\t\t// we need to convert start and delete count based on hidden ranges\n\t\tif (start < 0 || start > this.view.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusInside = DOM.isAncestor(document.activeElement, this.rowsContainer);\n\t\tsuper.splice(start, deleteCount, elements);\n\t\tif (focusInside) {\n\t\t\tthis.domFocus();\n\t\t}\n\n\t\tconst selectionsLeft = [];\n\t\tthis.getSelectedElements().forEach(el => {\n\t\t\tif (this._viewModel!.hasCell(el)) {\n\t\t\t\tselectionsLeft.push(el.handle);\n\t\t\t}\n\t\t});\n\n\t\tif (!selectionsLeft.length && this._viewModel!.viewCells.length) {\n\t\t\t// after splice, the selected cells are deleted\n\t\t\tthis._viewModel!.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 0, end: 1 }, selections: [{ start: 0, end: 1 }] });\n\t\t}\n\t}\n\n\tgetModelIndex(cell: CellViewModel): number | undefined {\n\t\tconst viewIndex = this.indexOf(cell);\n\t\treturn this.getModelIndex2(viewIndex);\n\t}\n\n\tgetModelIndex2(viewIndex: number): number | undefined {\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn viewIndex;\n\t\t}\n\n\t\tconst modelIndex = this.hiddenRangesPrefixSum.getPrefixSum(viewIndex - 1);\n\t\treturn modelIndex;\n\t}\n\n\tgetViewIndex(cell: ICellViewModel) {\n\t\tconst modelIndex = this._viewModel!.getCellIndex(cell);\n\t\treturn this.getViewIndex2(modelIndex);\n\t}\n\n\tgetViewIndex2(modelIndex: number): number | undefined {\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn modelIndex;\n\t\t}\n\n\t\tconst viewIndexInfo = this.hiddenRangesPrefixSum.getIndexOf(modelIndex);\n\n\t\tif (viewIndexInfo.remainder !== 0) {\n\t\t\tif (modelIndex >= this.hiddenRangesPrefixSum.getTotalSum()) {\n\t\t\t\t// it's already after the last hidden range\n\t\t\t\treturn modelIndex - (this.hiddenRangesPrefixSum.getTotalSum() - this.hiddenRangesPrefixSum.getCount());\n\t\t\t}\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\treturn viewIndexInfo.index;\n\t\t}\n\t}\n\n\tprivate _getVisibleRangesFromIndex(topViewIndex: number, topModelIndex: number, bottomViewIndex: number, bottomModelIndex: number) {\n\t\tconst stack: number[] = [];\n\t\tconst ranges: ICellRange[] = [];\n\t\t// there are hidden ranges\n\t\tlet index = topViewIndex;\n\t\tlet modelIndex = topModelIndex;\n\n\t\twhile (index <= bottomViewIndex) {\n\t\t\tconst accu = this.hiddenRangesPrefixSum!.getPrefixSum(index);\n\t\t\tif (accu === modelIndex + 1) {\n\t\t\t\t// no hidden area after it\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tif (stack[stack.length - 1] === modelIndex - 1) {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: modelIndex + 1 });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: stack[stack.length - 1] + 1 });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstack.push(modelIndex);\n\t\t\t\tindex++;\n\t\t\t\tmodelIndex++;\n\t\t\t} else {\n\t\t\t\t// there are hidden ranges after it\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tif (stack[stack.length - 1] === modelIndex - 1) {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: modelIndex + 1 });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: stack[stack.length - 1] + 1 });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstack.push(modelIndex);\n\t\t\t\tindex++;\n\t\t\t\tmodelIndex = accu;\n\t\t\t}\n\t\t}\n\n\t\tif (stack.length) {\n\t\t\tranges.push({ start: stack[stack.length - 1], end: stack[stack.length - 1] + 1 });\n\t\t}\n\n\t\treturn reduceCellRanges(ranges);\n\t}\n\n\tgetVisibleRangesPlusViewportAboveAndBelow() {\n\t\tif (this.view.length <= 0) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst top = Math.max(this.getViewScrollTop() - this.renderHeight, 0);\n\t\tconst topViewIndex = this.view.indexAt(top);\n\t\tconst topElement = this.view.element(topViewIndex);\n\t\tconst topModelIndex = this._viewModel!.getCellIndex(topElement);\n\t\tconst bottom = clamp(this.getViewScrollBottom() + this.renderHeight, 0, this.scrollHeight);\n\t\tconst bottomViewIndex = clamp(this.view.indexAt(bottom), 0, this.view.length - 1);\n\t\tconst bottomElement = this.view.element(bottomViewIndex);\n\t\tconst bottomModelIndex = this._viewModel!.getCellIndex(bottomElement);\n\n\t\tif (bottomModelIndex - topModelIndex === bottomViewIndex - topViewIndex) {\n\t\t\treturn [{ start: topModelIndex, end: bottomModelIndex }];\n\t\t} else {\n\t\t\treturn this._getVisibleRangesFromIndex(topViewIndex, topModelIndex, bottomViewIndex, bottomModelIndex);\n\t\t}\n\t}\n\n\tprivate _getViewIndexUpperBound(cell: ICellViewModel): number {\n\t\tif (!this._viewModel) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tconst modelIndex = this._viewModel.getCellIndex(cell);\n\t\tif (modelIndex === -1) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn modelIndex;\n\t\t}\n\n\t\tconst viewIndexInfo = this.hiddenRangesPrefixSum.getIndexOf(modelIndex);\n\n\t\tif (viewIndexInfo.remainder !== 0) {\n\t\t\tif (modelIndex >= this.hiddenRangesPrefixSum.getTotalSum()) {\n\t\t\t\treturn modelIndex - (this.hiddenRangesPrefixSum.getTotalSum() - this.hiddenRangesPrefixSum.getCount());\n\t\t\t}\n\t\t}\n\n\t\treturn viewIndexInfo.index;\n\t}\n\n\tprivate _getViewIndexUpperBound2(modelIndex: number) {\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn modelIndex;\n\t\t}\n\n\t\tconst viewIndexInfo = this.hiddenRangesPrefixSum.getIndexOf(modelIndex);\n\n\t\tif (viewIndexInfo.remainder !== 0) {\n\t\t\tif (modelIndex >= this.hiddenRangesPrefixSum.getTotalSum()) {\n\t\t\t\treturn modelIndex - (this.hiddenRangesPrefixSum.getTotalSum() - this.hiddenRangesPrefixSum.getCount());\n\t\t\t}\n\t\t}\n\n\t\treturn viewIndexInfo.index;\n\t}\n\n\tfocusElement(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0 && this._viewModel) {\n\t\t\t// update view model first, which will update both `focus` and `selection` in a single transaction\n\t\t\tconst focusedElementHandle = this.element(index).handle;\n\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\tprimary: focusedElementHandle,\n\t\t\t\tselections: [focusedElementHandle]\n\t\t\t}, 'view');\n\n\t\t\t// update the view as previous model update will not trigger event\n\t\t\tthis.setFocus([index], undefined, false);\n\t\t}\n\t}\n\n\tselectElements(elements: ICellViewModel[]) {\n\t\tconst indices = elements.map(cell => this._getViewIndexUpperBound(cell)).filter(index => index >= 0);\n\t\tthis.setSelection(indices);\n\t}\n\n\tgetCellViewScrollTop(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\t\tif (index === undefined || index < 0 || index >= this.length) {\n\t\t\tthrow new ListError(this.listUser, `Invalid index ${index}`);\n\t\t}\n\n\t\treturn this.view.elementTop(index);\n\t}\n\n\tgetCellViewScrollBottom(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\t\tif (index === undefined || index < 0 || index >= this.length) {\n\t\t\tthrow new ListError(this.listUser, `Invalid index ${index}`);\n\t\t}\n\n\t\tconst top = this.view.elementTop(index);\n\t\tconst height = this.view.elementHeight(index);\n\t\treturn top + height;\n\t}\n\n\toverride setFocus(indexes: number[], browserEvent?: UIEvent, ignoreTextModelUpdate?: boolean): void {\n\t\tif (ignoreTextModelUpdate) {\n\t\t\tsuper.setFocus(indexes, browserEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!indexes.length) {\n\t\t\tif (this._viewModel) {\n\t\t\t\tif (this.length) {\n\t\t\t\t\t// Don't allow clearing focus, #121129\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: null,\n\t\t\t\t\tselections: []\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._viewModel) {\n\t\t\t\tconst focusedElementHandle = this.element(indexes[0]).handle;\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: focusedElementHandle,\n\t\t\t\t\tselections: this.getSelection().map(selection => this.element(selection).handle)\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t}\n\n\t\tsuper.setFocus(indexes, browserEvent);\n\t}\n\n\toverride setSelection(indexes: number[], browserEvent?: UIEvent | undefined, ignoreTextModelUpdate?: boolean) {\n\t\tif (ignoreTextModelUpdate) {\n\t\t\tsuper.setSelection(indexes, browserEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!indexes.length) {\n\t\t\tif (this._viewModel) {\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: this.getFocusedElements()[0]?.handle ?? null,\n\t\t\t\t\tselections: []\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._viewModel) {\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: this.getFocusedElements()[0]?.handle ?? null,\n\t\t\t\t\tselections: indexes.map(index => this.element(index)).map(cell => cell.handle)\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t}\n\n\t\tsuper.setSelection(indexes, browserEvent);\n\t}\n\n\t/**\n\t * The range will be revealed with as little scrolling as possible.\n\t */\n\trevealCellsInView(range: ICellRange) {\n\t\tconst startIndex = this._getViewIndexUpperBound2(range.start);\n\n\t\tif (startIndex < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst endIndex = this._getViewIndexUpperBound2(range.end - 1);\n\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(startIndex);\n\t\tif (elementTop >= scrollTop\n\t\t\t&& elementTop < wrapperBottom) {\n\t\t\t// start element is visible\n\t\t\t// check end\n\n\t\t\tconst endElementTop = this.view.elementTop(endIndex);\n\t\t\tconst endElementHeight = this.view.elementHeight(endIndex);\n\n\t\t\tif (endElementTop + endElementHeight <= wrapperBottom) {\n\t\t\t\t// fully visible\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (endElementTop >= wrapperBottom) {\n\t\t\t\treturn this._revealInternal(endIndex, false, CellRevealPosition.Bottom);\n\t\t\t}\n\n\t\t\tif (endElementTop < wrapperBottom) {\n\t\t\t\t// end element partially visible\n\t\t\t\tif (endElementTop + endElementHeight - wrapperBottom < elementTop - scrollTop) {\n\t\t\t\t\t// there is enough space to just scroll up a little bit to make the end element visible\n\t\t\t\t\treturn this.view.setScrollTop(scrollTop + endElementTop + endElementHeight - wrapperBottom);\n\t\t\t\t} else {\n\t\t\t\t\t// don't even try it\n\t\t\t\t\treturn this._revealInternal(startIndex, false, CellRevealPosition.Top);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._revealInViewWithMinimalScrolling(startIndex);\n\t}\n\n\tprivate _revealInViewWithMinimalScrolling(viewIndex: number, firstLine?: boolean) {\n\t\tconst firstIndex = this.view.firstVisibleIndex;\n\t\tif (viewIndex <= firstIndex) {\n\t\t\tthis._revealInternal(viewIndex, true, CellRevealPosition.Top, firstLine);\n\t\t} else {\n\t\t\tthis._revealInternal(viewIndex, true, CellRevealPosition.Bottom, firstLine);\n\t\t}\n\t}\n\n\tscrollToBottom() {\n\t\tconst scrollHeight = this.view.scrollHeight;\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\n\t\tthis.view.setScrollTop(scrollHeight - (wrapperBottom - scrollTop));\n\t}\n\n\t//#region Reveal Cell synchronously\n\trevealCell(cell: ICellViewModel, revealType: CellRevealSyncType) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (revealType) {\n\t\t\tcase CellRevealSyncType.Top:\n\t\t\t\tthis._revealInternal(index, false, CellRevealPosition.Top);\n\t\t\t\tbreak;\n\t\t\tcase CellRevealSyncType.Center:\n\t\t\t\tthis._revealInternal(index, false, CellRevealPosition.Center);\n\t\t\t\tbreak;\n\t\t\tcase CellRevealSyncType.CenterIfOutsideViewport:\n\t\t\t\tthis._revealInternal(index, true, CellRevealPosition.Center);\n\t\t\t\tbreak;\n\t\t\tcase CellRevealSyncType.FirstLineIfOutsideViewport:\n\t\t\t\tthis._revealInViewWithMinimalScrolling(index, true);\n\t\t\t\tbreak;\n\t\t\tcase CellRevealSyncType.Default:\n\t\t\t\tthis._revealInViewWithMinimalScrolling(index);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate _revealInternal(viewIndex: number, ignoreIfInsideViewport: boolean, revealPosition: CellRevealPosition, firstLine?: boolean) {\n\t\tif (viewIndex >= this.view.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst elementBottom = this.view.elementHeight(viewIndex) + elementTop;\n\n\t\tif (ignoreIfInsideViewport) {\n\t\t\tif (elementTop >= scrollTop && elementBottom < wrapperBottom) {\n\t\t\t\t// element is already fully visible\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tswitch (revealPosition) {\n\t\t\tcase CellRevealPosition.Top:\n\t\t\t\tthis.view.setScrollTop(elementTop);\n\t\t\t\tthis.view.setScrollTop(this.view.elementTop(viewIndex));\n\t\t\t\tbreak;\n\t\t\tcase CellRevealPosition.Center:\n\t\t\tcase CellRevealPosition.NearTop:\n\t\t\t\t{\n\t\t\t\t\t// reveal the cell top in the viewport center initially\n\t\t\t\t\tthis.view.setScrollTop(elementTop - this.view.renderHeight / 2);\n\t\t\t\t\t// cell rendered already, we now have a more accurate cell height\n\t\t\t\t\tconst newElementTop = this.view.elementTop(viewIndex);\n\t\t\t\t\tconst newElementHeight = this.view.elementHeight(viewIndex);\n\t\t\t\t\tconst renderHeight = this.getViewScrollBottom() - this.getViewScrollTop();\n\t\t\t\t\tif (newElementHeight >= renderHeight) {\n\t\t\t\t\t\t// cell is larger than viewport, reveal top\n\t\t\t\t\t\tthis.view.setScrollTop(newElementTop);\n\t\t\t\t\t} else if (revealPosition === CellRevealPosition.Center) {\n\t\t\t\t\t\tthis.view.setScrollTop(newElementTop + (newElementHeight / 2) - (renderHeight / 2));\n\t\t\t\t\t} else if (revealPosition === CellRevealPosition.NearTop) {\n\t\t\t\t\t\tthis.view.setScrollTop(newElementTop - (renderHeight / 5));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase CellRevealPosition.Bottom:\n\t\t\t\tif (firstLine) {\n\t\t\t\t\tconst lineHeight = this.viewModel?.layoutInfo?.fontInfo.lineHeight ?? 15;\n\t\t\t\t\tconst padding = this.notebookOptions.getLayoutConfiguration().cellTopMargin + this.notebookOptions.getLayoutConfiguration().editorTopPadding;\n\t\t\t\t\tconst firstLineLocation = elementTop + lineHeight + padding;\n\t\t\t\t\tif (firstLineLocation < wrapperBottom) {\n\t\t\t\t\t\t// first line is already visible\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.view.setScrollTop(this.scrollTop + (firstLineLocation - wrapperBottom));\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.view.setScrollTop(this.scrollTop + (elementBottom - wrapperBottom));\n\t\t\t\tthis.view.setScrollTop(this.scrollTop + (this.view.elementTop(viewIndex) + this.view.elementHeight(viewIndex) - this.getViewScrollBottom()));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region Reveal Cell asynchronously\n\tasync revealCellAsync(cell: ICellViewModel, revealType: CellRevealType) {\n\t\tconst viewIndex = this._getViewIndexUpperBound(cell);\n\n\t\tif (viewIndex < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst revealPosition = revealType === CellRevealType.NearTopIfOutsideViewport ? CellRevealPosition.NearTop : CellRevealPosition.Center;\n\t\tthis._revealInternal(viewIndex, true, revealPosition);\n\n\t\t// wait for the editor to be created only if the cell is in editing mode (meaning it has an editor and will focus the editor)\n\t\tif (cell.getEditState() === CellEditState.Editing && !cell.editorAttached) {\n\t\t\treturn getEditorAttachedPromise(cell);\n\t\t}\n\n\t\treturn;\n\t}\n\n\t//#endregion\n\n\t//#region Reveal Cell Editor Range asynchronously\n\tasync revealCellRangeAsync(cell: ICellViewModel, range: Selection | Range, revealType: CellRevealRangeType): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch (revealType) {\n\t\t\tcase CellRevealRangeType.Default:\n\t\t\t\treturn this._revealRangeInternalAsync(index, range, CellEditorRevealType.Range);\n\t\t\tcase CellRevealRangeType.Center:\n\t\t\t\treturn this._revealRangeInCenterInternalAsync(index, range, CellEditorRevealType.Range);\n\t\t\tcase CellRevealRangeType.CenterIfOutsideViewport:\n\t\t\t\treturn this._revealRangeInCenterIfOutsideViewportInternalAsync(index, range, CellEditorRevealType.Range);\n\t\t}\n\t}\n\n\t// List items have real dynamic heights, which means after we set `scrollTop` based on the `elementTop(index)`, the element at `index` might still be removed from the view once all relayouting tasks are done.\n\t// For example, we scroll item 10 into the view upwards, in the first round, items 7, 8, 9, 10 are all in the viewport. Then item 7 and 8 resize themselves to be larger and finally item 10 is removed from the view.\n\t// To ensure that item 10 is always there, we need to scroll item 10 to the top edge of the viewport.\n\tprivate async _revealRangeInternalAsync(viewIndex: number, range: Selection | Range, revealType: CellEditorRevealType): Promise<void> {\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst element = this.view.element(viewIndex);\n\n\t\tif (element.editorAttached) {\n\t\t\tthis._revealRangeCommon(viewIndex, range, revealType, false, false);\n\t\t} else {\n\t\t\tconst elementHeight = this.view.elementHeight(viewIndex);\n\t\t\tlet upwards = false;\n\n\t\t\tif (elementTop + elementHeight < scrollTop) {\n\t\t\t\t// scroll downwards\n\t\t\t\tthis.view.setScrollTop(elementTop);\n\t\t\t\tupwards = false;\n\t\t\t} else if (elementTop > wrapperBottom) {\n\t\t\t\t// scroll upwards\n\t\t\t\tthis.view.setScrollTop(elementTop - this.view.renderHeight / 2);\n\t\t\t\tupwards = true;\n\t\t\t}\n\n\t\t\tconst editorAttachedPromise = new Promise<void>((resolve, reject) => {\n\t\t\t\telement.onDidChangeEditorAttachState(() => {\n\t\t\t\t\telement.editorAttached ? resolve() : reject();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn editorAttachedPromise.then(() => {\n\t\t\t\tthis._revealRangeCommon(viewIndex, range, revealType, true, upwards);\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate async _revealRangeInCenterInternalAsync(viewIndex: number, range: Selection | Range, revealType: CellEditorRevealType): Promise<void> {\n\t\tconst reveal = (viewIndex: number, range: Range, revealType: CellEditorRevealType) => {\n\t\t\tconst element = this.view.element(viewIndex);\n\t\t\tconst positionOffset = element.getPositionScrollTopOffset(range);\n\t\t\tconst positionOffsetInView = this.view.elementTop(viewIndex) + positionOffset;\n\t\t\tthis.view.setScrollTop(positionOffsetInView - this.view.renderHeight / 2);\n\n\t\t\tif (revealType === CellEditorRevealType.Range) {\n\t\t\t\telement.revealRangeInCenter(range);\n\t\t\t}\n\t\t};\n\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst viewItemOffset = elementTop;\n\t\tthis.view.setScrollTop(viewItemOffset - this.view.renderHeight / 2);\n\t\tconst element = this.view.element(viewIndex);\n\n\t\tif (!element.editorAttached) {\n\t\t\treturn getEditorAttachedPromise(element).then(() => reveal(viewIndex, range, revealType));\n\t\t} else {\n\t\t\treveal(viewIndex, range, revealType);\n\t\t}\n\t}\n\n\tprivate async _revealRangeInCenterIfOutsideViewportInternalAsync(viewIndex: number, range: Selection | Range, revealType: CellEditorRevealType): Promise<void> {\n\t\tconst reveal = (viewIndex: number, range: Range, revealType: CellEditorRevealType) => {\n\t\t\tconst element = this.view.element(viewIndex);\n\t\t\tconst positionOffset = element.getPositionScrollTopOffset(range);\n\t\t\tconst positionOffsetInView = this.view.elementTop(viewIndex) + positionOffset;\n\t\t\tthis.view.setScrollTop(positionOffsetInView - this.view.renderHeight / 2);\n\n\t\t\tif (revealType === CellEditorRevealType.Range) {\n\t\t\t\telement.revealRangeInCenter(range);\n\t\t\t}\n\t\t};\n\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst viewItemOffset = elementTop;\n\t\tconst element = this.view.element(viewIndex);\n\t\tconst positionOffset = viewItemOffset + element.getPositionScrollTopOffset(range);\n\n\t\tif (positionOffset < scrollTop || positionOffset > wrapperBottom) {\n\t\t\t// let it render\n\t\t\tthis.view.setScrollTop(positionOffset - this.view.renderHeight / 2);\n\n\t\t\t// after rendering, it might be pushed down due to markdown cell dynamic height\n\t\t\tconst newPositionOffset = this.view.elementTop(viewIndex) + element.getPositionScrollTopOffset(range);\n\t\t\tthis.view.setScrollTop(newPositionOffset - this.view.renderHeight / 2);\n\n\t\t\t// reveal editor\n\t\t\tif (!element.editorAttached) {\n\t\t\t\treturn getEditorAttachedPromise(element).then(() => reveal(viewIndex, range, revealType));\n\t\t\t} else {\n\t\t\t\t// for example markdown\n\t\t\t}\n\t\t} else {\n\t\t\tif (element.editorAttached) {\n\t\t\t\telement.revealRangeInCenter(range);\n\t\t\t} else {\n\t\t\t\t// for example, markdown cell in preview mode\n\t\t\t\treturn getEditorAttachedPromise(element).then(() => reveal(viewIndex, range, revealType));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _revealRangeCommon(viewIndex: number, range: Selection | Range, revealType: CellEditorRevealType, newlyCreated: boolean, alignToBottom: boolean) {\n\t\tconst element = this.view.element(viewIndex);\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst positionOffset = element.getPositionScrollTopOffset(range);\n\t\tconst elementOriginalHeight = this.view.elementHeight(viewIndex);\n\t\tif (positionOffset >= elementOriginalHeight) {\n\t\t\t// we are revealing a range that is beyond current element height\n\t\t\t// if we don't update the element height now, and directly `setTop` to reveal the range\n\t\t\t// the element might be scrolled out of view\n\t\t\t// next frame, when we update the element height, the element will never be scrolled back into view\n\t\t\tconst newTotalHeight = element.layoutInfo.totalHeight;\n\t\t\tthis.updateElementHeight(viewIndex, newTotalHeight);\n\t\t}\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst positionTop = elementTop + positionOffset;\n\n\t\t// TODO@rebornix 30 ---> line height * 1.5\n\t\tif (positionTop < scrollTop) {\n\t\t\tthis.view.setScrollTop(positionTop - 30);\n\t\t} else if (positionTop > wrapperBottom) {\n\t\t\tthis.view.setScrollTop(scrollTop + positionTop - wrapperBottom + 30);\n\t\t} else if (newlyCreated) {\n\t\t\t// newly scrolled into view\n\t\t\tif (alignToBottom) {\n\t\t\t\t// align to the bottom\n\t\t\t\tthis.view.setScrollTop(scrollTop + positionTop - wrapperBottom + 30);\n\t\t\t} else {\n\t\t\t\t// align to to top\n\t\t\t\tthis.view.setScrollTop(positionTop - 30);\n\t\t\t}\n\t\t}\n\n\t\tif (revealType === CellEditorRevealType.Range) {\n\t\t\telement.revealRangeInCenter(range);\n\t\t}\n\t}\n\t//#endregion\n\n\t//#region Reveal Cell offset\n\tasync revealCellOffsetInCenterAsync(cell: ICellViewModel, offset: number): Promise<void> {\n\t\tconst viewIndex = this._getViewIndexUpperBound(cell);\n\n\t\tif (viewIndex >= 0) {\n\t\t\tconst element = this.view.element(viewIndex);\n\t\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\t\tif (element instanceof MarkupCellViewModel) {\n\t\t\t\treturn this._revealInCenterIfOutsideViewport(viewIndex);\n\t\t\t} else {\n\t\t\t\tconst rangeOffset = element.layoutInfo.outputContainerOffset + Math.min(offset, element.layoutInfo.outputTotalHeight);\n\t\t\t\tthis.view.setScrollTop(elementTop - this.view.renderHeight / 2);\n\t\t\t\tthis.view.setScrollTop(elementTop + rangeOffset - this.view.renderHeight / 2);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _revealInCenterIfOutsideViewport(viewIndex: number) {\n\t\tthis._revealInternal(viewIndex, true, CellRevealPosition.Center);\n\t}\n\n\t//#endregion\n\n\tdomElementOfElement(element: ICellViewModel): HTMLElement | null {\n\t\tconst index = this._getViewIndexUpperBound(element);\n\t\tif (index >= 0) {\n\t\t\treturn this.view.domElement(index);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfocusView() {\n\t\tthis.view.domNode.focus();\n\t}\n\n\ttriggerScrollFromMouseWheelEvent(browserEvent: IMouseWheelEvent) {\n\t\tthis.view.delegateScrollFromMouseWheelEvent(browserEvent);\n\t}\n\n\tdelegateVerticalScrollbarPointerDown(browserEvent: PointerEvent) {\n\t\tthis.view.delegateVerticalScrollbarPointerDown(browserEvent);\n\t}\n\n\tprivate isElementAboveViewport(index: number) {\n\t\tconst elementTop = this.view.elementTop(index);\n\t\tconst elementBottom = elementTop + this.view.elementHeight(index);\n\n\t\treturn elementBottom < this.scrollTop;\n\t}\n\n\tupdateElementHeight2(element: ICellViewModel, size: number, anchorElementIndex: number | null = null): void {\n\t\tconst index = this._getViewIndexUpperBound(element);\n\t\tif (index === undefined || index < 0 || index >= this.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isElementAboveViewport(index)) {\n\t\t\t// update element above viewport\n\t\t\tconst oldHeight = this.elementHeight(element);\n\t\t\tconst delta = oldHeight - size;\n\t\t\tif (this._webviewElement) {\n\t\t\t\tEvent.once(this.view.onWillScroll)(() => {\n\t\t\t\t\tconst webviewTop = parseInt(this._webviewElement!.domNode.style.top, 10);\n\t\t\t\t\tif (validateWebviewBoundary(this._webviewElement!.domNode)) {\n\t\t\t\t\t\tthis._webviewElement!.setTop(webviewTop - delta);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// When the webview top boundary is below the list view scrollable element top boundary, then we can't insert a markdown cell at the top\n\t\t\t\t\t\t// or when its bottom boundary is above the list view bottom boundary, then we can't insert a markdown cell at the end\n\t\t\t\t\t\t// thus we have to revert the webview element position to initial state `-NOTEBOOK_WEBVIEW_BOUNDARY`.\n\t\t\t\t\t\t// this will trigger one visual flicker (as we need to update element offsets in the webview)\n\t\t\t\t\t\t// but as long as NOTEBOOK_WEBVIEW_BOUNDARY is large enough, it will happen less often\n\t\t\t\t\t\tthis._webviewElement!.setTop(-NOTEBOOK_WEBVIEW_BOUNDARY);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.view.updateElementHeight(index, size, anchorElementIndex);\n\t\t\treturn;\n\t\t}\n\n\t\tif (anchorElementIndex !== null) {\n\t\t\treturn this.view.updateElementHeight(index, size, anchorElementIndex);\n\t\t}\n\n\t\tconst focused = this.getFocus();\n\t\tif (!focused.length) {\n\t\t\treturn this.view.updateElementHeight(index, size, null);\n\t\t}\n\n\t\tconst focus = focused[0];\n\n\t\tif (focus <= index) {\n\t\t\treturn this.view.updateElementHeight(index, size, focus);\n\t\t}\n\n\t\t// the `element` is in the viewport, it's very often that the height update is triggerred by user interaction (collapse, run cell)\n\t\t// then we should make sure that the `element`'s visual view position doesn't change.\n\n\t\tif (this.view.elementTop(index) >= this.view.getScrollTop()) {\n\t\t\treturn this.view.updateElementHeight(index, size, index);\n\t\t}\n\n\t\tthis.view.updateElementHeight(index, size, focus);\n\t}\n\n\t// override\n\toverride domFocus() {\n\t\tconst focused = this.getFocusedElements()[0];\n\t\tconst focusedDomElement = focused && this.domElementOfElement(focused);\n\n\t\tif (document.activeElement && focusedDomElement && focusedDomElement.contains(document.activeElement)) {\n\t\t\t// for example, when focus goes into monaco editor, if we refocus the list view, the editor will lose focus.\n\t\t\treturn;\n\t\t}\n\n\t\tif (!isMacintosh && document.activeElement && isContextMenuFocused()) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.domFocus();\n\t}\n\n\tfocusContainer() {\n\t\tsuper.domFocus();\n\t}\n\n\tgetViewScrollTop() {\n\t\treturn this.view.getScrollTop();\n\t}\n\n\tgetViewScrollBottom() {\n\t\treturn this.getViewScrollTop() + this.view.renderHeight;\n\t}\n\n\tsetCellEditorSelection(cell: ICellViewModel, range: Range) {\n\t\tconst element = cell as CellViewModel;\n\t\tif (element.editorAttached) {\n\t\t\telement.setSelection(range);\n\t\t} else {\n\t\t\tgetEditorAttachedPromise(element).then(() => { element.setSelection(range); });\n\t\t}\n\t}\n\n\toverride style(styles: IListStyles) {\n\t\tconst selectorSuffix = this.view.domId;\n\t\tif (!this.styleElement) {\n\t\t\tthis.styleElement = DOM.createStyleSheet(this.view.domNode);\n\t\t}\n\t\tconst suffix = selectorSuffix && `.${selectorSuffix}`;\n\t\tconst content: string[] = [];\n\n\t\tif (styles.listBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows { background: ${styles.listBackground}; }`);\n\t\t}\n\n\t\tif (styles.listFocusBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listFocusForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\n\t\t}\n\n\t\tif (styles.listActiveSelectionBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listActiveSelectionForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\n\t\t}\n\n\t\tif (styles.listFocusAndSelectionBackground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listFocusAndSelectionForeground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listInactiveFocusBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listInactiveSelectionBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listInactiveSelectionForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\n\t\t}\n\n\t\tif (styles.listHoverBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:not(.drop-target) > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  ${styles.listHoverBackground}; }`);\n\t\t}\n\n\t\tif (styles.listHoverForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\n\t\t}\n\n\t\tif (styles.listSelectionOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listFocusOutline) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listInactiveFocusOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listHoverOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listDropBackground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`);\n\t\t}\n\n\t\tconst newStyles = content.join('\\n');\n\t\tif (newStyles !== this.styleElement.textContent) {\n\t\t\tthis.styleElement.textContent = newStyles;\n\t\t}\n\t}\n\n\tgetRenderHeight() {\n\t\treturn this.view.renderHeight;\n\t}\n\n\tgetScrollHeight() {\n\t\treturn this.view.scrollHeight;\n\t}\n\n\toverride layout(height?: number, width?: number): void {\n\t\tthis._isInLayout = true;\n\t\tsuper.layout(height, width);\n\t\tif (this.renderHeight === 0) {\n\t\t\tthis.view.domNode.style.visibility = 'hidden';\n\t\t} else {\n\t\t\tthis.view.domNode.style.visibility = 'initial';\n\t\t}\n\t\tthis._isInLayout = false;\n\t}\n\n\toverride dispose() {\n\t\tthis._isDisposed = true;\n\t\tthis._viewModelStore.dispose();\n\t\tthis._localDisposableStore.dispose();\n\t\tsuper.dispose();\n\n\t\t// un-ref\n\t\tthis._previousFocusedElements = [];\n\t\tthis._viewModel = null;\n\t\tthis._hiddenRangeIds = [];\n\t\tthis.hiddenRangesPrefixSum = null;\n\t\tthis._visibleRanges = [];\n\t}\n}\n\n\nexport class ListViewInfoAccessor extends Disposable {\n\tconstructor(\n\t\treadonly list: INotebookCellList\n\t) {\n\t\tsuper();\n\t}\n\n\tgetViewIndex(cell: ICellViewModel): number {\n\t\treturn this.list.getViewIndex(cell) ?? -1;\n\t}\n\n\tgetViewHeight(cell: ICellViewModel): number {\n\t\tif (!this.list.viewModel) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn this.list.elementHeight(cell);\n\t}\n\n\tgetCellRangeFromViewRange(startIndex: number, endIndex: number): ICellRange | undefined {\n\t\tif (!this.list.viewModel) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst modelIndex = this.list.getModelIndex2(startIndex);\n\t\tif (modelIndex === undefined) {\n\t\t\tthrow new Error(`startIndex ${startIndex} out of boundary`);\n\t\t}\n\n\t\tif (endIndex >= this.list.length) {\n\t\t\t// it's the end\n\t\t\tconst endModelIndex = this.list.viewModel.length;\n\t\t\treturn { start: modelIndex, end: endModelIndex };\n\t\t} else {\n\t\t\tconst endModelIndex = this.list.getModelIndex2(endIndex);\n\t\t\tif (endModelIndex === undefined) {\n\t\t\t\tthrow new Error(`endIndex ${endIndex} out of boundary`);\n\t\t\t}\n\t\t\treturn { start: modelIndex, end: endModelIndex };\n\t\t}\n\t}\n\n\tgetCellsFromViewRange(startIndex: number, endIndex: number): ReadonlyArray<ICellViewModel> {\n\t\tif (!this.list.viewModel) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst range = this.getCellRangeFromViewRange(startIndex, endIndex);\n\t\tif (!range) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn this.list.viewModel.getCellsInRange(range);\n\t}\n\n\tgetCellsInRange(range?: ICellRange): ReadonlyArray<ICellViewModel> {\n\t\treturn this.list.viewModel?.getCellsInRange(range) ?? [];\n\t}\n\n\tgetVisibleRangesPlusViewportAboveAndBelow(): ICellRange[] {\n\t\treturn this.list?.getVisibleRangesPlusViewportAboveAndBelow() ?? [];\n\t}\n}\n\nfunction getEditorAttachedPromise(element: ICellViewModel) {\n\treturn new Promise<void>((resolve, reject) => {\n\t\tEvent.once(element.onDidChangeEditorAttachState)(() => element.editorAttached ? resolve() : reject());\n\t});\n}\n\nfunction isContextMenuFocused() {\n\treturn !!DOM.findParentWithClass(<HTMLElement>document.activeElement, 'context-view');\n}\n"]}