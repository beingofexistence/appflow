{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/notebook/common/notebookProvider.ts"],"names":[],"mappings":"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","file":"notebookProvider.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as glob from 'vs/base/common/glob';\nimport { URI } from 'vs/base/common/uri';\nimport { basename } from 'vs/base/common/path';\nimport { INotebookExclusiveDocumentFilter, isDocumentExcludePattern, TransientOptions } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { RegisteredEditorPriority } from 'vs/workbench/services/editor/common/editorResolverService';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\n\ntype NotebookSelector = string | glob.IRelativePattern | INotebookExclusiveDocumentFilter;\n\nexport interface NotebookEditorDescriptor {\n\treadonly extension?: ExtensionIdentifier;\n\treadonly id: string;\n\treadonly displayName: string;\n\treadonly selectors: readonly { filenamePattern?: string; excludeFileNamePattern?: string }[];\n\treadonly priority: RegisteredEditorPriority;\n\treadonly providerDisplayName: string;\n\treadonly exclusive: boolean;\n}\n\nexport class NotebookProviderInfo {\n\n\treadonly extension?: ExtensionIdentifier;\n\treadonly id: string;\n\treadonly displayName: string;\n\treadonly priority: RegisteredEditorPriority;\n\treadonly providerDisplayName: string;\n\treadonly exclusive: boolean;\n\n\tprivate _selectors: NotebookSelector[];\n\tget selectors() {\n\t\treturn this._selectors;\n\t}\n\tprivate _options: TransientOptions;\n\tget options() {\n\t\treturn this._options;\n\t}\n\n\tconstructor(descriptor: NotebookEditorDescriptor) {\n\t\tthis.extension = descriptor.extension;\n\t\tthis.id = descriptor.id;\n\t\tthis.displayName = descriptor.displayName;\n\t\tthis._selectors = descriptor.selectors?.map(selector => ({\n\t\t\tinclude: selector.filenamePattern,\n\t\t\texclude: selector.excludeFileNamePattern || ''\n\t\t})) || [];\n\t\tthis.priority = descriptor.priority;\n\t\tthis.providerDisplayName = descriptor.providerDisplayName;\n\t\tthis.exclusive = descriptor.exclusive;\n\t\tthis._options = {\n\t\t\ttransientCellMetadata: {},\n\t\t\ttransientDocumentMetadata: {},\n\t\t\ttransientOutputs: false,\n\t\t\tcellContentMetadata: {}\n\t\t};\n\t}\n\n\tupdate(args: { selectors?: NotebookSelector[]; options?: TransientOptions }) {\n\t\tif (args.selectors) {\n\t\t\tthis._selectors = args.selectors;\n\t\t}\n\n\t\tif (args.options) {\n\t\t\tthis._options = args.options;\n\t\t}\n\t}\n\n\tmatches(resource: URI): boolean {\n\t\treturn this.selectors?.some(selector => NotebookProviderInfo.selectorMatches(selector, resource));\n\t}\n\n\tstatic selectorMatches(selector: NotebookSelector, resource: URI): boolean {\n\t\tif (typeof selector === 'string') {\n\t\t\t// filenamePattern\n\t\t\tif (glob.match(selector.toLowerCase(), basename(resource.fsPath).toLowerCase())) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (glob.isRelativePattern(selector)) {\n\t\t\tif (glob.match(selector, basename(resource.fsPath).toLowerCase())) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (!isDocumentExcludePattern(selector)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst filenamePattern = selector.include;\n\t\tconst excludeFilenamePattern = selector.exclude;\n\n\t\tif (glob.match(filenamePattern, basename(resource.fsPath).toLowerCase())) {\n\t\t\tif (excludeFilenamePattern) {\n\t\t\t\tif (glob.match(excludeFilenamePattern, basename(resource.fsPath).toLowerCase())) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tstatic possibleFileEnding(selectors: NotebookSelector[]): string | undefined {\n\t\tfor (const selector of selectors) {\n\t\t\tconst ending = NotebookProviderInfo._possibleFileEnding(selector);\n\t\t\tif (ending) {\n\t\t\t\treturn ending;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate static _possibleFileEnding(selector: NotebookSelector): string | undefined {\n\n\t\tconst pattern = /^.*(\\.[a-zA-Z0-9_-]+)$/;\n\n\t\tlet candidate: string | undefined;\n\n\t\tif (typeof selector === 'string') {\n\t\t\tcandidate = selector;\n\t\t} else if (glob.isRelativePattern(selector)) {\n\t\t\tcandidate = selector.pattern;\n\t\t} else if (selector.include) {\n\t\t\treturn NotebookProviderInfo._possibleFileEnding(selector.include);\n\t\t}\n\n\t\tif (candidate) {\n\t\t\tconst match = pattern.exec(candidate);\n\t\t\tif (match) {\n\t\t\t\treturn match[1];\n\t\t\t}\n\t\t}\n\n\t\treturn undefined;\n\t}\n}\n"]}