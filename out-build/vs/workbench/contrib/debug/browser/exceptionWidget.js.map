{"version":3,"sources":["vs/workbench/contrib/debug/browser/exceptionWidget.ts"],"names":[],"mappings":"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","file":"exceptionWidget.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/exceptionWidget';\nimport * as nls from 'vs/nls';\nimport * as dom from 'vs/base/browser/dom';\nimport { ZoneWidget } from 'vs/editor/contrib/zoneWidget/browser/zoneWidget';\nimport { ICodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { IExceptionInfo, IDebugSession, IDebugEditorContribution, EDITOR_CONTRIBUTION_ID } from 'vs/workbench/contrib/debug/common/debug';\nimport { RunOnceScheduler } from 'vs/base/common/async';\nimport { IThemeService, IColorTheme } from 'vs/platform/theme/common/themeService';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { Color } from 'vs/base/common/color';\nimport { registerColor } from 'vs/platform/theme/common/colorRegistry';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { LinkDetector } from 'vs/workbench/contrib/debug/browser/linkDetector';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { ActionBar } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { Action } from 'vs/base/common/actions';\nimport { widgetClose } from 'vs/platform/theme/common/iconRegistry';\nconst $ = dom.$;\n\n// theming\n\nconst debugExceptionWidgetBorder = registerColor('debugExceptionWidget.border', { dark: '#a31515', light: '#a31515', hcDark: '#a31515', hcLight: '#a31515' }, nls.localize('debugExceptionWidgetBorder', 'Exception widget border color.'));\nconst debugExceptionWidgetBackground = registerColor('debugExceptionWidget.background', { dark: '#420b0d', light: '#f1dfde', hcDark: '#420b0d', hcLight: '#f1dfde' }, nls.localize('debugExceptionWidgetBackground', 'Exception widget background color.'));\n\nexport class ExceptionWidget extends ZoneWidget {\n\n\tprivate backgroundColor: Color | undefined;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate exceptionInfo: IExceptionInfo,\n\t\tprivate debugSession: IDebugSession | undefined,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService\n\t) {\n\t\tsuper(editor, { showFrame: true, showArrow: true, isAccessible: true, frameWidth: 1, className: 'exception-widget-container' });\n\n\t\tthis.applyTheme(themeService.getColorTheme());\n\t\tthis._disposables.add(themeService.onDidColorThemeChange(this.applyTheme.bind(this)));\n\n\t\tthis.create();\n\t\tconst onDidLayoutChangeScheduler = new RunOnceScheduler(() => this._doLayout(undefined, undefined), 50);\n\t\tthis._disposables.add(this.editor.onDidLayoutChange(() => onDidLayoutChangeScheduler.schedule()));\n\t\tthis._disposables.add(onDidLayoutChangeScheduler);\n\t}\n\n\tprivate applyTheme(theme: IColorTheme): void {\n\t\tthis.backgroundColor = theme.getColor(debugExceptionWidgetBackground);\n\t\tconst frameColor = theme.getColor(debugExceptionWidgetBorder);\n\t\tthis.style({\n\t\t\tarrowColor: frameColor,\n\t\t\tframeColor: frameColor\n\t\t}); // style() will trigger _applyStyles\n\t}\n\n\tprotected override _applyStyles(): void {\n\t\tif (this.container) {\n\t\t\tthis.container.style.backgroundColor = this.backgroundColor ? this.backgroundColor.toString() : '';\n\t\t}\n\t\tsuper._applyStyles();\n\t}\n\n\tprotected _fillContainer(container: HTMLElement): void {\n\t\tthis.setCssClass('exception-widget');\n\t\t// Set the font size and line height to the one from the editor configuration.\n\t\tconst fontInfo = this.editor.getOption(EditorOption.fontInfo);\n\t\tcontainer.style.fontSize = `${fontInfo.fontSize}px`;\n\t\tcontainer.style.lineHeight = `${fontInfo.lineHeight}px`;\n\t\tcontainer.tabIndex = 0;\n\t\tconst title = $('.title');\n\t\tconst label = $('.label');\n\t\tdom.append(title, label);\n\t\tconst actions = $('.actions');\n\t\tdom.append(title, actions);\n\t\tlabel.textContent = this.exceptionInfo.id ? nls.localize('exceptionThrownWithId', 'Exception has occurred: {0}', this.exceptionInfo.id) : nls.localize('exceptionThrown', 'Exception has occurred.');\n\t\tlet ariaLabel = label.textContent;\n\n\t\tconst actionBar = new ActionBar(actions);\n\t\tactionBar.push(new Action('editor.closeExceptionWidget', nls.localize('close', \"Close\"), ThemeIcon.asClassName(widgetClose), true, async () => {\n\t\t\tconst contribution = this.editor.getContribution<IDebugEditorContribution>(EDITOR_CONTRIBUTION_ID);\n\t\t\tcontribution?.closeExceptionWidget();\n\t\t}), { label: false, icon: true });\n\n\t\tdom.append(container, title);\n\n\t\tif (this.exceptionInfo.description) {\n\t\t\tconst description = $('.description');\n\t\t\tdescription.textContent = this.exceptionInfo.description;\n\t\t\tariaLabel += ', ' + this.exceptionInfo.description;\n\t\t\tdom.append(container, description);\n\t\t}\n\n\t\tif (this.exceptionInfo.details && this.exceptionInfo.details.stackTrace) {\n\t\t\tconst stackTrace = $('.stack-trace');\n\t\t\tconst linkDetector = this.instantiationService.createInstance(LinkDetector);\n\t\t\tconst linkedStackTrace = linkDetector.linkify(this.exceptionInfo.details.stackTrace, true, this.debugSession ? this.debugSession.root : undefined);\n\t\t\tstackTrace.appendChild(linkedStackTrace);\n\t\t\tdom.append(container, stackTrace);\n\t\t\tariaLabel += ', ' + this.exceptionInfo.details.stackTrace;\n\t\t}\n\t\tcontainer.setAttribute('aria-label', ariaLabel);\n\t}\n\n\tprotected override _doLayout(_heightInPixel: number | undefined, _widthInPixel: number | undefined): void {\n\t\t// Reload the height with respect to the exception text content and relayout it to match the line count.\n\t\tthis.container!.style.height = 'initial';\n\n\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\tconst arrowHeight = Math.round(lineHeight / 3);\n\t\tconst computedLinesNumber = Math.ceil((this.container!.offsetHeight + arrowHeight) / lineHeight);\n\n\t\tthis._relayout(computedLinesNumber);\n\t}\n\n\tfocus(): void {\n\t\t// Focus into the container for accessibility purposes so the exception and stack trace gets read\n\t\tthis.container?.focus();\n\t}\n\n\toverride hasFocus(): boolean {\n\t\treturn dom.isAncestor(document.activeElement, this.container);\n\t}\n}\n"]}