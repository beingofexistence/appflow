{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/comments/browser/commentThreadWidget.ts"],"names":[],"mappings":"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","file":"commentThreadWidget.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/review';\nimport * as dom from 'vs/base/browser/dom';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable, dispose, IDisposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport * as languages from 'vs/editor/common/languages';\nimport { IMarkdownRendererOptions } from 'vs/editor/contrib/markdownRenderer/browser/markdownRenderer';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { CommentMenus } from 'vs/workbench/contrib/comments/browser/commentMenus';\nimport { CommentReply } from 'vs/workbench/contrib/comments/browser/commentReply';\nimport { ICommentService } from 'vs/workbench/contrib/comments/browser/commentService';\nimport { CommentThreadBody } from 'vs/workbench/contrib/comments/browser/commentThreadBody';\nimport { CommentThreadHeader } from 'vs/workbench/contrib/comments/browser/commentThreadHeader';\nimport { CommentThreadAdditionalActions } from 'vs/workbench/contrib/comments/browser/commentThreadAdditionalActions';\nimport { CommentContextKeys } from 'vs/workbench/contrib/comments/common/commentContextKeys';\nimport { ICommentThreadWidget } from 'vs/workbench/contrib/comments/common/commentThreadWidget';\nimport { IColorTheme } from 'vs/platform/theme/common/themeService';\nimport { contrastBorder, focusBorder, inputValidationErrorBackground, inputValidationErrorBorder, inputValidationErrorForeground, textBlockQuoteBackground, textBlockQuoteBorder, textLinkActiveForeground, textLinkForeground } from 'vs/platform/theme/common/colorRegistry';\nimport { PANEL_BORDER } from 'vs/workbench/common/theme';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { commentThreadStateBackgroundColorVar, commentThreadStateColorVar } from 'vs/workbench/contrib/comments/browser/commentColors';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { FontInfo } from 'vs/editor/common/config/fontInfo';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { registerNavigableContainer } from 'vs/workbench/browser/actions/widgetNavigationCommands';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { COMMENTS_SECTION, ICommentsConfiguration } from 'vs/workbench/contrib/comments/common/commentsConfiguration';\n\nexport const COMMENTEDITOR_DECORATION_KEY = 'commenteditordecoration';\n\n\nexport class CommentThreadWidget<T extends IRange | ICellRange = IRange> extends Disposable implements ICommentThreadWidget {\n\tprivate _header!: CommentThreadHeader<T>;\n\tprivate _body: CommentThreadBody<T>;\n\tprivate _commentReply?: CommentReply<T>;\n\tprivate _additionalActions?: CommentThreadAdditionalActions<T>;\n\tprivate _commentMenus: CommentMenus;\n\tprivate _commentThreadDisposables: IDisposable[] = [];\n\tprivate _threadIsEmpty: IContextKey<boolean>;\n\tprivate _styleElement: HTMLStyleElement;\n\tprivate _commentThreadContextValue: IContextKey<string | undefined>;\n\tprivate _onDidResize = new Emitter<dom.Dimension>();\n\tonDidResize = this._onDidResize.event;\n\n\tprivate _commentThreadState: languages.CommentThreadState | undefined;\n\n\tget commentThread() {\n\t\treturn this._commentThread;\n\t}\n\n\tconstructor(\n\t\treadonly container: HTMLElement,\n\t\tprivate _owner: string,\n\t\tprivate _parentResourceUri: URI,\n\t\tprivate _contextKeyService: IContextKeyService,\n\t\tprivate _scopedInstantiationService: IInstantiationService,\n\t\tprivate _commentThread: languages.CommentThread<T>,\n\t\tprivate _pendingComment: string | undefined,\n\t\tprivate _pendingEdits: { [key: number]: string } | undefined,\n\t\tprivate _markdownOptions: IMarkdownRendererOptions,\n\t\tprivate _commentOptions: languages.CommentOptions | undefined,\n\t\tprivate _containerDelegate: {\n\t\t\tactionRunner: (() => void) | null;\n\t\t\tcollapse: () => void;\n\t\t},\n\t\t@ICommentService private commentService: ICommentService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IConfigurationService private configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\n\t\tthis._threadIsEmpty = CommentContextKeys.commentThreadIsEmpty.bindTo(this._contextKeyService);\n\t\tthis._threadIsEmpty.set(!_commentThread.comments || !_commentThread.comments.length);\n\n\t\tthis._commentMenus = this.commentService.getCommentMenus(this._owner);\n\n\t\tthis._header = new CommentThreadHeader<T>(\n\t\t\tcontainer,\n\t\t\t{\n\t\t\t\tcollapse: this.collapse.bind(this)\n\t\t\t},\n\t\t\tthis._commentMenus,\n\t\t\tthis._commentThread,\n\t\t\tthis._contextKeyService,\n\t\t\tthis._scopedInstantiationService,\n\t\t\tcontextMenuService\n\t\t);\n\n\t\tthis._header.updateCommentThread(this._commentThread);\n\n\t\tconst bodyElement = <HTMLDivElement>dom.$('.body');\n\t\tcontainer.appendChild(bodyElement);\n\n\t\tconst tracker = this._register(dom.trackFocus(bodyElement));\n\t\tthis._register(registerNavigableContainer({\n\t\t\tfocusNotifiers: [tracker],\n\t\t\tfocusNextWidget: () => {\n\t\t\t\tif (!this._commentReply?.isCommentEditorFocused()) {\n\t\t\t\t\tthis._commentReply?.expandReplyAreaAndFocusCommentEditor();\n\t\t\t\t}\n\t\t\t},\n\t\t\tfocusPreviousWidget: () => {\n\t\t\t\tif (this._commentReply?.isCommentEditorFocused() && this._commentThread.comments?.length) {\n\t\t\t\t\tthis._body.focus();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._body = this._scopedInstantiationService.createInstance(\n\t\t\tCommentThreadBody,\n\t\t\tthis._owner,\n\t\t\tthis._parentResourceUri,\n\t\t\tbodyElement,\n\t\t\tthis._markdownOptions,\n\t\t\tthis._commentThread,\n\t\t\tthis._pendingEdits,\n\t\t\tthis._scopedInstantiationService,\n\t\t\tthis\n\t\t) as unknown as CommentThreadBody<T>;\n\t\tthis._register(this._body);\n\n\t\tthis._styleElement = dom.createStyleSheet(this.container);\n\n\n\t\tthis._commentThreadContextValue = CommentContextKeys.commentThreadContext.bindTo(this._contextKeyService);\n\t\tthis._commentThreadContextValue.set(_commentThread.contextValue);\n\n\t\tconst commentControllerKey = CommentContextKeys.commentControllerContext.bindTo(this._contextKeyService);\n\t\tconst controller = this.commentService.getCommentController(this._owner);\n\n\t\tif (controller?.contextValue) {\n\t\t\tcommentControllerKey.set(controller.contextValue);\n\t\t}\n\n\t\tthis.currentThreadListeners();\n\t}\n\n\tprivate updateCurrentThread(hasMouse: boolean, hasFocus: boolean) {\n\t\tif (hasMouse || hasFocus) {\n\t\t\tthis.commentService.setCurrentCommentThread(this.commentThread);\n\t\t} else {\n\t\t\tthis.commentService.setCurrentCommentThread(undefined);\n\t\t}\n\t}\n\n\tprivate currentThreadListeners() {\n\t\tlet hasMouse = false;\n\t\tlet hasFocus = false;\n\t\tthis._register(dom.addDisposableListener(this.container, dom.EventType.MOUSE_ENTER, (e) => {\n\t\t\tif ((<any>e).toElement === this.container) {\n\t\t\t\thasMouse = true;\n\t\t\t\tthis.updateCurrentThread(hasMouse, hasFocus);\n\t\t\t}\n\t\t}, true));\n\t\tthis._register(dom.addDisposableListener(this.container, dom.EventType.MOUSE_LEAVE, (e) => {\n\t\t\tif ((<any>e).fromElement === this.container) {\n\t\t\t\thasMouse = false;\n\t\t\t\tthis.updateCurrentThread(hasMouse, hasFocus);\n\t\t\t}\n\t\t}, true));\n\t\tthis._register(dom.addDisposableListener(this.container, dom.EventType.FOCUS_IN, () => {\n\t\t\thasFocus = true;\n\t\t\tthis.updateCurrentThread(hasMouse, hasFocus);\n\t\t}, true));\n\t\tthis._register(dom.addDisposableListener(this.container, dom.EventType.FOCUS_OUT, () => {\n\t\t\thasFocus = false;\n\t\t\tthis.updateCurrentThread(hasMouse, hasFocus);\n\t\t}, true));\n\t}\n\n\tupdateCommentThread(commentThread: languages.CommentThread<T>) {\n\t\tconst shouldCollapse = (this._commentThread.collapsibleState === languages.CommentThreadCollapsibleState.Expanded) && (this._commentThreadState === languages.CommentThreadState.Unresolved)\n\t\t\t&& (commentThread.state === languages.CommentThreadState.Resolved);\n\t\tthis._commentThreadState = commentThread.state;\n\t\tthis._commentThread = commentThread;\n\t\tdispose(this._commentThreadDisposables);\n\t\tthis._commentThreadDisposables = [];\n\t\tthis._bindCommentThreadListeners();\n\n\t\tthis._body.updateCommentThread(commentThread);\n\t\tthis._threadIsEmpty.set(!this._body.length);\n\t\tthis._header.updateCommentThread(commentThread);\n\t\tthis._commentReply?.updateCommentThread(commentThread);\n\n\t\tif (this._commentThread.contextValue) {\n\t\t\tthis._commentThreadContextValue.set(this._commentThread.contextValue);\n\t\t} else {\n\t\t\tthis._commentThreadContextValue.reset();\n\t\t}\n\n\t\tif (shouldCollapse && this.configurationService.getValue<ICommentsConfiguration>(COMMENTS_SECTION).collapseOnResolve) {\n\t\t\tthis.collapse();\n\t\t}\n\t}\n\n\tdisplay(lineHeight: number) {\n\t\tconst headHeight = Math.ceil(lineHeight * 1.2);\n\t\tthis._header.updateHeight(headHeight);\n\n\t\tthis._body.display();\n\n\t\t// create comment thread only when it supports reply\n\t\tif (this._commentThread.canReply) {\n\t\t\tthis._createCommentForm();\n\t\t}\n\t\tthis._createAdditionalActions();\n\n\t\tthis._register(this._body.onDidResize(dimension => {\n\t\t\tthis._refresh(dimension);\n\t\t}));\n\n\t\t// If there are no existing comments, place focus on the text area. This must be done after show, which also moves focus.\n\t\t// if this._commentThread.comments is undefined, it doesn't finish initialization yet, so we don't focus the editor immediately.\n\t\tif (this._commentThread.canReply && this._commentReply) {\n\t\t\tthis._commentReply.focusIfNeeded();\n\t\t}\n\n\t\tthis._bindCommentThreadListeners();\n\t}\n\n\tprivate _refresh(dimension: dom.Dimension) {\n\t\tthis._body.layout();\n\t\tthis._onDidResize.fire(dimension);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis.updateCurrentThread(false, false);\n\t}\n\n\tprivate _bindCommentThreadListeners() {\n\t\tthis._commentThreadDisposables.push(this._commentThread.onDidChangeCanReply(() => {\n\t\t\tif (this._commentReply) {\n\t\t\t\tthis._commentReply.updateCanReply();\n\t\t\t} else {\n\t\t\t\tif (this._commentThread.canReply) {\n\t\t\t\t\tthis._createCommentForm();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._commentThreadDisposables.push(this._commentThread.onDidChangeComments(async _ => {\n\t\t\tawait this.updateCommentThread(this._commentThread);\n\t\t}));\n\n\t\tthis._commentThreadDisposables.push(this._commentThread.onDidChangeLabel(_ => {\n\t\t\tthis._header.createThreadLabel();\n\t\t}));\n\t}\n\n\tprivate _createCommentForm() {\n\t\tthis._commentReply = this._scopedInstantiationService.createInstance(\n\t\t\tCommentReply,\n\t\t\tthis._owner,\n\t\t\tthis._body.container,\n\t\t\tthis._commentThread,\n\t\t\tthis._scopedInstantiationService,\n\t\t\tthis._contextKeyService,\n\t\t\tthis._commentMenus,\n\t\t\tthis._commentOptions,\n\t\t\tthis._pendingComment,\n\t\t\tthis,\n\t\t\tthis._containerDelegate.actionRunner\n\t\t);\n\n\t\tthis._register(this._commentReply);\n\t}\n\n\tprivate _createAdditionalActions() {\n\t\tthis._additionalActions = this._scopedInstantiationService.createInstance(\n\t\t\tCommentThreadAdditionalActions,\n\t\t\tthis._body.container,\n\t\t\tthis._commentThread,\n\t\t\tthis._contextKeyService,\n\t\t\tthis._commentMenus,\n\t\t\tthis._containerDelegate.actionRunner,\n\t\t);\n\n\t\tthis._register(this._additionalActions);\n\t}\n\n\tgetCommentCoords(commentUniqueId: number) {\n\t\treturn this._body.getCommentCoords(commentUniqueId);\n\t}\n\n\tgetPendingEdits(): { [key: number]: string } {\n\t\treturn this._body.getPendingEdits();\n\t}\n\n\tgetPendingComment(): string | undefined {\n\t\tif (this._commentReply) {\n\t\t\treturn this._commentReply.getPendingComment();\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tgetDimensions() {\n\t\treturn this._body.getDimensions();\n\t}\n\n\tlayout(widthInPixel?: number) {\n\t\tthis._body.layout();\n\n\t\tif (widthInPixel !== undefined) {\n\t\t\tthis._commentReply?.layout(widthInPixel);\n\t\t}\n\t}\n\n\tfocusCommentEditor() {\n\t\tthis._commentReply?.focusCommentEditor();\n\t}\n\n\tfocus() {\n\t\tthis._body.focus();\n\t}\n\n\tasync submitComment() {\n\t\tconst activeComment = this._body.activeComment;\n\t\tif (activeComment) {\n\t\t\treturn activeComment.submitComment();\n\t\t} else if ((this._commentReply?.getPendingComment()?.length ?? 0) > 0) {\n\t\t\treturn this._commentReply?.submitComment();\n\t\t}\n\t}\n\n\tcollapse() {\n\t\tthis._containerDelegate.collapse();\n\t}\n\n\tapplyTheme(theme: IColorTheme, fontInfo: FontInfo) {\n\t\tconst content: string[] = [];\n\n\t\tcontent.push(`.monaco-editor .review-widget > .body { border-top: 1px solid var(${commentThreadStateColorVar}) }`);\n\t\tcontent.push(`.monaco-editor .review-widget > .head { background-color: var(${commentThreadStateBackgroundColorVar}) }`);\n\n\t\tconst linkColor = theme.getColor(textLinkForeground);\n\t\tif (linkColor) {\n\t\t\tcontent.push(`.review-widget .body .comment-body a { color: ${linkColor} }`);\n\t\t}\n\n\t\tconst linkActiveColor = theme.getColor(textLinkActiveForeground);\n\t\tif (linkActiveColor) {\n\t\t\tcontent.push(`.review-widget .body .comment-body a:hover, a:active { color: ${linkActiveColor} }`);\n\t\t}\n\n\t\tconst focusColor = theme.getColor(focusBorder);\n\t\tif (focusColor) {\n\t\t\tcontent.push(`.review-widget .body .comment-body a:focus { outline: 1px solid ${focusColor}; }`);\n\t\t\tcontent.push(`.review-widget .body .monaco-editor.focused { outline: 1px solid ${focusColor}; }`);\n\t\t}\n\n\t\tconst blockQuoteBackground = theme.getColor(textBlockQuoteBackground);\n\t\tif (blockQuoteBackground) {\n\t\t\tcontent.push(`.review-widget .body .review-comment blockquote { background: ${blockQuoteBackground}; }`);\n\t\t}\n\n\t\tconst blockQuoteBOrder = theme.getColor(textBlockQuoteBorder);\n\t\tif (blockQuoteBOrder) {\n\t\t\tcontent.push(`.review-widget .body .review-comment blockquote { border-color: ${blockQuoteBOrder}; }`);\n\t\t}\n\n\t\tconst border = theme.getColor(PANEL_BORDER);\n\t\tif (border) {\n\t\t\tcontent.push(`.review-widget .body .review-comment .review-comment-contents .comment-reactions .action-item a.action-label { border-color: ${border}; }`);\n\t\t}\n\n\t\tconst hcBorder = theme.getColor(contrastBorder);\n\t\tif (hcBorder) {\n\t\t\tcontent.push(`.review-widget .body .comment-form .review-thread-reply-button { outline-color: ${hcBorder}; }`);\n\t\t\tcontent.push(`.review-widget .body .monaco-editor { outline: 1px solid ${hcBorder}; }`);\n\t\t}\n\n\t\tconst errorBorder = theme.getColor(inputValidationErrorBorder);\n\t\tif (errorBorder) {\n\t\t\tcontent.push(`.review-widget .validation-error { border: 1px solid ${errorBorder}; }`);\n\t\t}\n\n\t\tconst errorBackground = theme.getColor(inputValidationErrorBackground);\n\t\tif (errorBackground) {\n\t\t\tcontent.push(`.review-widget .validation-error { background: ${errorBackground}; }`);\n\t\t}\n\n\t\tconst errorForeground = theme.getColor(inputValidationErrorForeground);\n\t\tif (errorForeground) {\n\t\t\tcontent.push(`.review-widget .body .comment-form .validation-error { color: ${errorForeground}; }`);\n\t\t}\n\n\t\tconst fontFamilyVar = '--comment-thread-editor-font-family';\n\t\tconst fontSizeVar = '--comment-thread-editor-font-size';\n\t\tconst fontWeightVar = '--comment-thread-editor-font-weight';\n\t\tthis.container?.style.setProperty(fontFamilyVar, fontInfo.fontFamily);\n\t\tthis.container?.style.setProperty(fontSizeVar, `${fontInfo.fontSize}px`);\n\t\tthis.container?.style.setProperty(fontWeightVar, fontInfo.fontWeight);\n\n\t\tcontent.push(`.review-widget .body code {\n\t\t\tfont-family: var(${fontFamilyVar});\n\t\t\tfont-weight: var(${fontWeightVar});\n\t\t}`);\n\n\t\tthis._styleElement.textContent = content.join('\\n');\n\t\tthis._commentReply?.setCommentEditorDecorations();\n\t}\n}\n"]}