{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/comments/browser/commentThreadAdditionalActions.ts"],"names":[],"mappings":"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","file":"commentThreadAdditionalActions.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\n\nimport { IAction } from 'vs/base/common/actions';\nimport { IMenu, SubmenuItemAction } from 'vs/platform/actions/common/actions';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { IRange } from 'vs/editor/common/core/range';\nimport * as languages from 'vs/editor/common/languages';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { CommentFormActions } from 'vs/workbench/contrib/comments/browser/commentFormActions';\nimport { CommentMenus } from 'vs/workbench/contrib/comments/browser/commentMenus';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\n\nexport class CommentThreadAdditionalActions<T extends IRange | ICellRange> extends Disposable {\n\tprivate _container: HTMLElement | null;\n\tprivate _buttonBar: HTMLElement | null;\n\tprivate _commentFormActions!: CommentFormActions;\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate _commentThread: languages.CommentThread<T>,\n\t\tprivate _contextKeyService: IContextKeyService,\n\t\tprivate _commentMenus: CommentMenus,\n\t\tprivate _actionRunDelegate: (() => void) | null,\n\t) {\n\t\tsuper();\n\n\t\tthis._container = dom.append(container, dom.$('.comment-additional-actions'));\n\t\tdom.append(this._container, dom.$('.section-separator'));\n\n\t\tthis._buttonBar = dom.append(this._container, dom.$('.button-bar'));\n\t\tthis._createAdditionalActions(this._buttonBar);\n\t}\n\n\tprivate _showMenu() {\n\t\tthis._container?.classList.remove('hidden');\n\t}\n\n\tprivate _hideMenu() {\n\t\tthis._container?.classList.add('hidden');\n\t}\n\n\tprivate _enableDisableMenu(menu: IMenu) {\n\t\tconst groups = menu.getActions({ shouldForwardArgs: true });\n\n\t\t// Show the menu if at least one action is enabled.\n\t\tfor (const group of groups) {\n\t\t\tconst [, actions] = group;\n\t\t\tfor (const action of actions) {\n\t\t\t\tif (action.enabled) {\n\t\t\t\t\tthis._showMenu();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (const subAction of (action as SubmenuItemAction).actions ?? []) {\n\t\t\t\t\tif (subAction.enabled) {\n\t\t\t\t\t\tthis._showMenu();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._hideMenu();\n\t}\n\n\n\tprivate _createAdditionalActions(container: HTMLElement) {\n\t\tconst menu = this._commentMenus.getCommentThreadAdditionalActions(this._contextKeyService);\n\t\tthis._register(menu);\n\t\tthis._register(menu.onDidChange(() => {\n\t\t\tthis._commentFormActions.setActions(menu, /*hasOnlySecondaryActions*/ true);\n\t\t\tthis._enableDisableMenu(menu);\n\t\t}));\n\n\t\tthis._commentFormActions = new CommentFormActions(container, async (action: IAction) => {\n\t\t\tthis._actionRunDelegate?.();\n\n\t\t\taction.run({\n\t\t\t\tthread: this._commentThread,\n\t\t\t\t$mid: MarshalledId.CommentThreadInstance\n\t\t\t});\n\t\t}, 4);\n\n\t\tthis._register(this._commentFormActions);\n\t\tthis._commentFormActions.setActions(menu, /*hasOnlySecondaryActions*/ true);\n\t\tthis._enableDisableMenu(menu);\n\t}\n}\n"]}