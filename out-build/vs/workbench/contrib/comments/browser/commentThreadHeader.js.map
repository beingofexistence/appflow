{"version":3,"sources":["vs/workbench/contrib/comments/browser/commentThreadHeader.ts"],"names":[],"mappings":"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","file":"commentThreadHeader.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\nimport { ActionBar } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { Action, ActionRunner } from 'vs/base/common/actions';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport * as strings from 'vs/base/common/strings';\nimport * as languages from 'vs/editor/common/languages';\nimport { IRange } from 'vs/editor/common/core/range';\nimport * as nls from 'vs/nls';\nimport { createActionViewItem } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { IMenu, MenuItemAction, SubmenuItemAction } from 'vs/platform/actions/common/actions';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { registerIcon } from 'vs/platform/theme/common/iconRegistry';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { CommentMenus } from 'vs/workbench/contrib/comments/browser/commentMenus';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { MarshalledId } from 'vs/base/common/marshallingIds';\nimport { StandardMouseEvent } from 'vs/base/browser/mouseEvent';\n\nconst collapseIcon = registerIcon('review-comment-collapse', Codicon.chevronUp, nls.localize('collapseIcon', 'Icon to collapse a review comment.'));\nconst COLLAPSE_ACTION_CLASS = 'expand-review-action ' + ThemeIcon.asClassName(collapseIcon);\n\n\nexport class CommentThreadHeader<T = IRange> extends Disposable {\n\tprivate _headElement: HTMLElement;\n\tprivate _headingLabel!: HTMLElement;\n\tprivate _actionbarWidget!: ActionBar;\n\tprivate _collapseAction!: Action;\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate _delegate: { collapse: () => void },\n\t\tprivate _commentMenus: CommentMenus,\n\t\tprivate _commentThread: languages.CommentThread<T>,\n\t\tprivate _contextKeyService: IContextKeyService,\n\t\tprivate instantiationService: IInstantiationService,\n\t\tprivate _contextMenuService: IContextMenuService\n\t) {\n\t\tsuper();\n\t\tthis._headElement = <HTMLDivElement>dom.$('.head');\n\t\tcontainer.appendChild(this._headElement);\n\t\tthis._fillHead();\n\t}\n\n\tprotected _fillHead(): void {\n\t\tconst titleElement = dom.append(this._headElement, dom.$('.review-title'));\n\n\t\tthis._headingLabel = dom.append(titleElement, dom.$('span.filename'));\n\t\tthis.createThreadLabel();\n\n\t\tconst actionsContainer = dom.append(this._headElement, dom.$('.review-actions'));\n\t\tthis._actionbarWidget = new ActionBar(actionsContainer, {\n\t\t\tactionViewItemProvider: createActionViewItem.bind(undefined, this.instantiationService)\n\t\t});\n\n\t\tthis._register(this._actionbarWidget);\n\n\t\tthis._collapseAction = new Action('review.expand', nls.localize('label.collapse', \"Collapse\"), COLLAPSE_ACTION_CLASS, true, () => this._delegate.collapse());\n\n\t\tconst menu = this._commentMenus.getCommentThreadTitleActions(this._contextKeyService);\n\t\tthis.setActionBarActions(menu);\n\n\t\tthis._register(menu);\n\t\tthis._register(menu.onDidChange(e => {\n\t\t\tthis.setActionBarActions(menu);\n\t\t}));\n\n\t\tthis._register(dom.addDisposableListener(this._headElement, dom.EventType.CONTEXT_MENU, e => {\n\t\t\treturn this.onContextMenu(e);\n\t\t}));\n\n\t\tthis._actionbarWidget.context = this._commentThread;\n\t}\n\n\tprivate setActionBarActions(menu: IMenu): void {\n\t\tconst groups = menu.getActions({ shouldForwardArgs: true }).reduce((r, [, actions]) => [...r, ...actions], <(MenuItemAction | SubmenuItemAction)[]>[]);\n\t\tthis._actionbarWidget.clear();\n\t\tthis._actionbarWidget.push([...groups, this._collapseAction], { label: false, icon: true });\n\t}\n\n\tupdateCommentThread(commentThread: languages.CommentThread<T>) {\n\t\tthis._commentThread = commentThread;\n\n\t\tthis._actionbarWidget.context = this._commentThread;\n\t\tthis.createThreadLabel();\n\t}\n\n\tcreateThreadLabel() {\n\t\tlet label: string | undefined;\n\t\tlabel = this._commentThread.label;\n\n\t\tif (label === undefined) {\n\t\t\tif (!(this._commentThread.comments && this._commentThread.comments.length)) {\n\t\t\t\tlabel = nls.localize('startThread', \"Start discussion\");\n\t\t\t}\n\t\t}\n\n\t\tif (label) {\n\t\t\tthis._headingLabel.textContent = strings.escape(label);\n\t\t\tthis._headingLabel.setAttribute('aria-label', label);\n\t\t}\n\t}\n\n\tupdateHeight(headHeight: number) {\n\t\tthis._headElement.style.height = `${headHeight}px`;\n\t\tthis._headElement.style.lineHeight = this._headElement.style.height;\n\t}\n\n\tprivate onContextMenu(e: MouseEvent) {\n\t\tconst actions = this._commentMenus.getCommentThreadTitleContextActions(this._contextKeyService).getActions({ shouldForwardArgs: true }).map((value) => value[1]).flat();\n\t\tif (!actions.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst event = new StandardMouseEvent(e);\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => event,\n\t\t\tgetActions: () => actions,\n\t\t\tactionRunner: new ActionRunner(),\n\t\t\tgetActionsContext: () => {\n\t\t\t\treturn {\n\t\t\t\t\tcommentControlHandle: this._commentThread.controllerHandle,\n\t\t\t\t\tcommentThreadHandle: this._commentThread.commentThreadHandle,\n\t\t\t\t\t$mid: MarshalledId.CommentThread\n\t\t\t\t};\n\t\t\t},\n\t\t});\n\t}\n}\n"]}