{"version":3,"sources":["vs/workbench/contrib/codeEditor/browser/toggleWordWrap.ts"],"names":[],"mappings":"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","file":"toggleWordWrap.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { IActiveCodeEditor, ICodeEditor, IDiffEditor } from 'vs/editor/browser/editorBrowser';\nimport { EditorAction, ServicesAccessor, registerEditorAction, registerEditorContribution, registerDiffEditorContribution, EditorContributionInstantiation } from 'vs/editor/browser/editorExtensions';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { IDiffEditorContribution, IEditorContribution } from 'vs/editor/common/editorCommon';\nimport { ITextModel } from 'vs/editor/common/model';\nimport { MenuId, MenuRegistry } from 'vs/platform/actions/common/actions';\nimport { ContextKeyExpr, IContextKey, IContextKeyService, RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { IWorkbenchContribution, IWorkbenchContributionsRegistry, Extensions } from 'vs/workbench/common/contributions';\nimport { LifecyclePhase } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\n\nconst transientWordWrapState = 'transientWordWrapState';\nconst isWordWrapMinifiedKey = 'isWordWrapMinified';\nconst isDominatedByLongLinesKey = 'isDominatedByLongLines';\nconst CAN_TOGGLE_WORD_WRAP = new RawContextKey<boolean>('canToggleWordWrap', false, true);\nconst EDITOR_WORD_WRAP = new RawContextKey<boolean>('editorWordWrap', false, nls.localize('editorWordWrap', 'Whether the editor is currently using word wrapping.'));\n\n/**\n * State written/read by the toggle word wrap action and associated with a particular model.\n */\nexport interface IWordWrapTransientState {\n\treadonly wordWrapOverride: 'on' | 'off';\n}\n\n/**\n * Store (in memory) the word wrap state for a particular model.\n */\nexport function writeTransientState(model: ITextModel, state: IWordWrapTransientState | null, codeEditorService: ICodeEditorService): void {\n\tcodeEditorService.setTransientModelProperty(model, transientWordWrapState, state);\n}\n\n/**\n * Read (in memory) the word wrap state for a particular model.\n */\nexport function readTransientState(model: ITextModel, codeEditorService: ICodeEditorService): IWordWrapTransientState | null {\n\treturn codeEditorService.getTransientModelProperty(model, transientWordWrapState);\n}\n\nconst TOGGLE_WORD_WRAP_ID = 'editor.action.toggleWordWrap';\nclass ToggleWordWrapAction extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: TOGGLE_WORD_WRAP_ID,\n\t\t\tlabel: nls.localize('toggle.wordwrap', \"View: Toggle Word Wrap\"),\n\t\t\talias: 'View: Toggle Word Wrap',\n\t\t\tprecondition: undefined,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: null,\n\t\t\t\tprimary: KeyMod.Alt | KeyCode.KeyZ,\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic run(accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\n\t\tif (!canToggleWordWrap(codeEditorService, editor)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst model = editor.getModel();\n\n\t\t// Read the current state\n\t\tconst transientState = readTransientState(model, codeEditorService);\n\n\t\t// Compute the new state\n\t\tlet newState: IWordWrapTransientState | null;\n\t\tif (transientState) {\n\t\t\tnewState = null;\n\t\t} else {\n\t\t\tconst actualWrappingInfo = editor.getOption(EditorOption.wrappingInfo);\n\t\t\tconst wordWrapOverride = (actualWrappingInfo.wrappingColumn === -1 ? 'on' : 'off');\n\t\t\tnewState = { wordWrapOverride };\n\t\t}\n\n\t\t// Write the new state\n\t\t// (this will cause an event and the controller will apply the state)\n\t\twriteTransientState(model, newState, codeEditorService);\n\n\t\t// if we are in a diff editor, update the other editor (if possible)\n\t\tconst diffEditor = findDiffEditorContainingCodeEditor(editor, codeEditorService);\n\t\tif (diffEditor) {\n\t\t\tconst originalEditor = diffEditor.getOriginalEditor();\n\t\t\tconst modifiedEditor = diffEditor.getModifiedEditor();\n\t\t\tconst otherEditor = (originalEditor === editor ? modifiedEditor : originalEditor);\n\t\t\tif (canToggleWordWrap(codeEditorService, otherEditor)) {\n\t\t\t\twriteTransientState(otherEditor.getModel(), newState, codeEditorService);\n\t\t\t\tdiffEditor.updateOptions({});\n\t\t\t}\n\t\t}\n\t}\n}\n\n/**\n * If `editor` is the original or modified editor of a diff editor, it returns it.\n * It returns null otherwise.\n */\nfunction findDiffEditorContainingCodeEditor(editor: ICodeEditor, codeEditorService: ICodeEditorService): IDiffEditor | null {\n\tif (!editor.getOption(EditorOption.inDiffEditor)) {\n\t\treturn null;\n\t}\n\tfor (const diffEditor of codeEditorService.listDiffEditors()) {\n\t\tconst originalEditor = diffEditor.getOriginalEditor();\n\t\tconst modifiedEditor = diffEditor.getModifiedEditor();\n\t\tif (originalEditor === editor || modifiedEditor === editor) {\n\t\t\treturn diffEditor;\n\t\t}\n\t}\n\treturn null;\n}\n\nclass ToggleWordWrapController extends Disposable implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.toggleWordWrapController';\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@ICodeEditorService private readonly _codeEditorService: ICodeEditorService\n\t) {\n\t\tsuper();\n\n\t\tconst options = this._editor.getOptions();\n\t\tconst wrappingInfo = options.get(EditorOption.wrappingInfo);\n\t\tconst isWordWrapMinified = this._contextKeyService.createKey(isWordWrapMinifiedKey, wrappingInfo.isWordWrapMinified);\n\t\tconst isDominatedByLongLines = this._contextKeyService.createKey(isDominatedByLongLinesKey, wrappingInfo.isDominatedByLongLines);\n\t\tlet currentlyApplyingEditorConfig = false;\n\n\t\tthis._register(_editor.onDidChangeConfiguration((e) => {\n\t\t\tif (!e.hasChanged(EditorOption.wrappingInfo)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst options = this._editor.getOptions();\n\t\t\tconst wrappingInfo = options.get(EditorOption.wrappingInfo);\n\t\t\tisWordWrapMinified.set(wrappingInfo.isWordWrapMinified);\n\t\t\tisDominatedByLongLines.set(wrappingInfo.isDominatedByLongLines);\n\t\t\tif (!currentlyApplyingEditorConfig) {\n\t\t\t\t// I am not the cause of the word wrap getting changed\n\t\t\t\tensureWordWrapSettings();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(_editor.onDidChangeModel((e) => {\n\t\t\tensureWordWrapSettings();\n\t\t}));\n\n\t\tthis._register(_codeEditorService.onDidChangeTransientModelProperty(() => {\n\t\t\tensureWordWrapSettings();\n\t\t}));\n\n\t\tconst ensureWordWrapSettings = () => {\n\t\t\tif (!canToggleWordWrap(this._codeEditorService, this._editor)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst transientState = readTransientState(this._editor.getModel(), this._codeEditorService);\n\n\t\t\t// Apply the state\n\t\t\ttry {\n\t\t\t\tcurrentlyApplyingEditorConfig = true;\n\t\t\t\tthis._applyWordWrapState(transientState);\n\t\t\t} finally {\n\t\t\t\tcurrentlyApplyingEditorConfig = false;\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate _applyWordWrapState(state: IWordWrapTransientState | null): void {\n\t\tconst wordWrapOverride2 = state ? state.wordWrapOverride : 'inherit';\n\t\tthis._editor.updateOptions({\n\t\t\twordWrapOverride2: wordWrapOverride2\n\t\t});\n\t}\n}\n\nclass DiffToggleWordWrapController extends Disposable implements IDiffEditorContribution {\n\n\tpublic static readonly ID = 'diffeditor.contrib.toggleWordWrapController';\n\n\tconstructor(\n\t\tprivate readonly _diffEditor: IDiffEditor,\n\t\t@ICodeEditorService private readonly _codeEditorService: ICodeEditorService\n\t) {\n\t\tsuper();\n\n\t\tthis._register(this._diffEditor.onDidChangeModel(() => {\n\t\t\tthis._ensureSyncedWordWrapToggle();\n\t\t}));\n\t}\n\n\tprivate _ensureSyncedWordWrapToggle(): void {\n\t\tconst originalEditor = this._diffEditor.getOriginalEditor();\n\t\tconst modifiedEditor = this._diffEditor.getModifiedEditor();\n\n\t\tif (!originalEditor.hasModel() || !modifiedEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst originalTransientState = readTransientState(originalEditor.getModel(), this._codeEditorService);\n\t\tconst modifiedTransientState = readTransientState(modifiedEditor.getModel(), this._codeEditorService);\n\n\t\tif (originalTransientState && !modifiedTransientState && canToggleWordWrap(this._codeEditorService, originalEditor)) {\n\t\t\twriteTransientState(modifiedEditor.getModel(), originalTransientState, this._codeEditorService);\n\t\t\tthis._diffEditor.updateOptions({});\n\t\t}\n\t\tif (!originalTransientState && modifiedTransientState && canToggleWordWrap(this._codeEditorService, modifiedEditor)) {\n\t\t\twriteTransientState(originalEditor.getModel(), modifiedTransientState, this._codeEditorService);\n\t\t\tthis._diffEditor.updateOptions({});\n\t\t}\n\t}\n}\n\nfunction canToggleWordWrap(codeEditorService: ICodeEditorService, editor: ICodeEditor | null): editor is IActiveCodeEditor {\n\tif (!editor) {\n\t\treturn false;\n\t}\n\tif (editor.isSimpleWidget) {\n\t\t// in a simple widget...\n\t\treturn false;\n\t}\n\t// Ensure correct word wrap settings\n\tconst model = editor.getModel();\n\tif (!model) {\n\t\treturn false;\n\t}\n\tif (model.uri.scheme === 'output') {\n\t\t// in output editor\n\t\treturn false;\n\t}\n\tif (editor.getOption(EditorOption.inDiffEditor)) {\n\t\t// this editor belongs to a diff editor\n\t\tfor (const diffEditor of codeEditorService.listDiffEditors()) {\n\t\t\tif (diffEditor.getOriginalEditor() === editor && !diffEditor.renderSideBySide) {\n\t\t\t\t// this editor is the left side of an inline diff editor\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n}\n\nclass EditorWordWrapContextKeyTracker implements IWorkbenchContribution {\n\n\tprivate readonly _canToggleWordWrap: IContextKey<boolean>;\n\tprivate readonly _editorWordWrap: IContextKey<boolean>;\n\tprivate _activeEditor: ICodeEditor | null;\n\tprivate readonly _activeEditorListener: DisposableStore;\n\n\tconstructor(\n\t\t@IEditorService private readonly _editorService: IEditorService,\n\t\t@ICodeEditorService private readonly _codeEditorService: ICodeEditorService,\n\t\t@IContextKeyService private readonly _contextService: IContextKeyService,\n\t) {\n\t\twindow.addEventListener('focus', () => this._update(), true);\n\t\twindow.addEventListener('blur', () => this._update(), true);\n\t\tthis._editorService.onDidActiveEditorChange(() => this._update());\n\t\tthis._canToggleWordWrap = CAN_TOGGLE_WORD_WRAP.bindTo(this._contextService);\n\t\tthis._editorWordWrap = EDITOR_WORD_WRAP.bindTo(this._contextService);\n\t\tthis._activeEditor = null;\n\t\tthis._activeEditorListener = new DisposableStore();\n\t\tthis._update();\n\t}\n\n\tprivate _update(): void {\n\t\tconst activeEditor = this._codeEditorService.getFocusedCodeEditor() || this._codeEditorService.getActiveCodeEditor();\n\t\tif (this._activeEditor === activeEditor) {\n\t\t\t// no change\n\t\t\treturn;\n\t\t}\n\t\tthis._activeEditorListener.clear();\n\t\tthis._activeEditor = activeEditor;\n\n\t\tif (activeEditor) {\n\t\t\tthis._activeEditorListener.add(activeEditor.onDidChangeModel(() => this._updateFromCodeEditor()));\n\t\t\tthis._activeEditorListener.add(activeEditor.onDidChangeConfiguration((e) => {\n\t\t\t\tif (e.hasChanged(EditorOption.wrappingInfo)) {\n\t\t\t\t\tthis._updateFromCodeEditor();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis._updateFromCodeEditor();\n\t\t}\n\t}\n\n\tprivate _updateFromCodeEditor(): void {\n\t\tif (!canToggleWordWrap(this._codeEditorService, this._activeEditor)) {\n\t\t\treturn this._setValues(false, false);\n\t\t} else {\n\t\t\tconst wrappingInfo = this._activeEditor.getOption(EditorOption.wrappingInfo);\n\t\t\tthis._setValues(true, wrappingInfo.wrappingColumn !== -1);\n\t\t}\n\t}\n\n\tprivate _setValues(canToggleWordWrap: boolean, isWordWrap: boolean): void {\n\t\tthis._canToggleWordWrap.set(canToggleWordWrap);\n\t\tthis._editorWordWrap.set(isWordWrap);\n\t}\n}\n\nconst workbenchRegistry = Registry.as<IWorkbenchContributionsRegistry>(Extensions.Workbench);\nworkbenchRegistry.registerWorkbenchContribution(EditorWordWrapContextKeyTracker, LifecyclePhase.Ready);\n\nregisterEditorContribution(ToggleWordWrapController.ID, ToggleWordWrapController, EditorContributionInstantiation.Eager); // eager because it needs to change the editor word wrap configuration\nregisterDiffEditorContribution(DiffToggleWordWrapController.ID, DiffToggleWordWrapController);\nregisterEditorAction(ToggleWordWrapAction);\n\nMenuRegistry.appendMenuItem(MenuId.EditorTitle, {\n\tcommand: {\n\t\tid: TOGGLE_WORD_WRAP_ID,\n\t\ttitle: nls.localize('unwrapMinified', \"Disable wrapping for this file\"),\n\t\ticon: Codicon.wordWrap\n\t},\n\tgroup: 'navigation',\n\torder: 1,\n\twhen: ContextKeyExpr.and(\n\t\tContextKeyExpr.has(isDominatedByLongLinesKey),\n\t\tContextKeyExpr.has(isWordWrapMinifiedKey)\n\t)\n});\nMenuRegistry.appendMenuItem(MenuId.EditorTitle, {\n\tcommand: {\n\t\tid: TOGGLE_WORD_WRAP_ID,\n\t\ttitle: nls.localize('wrapMinified', \"Enable wrapping for this file\"),\n\t\ticon: Codicon.wordWrap\n\t},\n\tgroup: 'navigation',\n\torder: 1,\n\twhen: ContextKeyExpr.and(\n\t\tEditorContextKeys.inDiffEditor.negate(),\n\t\tContextKeyExpr.has(isDominatedByLongLinesKey),\n\t\tContextKeyExpr.not(isWordWrapMinifiedKey)\n\t)\n});\n\n\n// View menu\nMenuRegistry.appendMenuItem(MenuId.MenubarViewMenu, {\n\tcommand: {\n\t\tid: TOGGLE_WORD_WRAP_ID,\n\t\ttitle: nls.localize({ key: 'miToggleWordWrap', comment: ['&& denotes a mnemonic'] }, \"&&Word Wrap\"),\n\t\ttoggled: EDITOR_WORD_WRAP,\n\t\tprecondition: CAN_TOGGLE_WORD_WRAP\n\t},\n\torder: 1,\n\tgroup: '5_editor'\n});\n"]}