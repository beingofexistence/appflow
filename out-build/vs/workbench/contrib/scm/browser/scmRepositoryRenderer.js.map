{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/scm/browser/scmRepositoryRenderer.ts"],"names":[],"mappings":"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","file":"scmRepositoryRenderer.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/scm';\nimport { IDisposable, DisposableStore, combinedDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { append, $ } from 'vs/base/browser/dom';\nimport { ISCMRepository, ISCMViewService } from 'vs/workbench/contrib/scm/common/scm';\nimport { CountBadge } from 'vs/base/browser/ui/countBadge/countBadge';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { IAction } from 'vs/base/common/actions';\nimport { connectPrimaryMenu, isSCMRepository, StatusBarAction } from './util';\nimport { ITreeNode } from 'vs/base/browser/ui/tree/tree';\nimport { ICompressibleTreeRenderer } from 'vs/base/browser/ui/tree/objectTree';\nimport { FuzzyScore } from 'vs/base/common/filters';\nimport { ToolBar } from 'vs/base/browser/ui/toolbar/toolbar';\nimport { IListRenderer } from 'vs/base/browser/ui/list/list';\nimport { IWorkspaceContextService } from 'vs/platform/workspace/common/workspace';\nimport { basename } from 'vs/base/common/resources';\nimport { IActionViewItemProvider } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { defaultCountBadgeStyles } from 'vs/platform/theme/browser/defaultStyles';\n\ninterface RepositoryTemplate {\n\treadonly label: HTMLElement;\n\treadonly name: HTMLElement;\n\treadonly description: HTMLElement;\n\treadonly countContainer: HTMLElement;\n\treadonly count: CountBadge;\n\treadonly toolBar: ToolBar;\n\treadonly elementDisposables: DisposableStore;\n\treadonly templateDisposable: IDisposable;\n}\n\nexport class RepositoryRenderer implements ICompressibleTreeRenderer<ISCMRepository, FuzzyScore, RepositoryTemplate>, IListRenderer<ISCMRepository, RepositoryTemplate> {\n\n\tstatic readonly TEMPLATE_ID = 'repository';\n\tget templateId(): string { return RepositoryRenderer.TEMPLATE_ID; }\n\n\tconstructor(\n\t\tprivate actionViewItemProvider: IActionViewItemProvider,\n\t\t@ISCMViewService private scmViewService: ISCMViewService,\n\t\t@ICommandService private commandService: ICommandService,\n\t\t@IContextMenuService private contextMenuService: IContextMenuService,\n\t\t@IWorkspaceContextService private workspaceContextService: IWorkspaceContextService,\n\t) { }\n\n\trenderTemplate(container: HTMLElement): RepositoryTemplate {\n\t\t// hack\n\t\tif (container.classList.contains('monaco-tl-contents')) {\n\t\t\t(container.parentElement!.parentElement!.querySelector('.monaco-tl-twistie')! as HTMLElement).classList.add('force-twistie');\n\t\t}\n\n\t\tconst provider = append(container, $('.scm-provider'));\n\t\tconst label = append(provider, $('.label'));\n\t\tconst name = append(label, $('span.name'));\n\t\tconst description = append(label, $('span.description'));\n\t\tconst actions = append(provider, $('.actions'));\n\t\tconst toolBar = new ToolBar(actions, this.contextMenuService, { actionViewItemProvider: this.actionViewItemProvider });\n\t\tconst countContainer = append(provider, $('.count'));\n\t\tconst count = new CountBadge(countContainer, {}, defaultCountBadgeStyles);\n\t\tconst visibilityDisposable = toolBar.onDidChangeDropdownVisibility(e => provider.classList.toggle('active', e));\n\n\t\tconst templateDisposable = combinedDisposable(visibilityDisposable, toolBar);\n\n\t\treturn { label, name, description, countContainer, count, toolBar, elementDisposables: new DisposableStore(), templateDisposable };\n\t}\n\n\trenderElement(arg: ISCMRepository | ITreeNode<ISCMRepository, FuzzyScore>, index: number, templateData: RepositoryTemplate, height: number | undefined): void {\n\t\tconst repository = isSCMRepository(arg) ? arg : arg.element;\n\n\t\tif (repository.provider.rootUri) {\n\t\t\tconst folder = this.workspaceContextService.getWorkspaceFolder(repository.provider.rootUri);\n\n\t\t\tif (folder?.uri.toString() === repository.provider.rootUri.toString()) {\n\t\t\t\ttemplateData.name.textContent = folder.name;\n\t\t\t} else {\n\t\t\t\ttemplateData.name.textContent = basename(repository.provider.rootUri);\n\t\t\t}\n\n\t\t\ttemplateData.label.title = `${repository.provider.label}: ${repository.provider.rootUri.fsPath}`;\n\t\t\ttemplateData.description.textContent = repository.provider.label;\n\t\t} else {\n\t\t\ttemplateData.label.title = repository.provider.label;\n\t\t\ttemplateData.name.textContent = repository.provider.label;\n\t\t\ttemplateData.description.textContent = '';\n\t\t}\n\n\t\tlet statusPrimaryActions: IAction[] = [];\n\t\tlet menuPrimaryActions: IAction[] = [];\n\t\tlet menuSecondaryActions: IAction[] = [];\n\t\tconst updateToolbar = () => {\n\t\t\ttemplateData.toolBar.setActions([...statusPrimaryActions, ...menuPrimaryActions], menuSecondaryActions);\n\t\t};\n\n\t\tconst onDidChangeProvider = () => {\n\t\t\tconst commands = repository.provider.statusBarCommands || [];\n\t\t\tstatusPrimaryActions = commands.map(c => new StatusBarAction(c, this.commandService));\n\t\t\tupdateToolbar();\n\n\t\t\tconst count = repository.provider.count || 0;\n\t\t\ttemplateData.countContainer.setAttribute('data-count', String(count));\n\t\t\ttemplateData.count.setCount(count);\n\t\t};\n\n\t\t// TODO@joao TODO@lszomoru\n\t\tlet disposed = false;\n\t\ttemplateData.elementDisposables.add(toDisposable(() => disposed = true));\n\t\ttemplateData.elementDisposables.add(repository.provider.onDidChange(() => {\n\t\t\tif (disposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tonDidChangeProvider();\n\t\t}));\n\n\t\tonDidChangeProvider();\n\n\t\tconst menus = this.scmViewService.menus.getRepositoryMenus(repository.provider);\n\t\ttemplateData.elementDisposables.add(connectPrimaryMenu(menus.titleMenu.menu, (primary, secondary) => {\n\t\t\tmenuPrimaryActions = primary;\n\t\t\tmenuSecondaryActions = secondary;\n\t\t\tupdateToolbar();\n\t\t}));\n\t\ttemplateData.toolBar.context = repository.provider;\n\t}\n\n\trenderCompressedElements(): void {\n\t\tthrow new Error('Should never happen since node is incompressible');\n\t}\n\n\tdisposeElement(group: ISCMRepository | ITreeNode<ISCMRepository, FuzzyScore>, index: number, template: RepositoryTemplate): void {\n\t\ttemplate.elementDisposables.clear();\n\t}\n\n\tdisposeTemplate(templateData: RepositoryTemplate): void {\n\t\ttemplateData.elementDisposables.dispose();\n\t\ttemplateData.templateDisposable.dispose();\n\t}\n}\n"]}