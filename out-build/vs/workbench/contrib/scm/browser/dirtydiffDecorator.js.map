{"version":3,"sources":["vs/workbench/contrib/scm/browser/dirtydiffDecorator.ts"],"names":[],"mappings":"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","file":"dirtydiffDecorator.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\n\nimport 'vs/css!./media/dirtydiffDecorator';\nimport { ThrottledDelayer } from 'vs/base/common/async';\nimport { IDisposable, dispose, toDisposable, Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport * as ext from 'vs/workbench/common/contributions';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IResolvedTextEditorModel, ITextModelService } from 'vs/editor/common/services/resolverService';\nimport { IEditorWorkerService } from 'vs/editor/common/services/editorWorker';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { URI } from 'vs/base/common/uri';\nimport { ISCMService, ISCMRepository } from 'vs/workbench/contrib/scm/common/scm';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { IColorTheme, themeColorFromId, IThemeService } from 'vs/platform/theme/common/themeService';\nimport { editorErrorForeground, registerColor, transparent } from 'vs/platform/theme/common/colorRegistry';\nimport { ICodeEditor, IEditorMouseEvent, isCodeEditor, MouseTargetType } from 'vs/editor/browser/editorBrowser';\nimport { registerEditorAction, registerEditorContribution, ServicesAccessor, EditorAction, EditorContributionInstantiation } from 'vs/editor/browser/editorExtensions';\nimport { PeekViewWidget, getOuterEditor, peekViewBorder, peekViewTitleBackground, peekViewTitleForeground, peekViewTitleInfoForeground } from 'vs/editor/contrib/peekView/browser/peekView';\nimport { IContextKeyService, IContextKey, ContextKeyExpr, RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Range } from 'vs/editor/common/core/range';\nimport { rot } from 'vs/base/common/numbers';\nimport { KeybindingsRegistry, KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { EmbeddedDiffEditorWidget } from 'vs/editor/browser/widget/embeddedCodeEditorWidget';\nimport { IDiffEditorOptions, EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { Action, IAction, ActionRunner } from 'vs/base/common/actions';\nimport { IActionBarOptions } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { basename } from 'vs/base/common/resources';\nimport { MenuId, IMenuService, IMenu, MenuItemAction, MenuRegistry } from 'vs/platform/actions/common/actions';\nimport { createAndFillInActionBarActions } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { IEditorModel, ScrollType, IEditorContribution, IDiffEditorModel } from 'vs/editor/common/editorCommon';\nimport { OverviewRulerLane, ITextModel, IModelDecorationOptions, MinimapPosition, shouldSynchronizeModel } from 'vs/editor/common/model';\nimport { equals, sortedDiff } from 'vs/base/common/arrays';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { ISplice } from 'vs/base/common/sequence';\nimport * as dom from 'vs/base/browser/dom';\nimport { EncodingMode, ITextFileEditorModel, IResolvedTextFileEditorModel, ITextFileService, isTextFileEditorModel } from 'vs/workbench/services/textfile/common/textfiles';\nimport { gotoNextLocation, gotoPreviousLocation } from 'vs/platform/theme/common/iconRegistry';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { TextCompareEditorActiveContext } from 'vs/workbench/common/contextkeys';\nimport { IProgressService, ProgressLocation } from 'vs/platform/progress/common/progress';\nimport { IChange } from 'vs/editor/common/diff/legacyLinesDiffComputer';\nimport { Color } from 'vs/base/common/color';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { DEFAULT_EDITOR_ASSOCIATION } from 'vs/workbench/common/editor';\nimport { FILE_EDITOR_INPUT_ID } from 'vs/workbench/contrib/files/common/files';\nimport { AudioCue, IAudioCueService } from 'vs/platform/audioCues/browser/audioCueService';\nimport { IAccessibilityService } from 'vs/platform/accessibility/common/accessibility';\nimport { IQuickDiffService, QuickDiff } from 'vs/workbench/contrib/scm/common/quickDiff';\nimport { IQuickDiffSelectItem, SwitchQuickDiffBaseAction, SwitchQuickDiffViewItem } from 'vs/workbench/contrib/scm/browser/dirtyDiffSwitcher';\n\nclass DiffActionRunner extends ActionRunner {\n\n\tprotected override runAction(action: IAction, context: any): Promise<any> {\n\t\tif (action instanceof MenuItemAction) {\n\t\t\treturn action.run(...context);\n\t\t}\n\n\t\treturn super.runAction(action, context);\n\t}\n}\n\nexport interface IModelRegistry {\n\tgetModel(editorModel: IEditorModel): DirtyDiffModel | undefined;\n}\n\nexport interface DirtyDiffContribution extends IEditorContribution {\n\tgetChanges(): IChange[];\n}\n\nexport const isDirtyDiffVisible = new RawContextKey<boolean>('dirtyDiffVisible', false);\n\nfunction getChangeHeight(change: IChange): number {\n\tconst modified = change.modifiedEndLineNumber - change.modifiedStartLineNumber + 1;\n\tconst original = change.originalEndLineNumber - change.originalStartLineNumber + 1;\n\n\tif (change.originalEndLineNumber === 0) {\n\t\treturn modified;\n\t} else if (change.modifiedEndLineNumber === 0) {\n\t\treturn original;\n\t} else {\n\t\treturn modified + original;\n\t}\n}\n\nfunction getModifiedEndLineNumber(change: IChange): number {\n\tif (change.modifiedEndLineNumber === 0) {\n\t\treturn change.modifiedStartLineNumber === 0 ? 1 : change.modifiedStartLineNumber;\n\t} else {\n\t\treturn change.modifiedEndLineNumber;\n\t}\n}\n\nfunction lineIntersectsChange(lineNumber: number, change: IChange): boolean {\n\t// deletion at the beginning of the file\n\tif (lineNumber === 1 && change.modifiedStartLineNumber === 0 && change.modifiedEndLineNumber === 0) {\n\t\treturn true;\n\t}\n\n\treturn lineNumber >= change.modifiedStartLineNumber && lineNumber <= (change.modifiedEndLineNumber || change.modifiedStartLineNumber);\n}\n\nclass UIEditorAction extends Action {\n\n\tprivate editor: ICodeEditor;\n\tprivate action: EditorAction;\n\tprivate instantiationService: IInstantiationService;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\taction: EditorAction,\n\t\tcssClass: string,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IInstantiationService instantiationService: IInstantiationService\n\t) {\n\t\tconst keybinding = keybindingService.lookupKeybinding(action.id);\n\t\tconst label = action.label + (keybinding ? ` (${keybinding.getLabel()})` : '');\n\n\t\tsuper(action.id, label, cssClass);\n\n\t\tthis.instantiationService = instantiationService;\n\t\tthis.action = action;\n\t\tthis.editor = editor;\n\t}\n\n\toverride run(): Promise<any> {\n\t\treturn Promise.resolve(this.instantiationService.invokeFunction(accessor => this.action.run(accessor, this.editor, null)));\n\t}\n}\n\nenum ChangeType {\n\tModify,\n\tAdd,\n\tDelete\n}\n\nfunction getChangeType(change: IChange): ChangeType {\n\tif (change.originalEndLineNumber === 0) {\n\t\treturn ChangeType.Add;\n\t} else if (change.modifiedEndLineNumber === 0) {\n\t\treturn ChangeType.Delete;\n\t} else {\n\t\treturn ChangeType.Modify;\n\t}\n}\n\nfunction getChangeTypeColor(theme: IColorTheme, changeType: ChangeType): Color | undefined {\n\tswitch (changeType) {\n\t\tcase ChangeType.Modify: return theme.getColor(editorGutterModifiedBackground);\n\t\tcase ChangeType.Add: return theme.getColor(editorGutterAddedBackground);\n\t\tcase ChangeType.Delete: return theme.getColor(editorGutterDeletedBackground);\n\t}\n}\n\nfunction getOuterEditorFromDiffEditor(accessor: ServicesAccessor): ICodeEditor | null {\n\tconst diffEditors = accessor.get(ICodeEditorService).listDiffEditors();\n\n\tfor (const diffEditor of diffEditors) {\n\t\tif (diffEditor.hasTextFocus() && diffEditor instanceof EmbeddedDiffEditorWidget) {\n\t\t\treturn diffEditor.getParentEditor();\n\t\t}\n\t}\n\n\treturn getOuterEditor(accessor);\n}\n\nclass DirtyDiffWidget extends PeekViewWidget {\n\n\tprivate diffEditor!: EmbeddedDiffEditorWidget;\n\tprivate title: string;\n\tprivate menu: IMenu | undefined;\n\tprivate _index: number = 0;\n\tprivate _provider: string = '';\n\tprivate change: IChange | undefined;\n\tprivate height: number | undefined = undefined;\n\tprivate dropdown: SwitchQuickDiffViewItem | undefined;\n\tprivate dropdownContainer: HTMLElement | undefined;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate model: DirtyDiffModel,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IContextKeyService private contextKeyService: IContextKeyService\n\t) {\n\t\tsuper(editor, { isResizeable: true, frameWidth: 1, keepEditorSelection: true, className: 'dirty-diff' }, instantiationService);\n\n\t\tthis._disposables.add(themeService.onDidColorThemeChange(this._applyTheme, this));\n\t\tthis._applyTheme(themeService.getColorTheme());\n\n\t\tif (this.model.original.length > 0) {\n\t\t\tcontextKeyService = contextKeyService.createOverlay([['originalResourceScheme', this.model.original[0].uri.scheme], ['originalResourceSchemes', this.model.original.map(original => original.uri.scheme)]]);\n\t\t}\n\n\t\tthis.create();\n\t\tif (editor.hasModel()) {\n\t\t\tthis.title = basename(editor.getModel().uri);\n\t\t} else {\n\t\t\tthis.title = '';\n\t\t}\n\t\tthis.setTitle(this.title);\n\t}\n\n\tget provider(): string {\n\t\treturn this._provider;\n\t}\n\n\tget index(): number {\n\t\treturn this._index;\n\t}\n\n\tget visibleRange(): Range | undefined {\n\t\tconst visibleRanges = this.diffEditor.getModifiedEditor().getVisibleRanges();\n\t\treturn visibleRanges.length >= 0 ? visibleRanges[0] : undefined;\n\t}\n\n\tshowChange(index: number, usePosition: boolean = true): void {\n\t\tconst labeledChange = this.model.changes[index];\n\t\tconst change = labeledChange.change;\n\t\tthis._index = index;\n\t\tthis.contextKeyService.createKey('originalResourceScheme', this.model.changes[index].uri.scheme);\n\t\tthis.updateActions();\n\n\t\tthis._provider = labeledChange.label;\n\t\tthis.change = change;\n\n\t\tconst originalModel = this.model.original;\n\n\t\tif (!originalModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst onFirstDiffUpdate = Event.once(this.diffEditor.onDidUpdateDiff);\n\n\t\t// TODO@joao TODO@alex need this setTimeout probably because the\n\t\t// non-side-by-side diff still hasn't created the view zones\n\t\tonFirstDiffUpdate(() => setTimeout(() => this.revealChange(change), 0));\n\n\t\tconst diffEditorModel = this.model.getDiffEditorModel(labeledChange.uri.toString());\n\t\tif (!diffEditorModel) {\n\t\t\treturn;\n\t\t}\n\t\tthis.diffEditor.setModel(diffEditorModel);\n\t\tthis.dropdown?.setSelection(labeledChange.label);\n\n\t\tconst position = new Position(getModifiedEndLineNumber(change), 1);\n\n\t\tconst lineHeight = this.editor.getOption(EditorOption.lineHeight);\n\t\tconst editorHeight = this.editor.getLayoutInfo().height;\n\t\tconst editorHeightInLines = Math.floor(editorHeight / lineHeight);\n\t\tconst height = Math.min(getChangeHeight(change) + /* padding */ 8, Math.floor(editorHeightInLines / 3));\n\n\t\tthis.renderTitle(labeledChange.label);\n\n\t\tconst changeType = getChangeType(change);\n\t\tconst changeTypeColor = getChangeTypeColor(this.themeService.getColorTheme(), changeType);\n\t\tthis.style({ frameColor: changeTypeColor, arrowColor: changeTypeColor });\n\n\t\tconst providerSpecificChanges: IChange[] = [];\n\t\tlet contextIndex = index;\n\t\tfor (const change of this.model.changes) {\n\t\t\tif (change.label === this.model.changes[this._index].label) {\n\t\t\t\tproviderSpecificChanges.push(change.change);\n\t\t\t\tif (labeledChange === change) {\n\t\t\t\t\tcontextIndex = providerSpecificChanges.length - 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._actionbarWidget!.context = [diffEditorModel.modified.uri, providerSpecificChanges, contextIndex];\n\t\tif (usePosition) {\n\t\t\tthis.show(position, height);\n\t\t}\n\t\tthis.editor.focus();\n\t}\n\n\tprivate renderTitle(label: string): void {\n\t\tconst providerChanges = this.model.mapChanges.get(label)!;\n\t\tconst providerIndex = providerChanges.indexOf(this._index);\n\n\t\tlet detail: string;\n\t\tif (!this.shouldUseDropdown()) {\n\t\t\tdetail = this.model.changes.length > 1\n\t\t\t\t? nls.localize('changes', \"{0} - {1} of {2} changes\", label, providerIndex + 1, providerChanges.length)\n\t\t\t\t: nls.localize('change', \"{0} - {1} of {2} change\", label, providerIndex + 1, providerChanges.length);\n\t\t\tthis.dropdownContainer!.style.display = 'none';\n\t\t} else {\n\t\t\tdetail = this.model.changes.length > 1\n\t\t\t\t? nls.localize('multiChanges', \"{0} of {1} changes\", providerIndex + 1, providerChanges.length)\n\t\t\t\t: nls.localize('multiChange', \"{0} of {1} change\", providerIndex + 1, providerChanges.length);\n\t\t\tthis.dropdownContainer!.style.display = 'inherit';\n\t\t}\n\n\t\tthis.setTitle(this.title, detail);\n\t}\n\n\tprivate switchQuickDiff(event?: IQuickDiffSelectItem) {\n\t\tconst newProvider = event?.provider;\n\t\tif (newProvider === this.model.changes[this._index].label) {\n\t\t\treturn;\n\t\t}\n\t\tlet closestGreaterIndex = this._index < this.model.changes.length - 1 ? this._index + 1 : 0;\n\t\tfor (let i = closestGreaterIndex; i !== this._index; i < this.model.changes.length - 1 ? i++ : i = 0) {\n\t\t\tif (this.model.changes[i].label === newProvider) {\n\t\t\t\tclosestGreaterIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tlet closestLesserIndex = this._index > 0 ? this._index - 1 : this.model.changes.length - 1;\n\t\tfor (let i = closestLesserIndex; i !== this._index; i >= 0 ? i-- : i = this.model.changes.length - 1) {\n\t\t\tif (this.model.changes[i].label === newProvider) {\n\t\t\t\tclosestLesserIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tconst closestIndex = Math.abs(this.model.changes[closestGreaterIndex].change.modifiedEndLineNumber - this.model.changes[this._index].change.modifiedEndLineNumber)\n\t\t\t< Math.abs(this.model.changes[closestLesserIndex].change.modifiedEndLineNumber - this.model.changes[this._index].change.modifiedEndLineNumber)\n\t\t\t? closestGreaterIndex : closestLesserIndex;\n\t\tthis.showChange(closestIndex, false);\n\t}\n\n\tprivate shouldUseDropdown(): boolean {\n\t\tlet providersWithChangesCount = 0;\n\t\tif (this.model.mapChanges.size > 1) {\n\t\t\tconst keys = Array.from(this.model.mapChanges.keys());\n\t\t\tfor (let i = 0; (i < keys.length) && (providersWithChangesCount <= 1); i++) {\n\t\t\t\tif (this.model.mapChanges.get(keys[i])!.length > 0) {\n\t\t\t\t\tprovidersWithChangesCount++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn providersWithChangesCount >= 2;\n\t}\n\n\tprivate updateActions(): void {\n\t\tif (!this._actionbarWidget) {\n\t\t\treturn;\n\t\t}\n\t\tconst previous = this.instantiationService.createInstance(UIEditorAction, this.editor, new ShowPreviousChangeAction(this.editor), ThemeIcon.asClassName(gotoPreviousLocation));\n\t\tconst next = this.instantiationService.createInstance(UIEditorAction, this.editor, new ShowNextChangeAction(this.editor), ThemeIcon.asClassName(gotoNextLocation));\n\n\t\tthis._disposables.add(previous);\n\t\tthis._disposables.add(next);\n\n\t\tconst actions: IAction[] = [];\n\t\tif (this.menu) {\n\t\t\tthis.menu.dispose();\n\t\t}\n\t\tthis.menu = this.menuService.createMenu(MenuId.SCMChangeContext, this.contextKeyService);\n\t\tcreateAndFillInActionBarActions(this.menu, { shouldForwardArgs: true }, actions);\n\t\tthis._actionbarWidget.clear();\n\t\tthis._actionbarWidget.push(actions.reverse(), { label: false, icon: true });\n\t\tthis._actionbarWidget.push([next, previous], { label: false, icon: true });\n\t\tthis._actionbarWidget.push(new Action('peekview.close', nls.localize('label.close', \"Close\"), ThemeIcon.asClassName(Codicon.close), true, () => this.dispose()), { label: false, icon: true });\n\t}\n\n\tprotected override _fillHead(container: HTMLElement): void {\n\t\tsuper._fillHead(container, true);\n\n\t\tthis.dropdownContainer = dom.prepend(this._titleElement!, dom.$('.dropdown'));\n\t\tthis.dropdown = this.instantiationService.createInstance(SwitchQuickDiffViewItem, new SwitchQuickDiffBaseAction((event?: IQuickDiffSelectItem) => this.switchQuickDiff(event)),\n\t\t\tthis.model.quickDiffs.map(quickDiffer => quickDiffer.label), this.model.changes[this._index].label);\n\t\tthis.dropdown.render(this.dropdownContainer);\n\t\tthis.updateActions();\n\t}\n\n\tprotected override _getActionBarOptions(): IActionBarOptions {\n\t\tconst actionRunner = new DiffActionRunner();\n\n\t\t// close widget on successful action\n\t\tactionRunner.onDidRun(e => {\n\t\t\tif (!(e.action instanceof UIEditorAction) && !e.error) {\n\t\t\t\tthis.dispose();\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\t...super._getActionBarOptions(),\n\t\t\tactionRunner\n\t\t};\n\t}\n\n\tprotected _fillBody(container: HTMLElement): void {\n\t\tconst options: IDiffEditorOptions = {\n\t\t\tscrollBeyondLastLine: true,\n\t\t\tscrollbar: {\n\t\t\t\tverticalScrollbarSize: 14,\n\t\t\t\thorizontal: 'auto',\n\t\t\t\tuseShadows: true,\n\t\t\t\tverticalHasArrows: false,\n\t\t\t\thorizontalHasArrows: false\n\t\t\t},\n\t\t\toverviewRulerLanes: 2,\n\t\t\tfixedOverflowWidgets: true,\n\t\t\tminimap: { enabled: false },\n\t\t\trenderSideBySide: false,\n\t\t\treadOnly: false,\n\t\t\trenderIndicators: false,\n\t\t\tdiffAlgorithm: 'advanced',\n\t\t\tstickyScroll: { enabled: false }\n\t\t};\n\n\t\tthis.diffEditor = this.instantiationService.createInstance(EmbeddedDiffEditorWidget, container, options, {}, this.editor);\n\t\tthis._disposables.add(this.diffEditor);\n\t}\n\n\tprotected override _onWidth(width: number): void {\n\t\tif (typeof this.height === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.diffEditor.layout({ height: this.height, width });\n\t}\n\n\tprotected override _doLayoutBody(height: number, width: number): void {\n\t\tsuper._doLayoutBody(height, width);\n\t\tthis.diffEditor.layout({ height, width });\n\n\t\tif (typeof this.height === 'undefined' && this.change) {\n\t\t\tthis.revealChange(this.change);\n\t\t}\n\n\t\tthis.height = height;\n\t}\n\n\tprivate revealChange(change: IChange): void {\n\t\tlet start: number, end: number;\n\n\t\tif (change.modifiedEndLineNumber === 0) { // deletion\n\t\t\tstart = change.modifiedStartLineNumber;\n\t\t\tend = change.modifiedStartLineNumber + 1;\n\t\t} else if (change.originalEndLineNumber > 0) { // modification\n\t\t\tstart = change.modifiedStartLineNumber - 1;\n\t\t\tend = change.modifiedEndLineNumber + 1;\n\t\t} else { // insertion\n\t\t\tstart = change.modifiedStartLineNumber;\n\t\t\tend = change.modifiedEndLineNumber;\n\t\t}\n\n\t\tthis.diffEditor.revealLinesInCenter(start, end, ScrollType.Immediate);\n\t}\n\n\tprivate _applyTheme(theme: IColorTheme) {\n\t\tconst borderColor = theme.getColor(peekViewBorder) || Color.transparent;\n\t\tthis.style({\n\t\t\tarrowColor: borderColor,\n\t\t\tframeColor: borderColor,\n\t\t\theaderBackgroundColor: theme.getColor(peekViewTitleBackground) || Color.transparent,\n\t\t\tprimaryHeadingColor: theme.getColor(peekViewTitleForeground),\n\t\t\tsecondaryHeadingColor: theme.getColor(peekViewTitleInfoForeground)\n\t\t});\n\t}\n\n\tprotected override revealRange(range: Range) {\n\t\tthis.editor.revealLineInCenterIfOutsideViewport(range.endLineNumber, ScrollType.Smooth);\n\t}\n\n\toverride hasFocus(): boolean {\n\t\treturn this.diffEditor.hasTextFocus();\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis.menu?.dispose();\n\t}\n}\n\nexport class ShowPreviousChangeAction extends EditorAction {\n\n\tconstructor(private readonly outerEditor?: ICodeEditor) {\n\t\tsuper({\n\t\t\tid: 'editor.action.dirtydiff.previous',\n\t\t\tlabel: nls.localize('show previous change', \"Show Previous Change\"),\n\t\t\talias: 'Show Previous Change',\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: { kbExpr: EditorContextKeys.editorTextFocus, primary: KeyMod.Shift | KeyMod.Alt | KeyCode.F3, weight: KeybindingWeight.EditorContrib }\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor): void {\n\t\tconst outerEditor = this.outerEditor ?? getOuterEditorFromDiffEditor(accessor);\n\n\t\tif (!outerEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!controller.canNavigate()) {\n\t\t\treturn;\n\t\t}\n\n\t\tcontroller.previous();\n\t}\n}\nregisterEditorAction(ShowPreviousChangeAction);\n\nexport class ShowNextChangeAction extends EditorAction {\n\n\tconstructor(private readonly outerEditor?: ICodeEditor) {\n\t\tsuper({\n\t\t\tid: 'editor.action.dirtydiff.next',\n\t\t\tlabel: nls.localize('show next change', \"Show Next Change\"),\n\t\t\talias: 'Show Next Change',\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: { kbExpr: EditorContextKeys.editorTextFocus, primary: KeyMod.Alt | KeyCode.F3, weight: KeybindingWeight.EditorContrib }\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor): void {\n\t\tconst outerEditor = this.outerEditor ?? getOuterEditorFromDiffEditor(accessor);\n\n\t\tif (!outerEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!controller.canNavigate()) {\n\t\t\treturn;\n\t\t}\n\n\t\tcontroller.next();\n\t}\n}\nregisterEditorAction(ShowNextChangeAction);\n\n// Go to menu\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\n\tgroup: '7_change_nav',\n\tcommand: {\n\t\tid: 'editor.action.dirtydiff.next',\n\t\ttitle: nls.localize({ key: 'miGotoNextChange', comment: ['&& denotes a mnemonic'] }, \"Next &&Change\")\n\t},\n\torder: 1\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarGoMenu, {\n\tgroup: '7_change_nav',\n\tcommand: {\n\t\tid: 'editor.action.dirtydiff.previous',\n\t\ttitle: nls.localize({ key: 'miGotoPreviousChange', comment: ['&& denotes a mnemonic'] }, \"Previous &&Change\")\n\t},\n\torder: 2\n});\n\nexport class GotoPreviousChangeAction extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.editor.previousChange',\n\t\t\tlabel: nls.localize('move to previous change', \"Go to Previous Change\"),\n\t\t\talias: 'Go to Previous Change',\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: { kbExpr: EditorContextKeys.editorTextFocus, primary: KeyMod.Shift | KeyMod.Alt | KeyCode.F5, weight: KeybindingWeight.EditorContrib }\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor): Promise<void> {\n\t\tconst outerEditor = getOuterEditorFromDiffEditor(accessor);\n\t\tconst audioCueService = accessor.get(IAudioCueService);\n\t\tconst accessibilityService = accessor.get(IAccessibilityService);\n\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\n\t\tif (!outerEditor || !outerEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller || !controller.modelRegistry) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lineNumber = outerEditor.getPosition().lineNumber;\n\t\tconst model = controller.modelRegistry.getModel(outerEditor.getModel());\n\t\tif (!model || model.changes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = model.findPreviousClosestChange(lineNumber, false);\n\t\tconst change = model.changes[index];\n\t\tawait playAudioCueForChange(change.change, audioCueService);\n\t\tsetPositionAndSelection(change.change, outerEditor, accessibilityService, codeEditorService);\n\t}\n}\nregisterEditorAction(GotoPreviousChangeAction);\n\nexport class GotoNextChangeAction extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'workbench.action.editor.nextChange',\n\t\t\tlabel: nls.localize('move to next change', \"Go to Next Change\"),\n\t\t\talias: 'Go to Next Change',\n\t\t\tprecondition: TextCompareEditorActiveContext.toNegated(),\n\t\t\tkbOpts: { kbExpr: EditorContextKeys.editorTextFocus, primary: KeyMod.Alt | KeyCode.F5, weight: KeybindingWeight.EditorContrib }\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor): Promise<void> {\n\t\tconst audioCueService = accessor.get(IAudioCueService);\n\t\tconst outerEditor = getOuterEditorFromDiffEditor(accessor);\n\t\tconst accessibilityService = accessor.get(IAccessibilityService);\n\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\n\t\tif (!outerEditor || !outerEditor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller || !controller.modelRegistry) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lineNumber = outerEditor.getPosition().lineNumber;\n\t\tconst model = controller.modelRegistry.getModel(outerEditor.getModel());\n\n\t\tif (!model || model.changes.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = model.findNextClosestChange(lineNumber, false);\n\t\tconst change = model.changes[index].change;\n\t\tawait playAudioCueForChange(change, audioCueService);\n\t\tsetPositionAndSelection(change, outerEditor, accessibilityService, codeEditorService);\n\t}\n}\n\nfunction setPositionAndSelection(change: IChange, editor: ICodeEditor, accessibilityService: IAccessibilityService, codeEditorService: ICodeEditorService) {\n\tconst position = new Position(change.modifiedStartLineNumber, 1);\n\teditor.setPosition(position);\n\teditor.revealPositionInCenter(position);\n\tif (accessibilityService.isScreenReaderOptimized()) {\n\t\teditor.setSelection({ startLineNumber: change.modifiedStartLineNumber, startColumn: 0, endLineNumber: change.modifiedStartLineNumber, endColumn: Number.MAX_VALUE });\n\t\tcodeEditorService.getActiveCodeEditor()?.writeScreenReaderContent('diff-navigation');\n\t}\n}\n\nasync function playAudioCueForChange(change: IChange, audioCueService: IAudioCueService) {\n\tconst changeType = getChangeType(change);\n\tswitch (changeType) {\n\t\tcase ChangeType.Add:\n\t\t\taudioCueService.playAudioCue(AudioCue.diffLineInserted, { allowManyInParallel: true, source: 'dirtyDiffDecoration' });\n\t\t\tbreak;\n\t\tcase ChangeType.Delete:\n\t\t\taudioCueService.playAudioCue(AudioCue.diffLineDeleted, { allowManyInParallel: true, source: 'dirtyDiffDecoration' });\n\t\t\tbreak;\n\t\tcase ChangeType.Modify:\n\t\t\taudioCueService.playAudioCue(AudioCue.diffLineModified, { allowManyInParallel: true, source: 'dirtyDiffDecoration' });\n\t\t\tbreak;\n\t}\n}\n\nregisterEditorAction(GotoNextChangeAction);\n\nKeybindingsRegistry.registerCommandAndKeybindingRule({\n\tid: 'closeDirtyDiff',\n\tweight: KeybindingWeight.EditorContrib + 50,\n\tprimary: KeyCode.Escape,\n\tsecondary: [KeyMod.Shift | KeyCode.Escape],\n\twhen: ContextKeyExpr.and(isDirtyDiffVisible),\n\thandler: (accessor: ServicesAccessor) => {\n\t\tconst outerEditor = getOuterEditorFromDiffEditor(accessor);\n\n\t\tif (!outerEditor) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst controller = DirtyDiffController.get(outerEditor);\n\n\t\tif (!controller) {\n\t\t\treturn;\n\t\t}\n\n\t\tcontroller.close();\n\t}\n});\n\nexport class DirtyDiffController extends Disposable implements DirtyDiffContribution {\n\n\tpublic static readonly ID = 'editor.contrib.dirtydiff';\n\n\tstatic get(editor: ICodeEditor): DirtyDiffController | null {\n\t\treturn editor.getContribution<DirtyDiffController>(DirtyDiffController.ID);\n\t}\n\n\tmodelRegistry: IModelRegistry | null = null;\n\n\tprivate model: DirtyDiffModel | null = null;\n\tprivate widget: DirtyDiffWidget | null = null;\n\tprivate readonly isDirtyDiffVisible!: IContextKey<boolean>;\n\tprivate session: IDisposable = Disposable.None;\n\tprivate mouseDownInfo: { lineNumber: number } | null = null;\n\tprivate enabled = false;\n\tprivate readonly gutterActionDisposables = new DisposableStore();\n\tprivate stylesheet: HTMLStyleElement;\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t\tthis.enabled = !contextKeyService.getContextKeyValue('isInDiffEditor');\n\t\tthis.stylesheet = dom.createStyleSheet();\n\t\tthis._register(toDisposable(() => this.stylesheet.remove()));\n\n\t\tif (this.enabled) {\n\t\t\tthis.isDirtyDiffVisible = isDirtyDiffVisible.bindTo(contextKeyService);\n\t\t\tthis._register(editor.onDidChangeModel(() => this.close()));\n\n\t\t\tconst onDidChangeGutterAction = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorationsGutterAction'));\n\t\t\tthis._register(onDidChangeGutterAction(this.onDidChangeGutterAction, this));\n\t\t\tthis.onDidChangeGutterAction();\n\t\t}\n\t}\n\n\tprivate onDidChangeGutterAction(): void {\n\t\tconst gutterAction = this.configurationService.getValue<'diff' | 'none'>('scm.diffDecorationsGutterAction');\n\n\t\tthis.gutterActionDisposables.clear();\n\n\t\tif (gutterAction === 'diff') {\n\t\t\tthis.gutterActionDisposables.add(this.editor.onMouseDown(e => this.onEditorMouseDown(e)));\n\t\t\tthis.gutterActionDisposables.add(this.editor.onMouseUp(e => this.onEditorMouseUp(e)));\n\t\t\tthis.stylesheet.textContent = `\n\t\t\t\t.monaco-editor .dirty-diff-glyph {\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t}\n\n\t\t\t\t.monaco-editor .margin-view-overlays .dirty-diff-glyph:hover::before {\n\t\t\t\t\theight: 100%;\n\t\t\t\t\twidth: 6px;\n\t\t\t\t\tleft: -6px;\n\t\t\t\t}\n\n\t\t\t\t.monaco-editor .margin-view-overlays .dirty-diff-deleted:hover::after {\n\t\t\t\t\tbottom: 0;\n\t\t\t\t\tborder-top-width: 0;\n\t\t\t\t\tborder-bottom-width: 0;\n\t\t\t\t}\n\t\t\t`;\n\t\t} else {\n\t\t\tthis.stylesheet.textContent = ``;\n\t\t}\n\t}\n\n\tcanNavigate(): boolean {\n\t\treturn !this.widget || (this.widget?.index === -1) || (!!this.model && this.model.changes.length > 1);\n\t}\n\n\trefresh(): void {\n\t\tthis.widget?.showChange(this.widget.index, false);\n\t}\n\n\tnext(lineNumber?: number): void {\n\t\tif (!this.assertWidget()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.widget || !this.model) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet index: number;\n\t\tif (this.editor.hasModel() && (typeof lineNumber === 'number' || !this.widget.provider)) {\n\t\t\tindex = this.model.findNextClosestChange(typeof lineNumber === 'number' ? lineNumber : this.editor.getPosition().lineNumber, true, this.widget.provider);\n\t\t} else {\n\t\t\tconst providerChanges: number[] = this.model.mapChanges.get(this.widget.provider) ?? this.model.mapChanges.values().next().value;\n\t\t\tconst mapIndex = providerChanges.findIndex(value => value === this.widget!.index);\n\t\t\tindex = providerChanges[rot(mapIndex + 1, providerChanges.length)];\n\t\t}\n\n\t\tthis.widget.showChange(index);\n\t}\n\n\tprevious(lineNumber?: number): void {\n\t\tif (!this.assertWidget()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.widget || !this.model) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet index: number;\n\t\tif (this.editor.hasModel() && (typeof lineNumber === 'number')) {\n\t\t\tindex = this.model.findPreviousClosestChange(typeof lineNumber === 'number' ? lineNumber : this.editor.getPosition().lineNumber, true, this.widget.provider);\n\t\t} else {\n\t\t\tconst providerChanges: number[] = this.model.mapChanges.get(this.widget.provider) ?? this.model.mapChanges.values().next().value;\n\t\t\tconst mapIndex = providerChanges.findIndex(value => value === this.widget!.index);\n\t\t\tindex = providerChanges[rot(mapIndex - 1, providerChanges.length)];\n\t\t}\n\n\t\tthis.widget.showChange(index);\n\t}\n\n\tclose(): void {\n\t\tthis.session.dispose();\n\t\tthis.session = Disposable.None;\n\t}\n\n\tprivate assertWidget(): boolean {\n\t\tif (!this.enabled) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.widget) {\n\t\t\tif (!this.model || this.model.changes.length === 0) {\n\t\t\t\tthis.close();\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tif (!this.modelRegistry) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst editorModel = this.editor.getModel();\n\n\t\tif (!editorModel) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst model = this.modelRegistry.getModel(editorModel);\n\n\t\tif (!model) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (model.changes.length === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.model = model;\n\t\tthis.widget = this.instantiationService.createInstance(DirtyDiffWidget, this.editor, model);\n\t\tthis.isDirtyDiffVisible.set(true);\n\n\t\tconst disposables = new DisposableStore();\n\t\tdisposables.add(Event.once(this.widget.onDidClose)(this.close, this));\n\t\tconst onDidModelChange = Event.chain(model.onDidChange, $ =>\n\t\t\t$.filter(e => e.diff.length > 0)\n\t\t\t\t.map(e => e.diff)\n\t\t);\n\n\t\tonDidModelChange(this.onDidModelChange, this, disposables);\n\n\t\tdisposables.add(this.widget);\n\t\tdisposables.add(toDisposable(() => {\n\t\t\tthis.model = null;\n\t\t\tthis.widget = null;\n\t\t\tthis.isDirtyDiffVisible.set(false);\n\t\t\tthis.editor.focus();\n\t\t}));\n\n\t\tthis.session = disposables;\n\t\treturn true;\n\t}\n\n\tprivate onDidModelChange(splices: ISplice<LabeledChange>[]): void {\n\t\tif (!this.model || !this.widget || this.widget.hasFocus()) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const splice of splices) {\n\t\t\tif (splice.start <= this.widget.index) {\n\t\t\t\tthis.next();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.refresh();\n\t}\n\n\tprivate onEditorMouseDown(e: IEditorMouseEvent): void {\n\t\tthis.mouseDownInfo = null;\n\n\t\tconst range = e.target.range;\n\n\t\tif (!range) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!e.event.leftButton) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\t\treturn;\n\t\t}\n\t\tif (!e.target.element) {\n\t\t\treturn;\n\t\t}\n\t\tif (e.target.element.className.indexOf('dirty-diff-glyph') < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = e.target.detail;\n\t\tconst offsetLeftInGutter = e.target.element.offsetLeft;\n\t\tconst gutterOffsetX = data.offsetX - offsetLeftInGutter;\n\n\t\t// TODO@joao TODO@alex TODO@martin this is such that we don't collide with folding\n\t\tif (gutterOffsetX < -3 || gutterOffsetX > 3) { // dirty diff decoration on hover is 6px wide\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mouseDownInfo = { lineNumber: range.startLineNumber };\n\t}\n\n\tprivate onEditorMouseUp(e: IEditorMouseEvent): void {\n\t\tif (!this.mouseDownInfo) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { lineNumber } = this.mouseDownInfo;\n\t\tthis.mouseDownInfo = null;\n\n\t\tconst range = e.target.range;\n\n\t\tif (!range || range.startLineNumber !== lineNumber) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (e.target.type !== MouseTargetType.GUTTER_LINE_DECORATIONS) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.modelRegistry) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst editorModel = this.editor.getModel();\n\n\t\tif (!editorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst model = this.modelRegistry.getModel(editorModel);\n\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst index = model.changes.findIndex(change => lineIntersectsChange(lineNumber, change.change));\n\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (index === this.widget?.index) {\n\t\t\tthis.close();\n\t\t} else {\n\t\t\tthis.next(lineNumber);\n\t\t}\n\t}\n\n\tgetChanges(): IChange[] {\n\t\tif (!this.modelRegistry) {\n\t\t\treturn [];\n\t\t}\n\t\tif (!this.editor.hasModel()) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst model = this.modelRegistry.getModel(this.editor.getModel());\n\n\t\tif (!model) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn model.changes.map(change => change.change);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.gutterActionDisposables.dispose();\n\t\tsuper.dispose();\n\t}\n}\n\nconst editorGutterModifiedBackground = registerColor('editorGutter.modifiedBackground', {\n\tdark: '#1B81A8',\n\tlight: '#2090D3',\n\thcDark: '#1B81A8',\n\thcLight: '#2090D3'\n}, nls.localize('editorGutterModifiedBackground', \"Editor gutter background color for lines that are modified.\"));\n\nconst editorGutterAddedBackground = registerColor('editorGutter.addedBackground', {\n\tdark: '#487E02',\n\tlight: '#48985D',\n\thcDark: '#487E02',\n\thcLight: '#48985D'\n}, nls.localize('editorGutterAddedBackground', \"Editor gutter background color for lines that are added.\"));\n\nconst editorGutterDeletedBackground = registerColor('editorGutter.deletedBackground', {\n\tdark: editorErrorForeground,\n\tlight: editorErrorForeground,\n\thcDark: editorErrorForeground,\n\thcLight: editorErrorForeground\n}, nls.localize('editorGutterDeletedBackground', \"Editor gutter background color for lines that are deleted.\"));\n\nconst minimapGutterModifiedBackground = registerColor('minimapGutter.modifiedBackground', {\n\tdark: editorGutterModifiedBackground,\n\tlight: editorGutterModifiedBackground,\n\thcDark: editorGutterModifiedBackground,\n\thcLight: editorGutterModifiedBackground\n}, nls.localize('minimapGutterModifiedBackground', \"Minimap gutter background color for lines that are modified.\"));\n\nconst minimapGutterAddedBackground = registerColor('minimapGutter.addedBackground', {\n\tdark: editorGutterAddedBackground,\n\tlight: editorGutterAddedBackground,\n\thcDark: editorGutterAddedBackground,\n\thcLight: editorGutterAddedBackground\n}, nls.localize('minimapGutterAddedBackground', \"Minimap gutter background color for lines that are added.\"));\n\nconst minimapGutterDeletedBackground = registerColor('minimapGutter.deletedBackground', {\n\tdark: editorGutterDeletedBackground,\n\tlight: editorGutterDeletedBackground,\n\thcDark: editorGutterDeletedBackground,\n\thcLight: editorGutterDeletedBackground\n}, nls.localize('minimapGutterDeletedBackground', \"Minimap gutter background color for lines that are deleted.\"));\n\nconst overviewRulerModifiedForeground = registerColor('editorOverviewRuler.modifiedForeground', { dark: transparent(editorGutterModifiedBackground, 0.6), light: transparent(editorGutterModifiedBackground, 0.6), hcDark: transparent(editorGutterModifiedBackground, 0.6), hcLight: transparent(editorGutterModifiedBackground, 0.6) }, nls.localize('overviewRulerModifiedForeground', 'Overview ruler marker color for modified content.'));\nconst overviewRulerAddedForeground = registerColor('editorOverviewRuler.addedForeground', { dark: transparent(editorGutterAddedBackground, 0.6), light: transparent(editorGutterAddedBackground, 0.6), hcDark: transparent(editorGutterAddedBackground, 0.6), hcLight: transparent(editorGutterAddedBackground, 0.6) }, nls.localize('overviewRulerAddedForeground', 'Overview ruler marker color for added content.'));\nconst overviewRulerDeletedForeground = registerColor('editorOverviewRuler.deletedForeground', { dark: transparent(editorGutterDeletedBackground, 0.6), light: transparent(editorGutterDeletedBackground, 0.6), hcDark: transparent(editorGutterDeletedBackground, 0.6), hcLight: transparent(editorGutterDeletedBackground, 0.6) }, nls.localize('overviewRulerDeletedForeground', 'Overview ruler marker color for deleted content.'));\n\nclass DirtyDiffDecorator extends Disposable {\n\n\tstatic createDecoration(className: string, options: { gutter: boolean; overview: { active: boolean; color: string }; minimap: { active: boolean; color: string }; isWholeLine: boolean }): ModelDecorationOptions {\n\t\tconst decorationOptions: IModelDecorationOptions = {\n\t\t\tdescription: 'dirty-diff-decoration',\n\t\t\tisWholeLine: options.isWholeLine,\n\t\t};\n\n\t\tif (options.gutter) {\n\t\t\tdecorationOptions.linesDecorationsClassName = `dirty-diff-glyph ${className}`;\n\t\t}\n\n\t\tif (options.overview.active) {\n\t\t\tdecorationOptions.overviewRuler = {\n\t\t\t\tcolor: themeColorFromId(options.overview.color),\n\t\t\t\tposition: OverviewRulerLane.Left\n\t\t\t};\n\t\t}\n\n\t\tif (options.minimap.active) {\n\t\t\tdecorationOptions.minimap = {\n\t\t\t\tcolor: themeColorFromId(options.minimap.color),\n\t\t\t\tposition: MinimapPosition.Gutter\n\t\t\t};\n\t\t}\n\n\t\treturn ModelDecorationOptions.createDynamic(decorationOptions);\n\t}\n\n\tprivate addedOptions: ModelDecorationOptions;\n\tprivate addedPatternOptions: ModelDecorationOptions;\n\tprivate modifiedOptions: ModelDecorationOptions;\n\tprivate modifiedPatternOptions: ModelDecorationOptions;\n\tprivate deletedOptions: ModelDecorationOptions;\n\tprivate decorations: string[] = [];\n\tprivate editorModel: ITextModel | null;\n\n\tconstructor(\n\t\teditorModel: ITextModel,\n\t\tprivate model: DirtyDiffModel,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\t\tthis.editorModel = editorModel;\n\n\t\tconst decorations = configurationService.getValue<string>('scm.diffDecorations');\n\t\tconst gutter = decorations === 'all' || decorations === 'gutter';\n\t\tconst overview = decorations === 'all' || decorations === 'overview';\n\t\tconst minimap = decorations === 'all' || decorations === 'minimap';\n\n\t\tthis.addedOptions = DirtyDiffDecorator.createDecoration('dirty-diff-added', {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerAddedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterAddedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tthis.addedPatternOptions = DirtyDiffDecorator.createDecoration('dirty-diff-added-pattern', {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerAddedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterAddedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tthis.modifiedOptions = DirtyDiffDecorator.createDecoration('dirty-diff-modified', {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerModifiedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterModifiedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tthis.modifiedPatternOptions = DirtyDiffDecorator.createDecoration('dirty-diff-modified-pattern', {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerModifiedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterModifiedBackground },\n\t\t\tisWholeLine: true\n\t\t});\n\t\tthis.deletedOptions = DirtyDiffDecorator.createDecoration('dirty-diff-deleted', {\n\t\t\tgutter,\n\t\t\toverview: { active: overview, color: overviewRulerDeletedForeground },\n\t\t\tminimap: { active: minimap, color: minimapGutterDeletedBackground },\n\t\t\tisWholeLine: false\n\t\t});\n\n\t\tthis._register(configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('scm.diffDecorationsGutterPattern')) {\n\t\t\t\tthis.onDidChange();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(model.onDidChange(this.onDidChange, this));\n\t}\n\n\tprivate onDidChange(): void {\n\t\tif (!this.editorModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst pattern = this.configurationService.getValue<{ added: boolean; modified: boolean }>('scm.diffDecorationsGutterPattern');\n\t\tconst decorations = this.model.changes.map((labeledChange) => {\n\t\t\tconst change = labeledChange.change;\n\t\t\tconst changeType = getChangeType(change);\n\t\t\tconst startLineNumber = change.modifiedStartLineNumber;\n\t\t\tconst endLineNumber = change.modifiedEndLineNumber || startLineNumber;\n\n\t\t\tswitch (changeType) {\n\t\t\t\tcase ChangeType.Add:\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tstartLineNumber: startLineNumber, startColumn: 1,\n\t\t\t\t\t\t\tendLineNumber: endLineNumber, endColumn: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions: pattern.added ? this.addedPatternOptions : this.addedOptions\n\t\t\t\t\t};\n\t\t\t\tcase ChangeType.Delete:\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tstartLineNumber: startLineNumber, startColumn: Number.MAX_VALUE,\n\t\t\t\t\t\t\tendLineNumber: startLineNumber, endColumn: Number.MAX_VALUE\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions: this.deletedOptions\n\t\t\t\t\t};\n\t\t\t\tcase ChangeType.Modify:\n\t\t\t\t\treturn {\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tstartLineNumber: startLineNumber, startColumn: 1,\n\t\t\t\t\t\t\tendLineNumber: endLineNumber, endColumn: 1\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions: pattern.modified ? this.modifiedPatternOptions : this.modifiedOptions\n\t\t\t\t\t};\n\t\t\t}\n\t\t});\n\n\t\tthis.decorations = this.editorModel.deltaDecorations(this.decorations, decorations);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tif (this.editorModel && !this.editorModel.isDisposed()) {\n\t\t\tthis.editorModel.deltaDecorations(this.decorations, []);\n\t\t}\n\n\t\tthis.editorModel = null;\n\t\tthis.decorations = [];\n\t}\n}\n\nfunction compareChanges(a: IChange, b: IChange): number {\n\tlet result = a.modifiedStartLineNumber - b.modifiedStartLineNumber;\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tresult = a.modifiedEndLineNumber - b.modifiedEndLineNumber;\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tresult = a.originalStartLineNumber - b.originalStartLineNumber;\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\treturn a.originalEndLineNumber - b.originalEndLineNumber;\n}\n\n\nexport async function getOriginalResource(quickDiffService: IQuickDiffService, uri: URI, language: string | undefined, isSynchronized: boolean | undefined): Promise<URI | null> {\n\tconst quickDiffs = await quickDiffService.getQuickDiffs(uri, language, isSynchronized);\n\treturn quickDiffs.length > 0 ? quickDiffs[0].originalResource : null;\n}\n\ntype LabeledChange = { change: IChange; label: string; uri: URI };\n\nexport class DirtyDiffModel extends Disposable {\n\n\tprivate _quickDiffs: QuickDiff[] = [];\n\tprivate _originalModels: Map<string, IResolvedTextEditorModel> = new Map(); // key is uri.toString()\n\tprivate _originalTextModels: ITextModel[] = [];\n\tprivate _model: ITextFileEditorModel;\n\tget original(): ITextModel[] { return this._originalTextModels; }\n\n\tprivate diffDelayer = new ThrottledDelayer<{ changes: LabeledChange[]; mapChanges: Map<string, number[]> } | null>(200);\n\tprivate _quickDiffsPromise?: Promise<QuickDiff[]>;\n\tprivate repositoryDisposables = new Set<IDisposable>();\n\tprivate readonly originalModelDisposables = this._register(new DisposableStore());\n\tprivate _disposed = false;\n\n\tprivate readonly _onDidChange = new Emitter<{ changes: LabeledChange[]; diff: ISplice<LabeledChange>[] }>();\n\treadonly onDidChange: Event<{ changes: LabeledChange[]; diff: ISplice<LabeledChange>[] }> = this._onDidChange.event;\n\n\tprivate _changes: LabeledChange[] = [];\n\tget changes(): LabeledChange[] { return this._changes; }\n\tprivate _mapChanges: Map<string, number[]> = new Map(); // key is the quick diff name, value is the index of the change in this._changes\n\tget mapChanges(): Map<string, number[]> { return this._mapChanges; }\n\n\tconstructor(\n\t\ttextFileModel: IResolvedTextFileEditorModel,\n\t\t@ISCMService private readonly scmService: ISCMService,\n\t\t@IQuickDiffService private readonly quickDiffService: IQuickDiffService,\n\t\t@IEditorWorkerService private readonly editorWorkerService: IEditorWorkerService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITextModelService private readonly textModelResolverService: ITextModelService,\n\t\t@IProgressService private readonly progressService: IProgressService,\n\t) {\n\t\tsuper();\n\t\tthis._model = textFileModel;\n\n\t\tthis._register(textFileModel.textEditorModel.onDidChangeContent(() => this.triggerDiff()));\n\t\tthis._register(\n\t\t\tEvent.filter(configurationService.onDidChangeConfiguration,\n\t\t\t\te => e.affectsConfiguration('scm.diffDecorationsIgnoreTrimWhitespace') || e.affectsConfiguration('diffEditor.ignoreTrimWhitespace')\n\t\t\t)(this.triggerDiff, this)\n\t\t);\n\t\tthis._register(scmService.onDidAddRepository(this.onDidAddRepository, this));\n\t\tfor (const r of scmService.repositories) {\n\t\t\tthis.onDidAddRepository(r);\n\t\t}\n\n\t\tthis._register(this._model.onDidChangeEncoding(() => {\n\t\t\tthis.diffDelayer.cancel();\n\t\t\tthis._quickDiffs = [];\n\t\t\tthis._originalModels.clear();\n\t\t\tthis._originalTextModels = [];\n\t\t\tthis._quickDiffsPromise = undefined;\n\t\t\tthis.setChanges([], new Map());\n\t\t\tthis.triggerDiff();\n\t\t}));\n\n\t\tthis._register(this.quickDiffService.onDidChangeQuickDiffProviders(() => this.triggerDiff()));\n\t\tthis.triggerDiff();\n\t}\n\n\tget quickDiffs(): readonly QuickDiff[] {\n\t\treturn this._quickDiffs;\n\t}\n\n\tpublic getDiffEditorModel(originalUri: string): IDiffEditorModel | undefined {\n\t\tif (!this._originalModels.has(originalUri)) {\n\t\t\treturn;\n\t\t}\n\t\tconst original = this._originalModels.get(originalUri)!;\n\n\t\treturn {\n\t\t\tmodified: this._model.textEditorModel!,\n\t\t\toriginal: original.textEditorModel\n\t\t};\n\t}\n\n\tprivate onDidAddRepository(repository: ISCMRepository): void {\n\t\tconst disposables = new DisposableStore();\n\n\t\tthis.repositoryDisposables.add(disposables);\n\t\tdisposables.add(toDisposable(() => this.repositoryDisposables.delete(disposables)));\n\n\t\tconst onDidChange = Event.any(repository.provider.onDidChange, repository.provider.onDidChangeResources);\n\t\tdisposables.add(onDidChange(this.triggerDiff, this));\n\n\t\tconst onDidRemoveThis = Event.filter(this.scmService.onDidRemoveRepository, r => r === repository);\n\t\tdisposables.add(onDidRemoveThis(() => dispose(disposables), null));\n\n\t\tthis.triggerDiff();\n\t}\n\n\tprivate triggerDiff(): Promise<any> {\n\t\tif (!this.diffDelayer) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn this.diffDelayer\n\t\t\t.trigger(() => this.diff())\n\t\t\t.then((result: { changes: LabeledChange[]; mapChanges: Map<string, number[]> } | null) => {\n\t\t\t\tconst originalModels = Array.from(this._originalModels.values());\n\t\t\t\tif (!result || this._disposed || this._model.isDisposed() || originalModels.some(originalModel => originalModel.isDisposed())) {\n\t\t\t\t\treturn; // disposed\n\t\t\t\t}\n\n\t\t\t\tif (originalModels.every(originalModel => originalModel.textEditorModel.getValueLength() === 0)) {\n\t\t\t\t\tresult.changes = [];\n\t\t\t\t}\n\n\t\t\t\tif (!result.changes) {\n\t\t\t\t\tresult.changes = [];\n\t\t\t\t}\n\n\t\t\t\tthis.setChanges(result.changes, result.mapChanges);\n\t\t\t}, (err) => onUnexpectedError(err));\n\t}\n\n\tprivate setChanges(changes: LabeledChange[], mapChanges: Map<string, number[]>): void {\n\t\tconst diff = sortedDiff(this._changes, changes, (a, b) => compareChanges(a.change, b.change));\n\t\tthis._changes = changes;\n\t\tthis._mapChanges = mapChanges;\n\t\tthis._onDidChange.fire({ changes, diff });\n\t}\n\n\tprivate diff(): Promise<{ changes: LabeledChange[]; mapChanges: Map<string, number[]> } | null> {\n\t\treturn this.progressService.withProgress({ location: ProgressLocation.Scm, delay: 250 }, async () => {\n\t\t\tconst originalURIs = await this.getQuickDiffsPromise();\n\t\t\tif (this._disposed || this._model.isDisposed() || (originalURIs.length === 0)) {\n\t\t\t\treturn Promise.resolve({ changes: [], mapChanges: new Map() }); // disposed\n\t\t\t}\n\n\t\t\tconst filteredToDiffable = originalURIs.filter(quickDiff => this.editorWorkerService.canComputeDirtyDiff(quickDiff.originalResource, this._model.resource));\n\t\t\tif (filteredToDiffable.length === 0) {\n\t\t\t\treturn Promise.resolve({ changes: [], mapChanges: new Map() }); // All files are too large\n\t\t\t}\n\n\t\t\tconst ignoreTrimWhitespaceSetting = this.configurationService.getValue<'true' | 'false' | 'inherit'>('scm.diffDecorationsIgnoreTrimWhitespace');\n\t\t\tconst ignoreTrimWhitespace = ignoreTrimWhitespaceSetting === 'inherit'\n\t\t\t\t? this.configurationService.getValue<boolean>('diffEditor.ignoreTrimWhitespace')\n\t\t\t\t: ignoreTrimWhitespaceSetting !== 'false';\n\n\t\t\tconst allDiffs: LabeledChange[] = [];\n\t\t\tfor (const quickDiff of filteredToDiffable) {\n\t\t\t\tconst dirtyDiff = await this.editorWorkerService.computeDirtyDiff(quickDiff.originalResource, this._model.resource, ignoreTrimWhitespace);\n\t\t\t\tif (dirtyDiff) {\n\t\t\t\t\tfor (const diff of dirtyDiff) {\n\t\t\t\t\t\tif (diff) {\n\t\t\t\t\t\t\tallDiffs.push({ change: diff, label: quickDiff.label, uri: quickDiff.originalResource });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst sorted = allDiffs.sort((a, b) => compareChanges(a.change, b.change));\n\t\t\tconst map: Map<string, number[]> = new Map();\n\t\t\tfor (let i = 0; i < sorted.length; i++) {\n\t\t\t\tconst label = sorted[i].label;\n\t\t\t\tif (!map.has(label)) {\n\t\t\t\t\tmap.set(label, []);\n\t\t\t\t}\n\t\t\t\tmap.get(label)!.push(i);\n\t\t\t}\n\t\t\treturn { changes: sorted, mapChanges: map };\n\t\t});\n\t}\n\n\tprivate getQuickDiffsPromise(): Promise<QuickDiff[]> {\n\t\tif (this._quickDiffsPromise) {\n\t\t\treturn this._quickDiffsPromise;\n\t\t}\n\n\t\tthis._quickDiffsPromise = this.getOriginalResource().then(async (quickDiffs) => {\n\t\t\tif (this._disposed) { // disposed\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tif (quickDiffs.length === 0) {\n\t\t\t\tthis._quickDiffs = [];\n\t\t\t\tthis._originalModels.clear();\n\t\t\t\tthis._originalTextModels = [];\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tif (equals(this._quickDiffs, quickDiffs, (a, b) => a.originalResource.toString() === b.originalResource.toString() && a.label === b.label)) {\n\t\t\t\treturn quickDiffs;\n\t\t\t}\n\n\t\t\tthis.originalModelDisposables.clear();\n\t\t\tthis._originalModels.clear();\n\t\t\tthis._originalTextModels = [];\n\t\t\tthis._quickDiffs = quickDiffs;\n\t\t\treturn (await Promise.all(quickDiffs.map(async (quickDiff) => {\n\t\t\t\ttry {\n\t\t\t\t\tconst ref = await this.textModelResolverService.createModelReference(quickDiff.originalResource);\n\t\t\t\t\tif (this._disposed) { // disposed\n\t\t\t\t\t\tref.dispose();\n\t\t\t\t\t\treturn [];\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._originalModels.set(quickDiff.originalResource.toString(), ref.object);\n\t\t\t\t\tthis._originalTextModels.push(ref.object.textEditorModel);\n\n\t\t\t\t\tif (isTextFileEditorModel(ref.object)) {\n\t\t\t\t\t\tconst encoding = this._model.getEncoding();\n\n\t\t\t\t\t\tif (encoding) {\n\t\t\t\t\t\t\tref.object.setEncoding(encoding, EncodingMode.Decode);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.originalModelDisposables.add(ref);\n\t\t\t\t\tthis.originalModelDisposables.add(ref.object.textEditorModel.onDidChangeContent(() => this.triggerDiff()));\n\n\t\t\t\t\treturn quickDiff;\n\t\t\t\t} catch (error) {\n\t\t\t\t\treturn []; // possibly invalid reference\n\t\t\t\t}\n\t\t\t}))).flat();\n\t\t});\n\n\t\treturn this._quickDiffsPromise.finally(() => {\n\t\t\tthis._quickDiffsPromise = undefined;\n\t\t});\n\t}\n\n\tprivate async getOriginalResource(): Promise<QuickDiff[]> {\n\t\tif (this._disposed) {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\n\t\tconst uri = this._model.resource;\n\t\treturn this.quickDiffService.getQuickDiffs(uri, this._model.getLanguageId(), this._model.textEditorModel ? shouldSynchronizeModel(this._model.textEditorModel) : undefined);\n\t}\n\n\tfindNextClosestChange(lineNumber: number, inclusive = true, provider?: string): number {\n\t\tlet preferredProvider: string | undefined;\n\t\tif (!provider && inclusive) {\n\t\t\tpreferredProvider = this.quickDiffs.find(value => value.isSCM)?.label;\n\t\t}\n\n\t\tconst possibleChanges: number[] = [];\n\t\tfor (let i = 0; i < this.changes.length; i++) {\n\t\t\tif (provider && this.changes[i].label !== provider) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst change = this.changes[i];\n\t\t\tconst possibleChangesLength = possibleChanges.length;\n\n\t\t\tif (inclusive) {\n\t\t\t\tif (getModifiedEndLineNumber(change.change) >= lineNumber) {\n\t\t\t\t\tif (preferredProvider && change.label !== preferredProvider) {\n\t\t\t\t\t\tpossibleChanges.push(i);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (change.change.modifiedStartLineNumber > lineNumber) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ((possibleChanges.length > 0) && (possibleChanges.length === possibleChangesLength)) {\n\t\t\t\treturn possibleChanges[0];\n\t\t\t}\n\t\t}\n\n\t\treturn possibleChanges.length > 0 ? possibleChanges[0] : 0;\n\t}\n\n\tfindPreviousClosestChange(lineNumber: number, inclusive = true, provider?: string): number {\n\t\tfor (let i = this.changes.length - 1; i >= 0; i--) {\n\t\t\tif (provider && this.changes[i].label !== provider) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst change = this.changes[i].change;\n\n\t\t\tif (inclusive) {\n\t\t\t\tif (change.modifiedStartLineNumber <= lineNumber) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (getModifiedEndLineNumber(change) < lineNumber) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.changes.length - 1;\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis._disposed = true;\n\t\tthis._quickDiffs = [];\n\t\tthis._originalModels.clear();\n\t\tthis._originalTextModels = [];\n\t\tthis.diffDelayer.cancel();\n\t\tthis.repositoryDisposables.forEach(d => dispose(d));\n\t\tthis.repositoryDisposables.clear();\n\t}\n}\n\nclass DirtyDiffItem {\n\n\tconstructor(\n\t\treadonly model: DirtyDiffModel,\n\t\treadonly decorator: DirtyDiffDecorator\n\t) { }\n\n\tdispose(): void {\n\t\tthis.decorator.dispose();\n\t\tthis.model.dispose();\n\t}\n}\n\ninterface IViewState {\n\treadonly width: number;\n\treadonly visibility: 'always' | 'hover';\n}\n\nexport class DirtyDiffWorkbenchController extends Disposable implements ext.IWorkbenchContribution, IModelRegistry {\n\n\tprivate enabled = false;\n\tprivate viewState: IViewState = { width: 3, visibility: 'always' };\n\tprivate items = new ResourceMap<DirtyDiffItem>();\n\tprivate readonly transientDisposables = this._register(new DisposableStore());\n\tprivate stylesheet: HTMLStyleElement;\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService\n\t) {\n\t\tsuper();\n\t\tthis.stylesheet = dom.createStyleSheet();\n\t\tthis._register(toDisposable(() => this.stylesheet.parentElement!.removeChild(this.stylesheet)));\n\n\t\tconst onDidChangeConfiguration = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorations'));\n\t\tthis._register(onDidChangeConfiguration(this.onDidChangeConfiguration, this));\n\t\tthis.onDidChangeConfiguration();\n\n\t\tconst onDidChangeDiffWidthConfiguration = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorationsGutterWidth'));\n\t\tonDidChangeDiffWidthConfiguration(this.onDidChangeDiffWidthConfiguration, this);\n\t\tthis.onDidChangeDiffWidthConfiguration();\n\n\t\tconst onDidChangeDiffVisibilityConfiguration = Event.filter(configurationService.onDidChangeConfiguration, e => e.affectsConfiguration('scm.diffDecorationsGutterVisibility'));\n\t\tonDidChangeDiffVisibilityConfiguration(this.onDidChangeDiffVisibiltiyConfiguration, this);\n\t\tthis.onDidChangeDiffVisibiltiyConfiguration();\n\t}\n\n\tprivate onDidChangeConfiguration(): void {\n\t\tconst enabled = this.configurationService.getValue<string>('scm.diffDecorations') !== 'none';\n\n\t\tif (enabled) {\n\t\t\tthis.enable();\n\t\t} else {\n\t\t\tthis.disable();\n\t\t}\n\t}\n\n\tprivate onDidChangeDiffWidthConfiguration(): void {\n\t\tlet width = this.configurationService.getValue<number>('scm.diffDecorationsGutterWidth');\n\n\t\tif (isNaN(width) || width <= 0 || width > 5) {\n\t\t\twidth = 3;\n\t\t}\n\n\t\tthis.setViewState({ ...this.viewState, width });\n\t}\n\n\tprivate onDidChangeDiffVisibiltiyConfiguration(): void {\n\t\tconst visibility = this.configurationService.getValue<'always' | 'hover'>('scm.diffDecorationsGutterVisibility');\n\t\tthis.setViewState({ ...this.viewState, visibility });\n\t}\n\n\tprivate setViewState(state: IViewState): void {\n\t\tthis.viewState = state;\n\t\tthis.stylesheet.textContent = `\n\t\t\t.monaco-editor .dirty-diff-added,\n\t\t\t.monaco-editor .dirty-diff-modified {\n\t\t\t\tborder-left-width:${state.width}px;\n\t\t\t}\n\t\t\t.monaco-editor .dirty-diff-added-pattern,\n\t\t\t.monaco-editor .dirty-diff-added-pattern:before,\n\t\t\t.monaco-editor .dirty-diff-modified-pattern,\n\t\t\t.monaco-editor .dirty-diff-modified-pattern:before {\n\t\t\t\tbackground-size: ${state.width}px ${state.width}px;\n\t\t\t}\n\t\t\t.monaco-editor .dirty-diff-added,\n\t\t\t.monaco-editor .dirty-diff-added-pattern,\n\t\t\t.monaco-editor .dirty-diff-modified,\n\t\t\t.monaco-editor .dirty-diff-modified-pattern,\n\t\t\t.monaco-editor .dirty-diff-deleted {\n\t\t\t\topacity: ${state.visibility === 'always' ? 1 : 0};\n\t\t\t}\n\t\t`;\n\t}\n\n\tprivate enable(): void {\n\t\tif (this.enabled) {\n\t\t\tthis.disable();\n\t\t}\n\n\t\tthis.transientDisposables.add(Event.any(this.editorService.onDidCloseEditor, this.editorService.onDidVisibleEditorsChange)(() => this.onEditorsChanged()));\n\t\tthis.onEditorsChanged();\n\t\tthis.enabled = true;\n\t}\n\n\tprivate disable(): void {\n\t\tif (!this.enabled) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.transientDisposables.clear();\n\n\t\tfor (const [, dirtyDiff] of this.items) {\n\t\t\tdirtyDiff.dispose();\n\t\t}\n\n\t\tthis.items.clear();\n\t\tthis.enabled = false;\n\t}\n\n\tprivate onEditorsChanged(): void {\n\t\tfor (const editor of this.editorService.visibleTextEditorControls) {\n\t\t\tif (isCodeEditor(editor)) {\n\t\t\t\tconst textModel = editor.getModel();\n\t\t\t\tconst controller = DirtyDiffController.get(editor);\n\n\t\t\t\tif (controller) {\n\t\t\t\t\tcontroller.modelRegistry = this;\n\t\t\t\t}\n\n\t\t\t\tif (textModel && !this.items.has(textModel.uri)) {\n\t\t\t\t\tconst textFileModel = this.textFileService.files.get(textModel.uri);\n\n\t\t\t\t\tif (textFileModel?.isResolved()) {\n\t\t\t\t\t\tconst dirtyDiffModel = this.instantiationService.createInstance(DirtyDiffModel, textFileModel);\n\t\t\t\t\t\tconst decorator = new DirtyDiffDecorator(textFileModel.textEditorModel, dirtyDiffModel, this.configurationService);\n\t\t\t\t\t\tthis.items.set(textModel.uri, new DirtyDiffItem(dirtyDiffModel, decorator));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (const [uri, item] of this.items) {\n\t\t\tif (!this.editorService.isOpened({ resource: uri, typeId: FILE_EDITOR_INPUT_ID, editorId: DEFAULT_EDITOR_ASSOCIATION.id })) {\n\t\t\t\titem.dispose();\n\t\t\t\tthis.items.delete(uri);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetModel(editorModel: ITextModel): DirtyDiffModel | undefined {\n\t\treturn this.items.get(editorModel.uri)?.model;\n\t}\n\n\toverride dispose(): void {\n\t\tthis.disable();\n\t\tsuper.dispose();\n\t}\n}\n\nregisterEditorContribution(DirtyDiffController.ID, DirtyDiffController, EditorContributionInstantiation.AfterFirstRender);\n"]}