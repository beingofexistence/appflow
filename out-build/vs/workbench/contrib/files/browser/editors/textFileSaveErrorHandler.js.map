{"version":3,"sources":["vs/workbench/contrib/files/browser/editors/textFileSaveErrorHandler.ts"],"names":[],"mappings":"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","file":"textFileSaveErrorHandler.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { toErrorMessage } from 'vs/base/common/errorMessage';\nimport { basename, isEqual } from 'vs/base/common/resources';\nimport { Action } from 'vs/base/common/actions';\nimport { URI } from 'vs/base/common/uri';\nimport { FileOperationError, FileOperationResult, IWriteFileOptions } from 'vs/platform/files/common/files';\nimport { ITextFileService, ISaveErrorHandler, ITextFileEditorModel, ITextFileSaveAsOptions } from 'vs/workbench/services/textfile/common/textfiles';\nimport { ServicesAccessor, IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IDisposable, dispose, Disposable } from 'vs/base/common/lifecycle';\nimport { IWorkbenchContribution } from 'vs/workbench/common/contributions';\nimport { ITextModelService } from 'vs/editor/common/services/resolverService';\nimport { ResourceMap } from 'vs/base/common/map';\nimport { DiffEditorInput } from 'vs/workbench/common/editor/diffEditorInput';\nimport { IContextKeyService, RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { TextFileContentProvider } from 'vs/workbench/contrib/files/common/files';\nimport { FileEditorInput } from 'vs/workbench/contrib/files/browser/editors/fileEditorInput';\nimport { SAVE_FILE_AS_LABEL } from 'vs/workbench/contrib/files/browser/fileConstants';\nimport { INotificationService, INotificationHandle, INotificationActions, Severity } from 'vs/platform/notification/common/notification';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { IProductService } from 'vs/platform/product/common/productService';\nimport { Event } from 'vs/base/common/event';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { isWindows } from 'vs/base/common/platform';\nimport { Schemas } from 'vs/base/common/network';\nimport { IPreferencesService } from 'vs/workbench/services/preferences/common/preferences';\nimport { IEditorIdentifier, SaveReason, SideBySideEditor } from 'vs/workbench/common/editor';\nimport { hash } from 'vs/base/common/hash';\n\nexport const CONFLICT_RESOLUTION_CONTEXT = 'saveConflictResolutionContext';\nexport const CONFLICT_RESOLUTION_SCHEME = 'conflictResolution';\n\nconst LEARN_MORE_DIRTY_WRITE_IGNORE_KEY = 'learnMoreDirtyWriteError';\n\nconst conflictEditorHelp = localize('userGuide', \"Use the actions in the editor tool bar to either undo your changes or overwrite the content of the file with your changes.\");\n\n// A handler for text file save error happening with conflict resolution actions\nexport class TextFileSaveErrorHandler extends Disposable implements ISaveErrorHandler, IWorkbenchContribution {\n\n\tprivate readonly messages = new ResourceMap<INotificationHandle>();\n\tprivate readonly conflictResolutionContext = new RawContextKey<boolean>(CONFLICT_RESOLUTION_CONTEXT, false, true).bindTo(this.contextKeyService);\n\tprivate activeConflictResolutionResource: URI | undefined = undefined;\n\n\tconstructor(\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService,\n\t\t@IContextKeyService private contextKeyService: IContextKeyService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@ITextModelService textModelService: ITextModelService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tsuper();\n\n\t\tconst provider = this._register(instantiationService.createInstance(TextFileContentProvider));\n\t\tthis._register(textModelService.registerTextModelContentProvider(CONFLICT_RESOLUTION_SCHEME, provider));\n\n\t\t// Set as save error handler to service for text files\n\t\tthis.textFileService.files.saveErrorHandler = this;\n\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tthis._register(this.textFileService.files.onDidSave(e => this.onFileSavedOrReverted(e.model.resource)));\n\t\tthis._register(this.textFileService.files.onDidRevert(model => this.onFileSavedOrReverted(model.resource)));\n\t\tthis._register(this.editorService.onDidActiveEditorChange(() => this.onActiveEditorChanged()));\n\t}\n\n\tprivate onActiveEditorChanged(): void {\n\t\tlet isActiveEditorSaveConflictResolution = false;\n\t\tlet activeConflictResolutionResource: URI | undefined;\n\n\t\tconst activeInput = this.editorService.activeEditor;\n\t\tif (activeInput instanceof DiffEditorInput) {\n\t\t\tconst resource = activeInput.original.resource;\n\t\t\tif (resource?.scheme === CONFLICT_RESOLUTION_SCHEME) {\n\t\t\t\tisActiveEditorSaveConflictResolution = true;\n\t\t\t\tactiveConflictResolutionResource = activeInput.modified.resource;\n\t\t\t}\n\t\t}\n\n\t\tthis.conflictResolutionContext.set(isActiveEditorSaveConflictResolution);\n\t\tthis.activeConflictResolutionResource = activeConflictResolutionResource;\n\t}\n\n\tprivate onFileSavedOrReverted(resource: URI): void {\n\t\tconst messageHandle = this.messages.get(resource);\n\t\tif (messageHandle) {\n\t\t\tmessageHandle.close();\n\t\t\tthis.messages.delete(resource);\n\t\t}\n\t}\n\n\tonSaveError(error: unknown, model: ITextFileEditorModel): void {\n\t\tconst fileOperationError = error as FileOperationError;\n\t\tconst resource = model.resource;\n\n\t\tlet message: string;\n\t\tconst primaryActions: Action[] = [];\n\t\tconst secondaryActions: Action[] = [];\n\n\t\t// Dirty write prevention\n\t\tif (fileOperationError.fileOperationResult === FileOperationResult.FILE_MODIFIED_SINCE) {\n\n\t\t\t// If the user tried to save from the opened conflict editor, show its message again\n\t\t\tif (this.activeConflictResolutionResource && isEqual(this.activeConflictResolutionResource, model.resource)) {\n\t\t\t\tif (this.storageService.getBoolean(LEARN_MORE_DIRTY_WRITE_IGNORE_KEY, StorageScope.APPLICATION)) {\n\t\t\t\t\treturn; // return if this message is ignored\n\t\t\t\t}\n\n\t\t\t\tmessage = conflictEditorHelp;\n\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(ResolveConflictLearnMoreAction));\n\t\t\t\tsecondaryActions.push(this.instantiationService.createInstance(DoNotShowResolveConflictLearnMoreAction));\n\t\t\t}\n\n\t\t\t// Otherwise show the message that will lead the user into the save conflict editor.\n\t\t\telse {\n\t\t\t\tmessage = localize('staleSaveError', \"Failed to save '{0}': The content of the file is newer. Please compare your version with the file contents or overwrite the content of the file with your changes.\", basename(resource));\n\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(ResolveSaveConflictAction, model));\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(SaveModelIgnoreModifiedSinceAction, model));\n\n\t\t\t\tsecondaryActions.push(this.instantiationService.createInstance(ConfigureSaveConflictAction));\n\t\t\t}\n\t\t}\n\n\t\t// Any other save error\n\t\telse {\n\t\t\tconst isWriteLocked = fileOperationError.fileOperationResult === FileOperationResult.FILE_WRITE_LOCKED;\n\t\t\tconst triedToUnlock = isWriteLocked && (fileOperationError.options as IWriteFileOptions | undefined)?.unlock;\n\t\t\tconst isPermissionDenied = fileOperationError.fileOperationResult === FileOperationResult.FILE_PERMISSION_DENIED;\n\t\t\tconst canSaveElevated = resource.scheme === Schemas.file; // currently only supported for local schemes (https://github.com/microsoft/vscode/issues/48659)\n\n\t\t\t// Save Elevated\n\t\t\tif (canSaveElevated && (isPermissionDenied || triedToUnlock)) {\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(SaveModelElevatedAction, model, !!triedToUnlock));\n\t\t\t}\n\n\t\t\t// Unlock\n\t\t\telse if (isWriteLocked) {\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(UnlockModelAction, model));\n\t\t\t}\n\n\t\t\t// Retry\n\t\t\telse {\n\t\t\t\tprimaryActions.push(this.instantiationService.createInstance(RetrySaveModelAction, model));\n\t\t\t}\n\n\t\t\t// Save As\n\t\t\tprimaryActions.push(this.instantiationService.createInstance(SaveModelAsAction, model));\n\n\t\t\t// Discard\n\t\t\tprimaryActions.push(this.instantiationService.createInstance(DiscardModelAction, model));\n\n\t\t\t// Message\n\t\t\tif (isWriteLocked) {\n\t\t\t\tif (triedToUnlock && canSaveElevated) {\n\t\t\t\t\tmessage = isWindows ? localize('readonlySaveErrorAdmin', \"Failed to save '{0}': File is read-only. Select 'Overwrite as Admin' to retry as administrator.\", basename(resource)) : localize('readonlySaveErrorSudo', \"Failed to save '{0}': File is read-only. Select 'Overwrite as Sudo' to retry as superuser.\", basename(resource));\n\t\t\t\t} else {\n\t\t\t\t\tmessage = localize('readonlySaveError', \"Failed to save '{0}': File is read-only. Select 'Overwrite' to attempt to make it writeable.\", basename(resource));\n\t\t\t\t}\n\t\t\t} else if (canSaveElevated && isPermissionDenied) {\n\t\t\t\tmessage = isWindows ? localize('permissionDeniedSaveError', \"Failed to save '{0}': Insufficient permissions. Select 'Retry as Admin' to retry as administrator.\", basename(resource)) : localize('permissionDeniedSaveErrorSudo', \"Failed to save '{0}': Insufficient permissions. Select 'Retry as Sudo' to retry as superuser.\", basename(resource));\n\t\t\t} else {\n\t\t\t\tmessage = localize({ key: 'genericSaveError', comment: ['{0} is the resource that failed to save and {1} the error message'] }, \"Failed to save '{0}': {1}\", basename(resource), toErrorMessage(error, false));\n\t\t\t}\n\t\t}\n\n\t\t// Show message and keep function to hide in case the file gets saved/reverted\n\t\tconst actions: INotificationActions = { primary: primaryActions, secondary: secondaryActions };\n\t\tconst handle = this.notificationService.notify({\n\t\t\tid: `${hash(model.resource.toString())}`, // unique per model (https://github.com/microsoft/vscode/issues/121539)\n\t\t\tseverity: Severity.Error,\n\t\t\tmessage,\n\t\t\tactions\n\t\t});\n\t\tEvent.once(handle.onDidClose)(() => { dispose(primaryActions); dispose(secondaryActions); });\n\t\tthis.messages.set(model.resource, handle);\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\n\t\tthis.messages.clear();\n\t}\n}\n\nconst pendingResolveSaveConflictMessages: INotificationHandle[] = [];\nfunction clearPendingResolveSaveConflictMessages(): void {\n\twhile (pendingResolveSaveConflictMessages.length > 0) {\n\t\tconst item = pendingResolveSaveConflictMessages.pop();\n\t\titem?.close();\n\t}\n}\n\nclass ResolveConflictLearnMoreAction extends Action {\n\n\tconstructor(\n\t\t@IOpenerService private readonly openerService: IOpenerService\n\t) {\n\t\tsuper('workbench.files.action.resolveConflictLearnMore', localize('learnMore', \"Learn More\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tawait this.openerService.open(URI.parse('https://go.microsoft.com/fwlink/?linkid=868264'));\n\t}\n}\n\nclass DoNotShowResolveConflictLearnMoreAction extends Action {\n\n\tconstructor(\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tsuper('workbench.files.action.resolveConflictLearnMoreDoNotShowAgain', localize('dontShowAgain', \"Don't Show Again\"));\n\t}\n\n\toverride async run(notification: IDisposable): Promise<void> {\n\n\t\t// Remember this as application state\n\t\tthis.storageService.store(LEARN_MORE_DIRTY_WRITE_IGNORE_KEY, true, StorageScope.APPLICATION, StorageTarget.USER);\n\n\t\t// Hide notification\n\t\tnotification.dispose();\n\t}\n}\n\nclass ResolveSaveConflictAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IProductService private readonly productService: IProductService\n\t) {\n\t\tsuper('workbench.files.action.resolveConflict', localize('compareChanges', \"Compare\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tconst resource = this.model.resource;\n\t\t\tconst name = basename(resource);\n\t\t\tconst editorLabel = localize('saveConflictDiffLabel', \"{0} (in file) ↔ {1} (in {2}) - Resolve save conflict\", name, name, this.productService.nameLong);\n\n\t\t\tawait TextFileContentProvider.open(resource, CONFLICT_RESOLUTION_SCHEME, editorLabel, this.editorService, { pinned: true });\n\n\t\t\t// Show additional help how to resolve the save conflict\n\t\t\tconst actions = { primary: [this.instantiationService.createInstance(ResolveConflictLearnMoreAction)] };\n\t\t\tconst handle = this.notificationService.notify({\n\t\t\t\tid: `${hash(resource.toString())}`, // unique per model\n\t\t\t\tseverity: Severity.Info,\n\t\t\t\tmessage: conflictEditorHelp,\n\t\t\t\tactions,\n\t\t\t\tneverShowAgain: { id: LEARN_MORE_DIRTY_WRITE_IGNORE_KEY, isSecondary: true }\n\t\t\t});\n\t\t\tEvent.once(handle.onDidClose)(() => dispose(actions.primary));\n\t\t\tpendingResolveSaveConflictMessages.push(handle);\n\t\t}\n\t}\n}\n\nclass SaveModelElevatedAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\tprivate triedToUnlock: boolean\n\t) {\n\t\tsuper('workbench.files.action.saveModelElevated', triedToUnlock ? isWindows ? localize('overwriteElevated', \"Overwrite as Admin...\") : localize('overwriteElevatedSudo', \"Overwrite as Sudo...\") : isWindows ? localize('saveElevated', \"Retry as Admin...\") : localize('saveElevatedSudo', \"Retry as Sudo...\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({\n\t\t\t\twriteElevated: true,\n\t\t\t\twriteUnlock: this.triedToUnlock,\n\t\t\t\treason: SaveReason.EXPLICIT\n\t\t\t});\n\t\t}\n\t}\n}\n\nclass RetrySaveModelAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel\n\t) {\n\t\tsuper('workbench.files.action.saveModel', localize('retry', \"Retry\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({ reason: SaveReason.EXPLICIT });\n\t\t}\n\t}\n}\n\nclass DiscardModelAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel\n\t) {\n\t\tsuper('workbench.files.action.discardModel', localize('discard', \"Discard\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.revert();\n\t\t}\n\t}\n}\n\nclass SaveModelAsAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel,\n\t\t@IEditorService private editorService: IEditorService\n\t) {\n\t\tsuper('workbench.files.action.saveModelAs', SAVE_FILE_AS_LABEL);\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tconst editor = this.findEditor();\n\t\t\tif (editor) {\n\t\t\t\tawait this.editorService.save(editor, { saveAs: true, reason: SaveReason.EXPLICIT });\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate findEditor(): IEditorIdentifier | undefined {\n\t\tlet preferredMatchingEditor: IEditorIdentifier | undefined;\n\n\t\tconst editors = this.editorService.findEditors(this.model.resource, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\tfor (const identifier of editors) {\n\t\t\tif (identifier.editor instanceof FileEditorInput) {\n\t\t\t\t// We prefer a `FileEditorInput` for \"Save As\", but it is possible\n\t\t\t\t// that a custom editor is leveraging the text file model and as\n\t\t\t\t// such we need to fallback to any other editor having the resource\n\t\t\t\t// opened for running the save.\n\t\t\t\tpreferredMatchingEditor = identifier;\n\t\t\t\tbreak;\n\t\t\t} else if (!preferredMatchingEditor) {\n\t\t\t\tpreferredMatchingEditor = identifier;\n\t\t\t}\n\t\t}\n\n\t\treturn preferredMatchingEditor;\n\t}\n}\n\nclass UnlockModelAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel\n\t) {\n\t\tsuper('workbench.files.action.unlock', localize('overwrite', \"Overwrite\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({ writeUnlock: true, reason: SaveReason.EXPLICIT });\n\t\t}\n\t}\n}\n\nclass SaveModelIgnoreModifiedSinceAction extends Action {\n\n\tconstructor(\n\t\tprivate model: ITextFileEditorModel\n\t) {\n\t\tsuper('workbench.files.action.saveIgnoreModifiedSince', localize('overwrite', \"Overwrite\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tif (!this.model.isDisposed()) {\n\t\t\tawait this.model.save({ ignoreModifiedSince: true, reason: SaveReason.EXPLICIT });\n\t\t}\n\t}\n}\n\nclass ConfigureSaveConflictAction extends Action {\n\n\tconstructor(\n\t\t@IPreferencesService private readonly preferencesService: IPreferencesService\n\t) {\n\t\tsuper('workbench.files.action.configureSaveConflict', localize('configure', \"Configure\"));\n\t}\n\n\toverride async run(): Promise<void> {\n\t\tthis.preferencesService.openSettings({ query: 'files.saveConflictResolution' });\n\t}\n}\n\nexport const acceptLocalChangesCommand = (accessor: ServicesAccessor, resource: URI) => {\n\treturn acceptOrRevertLocalChangesCommand(accessor, resource, true);\n};\n\nexport const revertLocalChangesCommand = (accessor: ServicesAccessor, resource: URI) => {\n\treturn acceptOrRevertLocalChangesCommand(accessor, resource, false);\n};\n\nasync function acceptOrRevertLocalChangesCommand(accessor: ServicesAccessor, resource: URI, accept: boolean) {\n\tconst editorService = accessor.get(IEditorService);\n\n\tconst editorPane = editorService.activeEditorPane;\n\tif (!editorPane) {\n\t\treturn;\n\t}\n\n\tconst editor = editorPane.input;\n\tconst group = editorPane.group;\n\n\t// Hide any previously shown message about how to use these actions\n\tclearPendingResolveSaveConflictMessages();\n\n\t// Accept or revert\n\tif (accept) {\n\t\tconst options: ITextFileSaveAsOptions = { ignoreModifiedSince: true, reason: SaveReason.EXPLICIT };\n\t\tawait editorService.save({ editor, groupId: group.id }, options);\n\t} else {\n\t\tawait editorService.revert({ editor, groupId: group.id });\n\t}\n\n\t// Reopen original editor\n\tawait editorService.openEditor({ resource }, group);\n\n\t// Clean up\n\treturn group.closeEditor(editor);\n}\n"]}