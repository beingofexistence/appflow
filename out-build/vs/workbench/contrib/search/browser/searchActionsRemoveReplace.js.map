{"version":3,"sources":["vs/workbench/contrib/search/browser/searchActionsRemoveReplace.ts"],"names":[],"mappings":"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","file":"searchActionsRemoveReplace.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ITreeNavigator } from 'vs/base/browser/ui/tree/tree';\nimport * as nls from 'vs/nls';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { getSelectionKeyboardEvent, WorkbenchCompressibleObjectTree } from 'vs/platform/list/browser/listService';\nimport { IViewsService } from 'vs/workbench/common/views';\nimport { searchRemoveIcon, searchReplaceIcon } from 'vs/workbench/contrib/search/browser/searchIcons';\nimport { SearchView } from 'vs/workbench/contrib/search/browser/searchView';\nimport * as Constants from 'vs/workbench/contrib/search/common/constants';\nimport { IReplaceService } from 'vs/workbench/contrib/search/browser/replace';\nimport { arrayContainsElementOrParent, FileMatch, FolderMatch, Match, MatchInNotebook, RenderableMatch, SearchResult } from 'vs/workbench/contrib/search/browser/searchModel';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { ISearchConfiguration, ISearchConfigurationProperties } from 'vs/workbench/services/search/common/search';\nimport { IUriIdentityService } from 'vs/platform/uriIdentity/common/uriIdentity';\nimport { ContextKeyExpr } from 'vs/platform/contextkey/common/contextkey';\nimport { Action2, MenuId, registerAction2 } from 'vs/platform/actions/common/actions';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { category, getElementsToOperateOn, getSearchView, shouldRefocus } from 'vs/workbench/contrib/search/browser/searchActionsBase';\nimport { equals } from 'vs/base/common/arrays';\n\n\n//#region Interfaces\nexport interface ISearchActionContext {\n\treadonly viewer: WorkbenchCompressibleObjectTree<RenderableMatch>;\n\treadonly element: RenderableMatch;\n}\n\n\nexport interface IFindInFilesArgs {\n\tquery?: string;\n\treplace?: string;\n\tpreserveCase?: boolean;\n\ttriggerSearch?: boolean;\n\tfilesToInclude?: string;\n\tfilesToExclude?: string;\n\tisRegex?: boolean;\n\tisCaseSensitive?: boolean;\n\tmatchWholeWord?: boolean;\n\tuseExcludeSettingsAndIgnoreFiles?: boolean;\n\tonlyOpenEditors?: boolean;\n}\n\n//#endregion\n\n//#region Actions\nregisterAction2(class RemoveAction extends Action2 {\n\n\tconstructor(\n\t) {\n\t\tsuper({\n\t\t\tid: Constants.RemoveActionId,\n\t\t\ttitle: {\n\t\t\t\tvalue: nls.localize('RemoveAction.label', \"Dismiss\"),\n\t\t\t\toriginal: 'Dismiss'\n\t\t\t},\n\t\t\tcategory,\n\t\t\ticon: searchRemoveIcon,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\twhen: ContextKeyExpr.and(Constants.SearchViewVisibleKey, Constants.FileMatchOrMatchFocusKey),\n\t\t\t\tprimary: KeyCode.Delete,\n\t\t\t\tmac: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Backspace,\n\t\t\t\t},\n\t\t\t},\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchContext,\n\t\t\t\t\tgroup: 'search',\n\t\t\t\t\torder: 2,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchActionMenu,\n\t\t\t\t\tgroup: 'inline',\n\t\t\t\t\torder: 2,\n\t\t\t\t},\n\t\t\t]\n\t\t});\n\t}\n\n\trun(accessor: ServicesAccessor, context: ISearchActionContext | undefined): void {\n\t\tconst viewsService = accessor.get(IViewsService);\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\t\tconst searchView = getSearchView(viewsService);\n\n\t\tif (!searchView) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet element = context?.element;\n\t\tlet viewer = context?.viewer;\n\t\tif (!viewer) {\n\t\t\tviewer = searchView.getControl();\n\t\t}\n\t\tif (!element) {\n\t\t\telement = viewer.getFocus()[0] ?? undefined;\n\t\t}\n\n\t\tconst elementsToRemove = getElementsToOperateOn(viewer, element, configurationService.getValue<ISearchConfigurationProperties>('search'));\n\t\tlet focusElement = viewer.getFocus()[0] ?? undefined;\n\n\t\tif (elementsToRemove.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!focusElement || (focusElement instanceof SearchResult)) {\n\t\t\tfocusElement = element;\n\t\t}\n\n\t\tlet nextFocusElement;\n\t\tconst shouldRefocusMatch = shouldRefocus(elementsToRemove, focusElement);\n\t\tif (focusElement && shouldRefocusMatch) {\n\t\t\tnextFocusElement = getElementToFocusAfterRemoved(viewer, focusElement, elementsToRemove);\n\t\t}\n\n\t\tconst searchResult = searchView.searchResult;\n\n\t\tif (searchResult) {\n\t\t\tsearchResult.batchRemove(elementsToRemove);\n\t\t}\n\n\t\tif (focusElement && shouldRefocusMatch) {\n\t\t\tif (!nextFocusElement) {\n\t\t\t\tnextFocusElement = getLastNodeFromSameType(viewer, focusElement);\n\t\t\t}\n\n\t\t\tif (nextFocusElement && !arrayContainsElementOrParent(nextFocusElement, elementsToRemove)) {\n\t\t\t\tviewer.reveal(nextFocusElement);\n\t\t\t\tviewer.setFocus([nextFocusElement], getSelectionKeyboardEvent());\n\t\t\t\tviewer.setSelection([nextFocusElement], getSelectionKeyboardEvent());\n\t\t\t}\n\t\t} else if (!equals(viewer.getFocus(), viewer.getSelection())) {\n\t\t\tviewer.setSelection(viewer.getFocus());\n\t\t}\n\n\t\tviewer.domFocus();\n\t\treturn;\n\t}\n});\n\nregisterAction2(class ReplaceAction extends Action2 {\n\tconstructor(\n\t) {\n\t\tsuper({\n\t\t\tid: Constants.ReplaceActionId,\n\t\t\ttitle: {\n\t\t\t\tvalue: nls.localize('match.replace.label', \"Replace\"),\n\t\t\t\toriginal: 'Replace'\n\t\t\t},\n\t\t\tcategory,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\twhen: ContextKeyExpr.and(Constants.SearchViewVisibleKey, Constants.ReplaceActiveKey, Constants.MatchFocusKey, Constants.IsEditableItemKey),\n\t\t\t\tprimary: KeyMod.Shift | KeyMod.CtrlCmd | KeyCode.Digit1,\n\t\t\t},\n\t\t\ticon: searchReplaceIcon,\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchContext,\n\t\t\t\t\twhen: ContextKeyExpr.and(Constants.ReplaceActiveKey, Constants.MatchFocusKey, Constants.IsEditableItemKey),\n\t\t\t\t\tgroup: 'search',\n\t\t\t\t\torder: 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchActionMenu,\n\t\t\t\t\twhen: ContextKeyExpr.and(Constants.ReplaceActiveKey, Constants.MatchFocusKey, Constants.IsEditableItemKey),\n\t\t\t\t\tgroup: 'inline',\n\t\t\t\t\torder: 1\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, context: ISearchActionContext | undefined): Promise<any> {\n\t\treturn performReplace(accessor, context);\n\t}\n});\n\nregisterAction2(class ReplaceAllAction extends Action2 {\n\n\tconstructor(\n\t) {\n\t\tsuper({\n\t\t\tid: Constants.ReplaceAllInFileActionId,\n\t\t\ttitle: {\n\t\t\t\tvalue: nls.localize('file.replaceAll.label', \"Replace All\"),\n\t\t\t\toriginal: 'Replace All'\n\t\t\t},\n\t\t\tcategory,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\twhen: ContextKeyExpr.and(Constants.SearchViewVisibleKey, Constants.ReplaceActiveKey, Constants.FileFocusKey, Constants.IsEditableItemKey),\n\t\t\t\tprimary: KeyMod.Shift | KeyMod.CtrlCmd | KeyCode.Digit1,\n\t\t\t\tsecondary: [KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.Enter],\n\t\t\t},\n\t\t\ticon: searchReplaceIcon,\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchContext,\n\t\t\t\t\twhen: ContextKeyExpr.and(Constants.ReplaceActiveKey, Constants.FileFocusKey, Constants.IsEditableItemKey),\n\t\t\t\t\tgroup: 'search',\n\t\t\t\t\torder: 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchActionMenu,\n\t\t\t\t\twhen: ContextKeyExpr.and(Constants.ReplaceActiveKey, Constants.FileFocusKey, Constants.IsEditableItemKey),\n\t\t\t\t\tgroup: 'inline',\n\t\t\t\t\torder: 1\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, context: ISearchActionContext | undefined): Promise<any> {\n\t\treturn performReplace(accessor, context);\n\t}\n});\n\nregisterAction2(class ReplaceAllInFolderAction extends Action2 {\n\tconstructor(\n\t) {\n\t\tsuper({\n\t\t\tid: Constants.ReplaceAllInFolderActionId,\n\t\t\ttitle: {\n\t\t\t\tvalue: nls.localize('file.replaceAll.label', \"Replace All\"),\n\t\t\t\toriginal: 'Replace All'\n\t\t\t},\n\t\t\tcategory,\n\t\t\tkeybinding: {\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\twhen: ContextKeyExpr.and(Constants.SearchViewVisibleKey, Constants.ReplaceActiveKey, Constants.FolderFocusKey, Constants.IsEditableItemKey),\n\t\t\t\tprimary: KeyMod.Shift | KeyMod.CtrlCmd | KeyCode.Digit1,\n\t\t\t\tsecondary: [KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.Enter],\n\t\t\t},\n\t\t\ticon: searchReplaceIcon,\n\t\t\tmenu: [\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchContext,\n\t\t\t\t\twhen: ContextKeyExpr.and(Constants.ReplaceActiveKey, Constants.FolderFocusKey, Constants.IsEditableItemKey),\n\t\t\t\t\tgroup: 'search',\n\t\t\t\t\torder: 1\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuId.SearchActionMenu,\n\t\t\t\t\twhen: ContextKeyExpr.and(Constants.ReplaceActiveKey, Constants.FolderFocusKey, Constants.IsEditableItemKey),\n\t\t\t\t\tgroup: 'inline',\n\t\t\t\t\torder: 1\n\t\t\t\t}\n\t\t\t]\n\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, context: ISearchActionContext | undefined): Promise<any> {\n\t\treturn performReplace(accessor, context);\n\t}\n});\n\n//#endregion\n\n//#region Helpers\n\nfunction performReplace(accessor: ServicesAccessor,\n\tcontext: ISearchActionContext | undefined): void {\n\tconst configurationService = accessor.get(IConfigurationService);\n\tconst viewsService = accessor.get(IViewsService);\n\n\tconst viewlet: SearchView | undefined = getSearchView(viewsService);\n\tconst viewer: WorkbenchCompressibleObjectTree<RenderableMatch> | undefined = context?.viewer ?? viewlet?.getControl();\n\n\tif (!viewer) {\n\t\treturn;\n\t}\n\tconst element: RenderableMatch | null = context?.element ?? viewer.getFocus()[0];\n\n\t// since multiple elements can be selected, we need to check the type of the FolderMatch/FileMatch/Match before we perform the replace.\n\tconst elementsToReplace = getElementsToOperateOn(viewer, element ?? undefined, configurationService.getValue<ISearchConfigurationProperties>('search'));\n\tlet focusElement = viewer.getFocus()[0];\n\n\tif (!focusElement || (focusElement && !arrayContainsElementOrParent(focusElement, elementsToReplace)) || (focusElement instanceof SearchResult)) {\n\t\tfocusElement = element;\n\t}\n\n\tif (elementsToReplace.length === 0) {\n\t\treturn;\n\t}\n\tlet nextFocusElement;\n\tif (focusElement) {\n\t\tnextFocusElement = getElementToFocusAfterRemoved(viewer, focusElement, elementsToReplace);\n\t}\n\n\tconst searchResult = viewlet?.searchResult;\n\n\tif (searchResult) {\n\t\tsearchResult.batchReplace(elementsToReplace);\n\t}\n\n\tif (focusElement) {\n\t\tif (!nextFocusElement) {\n\t\t\tnextFocusElement = getLastNodeFromSameType(viewer, focusElement);\n\t\t}\n\n\t\tif (nextFocusElement) {\n\t\t\tviewer.reveal(nextFocusElement);\n\t\t\tviewer.setFocus([nextFocusElement], getSelectionKeyboardEvent());\n\t\t\tviewer.setSelection([nextFocusElement], getSelectionKeyboardEvent());\n\n\t\t\tif (nextFocusElement instanceof Match) {\n\t\t\t\tconst useReplacePreview = configurationService.getValue<ISearchConfiguration>().search.useReplacePreview;\n\t\t\t\tif (!useReplacePreview || hasToOpenFile(accessor, nextFocusElement) || nextFocusElement instanceof MatchInNotebook) {\n\t\t\t\t\tviewlet?.open(nextFocusElement, true);\n\t\t\t\t} else {\n\t\t\t\t\taccessor.get(IReplaceService).openReplacePreview(nextFocusElement, true);\n\t\t\t\t}\n\t\t\t} else if (nextFocusElement instanceof FileMatch) {\n\t\t\t\tviewlet?.open(nextFocusElement, true);\n\t\t\t}\n\t\t}\n\n\t}\n\n\tviewer.domFocus();\n}\n\nfunction hasToOpenFile(accessor: ServicesAccessor, currBottomElem: RenderableMatch): boolean {\n\tif (!(currBottomElem instanceof Match)) {\n\t\treturn false;\n\t}\n\tconst activeEditor = accessor.get(IEditorService).activeEditor;\n\tconst file = activeEditor?.resource;\n\tif (file) {\n\t\treturn accessor.get(IUriIdentityService).extUri.isEqual(file, currBottomElem.parent().resource);\n\t}\n\treturn false;\n}\n\nfunction compareLevels(elem1: RenderableMatch, elem2: RenderableMatch) {\n\tif (elem1 instanceof Match) {\n\t\tif (elem2 instanceof Match) {\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\n\t} else if (elem1 instanceof FileMatch) {\n\t\tif (elem2 instanceof Match) {\n\t\t\treturn 1;\n\t\t} else if (elem2 instanceof FileMatch) {\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\n\t} else {\n\t\t// FolderMatch\n\t\tif (elem2 instanceof FolderMatch) {\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn 1;\n\t\t}\n\t}\n}\n\n/**\n * Returns element to focus after removing the given element\n */\nexport function getElementToFocusAfterRemoved(viewer: WorkbenchCompressibleObjectTree<RenderableMatch>, element: RenderableMatch, elementsToRemove: RenderableMatch[]): RenderableMatch | undefined {\n\tconst navigator: ITreeNavigator<any> = viewer.navigate(element);\n\tif (element instanceof FolderMatch) {\n\t\twhile (!!navigator.next() && (!(navigator.current() instanceof FolderMatch) || arrayContainsElementOrParent(navigator.current(), elementsToRemove))) { }\n\t} else if (element instanceof FileMatch) {\n\t\twhile (!!navigator.next() && (!(navigator.current() instanceof FileMatch) || arrayContainsElementOrParent(navigator.current(), elementsToRemove))) {\n\t\t\tviewer.expand(navigator.current());\n\t\t}\n\t} else {\n\t\twhile (navigator.next() && (!(navigator.current() instanceof Match) || arrayContainsElementOrParent(navigator.current(), elementsToRemove))) {\n\t\t\tviewer.expand(navigator.current());\n\t\t}\n\t}\n\treturn navigator.current();\n}\n\n/***\n * Finds the last element in the tree with the same type as `element`\n */\nexport function getLastNodeFromSameType(viewer: WorkbenchCompressibleObjectTree<RenderableMatch>, element: RenderableMatch): RenderableMatch | undefined {\n\tlet lastElem: RenderableMatch | null = viewer.lastVisibleElement ?? null;\n\n\twhile (lastElem) {\n\t\tconst compareVal = compareLevels(element, lastElem);\n\t\tif (compareVal === -1) {\n\t\t\tviewer.expand(lastElem);\n\t\t\tlastElem = viewer.lastVisibleElement;\n\t\t} else if (compareVal === 1) {\n\t\t\tlastElem = viewer.getParentElement(lastElem);\n\t\t} else {\n\t\t\treturn lastElem;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\n//#endregion\n\n"]}