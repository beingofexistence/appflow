{"version":3,"sources":["vs/workbench/contrib/search/browser/symbolsQuickAccess.ts"],"names":[],"mappings":"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","file":"symbolsQuickAccess.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { IPickerQuickAccessItem, PickerQuickAccessProvider, TriggerAction } from 'vs/platform/quickinput/browser/pickerQuickAccess';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ThrottledDelayer } from 'vs/base/common/async';\nimport { getWorkspaceSymbols, IWorkspaceSymbol, IWorkspaceSymbolProvider } from 'vs/workbench/contrib/search/common/search';\nimport { SymbolKinds, SymbolTag, SymbolKind } from 'vs/editor/common/languages';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { Schemas } from 'vs/base/common/network';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { IEditorService, SIDE_GROUP, ACTIVE_GROUP } from 'vs/workbench/services/editor/common/editorService';\nimport { Range } from 'vs/editor/common/core/range';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IWorkbenchEditorConfiguration } from 'vs/workbench/common/editor';\nimport { IKeyMods, IQuickPickItemWithResource } from 'vs/platform/quickinput/common/quickInput';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { getSelectionSearchString } from 'vs/editor/contrib/find/browser/findController';\nimport { prepareQuery, IPreparedQuery, scoreFuzzy2, pieceToQuery } from 'vs/base/common/fuzzyScorer';\nimport { IMatch } from 'vs/base/common/filters';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { ThemeIcon } from 'vs/base/common/themables';\n\ninterface ISymbolQuickPickItem extends IPickerQuickAccessItem, IQuickPickItemWithResource {\n\tscore?: number;\n\tsymbol?: IWorkspaceSymbol;\n}\n\nexport class SymbolsQuickAccessProvider extends PickerQuickAccessProvider<ISymbolQuickPickItem> {\n\n\tstatic PREFIX = '#';\n\n\tprivate static readonly TYPING_SEARCH_DELAY = 200; // this delay accommodates for the user typing a word and then stops typing to start searching\n\n\tprivate static TREAT_AS_GLOBAL_SYMBOL_TYPES = new Set<SymbolKind>([\n\t\tSymbolKind.Class,\n\t\tSymbolKind.Enum,\n\t\tSymbolKind.File,\n\t\tSymbolKind.Interface,\n\t\tSymbolKind.Namespace,\n\t\tSymbolKind.Package,\n\t\tSymbolKind.Module\n\t]);\n\n\tprivate delayer = this._register(new ThrottledDelayer<ISymbolQuickPickItem[]>(SymbolsQuickAccessProvider.TYPING_SEARCH_DELAY));\n\n\tget defaultFilterValue(): string | undefined {\n\n\t\t// Prefer the word under the cursor in the active editor as default filter\n\t\tconst editor = this.codeEditorService.getFocusedCodeEditor();\n\t\tif (editor) {\n\t\t\treturn getSelectionSearchString(editor) ?? undefined;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tconstructor(\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService\n\t) {\n\t\tsuper(SymbolsQuickAccessProvider.PREFIX, {\n\t\t\tcanAcceptInBackground: true,\n\t\t\tnoResultsPick: {\n\t\t\t\tlabel: localize('noSymbolResults', \"No matching workspace symbols\")\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate get configuration() {\n\t\tconst editorConfig = this.configurationService.getValue<IWorkbenchEditorConfiguration>().workbench?.editor;\n\n\t\treturn {\n\t\t\topenEditorPinned: !editorConfig?.enablePreviewFromQuickOpen || !editorConfig?.enablePreview,\n\t\t\topenSideBySideDirection: editorConfig?.openSideBySideDirection\n\t\t};\n\t}\n\n\tprotected _getPicks(filter: string, disposables: DisposableStore, token: CancellationToken): Promise<Array<ISymbolQuickPickItem>> {\n\t\treturn this.getSymbolPicks(filter, undefined, token);\n\t}\n\n\tasync getSymbolPicks(filter: string, options: { skipLocal?: boolean; skipSorting?: boolean; delay?: number } | undefined, token: CancellationToken): Promise<Array<ISymbolQuickPickItem>> {\n\t\treturn this.delayer.trigger(async () => {\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.doGetSymbolPicks(prepareQuery(filter), options, token);\n\t\t}, options?.delay);\n\t}\n\n\tprivate async doGetSymbolPicks(query: IPreparedQuery, options: { skipLocal?: boolean; skipSorting?: boolean } | undefined, token: CancellationToken): Promise<Array<ISymbolQuickPickItem>> {\n\n\t\t// Split between symbol and container query\n\t\tlet symbolQuery: IPreparedQuery;\n\t\tlet containerQuery: IPreparedQuery | undefined;\n\t\tif (query.values && query.values.length > 1) {\n\t\t\tsymbolQuery = pieceToQuery(query.values[0]); \t\t  // symbol: only match on first part\n\t\t\tcontainerQuery = pieceToQuery(query.values.slice(1)); // container: match on all but first parts\n\t\t} else {\n\t\t\tsymbolQuery = query;\n\t\t}\n\n\t\t// Run the workspace symbol query\n\t\tconst workspaceSymbols = await getWorkspaceSymbols(symbolQuery.original, token);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst symbolPicks: Array<ISymbolQuickPickItem> = [];\n\n\t\t// Convert to symbol picks and apply filtering\n\t\tconst openSideBySideDirection = this.configuration.openSideBySideDirection;\n\t\tfor (const { symbol, provider } of workspaceSymbols) {\n\n\t\t\t// Depending on the workspace symbols filter setting, skip over symbols that:\n\t\t\t// - do not have a container\n\t\t\t// - and are not treated explicitly as global symbols (e.g. classes)\n\t\t\tif (options?.skipLocal && !SymbolsQuickAccessProvider.TREAT_AS_GLOBAL_SYMBOL_TYPES.has(symbol.kind) && !!symbol.containerName) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst symbolLabel = symbol.name;\n\t\t\tconst symbolLabelWithIcon = `$(${SymbolKinds.toIcon(symbol.kind).id}) ${symbolLabel}`;\n\t\t\tconst symbolLabelIconOffset = symbolLabelWithIcon.length - symbolLabel.length;\n\n\t\t\t// Score by symbol label if searching\n\t\t\tlet symbolScore: number | undefined = undefined;\n\t\t\tlet symbolMatches: IMatch[] | undefined = undefined;\n\t\t\tlet skipContainerQuery = false;\n\t\t\tif (symbolQuery.original.length > 0) {\n\n\t\t\t\t// First: try to score on the entire query, it is possible that\n\t\t\t\t// the symbol matches perfectly (e.g. searching for \"change log\"\n\t\t\t\t// can be a match on a markdown symbol \"change log\"). In that\n\t\t\t\t// case we want to skip the container query altogether.\n\t\t\t\tif (symbolQuery !== query) {\n\t\t\t\t\t[symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, { ...query, values: undefined /* disable multi-query support */ }, 0, symbolLabelIconOffset);\n\t\t\t\t\tif (typeof symbolScore === 'number') {\n\t\t\t\t\t\tskipContainerQuery = true; // since we consumed the query, skip any container matching\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Otherwise: score on the symbol query and match on the container later\n\t\t\t\tif (typeof symbolScore !== 'number') {\n\t\t\t\t\t[symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, symbolQuery, 0, symbolLabelIconOffset);\n\t\t\t\t\tif (typeof symbolScore !== 'number') {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst symbolUri = symbol.location.uri;\n\t\t\tlet containerLabel: string | undefined = undefined;\n\t\t\tif (symbolUri) {\n\t\t\t\tconst containerPath = this.labelService.getUriLabel(symbolUri, { relative: true });\n\t\t\t\tif (symbol.containerName) {\n\t\t\t\t\tcontainerLabel = `${symbol.containerName} • ${containerPath}`;\n\t\t\t\t} else {\n\t\t\t\t\tcontainerLabel = containerPath;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Score by container if specified and searching\n\t\t\tlet containerScore: number | undefined = undefined;\n\t\t\tlet containerMatches: IMatch[] | undefined = undefined;\n\t\t\tif (!skipContainerQuery && containerQuery && containerQuery.original.length > 0) {\n\t\t\t\tif (containerLabel) {\n\t\t\t\t\t[containerScore, containerMatches] = scoreFuzzy2(containerLabel, containerQuery);\n\t\t\t\t}\n\n\t\t\t\tif (typeof containerScore !== 'number') {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (typeof symbolScore === 'number') {\n\t\t\t\t\tsymbolScore += containerScore; // boost symbolScore by containerScore\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst deprecated = symbol.tags ? symbol.tags.indexOf(SymbolTag.Deprecated) >= 0 : false;\n\n\t\t\tsymbolPicks.push({\n\t\t\t\tsymbol,\n\t\t\t\tresource: symbolUri,\n\t\t\t\tscore: symbolScore,\n\t\t\t\tlabel: symbolLabelWithIcon,\n\t\t\t\tariaLabel: symbolLabel,\n\t\t\t\thighlights: deprecated ? undefined : {\n\t\t\t\t\tlabel: symbolMatches,\n\t\t\t\t\tdescription: containerMatches\n\t\t\t\t},\n\t\t\t\tdescription: containerLabel,\n\t\t\t\tstrikethrough: deprecated,\n\t\t\t\tbuttons: [\n\t\t\t\t\t{\n\t\t\t\t\t\ticonClass: openSideBySideDirection === 'right' ? ThemeIcon.asClassName(Codicon.splitHorizontal) : ThemeIcon.asClassName(Codicon.splitVertical),\n\t\t\t\t\t\ttooltip: openSideBySideDirection === 'right' ? localize('openToSide', \"Open to the Side\") : localize('openToBottom', \"Open to the Bottom\")\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\ttrigger: (buttonIndex, keyMods) => {\n\t\t\t\t\tthis.openSymbol(provider, symbol, token, { keyMods, forceOpenSideBySide: true });\n\n\t\t\t\t\treturn TriggerAction.CLOSE_PICKER;\n\t\t\t\t},\n\t\t\t\taccept: async (keyMods, event) => this.openSymbol(provider, symbol, token, { keyMods, preserveFocus: event.inBackground, forcePinned: event.inBackground }),\n\t\t\t});\n\n\t\t}\n\n\t\t// Sort picks (unless disabled)\n\t\tif (!options?.skipSorting) {\n\t\t\tsymbolPicks.sort((symbolA, symbolB) => this.compareSymbols(symbolA, symbolB));\n\t\t}\n\n\t\treturn symbolPicks;\n\t}\n\n\tprivate async openSymbol(provider: IWorkspaceSymbolProvider, symbol: IWorkspaceSymbol, token: CancellationToken, options: { keyMods: IKeyMods; forceOpenSideBySide?: boolean; preserveFocus?: boolean; forcePinned?: boolean }): Promise<void> {\n\n\t\t// Resolve actual symbol to open for providers that can resolve\n\t\tlet symbolToOpen = symbol;\n\t\tif (typeof provider.resolveWorkspaceSymbol === 'function') {\n\t\t\tsymbolToOpen = await provider.resolveWorkspaceSymbol(symbol, token) || symbol;\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Open HTTP(s) links with opener service\n\t\tif (symbolToOpen.location.uri.scheme === Schemas.http || symbolToOpen.location.uri.scheme === Schemas.https) {\n\t\t\tawait this.openerService.open(symbolToOpen.location.uri, { fromUserGesture: true, allowContributedOpeners: true });\n\t\t}\n\n\t\t// Otherwise open as editor\n\t\telse {\n\t\t\tawait this.editorService.openEditor({\n\t\t\t\tresource: symbolToOpen.location.uri,\n\t\t\t\toptions: {\n\t\t\t\t\tpreserveFocus: options?.preserveFocus,\n\t\t\t\t\tpinned: options.keyMods.ctrlCmd || options.forcePinned || this.configuration.openEditorPinned,\n\t\t\t\t\tselection: symbolToOpen.location.range ? Range.collapseToStart(symbolToOpen.location.range) : undefined\n\t\t\t\t}\n\t\t\t}, options.keyMods.alt || (this.configuration.openEditorPinned && options.keyMods.ctrlCmd) || options?.forceOpenSideBySide ? SIDE_GROUP : ACTIVE_GROUP);\n\t\t}\n\t}\n\n\tprivate compareSymbols(symbolA: ISymbolQuickPickItem, symbolB: ISymbolQuickPickItem): number {\n\n\t\t// By score\n\t\tif (typeof symbolA.score === 'number' && typeof symbolB.score === 'number') {\n\t\t\tif (symbolA.score > symbolB.score) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif (symbolA.score < symbolB.score) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\n\t\t// By name\n\t\tif (symbolA.symbol && symbolB.symbol) {\n\t\t\tconst symbolAName = symbolA.symbol.name.toLowerCase();\n\t\t\tconst symbolBName = symbolB.symbol.name.toLowerCase();\n\t\t\tconst res = symbolAName.localeCompare(symbolBName);\n\t\t\tif (res !== 0) {\n\t\t\t\treturn res;\n\t\t\t}\n\t\t}\n\n\t\t// By kind\n\t\tif (symbolA.symbol && symbolB.symbol) {\n\t\t\tconst symbolAKind = SymbolKinds.toIcon(symbolA.symbol.kind).id;\n\t\t\tconst symbolBKind = SymbolKinds.toIcon(symbolB.symbol.kind).id;\n\t\t\treturn symbolAKind.localeCompare(symbolBKind);\n\t\t}\n\n\t\treturn 0;\n\t}\n}\n"]}