{"version":3,"sources":["vs/workbench/contrib/terminalContrib/accessibility/browser/terminalAccessibilityHelp.ts"],"names":[],"mappings":"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","file":"terminalAccessibilityHelp.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { format } from 'vs/base/common/strings';\nimport { localize } from 'vs/nls';\nimport { IAccessibilityService } from 'vs/platform/accessibility/common/accessibility';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { ContextKeyExpr, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { ShellIntegrationStatus, TerminalSettingId, WindowsShellType } from 'vs/platform/terminal/common/terminal';\nimport { AccessibilityVerbositySettingId, AccessibleViewProviderId, accessibleViewCurrentProviderId, accessibleViewIsShown } from 'vs/workbench/contrib/accessibility/browser/accessibilityConfiguration';\nimport { AccessibleViewType, IAccessibleContentProvider, IAccessibleViewOptions } from 'vs/workbench/contrib/accessibility/browser/accessibleView';\nimport { AccessibilityCommandId } from 'vs/workbench/contrib/accessibility/common/accessibilityCommands';\nimport { ITerminalInstance, IXtermTerminal } from 'vs/workbench/contrib/terminal/browser/terminal';\nimport { TerminalCommandId } from 'vs/workbench/contrib/terminal/common/terminal';\nimport type { Terminal } from 'xterm';\n\nexport const enum ClassName {\n\tActive = 'active',\n\tEditorTextArea = 'textarea'\n}\n\nexport class TerminalAccessibleContentProvider extends Disposable implements IAccessibleContentProvider {\n\n\tprivate readonly _hasShellIntegration: boolean = false;\n\n\tonClose() {\n\t\tconst expr = ContextKeyExpr.and(accessibleViewIsShown, ContextKeyExpr.equals(accessibleViewCurrentProviderId.key, AccessibleViewProviderId.Terminal));\n\t\tif (expr?.evaluate(this._contextKeyService.getContext(null))) {\n\t\t\tthis._commandService.executeCommand(TerminalCommandId.FocusAccessibleBuffer);\n\t\t} else {\n\t\t\tthis._instance.focus();\n\t\t}\n\t\tthis.dispose();\n\t}\n\toptions: IAccessibleViewOptions = {\n\t\ttype: AccessibleViewType.Help,\n\t\treadMoreUrl: 'https://code.visualstudio.com/docs/editor/accessibility#_terminal-accessibility'\n\t};\n\tverbositySettingKey = AccessibilityVerbositySettingId.Terminal;\n\n\tconstructor(\n\t\tprivate readonly _instance: Pick<ITerminalInstance, 'shellType' | 'capabilities' | 'onDidRequestFocus' | 'resource' | 'focus'>,\n\t\t_xterm: Pick<IXtermTerminal, 'getFont' | 'shellIntegration'> & { raw: Terminal },\n\t\t@IInstantiationService _instantiationService: IInstantiationService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper();\n\t\tthis._hasShellIntegration = _xterm.shellIntegration.status === ShellIntegrationStatus.VSCode;\n\t}\n\n\tprivate _descriptionForCommand(commandId: string, msg: string, noKbMsg: string): string {\n\t\tif (commandId === TerminalCommandId.RunRecentCommand) {\n\t\t\tconst kb = this._keybindingService.lookupKeybindings(commandId);\n\t\t\t// Run recent command has multiple keybindings. lookupKeybinding just returns the first one regardless of the when context.\n\t\t\t// Thus, we have to check if accessibility mode is enabled to determine which keybinding to use.\n\t\t\tconst isScreenReaderOptimized = this._accessibilityService.isScreenReaderOptimized();\n\t\t\tif (isScreenReaderOptimized && kb[1]) {\n\t\t\t\tformat(msg, kb[1].getAriaLabel());\n\t\t\t} else if (kb[0]) {\n\t\t\t\tformat(msg, kb[0].getAriaLabel());\n\t\t\t} else {\n\t\t\t\treturn format(noKbMsg, commandId);\n\t\t\t}\n\t\t}\n\t\tconst kb = this._keybindingService.lookupKeybinding(commandId, this._contextKeyService)?.getAriaLabel();\n\t\treturn !kb ? format(noKbMsg, commandId) : format(msg, kb);\n\t}\n\n\tprovideContent(): string {\n\t\tconst content = [];\n\t\tcontent.push(this._descriptionForCommand(TerminalCommandId.FocusAccessibleBuffer, localize('focusAccessibleBuffer', 'The Focus Accessible Buffer ({0}) command enables screen readers to read terminal contents.'), localize('focusAccessibleBufferNoKb', 'The Focus Accessible Buffer command enables screen readers to read terminal contents and is currently not triggerable by a keybinding.')));\n\t\tif (this._instance.shellType === WindowsShellType.CommandPrompt) {\n\t\t\tcontent.push(localize('commandPromptMigration', \"Consider using powershell instead of command prompt for an improved experience\"));\n\t\t}\n\t\tif (this._hasShellIntegration) {\n\t\t\tconst shellIntegrationCommandList = [];\n\t\t\tshellIntegrationCommandList.push(localize('shellIntegration', \"The terminal has a feature called shell integration that offers an enhanced experience and provides useful commands for screen readers such as:\"));\n\t\t\tshellIntegrationCommandList.push('- ' + this._descriptionForCommand(TerminalCommandId.AccessibleBufferGoToNextCommand, localize('goToNextCommand', 'Go to Next Command ({0})'), localize('goToNextCommandNoKb', 'Go to Next Command is currently not triggerable by a keybinding.')));\n\t\t\tshellIntegrationCommandList.push('- ' + this._descriptionForCommand(TerminalCommandId.AccessibleBufferGoToPreviousCommand, localize('goToPreviousCommand', 'Go to Previous Command ({0})'), localize('goToPreviousCommandNoKb', 'Go to Previous Command is currently not triggerable by a keybinding.')));\n\t\t\tshellIntegrationCommandList.push('- ' + this._descriptionForCommand(AccessibilityCommandId.GoToSymbol, localize('goToSymbol', 'Go to Symbol ({0})'), localize('goToSymbolNoKb', 'Go to symbol is currently not triggerable by a keybinding.')));\n\t\t\tshellIntegrationCommandList.push('- ' + this._descriptionForCommand(TerminalCommandId.RunRecentCommand, localize('runRecentCommand', 'Run Recent Command ({0})'), localize('runRecentCommandNoKb', 'Run Recent Command is currently not triggerable by a keybinding.')));\n\t\t\tshellIntegrationCommandList.push('- ' + this._descriptionForCommand(TerminalCommandId.GoToRecentDirectory, localize('goToRecentDirectory', 'Go to Recent Directory ({0})'), localize('goToRecentDirectoryNoKb', 'Go to Recent Directory is currently not triggerable by a keybinding.')));\n\t\t\tcontent.push(shellIntegrationCommandList.join('\\n'));\n\t\t} else {\n\t\t\tcontent.push(this._descriptionForCommand(TerminalCommandId.RunRecentCommand, localize('goToRecentDirectoryNoShellIntegration', 'The Go to Recent Directory command ({0}) enables screen readers to easily navigate to a directory that has been used in the terminal.'), localize('goToRecentDirectoryNoKbNoShellIntegration', 'The Go to Recent Directory command enables screen readers to easily navigate to a directory that has been used in the terminal and is currently not triggerable by a keybinding.')));\n\t\t}\n\t\tcontent.push(this._descriptionForCommand(TerminalCommandId.OpenDetectedLink, localize('openDetectedLink', 'The Open Detected Link ({0}) command enables screen readers to easily open links found in the terminal.'), localize('openDetectedLinkNoKb', 'The Open Detected Link command enables screen readers to easily open links found in the terminal and is currently not triggerable by a keybinding.')));\n\t\tcontent.push(this._descriptionForCommand(TerminalCommandId.NewWithProfile, localize('newWithProfile', 'The Create New Terminal (With Profile) ({0}) command allows for easy terminal creation using a specific profile.'), localize('newWithProfileNoKb', 'The Create New Terminal (With Profile) command allows for easy terminal creation using a specific profile and is currently not triggerable by a keybinding.')));\n\t\tcontent.push(localize('focusAfterRun', 'Configure what gets focused after running selected text in the terminal with `{0}`.', TerminalSettingId.FocusAfterRun));\n\t\tcontent.push(localize('accessibilitySettings', 'Access accessibility settings such as `terminal.integrated.tabFocusMode` via the Preferences: Open Accessibility Settings command.'));\n\t\treturn content.join('\\n\\n');\n\t}\n}\n"]}