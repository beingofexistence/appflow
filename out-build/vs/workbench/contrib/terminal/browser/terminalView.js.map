{"version":3,"sources":["vs/workbench/contrib/terminal/browser/terminalView.ts"],"names":[],"mappings":"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","file":"terminalView.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as dom from 'vs/base/browser/dom';\nimport { Action, IAction } from 'vs/base/common/actions';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IContextMenuService, IContextViewService } from 'vs/platform/contextview/browser/contextView';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IThemeService, Themable } from 'vs/platform/theme/common/themeService';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { switchTerminalActionViewItemSeparator, switchTerminalShowTabsTitle } from 'vs/workbench/contrib/terminal/browser/terminalActions';\nimport { INotificationService, IPromptChoice, Severity } from 'vs/platform/notification/common/notification';\nimport { ICreateTerminalOptions, ITerminalGroupService, ITerminalInstance, ITerminalService, TerminalConnectionState, TerminalDataTransfers } from 'vs/workbench/contrib/terminal/browser/terminal';\nimport { ViewPane, IViewPaneOptions } from 'vs/workbench/browser/parts/views/viewPane';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IViewDescriptorService } from 'vs/workbench/common/views';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { IMenu, IMenuService, MenuId, MenuItemAction } from 'vs/platform/actions/common/actions';\nimport { ITerminalProfileResolverService, ITerminalProfileService, TerminalCommandId } from 'vs/workbench/contrib/terminal/common/terminal';\nimport { TerminalSettingId, ITerminalProfile, TerminalLocation } from 'vs/platform/terminal/common/terminal';\nimport { ActionViewItem, SelectActionViewItem } from 'vs/base/browser/ui/actionbar/actionViewItems';\nimport { asCssVariable, selectBorder } from 'vs/platform/theme/common/colorRegistry';\nimport { ISelectOptionItem } from 'vs/base/browser/ui/selectBox/selectBox';\nimport { IActionViewItem } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { TerminalTabbedView } from 'vs/workbench/contrib/terminal/browser/terminalTabbedView';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { renderLabelWithIcons } from 'vs/base/browser/ui/iconLabel/iconLabels';\nimport { getColorForSeverity } from 'vs/workbench/contrib/terminal/browser/terminalStatusList';\nimport { createAndFillInContextMenuActions, MenuEntryActionViewItem } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { DropdownWithPrimaryActionViewItem } from 'vs/platform/actions/browser/dropdownWithPrimaryActionViewItem';\nimport { dispose, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { ColorScheme } from 'vs/platform/theme/common/theme';\nimport { getColorClass, getUriClasses } from 'vs/workbench/contrib/terminal/browser/terminalIcon';\nimport { getTerminalActionBarArgs } from 'vs/workbench/contrib/terminal/browser/terminalMenus';\nimport { TerminalContextKeys } from 'vs/workbench/contrib/terminal/common/terminalContextKey';\nimport { getInstanceHoverInfo } from 'vs/workbench/contrib/terminal/browser/terminalTooltip';\nimport { ServicesAccessor } from 'vs/editor/browser/editorExtensions';\nimport { TerminalCapability } from 'vs/platform/terminal/common/capabilities/capabilities';\nimport { defaultSelectBoxStyles } from 'vs/platform/theme/browser/defaultStyles';\nimport { Event } from 'vs/base/common/event';\nimport { IHoverDelegate, IHoverDelegateOptions } from 'vs/base/browser/ui/iconLabel/iconHoverDelegate';\nimport { IHoverService } from 'vs/workbench/services/hover/browser/hover';\nimport { IAccessibilityService } from 'vs/platform/accessibility/common/accessibility';\n\nexport class TerminalViewPane extends ViewPane {\n\tprivate _fontStyleElement: HTMLElement | undefined;\n\tprivate _parentDomElement: HTMLElement | undefined;\n\tprivate _terminalTabbedView?: TerminalTabbedView;\n\tget terminalTabbedView(): TerminalTabbedView | undefined { return this._terminalTabbedView; }\n\tprivate _isWelcomeShowing: boolean = false;\n\tprivate _isInitialized: boolean = false;\n\tprivate _newDropdown: DropdownWithPrimaryActionViewItem | undefined;\n\tprivate readonly _dropdownMenu: IMenu;\n\tprivate readonly _singleTabMenu: IMenu;\n\tprivate _viewShowing: IContextKey<boolean>;\n\n\tconstructor(\n\t\toptions: IViewPaneOptions,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IMenuService private readonly _menuService: IMenuService,\n\t\t@ITerminalProfileService private readonly _terminalProfileService: ITerminalProfileService,\n\t\t@ITerminalProfileResolverService private readonly _terminalProfileResolverService: ITerminalProfileResolverService,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@IAccessibilityService private readonly _accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper(options, keybindingService, _contextMenuService, _configurationService, _contextKeyService, viewDescriptorService, _instantiationService, openerService, themeService, telemetryService);\n\t\tthis._register(this._terminalService.onDidRegisterProcessSupport(() => {\n\t\t\tthis._onDidChangeViewWelcomeState.fire();\n\t\t}));\n\n\t\tthis._register(this._terminalService.onDidChangeInstances(() => {\n\t\t\tif (!this._isWelcomeShowing) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._isWelcomeShowing = true;\n\t\t\tthis._onDidChangeViewWelcomeState.fire();\n\t\t\tif (!this._terminalTabbedView && this._parentDomElement) {\n\t\t\t\tthis._createTabsView();\n\t\t\t\tthis.layoutBody(this._parentDomElement.offsetHeight, this._parentDomElement.offsetWidth);\n\t\t\t}\n\t\t}));\n\t\tthis._dropdownMenu = this._register(this._menuService.createMenu(MenuId.TerminalNewDropdownContext, this._contextKeyService));\n\t\tthis._singleTabMenu = this._register(this._menuService.createMenu(MenuId.TerminalTabContext, this._contextKeyService));\n\t\tthis._register(this._terminalProfileService.onDidChangeAvailableProfiles(profiles => this._updateTabActionBar(profiles)));\n\t\tthis._viewShowing = TerminalContextKeys.viewShowing.bindTo(this._contextKeyService);\n\t\tthis._register(this.onDidChangeBodyVisibility(e => {\n\t\t\tif (e) {\n\t\t\t\tthis._terminalTabbedView?.rerenderTabs();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (this._parentDomElement && (e.affectsConfiguration(TerminalSettingId.ShellIntegrationDecorationsEnabled) || e.affectsConfiguration(TerminalSettingId.ShellIntegrationEnabled))) {\n\t\t\t\tthis._updateForShellIntegration(this._parentDomElement);\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._terminalService.onDidCreateInstance((i) => {\n\t\t\ti.capabilities.onDidAddCapabilityType(c => {\n\t\t\t\tif (c === TerminalCapability.CommandDetection && this._gutterDecorationsEnabled()) {\n\t\t\t\t\tthis._parentDomElement?.classList.add('shell-integration');\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t}\n\n\tprivate _updateForShellIntegration(container: HTMLElement) {\n\t\tcontainer.classList.toggle('shell-integration', this._gutterDecorationsEnabled());\n\t}\n\n\tprivate _gutterDecorationsEnabled(): boolean {\n\t\tconst decorationsEnabled = this._configurationService.getValue(TerminalSettingId.ShellIntegrationDecorationsEnabled);\n\t\treturn (decorationsEnabled === 'both' || decorationsEnabled === 'gutter') && this._configurationService.getValue(TerminalSettingId.ShellIntegrationEnabled);\n\t}\n\n\tprivate _initializeTerminal(checkRestoredTerminals: boolean) {\n\t\tif (this.isBodyVisible() && this._terminalService.isProcessSupportRegistered && this._terminalService.connectionState === TerminalConnectionState.Connected) {\n\t\t\tconst wasInitialized = this._isInitialized;\n\t\t\tthis._isInitialized = true;\n\n\t\t\tlet hideOnStartup: 'never' | 'whenEmpty' | 'always' = 'never';\n\t\t\tif (!wasInitialized) {\n\t\t\t\thideOnStartup = this._configurationService.getValue(TerminalSettingId.HideOnStartup);\n\t\t\t\tif (hideOnStartup === 'always') {\n\t\t\t\t\tthis._terminalGroupService.hidePanel();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlet shouldCreate = this._terminalGroupService.groups.length === 0;\n\t\t\t// When triggered just after reconnection, also check there are no groups that could be\n\t\t\t// getting restored currently\n\t\t\tif (checkRestoredTerminals) {\n\t\t\t\tshouldCreate &&= this._terminalService.restoredGroupCount === 0;\n\t\t\t}\n\t\t\tif (!shouldCreate) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!wasInitialized) {\n\t\t\t\tswitch (hideOnStartup) {\n\t\t\t\t\tcase 'never':\n\t\t\t\t\t\tthis._terminalService.createTerminal({ location: TerminalLocation.Panel });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'whenEmpty':\n\t\t\t\t\t\tif (this._terminalService.restoredGroupCount === 0) {\n\t\t\t\t\t\t\tthis._terminalGroupService.hidePanel();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._terminalService.createTerminal({ location: TerminalLocation.Panel });\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected override renderBody(container: HTMLElement): void {\n\t\tsuper.renderBody(container);\n\n\t\tif (!this._parentDomElement) {\n\t\t\tthis._updateForShellIntegration(container);\n\t\t}\n\t\tthis._parentDomElement = container;\n\t\tthis._parentDomElement.classList.add('integrated-terminal');\n\t\tthis._fontStyleElement = document.createElement('style');\n\t\tthis._instantiationService.createInstance(TerminalThemeIconStyle, this._parentDomElement);\n\n\t\tif (!this.shouldShowWelcome()) {\n\t\t\tthis._createTabsView();\n\t\t}\n\n\t\tthis._parentDomElement.appendChild(this._fontStyleElement);\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TerminalSettingId.FontFamily) || e.affectsConfiguration('editor.fontFamily')) {\n\t\t\t\tconst configHelper = this._terminalService.configHelper;\n\t\t\t\tif (!configHelper.configFontIsMonospace()) {\n\t\t\t\t\tconst choices: IPromptChoice[] = [{\n\t\t\t\t\t\tlabel: nls.localize('terminal.useMonospace', \"Use 'monospace'\"),\n\t\t\t\t\t\trun: () => this.configurationService.updateValue(TerminalSettingId.FontFamily, 'monospace'),\n\t\t\t\t\t}];\n\t\t\t\t\tthis._notificationService.prompt(Severity.Warning, nls.localize('terminal.monospaceOnly', \"The terminal only supports monospace fonts. Be sure to restart VS Code if this is a newly installed font.\"), choices);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._register(this.onDidChangeBodyVisibility(async visible => {\n\t\t\tthis._viewShowing.set(visible);\n\t\t\tif (visible) {\n\t\t\t\tif (!this._terminalService.isProcessSupportRegistered) {\n\t\t\t\t\tthis._onDidChangeViewWelcomeState.fire();\n\t\t\t\t}\n\t\t\t\tthis._initializeTerminal(false);\n\t\t\t\t// we don't know here whether or not it should be focused, so\n\t\t\t\t// defer focusing the panel to the focus() call\n\t\t\t\t// to prevent overriding preserveFocus for extensions\n\t\t\t\tthis._terminalGroupService.showPanel(false);\n\t\t\t} else {\n\t\t\t\tfor (const instance of this._terminalGroupService.instances) {\n\t\t\t\t\tinstance.resetFocusContextKey();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._terminalGroupService.updateVisibility();\n\t\t}));\n\t\tthis._register(this._terminalService.onDidChangeConnectionState(() => this._initializeTerminal(true)));\n\t\tthis.layoutBody(this._parentDomElement.offsetHeight, this._parentDomElement.offsetWidth);\n\t}\n\n\tprivate _createTabsView(): void {\n\t\tif (!this._parentDomElement) {\n\t\t\treturn;\n\t\t}\n\t\tthis._terminalTabbedView = this.instantiationService.createInstance(TerminalTabbedView, this._parentDomElement);\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected override layoutBody(height: number, width: number): void {\n\t\tsuper.layoutBody(height, width);\n\t\tthis._terminalTabbedView?.layout(width, height);\n\t}\n\n\toverride getActionViewItem(action: Action): IActionViewItem | undefined {\n\t\tswitch (action.id) {\n\t\t\tcase TerminalCommandId.Split: {\n\t\t\t\t// Split needs to be special cased to force splitting within the panel, not the editor\n\t\t\t\tconst that = this;\n\t\t\t\tconst panelOnlySplitAction = new class extends Action {\n\t\t\t\t\tconstructor() {\n\t\t\t\t\t\tsuper(action.id, action.label, action.class, action.enabled);\n\t\t\t\t\t\tthis.checked = action.checked;\n\t\t\t\t\t\tthis.tooltip = action.tooltip;\n\t\t\t\t\t\tthis._register(action);\n\t\t\t\t\t}\n\t\t\t\t\toverride async run() {\n\t\t\t\t\t\tconst instance = that._terminalGroupService.activeInstance;\n\t\t\t\t\t\tif (instance) {\n\t\t\t\t\t\t\tconst newInstance = await that._terminalService.createTerminal({ location: { parentTerminal: instance } });\n\t\t\t\t\t\t\treturn newInstance?.focusWhenReady();\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\treturn new ActionViewItem(action, panelOnlySplitAction, { icon: true, label: false, keybinding: this._getKeybindingLabel(action) });\n\t\t\t}\n\t\t\tcase TerminalCommandId.SwitchTerminal: {\n\t\t\t\treturn this._instantiationService.createInstance(SwitchTerminalActionViewItem, action);\n\t\t\t}\n\t\t\tcase TerminalCommandId.Focus: {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst actions: IAction[] = [];\n\t\t\t\t\tcreateAndFillInContextMenuActions(this._singleTabMenu, undefined, actions);\n\t\t\t\t\treturn this._instantiationService.createInstance(SingleTerminalTabActionViewItem, action, actions);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcase TerminalCommandId.New: {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst actions = getTerminalActionBarArgs(TerminalLocation.Panel, this._terminalProfileService.availableProfiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu);\n\t\t\t\t\tthis._newDropdown?.dispose();\n\t\t\t\t\tthis._newDropdown = new DropdownWithPrimaryActionViewItem(action, actions.dropdownAction, actions.dropdownMenuActions, actions.className, this._contextMenuService, {}, this._keybindingService, this._notificationService, this._contextKeyService, this._themeService, this._accessibilityService);\n\t\t\t\t\tthis._updateTabActionBar(this._terminalProfileService.availableProfiles);\n\t\t\t\t\treturn this._newDropdown;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn super.getActionViewItem(action);\n\t}\n\n\tprivate _getDefaultProfileName(): string {\n\t\tlet defaultProfileName;\n\t\ttry {\n\t\t\tdefaultProfileName = this._terminalProfileService.getDefaultProfileName();\n\t\t} catch (e) {\n\t\t\tdefaultProfileName = this._terminalProfileResolverService.defaultProfileName;\n\t\t}\n\t\treturn defaultProfileName!;\n\t}\n\n\tprivate _getKeybindingLabel(action: IAction): string | undefined {\n\t\treturn this._keybindingService.lookupKeybinding(action.id)?.getLabel() ?? undefined;\n\t}\n\n\tprivate _updateTabActionBar(profiles: ITerminalProfile[]): void {\n\t\tconst actions = getTerminalActionBarArgs(TerminalLocation.Panel, profiles, this._getDefaultProfileName(), this._terminalProfileService.contributedProfiles, this._terminalService, this._dropdownMenu);\n\t\tthis._newDropdown?.update(actions.dropdownAction, actions.dropdownMenuActions);\n\t}\n\n\toverride focus() {\n\t\tif (this._terminalService.connectionState === TerminalConnectionState.Connecting) {\n\t\t\t// If the terminal is waiting to reconnect to remote terminals, then there is no TerminalInstance yet that can\n\t\t\t// be focused. So wait for connection to finish, then focus.\n\t\t\tconst activeElement = document.activeElement;\n\t\t\tthis._register(this._terminalService.onDidChangeConnectionState(() => {\n\t\t\t\t// Only focus the terminal if the activeElement has not changed since focus() was called\n\t\t\t\t// TODO hack\n\t\t\t\tif (document.activeElement === activeElement) {\n\t\t\t\t\tthis._terminalGroupService.showPanel(true);\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\treturn;\n\t\t}\n\t\tthis._terminalGroupService.showPanel(true);\n\t}\n\n\toverride shouldShowWelcome(): boolean {\n\t\tthis._isWelcomeShowing = !this._terminalService.isProcessSupportRegistered && this._terminalService.instances.length === 0;\n\t\treturn this._isWelcomeShowing;\n\t}\n}\n\nclass SwitchTerminalActionViewItem extends SelectActionViewItem {\n\tconstructor(\n\t\taction: IAction,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IContextViewService contextViewService: IContextViewService,\n\t\t@ITerminalProfileService terminalProfileService: ITerminalProfileService\n\t) {\n\t\tsuper(null, action, getTerminalSelectOpenItems(_terminalService, _terminalGroupService), _terminalGroupService.activeGroupIndex, contextViewService, defaultSelectBoxStyles, { ariaLabel: nls.localize('terminals', 'Open Terminals.'), optionsAsChildren: true });\n\t\tthis._register(_terminalService.onDidChangeInstances(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeActiveGroup(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeActiveInstance(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeInstanceTitle(() => this._updateItems(), this));\n\t\tthis._register(_terminalGroupService.onDidChangeGroups(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeConnectionState(() => this._updateItems(), this));\n\t\tthis._register(terminalProfileService.onDidChangeAvailableProfiles(() => this._updateItems(), this));\n\t\tthis._register(_terminalService.onDidChangeInstancePrimaryStatus(() => this._updateItems(), this));\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tcontainer.classList.add('switch-terminal');\n\t\tcontainer.style.borderColor = asCssVariable(selectBorder);\n\t}\n\n\tprivate _updateItems(): void {\n\t\tconst options = getTerminalSelectOpenItems(this._terminalService, this._terminalGroupService);\n\t\tthis.setOptions(options, this._terminalGroupService.activeGroupIndex);\n\t}\n}\n\nfunction getTerminalSelectOpenItems(terminalService: ITerminalService, terminalGroupService: ITerminalGroupService): ISelectOptionItem[] {\n\tlet items: ISelectOptionItem[];\n\tif (terminalService.connectionState === TerminalConnectionState.Connected) {\n\t\titems = terminalGroupService.getGroupLabels().map(label => {\n\t\t\treturn { text: label };\n\t\t});\n\t} else {\n\t\titems = [{ text: nls.localize('terminalConnectingLabel', \"Starting...\") }];\n\t}\n\titems.push({ text: switchTerminalActionViewItemSeparator, isDisabled: true });\n\titems.push({ text: switchTerminalShowTabsTitle });\n\treturn items;\n}\n\nclass SingleTerminalTabActionViewItem extends MenuEntryActionViewItem {\n\tprivate _color: string | undefined;\n\tprivate _altCommand: string | undefined;\n\tprivate _class: string | undefined;\n\tprivate readonly _elementDisposables: IDisposable[] = [];\n\n\tconstructor(\n\t\taction: MenuItemAction,\n\t\tprivate readonly _actions: IAction[],\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@IAccessibilityService _accessibilityService: IAccessibilityService\n\t) {\n\t\tsuper(action, {\n\t\t\tdraggable: true,\n\t\t\thoverDelegate: _instantiationService.createInstance(SingleTabHoverDelegate)\n\t\t}, keybindingService, notificationService, contextKeyService, themeService, contextMenuService, _accessibilityService);\n\n\t\t// Register listeners to update the tab\n\t\tthis._register(Event.debounce<ITerminalInstance | undefined, Set<ITerminalInstance>>(Event.any(\n\t\t\tthis._terminalService.onDidChangeInstancePrimaryStatus,\n\t\t\tthis._terminalGroupService.onDidChangeActiveInstance,\n\t\t\tEvent.map(this._terminalService.onDidChangeInstanceIcon, e => e.instance),\n\t\t\tEvent.map(this._terminalService.onDidChangeInstanceColor, e => e.instance),\n\t\t\tthis._terminalService.onDidChangeInstanceTitle,\n\t\t\tthis._terminalService.onDidChangeInstanceCapability,\n\t\t), (last, e) => {\n\t\t\tif (!last) {\n\t\t\t\tlast = new Set();\n\t\t\t}\n\t\t\tif (e) {\n\t\t\t\tlast.add(e);\n\t\t\t}\n\t\t\treturn last;\n\t\t})(merged => {\n\t\t\tfor (const e of merged) {\n\t\t\t\tthis.updateLabel(e);\n\t\t\t}\n\t\t}));\n\n\t\t// Clean up on dispose\n\t\tthis._register(toDisposable(() => dispose(this._elementDisposables)));\n\t}\n\n\toverride async onClick(event: MouseEvent): Promise<void> {\n\t\tthis._terminalGroupService.lastAccessedMenu = 'inline-tab';\n\t\tif (event.altKey && this._menuItemAction.alt) {\n\t\t\tthis._commandService.executeCommand(this._menuItemAction.alt.id, { target: TerminalLocation.Panel } as ICreateTerminalOptions);\n\t\t} else {\n\t\t\tthis._openContextMenu();\n\t\t}\n\t}\n\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\tprotected override updateLabel(e?: ITerminalInstance): void {\n\t\t// Only update if it's the active instance\n\t\tif (e && e !== this._terminalGroupService.activeInstance) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._elementDisposables.length === 0 && this.element && this.label) {\n\t\t\t// Right click opens context menu\n\t\t\tthis._elementDisposables.push(dom.addDisposableListener(this.element, dom.EventType.CONTEXT_MENU, e => {\n\t\t\t\tif (e.button === 2) {\n\t\t\t\t\tthis._openContextMenu();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}));\n\t\t\t// Middle click kills\n\t\t\tthis._elementDisposables.push(dom.addDisposableListener(this.element, dom.EventType.AUXCLICK, e => {\n\t\t\t\tif (e.button === 1) {\n\t\t\t\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\t\t\t\tif (instance) {\n\t\t\t\t\t\tthis._terminalService.safeDisposeTerminal(instance);\n\t\t\t\t\t}\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t}));\n\t\t\t// Drag and drop\n\t\t\tthis._elementDisposables.push(dom.addDisposableListener(this.element, dom.EventType.DRAG_START, e => {\n\t\t\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\t\t\tif (e.dataTransfer && instance) {\n\t\t\t\t\te.dataTransfer.setData(TerminalDataTransfers.Terminals, JSON.stringify([instance.resource.toString()]));\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t\tif (this.label) {\n\t\t\tconst label = this.label;\n\t\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\t\tif (!instance) {\n\t\t\t\tdom.reset(label, '');\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlabel.classList.add('single-terminal-tab');\n\t\t\tlet colorStyle = '';\n\t\t\tconst primaryStatus = instance.statusList.primary;\n\t\t\tif (primaryStatus) {\n\t\t\t\tconst colorKey = getColorForSeverity(primaryStatus.severity);\n\t\t\t\tthis._themeService.getColorTheme();\n\t\t\t\tconst foundColor = this._themeService.getColorTheme().getColor(colorKey);\n\t\t\t\tif (foundColor) {\n\t\t\t\t\tcolorStyle = foundColor.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t\tlabel.style.color = colorStyle;\n\t\t\tdom.reset(label, ...renderLabelWithIcons(this._instantiationService.invokeFunction(getSingleTabLabel, instance, this._terminalService.configHelper.config.tabs.separator, ThemeIcon.isThemeIcon(this._commandAction.item.icon) ? this._commandAction.item.icon : undefined)));\n\n\t\t\tif (this._altCommand) {\n\t\t\t\tlabel.classList.remove(this._altCommand);\n\t\t\t\tthis._altCommand = undefined;\n\t\t\t}\n\t\t\tif (this._color) {\n\t\t\t\tlabel.classList.remove(this._color);\n\t\t\t\tthis._color = undefined;\n\t\t\t}\n\t\t\tif (this._class) {\n\t\t\t\tlabel.classList.remove(this._class);\n\t\t\t\tlabel.classList.remove('terminal-uri-icon');\n\t\t\t\tthis._class = undefined;\n\t\t\t}\n\t\t\tconst colorClass = getColorClass(instance);\n\t\t\tif (colorClass) {\n\t\t\t\tthis._color = colorClass;\n\t\t\t\tlabel.classList.add(colorClass);\n\t\t\t}\n\t\t\tconst uriClasses = getUriClasses(instance, this._themeService.getColorTheme().type);\n\t\t\tif (uriClasses) {\n\t\t\t\tthis._class = uriClasses?.[0];\n\t\t\t\tlabel.classList.add(...uriClasses);\n\t\t\t}\n\t\t\tif (this._commandAction.item.icon) {\n\t\t\t\tthis._altCommand = `alt-command`;\n\t\t\t\tlabel.classList.add(this._altCommand);\n\t\t\t}\n\t\t\tthis.updateTooltip();\n\t\t}\n\t}\n\n\tprivate _openContextMenu() {\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tgetAnchor: () => this.element!,\n\t\t\tgetActions: () => this._actions,\n\t\t\tgetActionsContext: () => this.label\n\t\t});\n\t}\n}\n\nfunction getSingleTabLabel(accessor: ServicesAccessor, instance: ITerminalInstance | undefined, separator: string, icon?: ThemeIcon) {\n\t// Don't even show the icon if there is no title as the icon would shift around when the title\n\t// is added\n\tif (!instance || !instance.title) {\n\t\treturn '';\n\t}\n\tconst iconId = ThemeIcon.isThemeIcon(instance.icon) ? instance.icon.id : accessor.get(ITerminalProfileResolverService).getDefaultIcon().id;\n\tconst label = `$(${icon?.id || iconId}) ${getSingleTabTitle(instance, separator)}`;\n\n\tconst primaryStatus = instance.statusList.primary;\n\tif (!primaryStatus?.icon) {\n\t\treturn label;\n\t}\n\treturn `${label} $(${primaryStatus.icon.id})`;\n}\n\nfunction getSingleTabTitle(instance: ITerminalInstance | undefined, separator: string): string {\n\tif (!instance) {\n\t\treturn '';\n\t}\n\treturn !instance.description ? instance.title : `${instance.title} ${separator} ${instance.description}`;\n}\n\nclass TerminalThemeIconStyle extends Themable {\n\tprivate _styleElement: HTMLElement;\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@ITerminalService private readonly _terminalService: ITerminalService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService\n\t) {\n\t\tsuper(_themeService);\n\t\tthis._registerListeners();\n\t\tthis._styleElement = document.createElement('style');\n\t\tcontainer.appendChild(this._styleElement);\n\t\tthis._register(toDisposable(() => container.removeChild(this._styleElement)));\n\t\tthis.updateStyles();\n\t}\n\n\tprivate _registerListeners(): void {\n\t\tthis._register(this._terminalService.onDidChangeInstanceIcon(() => this.updateStyles()));\n\t\tthis._register(this._terminalService.onDidChangeInstanceColor(() => this.updateStyles()));\n\t\tthis._register(this._terminalService.onDidChangeInstances(() => this.updateStyles()));\n\t\tthis._register(this._terminalGroupService.onDidChangeGroups(() => this.updateStyles()));\n\t}\n\n\toverride updateStyles(): void {\n\t\tsuper.updateStyles();\n\t\tconst colorTheme = this._themeService.getColorTheme();\n\n\t\t// TODO: add a rule collector to avoid duplication\n\t\tlet css = '';\n\n\t\t// Add icons\n\t\tfor (const instance of this._terminalService.instances) {\n\t\t\tconst icon = instance.icon;\n\t\t\tif (!icon) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet uri = undefined;\n\t\t\tif (icon instanceof URI) {\n\t\t\t\turi = icon;\n\t\t\t} else if (icon instanceof Object && 'light' in icon && 'dark' in icon) {\n\t\t\t\turi = colorTheme.type === ColorScheme.LIGHT ? icon.light : icon.dark;\n\t\t\t}\n\t\t\tconst iconClasses = getUriClasses(instance, colorTheme.type);\n\t\t\tif (uri instanceof URI && iconClasses && iconClasses.length > 1) {\n\t\t\t\tcss += (\n\t\t\t\t\t`.monaco-workbench .${iconClasses[0]} .monaco-highlighted-label .codicon, .monaco-action-bar .terminal-uri-icon.single-terminal-tab.action-label:not(.alt-command) .codicon` +\n\t\t\t\t\t`{background-image: ${dom.asCSSUrl(uri)};}`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Add colors\n\t\tfor (const instance of this._terminalService.instances) {\n\t\t\tconst colorClass = getColorClass(instance);\n\t\t\tif (!colorClass || !instance.color) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst color = colorTheme.getColor(instance.color);\n\t\t\tif (color) {\n\t\t\t\t// exclude status icons (file-icon) and inline action icons (trashcan and horizontalSplit)\n\t\t\t\tcss += (\n\t\t\t\t\t`.monaco-workbench .${colorClass} .codicon:first-child:not(.codicon-split-horizontal):not(.codicon-trashcan):not(.file-icon)` +\n\t\t\t\t\t`{ color: ${color} !important; }`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis._styleElement.textContent = css;\n\t}\n}\n\nclass SingleTabHoverDelegate implements IHoverDelegate {\n\tprivate _lastHoverHideTime: number = 0;\n\n\treadonly placement = 'element';\n\n\tconstructor(\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IHoverService private readonly _hoverService: IHoverService,\n\t\t@ITerminalGroupService private readonly _terminalGroupService: ITerminalGroupService\n\t) {\n\t}\n\n\tget delay(): number {\n\t\treturn Date.now() - this._lastHoverHideTime < 200\n\t\t\t? 0  // show instantly when a hover was recently shown\n\t\t\t: this._configurationService.getValue<number>('workbench.hover.delay');\n\t}\n\n\tshowHover(options: IHoverDelegateOptions, focus?: boolean) {\n\t\tconst instance = this._terminalGroupService.activeInstance;\n\t\tif (!instance) {\n\t\t\treturn;\n\t\t}\n\t\tconst hoverInfo = getInstanceHoverInfo(instance);\n\t\treturn this._hoverService.showHover({\n\t\t\t...options,\n\t\t\tcontent: hoverInfo.content,\n\t\t\tactions: hoverInfo.actions\n\t\t}, focus);\n\t}\n\n\tonDidHideHover() {\n\t\tthis._lastHoverHideTime = Date.now();\n\t}\n}\n"]}