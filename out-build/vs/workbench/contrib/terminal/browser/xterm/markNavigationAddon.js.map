{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/terminal/browser/xterm/markNavigationAddon.ts"],"names":[],"mappings":"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","file":"markNavigationAddon.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { coalesce } from 'vs/base/common/arrays';\nimport { Disposable, dispose } from 'vs/base/common/lifecycle';\nimport { IMarkTracker } from 'vs/workbench/contrib/terminal/browser/terminal';\nimport { ITerminalCapabilityStore, TerminalCapability } from 'vs/platform/terminal/common/capabilities/capabilities';\nimport type { Terminal, IMarker, ITerminalAddon, IDecoration } from 'xterm';\nimport { timeout } from 'vs/base/common/async';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { TERMINAL_OVERVIEW_RULER_CURSOR_FOREGROUND_COLOR } from 'vs/workbench/contrib/terminal/common/terminalColorRegistry';\n\nenum Boundary {\n\tTop,\n\tBottom\n}\n\nexport const enum ScrollPosition {\n\tTop,\n\tMiddle\n}\n\nexport class MarkNavigationAddon extends Disposable implements IMarkTracker, ITerminalAddon {\n\tprivate _currentMarker: IMarker | Boundary = Boundary.Bottom;\n\tprivate _selectionStart: IMarker | Boundary | null = null;\n\tprivate _isDisposable: boolean = false;\n\tprotected _terminal: Terminal | undefined;\n\tprivate _navigationDecorations: IDecoration[] | undefined;\n\n\tactivate(terminal: Terminal): void {\n\t\tthis._terminal = terminal;\n\t\tthis._register(this._terminal.onData(() => {\n\t\t\tthis._currentMarker = Boundary.Bottom;\n\t\t}));\n\t}\n\n\tconstructor(\n\t\tprivate readonly _capabilities: ITerminalCapabilityStore,\n\t\t@IThemeService private readonly _themeService: IThemeService\n\t) {\n\t\tsuper();\n\t}\n\n\tprivate _getMarkers(skipEmptyCommands?: boolean): readonly IMarker[] {\n\t\tconst commandCapability = this._capabilities.get(TerminalCapability.CommandDetection);\n\t\tconst partialCommandCapability = this._capabilities.get(TerminalCapability.PartialCommandDetection);\n\t\tconst markCapability = this._capabilities.get(TerminalCapability.BufferMarkDetection);\n\t\tlet markers: IMarker[] = [];\n\t\tif (commandCapability) {\n\t\t\tmarkers = coalesce(commandCapability.commands.map(e => e.marker));\n\t\t} else if (partialCommandCapability) {\n\t\t\tmarkers.push(...partialCommandCapability.commands);\n\t\t}\n\n\t\tif (markCapability && !skipEmptyCommands) {\n\t\t\tlet next = markCapability.markers().next()?.value;\n\t\t\tconst arr: IMarker[] = [];\n\t\t\twhile (next) {\n\t\t\t\tarr.push(next);\n\t\t\t\tnext = markCapability.markers().next()?.value;\n\t\t\t}\n\t\t\tmarkers = arr;\n\t\t}\n\t\treturn markers;\n\t}\n\n\tclearMarker(): void {\n\t\t// Clear the current marker so successive focus/selection actions are performed from the\n\t\t// bottom of the buffer\n\t\tthis._currentMarker = Boundary.Bottom;\n\t\tthis._resetNavigationDecorations();\n\t\tthis._selectionStart = null;\n\t}\n\n\tprivate _resetNavigationDecorations() {\n\t\tif (this._navigationDecorations) {\n\t\t\tdispose(this._navigationDecorations);\n\t\t}\n\t\tthis._navigationDecorations = [];\n\t}\n\n\tprivate _isEmptyCommand(marker: IMarker | Boundary) {\n\t\tif (marker === Boundary.Bottom) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (marker === Boundary.Top) {\n\t\t\treturn !this._getMarkers(true).map(e => e.line).includes(0);\n\t\t}\n\n\t\treturn !this._getMarkers(true).includes(marker);\n\t}\n\n\tscrollToPreviousMark(scrollPosition: ScrollPosition = ScrollPosition.Middle, retainSelection: boolean = false, skipEmptyCommands: boolean = false): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (!retainSelection) {\n\t\t\tthis._selectionStart = null;\n\t\t}\n\n\t\tlet markerIndex;\n\t\tconst currentLineY = typeof this._currentMarker === 'object'\n\t\t\t? this._getTargetScrollLine(this._terminal, this._currentMarker, scrollPosition)\n\t\t\t: Math.min(getLine(this._terminal, this._currentMarker), this._terminal.buffer.active.baseY);\n\t\tconst viewportY = this._terminal.buffer.active.viewportY;\n\t\tif (typeof this._currentMarker === 'object' ? !this._isMarkerInViewport(this._terminal, this._currentMarker) : currentLineY !== viewportY) {\n\t\t\t// The user has scrolled, find the line based on the current scroll position. This only\n\t\t\t// works when not retaining selection\n\t\t\tconst markersBelowViewport = this._getMarkers(skipEmptyCommands).filter(e => e.line >= viewportY).length;\n\t\t\t// -1 will scroll to the top\n\t\t\tmarkerIndex = this._getMarkers(skipEmptyCommands).length - markersBelowViewport - 1;\n\t\t} else if (this._currentMarker === Boundary.Bottom) {\n\t\t\tmarkerIndex = this._getMarkers(skipEmptyCommands).length - 1;\n\t\t} else if (this._currentMarker === Boundary.Top) {\n\t\t\tmarkerIndex = -1;\n\t\t} else if (this._isDisposable) {\n\t\t\tmarkerIndex = this._findPreviousMarker(this._terminal, skipEmptyCommands);\n\t\t\tthis._currentMarker.dispose();\n\t\t\tthis._isDisposable = false;\n\t\t} else {\n\t\t\tif (skipEmptyCommands && this._isEmptyCommand(this._currentMarker)) {\n\t\t\t\tmarkerIndex = this._findPreviousMarker(this._terminal, true);\n\t\t\t} else {\n\t\t\t\tmarkerIndex = this._getMarkers(skipEmptyCommands).indexOf(this._currentMarker) - 1;\n\t\t\t}\n\t\t}\n\n\t\tif (markerIndex < 0) {\n\t\t\tthis._currentMarker = Boundary.Top;\n\t\t\tthis._terminal.scrollToTop();\n\t\t\tthis._resetNavigationDecorations();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._currentMarker = this._getMarkers(skipEmptyCommands)[markerIndex];\n\t\tthis._scrollToMarker(this._currentMarker, scrollPosition);\n\t}\n\n\tscrollToNextMark(scrollPosition: ScrollPosition = ScrollPosition.Middle, retainSelection: boolean = false, skipEmptyCommands: boolean = true): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (!retainSelection) {\n\t\t\tthis._selectionStart = null;\n\t\t}\n\n\t\tlet markerIndex;\n\t\tconst currentLineY = typeof this._currentMarker === 'object'\n\t\t\t? this._getTargetScrollLine(this._terminal, this._currentMarker, scrollPosition)\n\t\t\t: Math.min(getLine(this._terminal, this._currentMarker), this._terminal.buffer.active.baseY);\n\t\tconst viewportY = this._terminal.buffer.active.viewportY;\n\t\tif (typeof this._currentMarker === 'object' ? !this._isMarkerInViewport(this._terminal, this._currentMarker) : currentLineY !== viewportY) {\n\t\t\t// The user has scrolled, find the line based on the current scroll position. This only\n\t\t\t// works when not retaining selection\n\t\t\tconst markersAboveViewport = this._getMarkers(skipEmptyCommands).filter(e => e.line <= viewportY).length;\n\t\t\t// markers.length will scroll to the bottom\n\t\t\tmarkerIndex = markersAboveViewport;\n\t\t} else if (this._currentMarker === Boundary.Bottom) {\n\t\t\tmarkerIndex = this._getMarkers(skipEmptyCommands).length;\n\t\t} else if (this._currentMarker === Boundary.Top) {\n\t\t\tmarkerIndex = 0;\n\t\t} else if (this._isDisposable) {\n\t\t\tmarkerIndex = this._findNextMarker(this._terminal, skipEmptyCommands);\n\t\t\tthis._currentMarker.dispose();\n\t\t\tthis._isDisposable = false;\n\t\t} else {\n\t\t\tif (skipEmptyCommands && this._isEmptyCommand(this._currentMarker)) {\n\t\t\t\tmarkerIndex = this._findNextMarker(this._terminal, true);\n\t\t\t} else {\n\t\t\t\tmarkerIndex = this._getMarkers(skipEmptyCommands).indexOf(this._currentMarker) + 1;\n\t\t\t}\n\t\t}\n\n\t\tif (markerIndex >= this._getMarkers(skipEmptyCommands).length) {\n\t\t\tthis._currentMarker = Boundary.Bottom;\n\t\t\tthis._terminal.scrollToBottom();\n\t\t\tthis._resetNavigationDecorations();\n\t\t\treturn;\n\t\t}\n\n\t\tthis._currentMarker = this._getMarkers(skipEmptyCommands)[markerIndex];\n\t\tthis._scrollToMarker(this._currentMarker, scrollPosition);\n\t}\n\n\tprivate _scrollToMarker(marker: IMarker, position: ScrollPosition, endMarker?: IMarker, hideDecoration?: boolean): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._isMarkerInViewport(this._terminal, marker)) {\n\t\t\tconst line = this._getTargetScrollLine(this._terminal, marker, position);\n\t\t\tthis._terminal.scrollToLine(line);\n\t\t}\n\t\tif (!hideDecoration) {\n\t\t\tthis._registerTemporaryDecoration(marker, endMarker);\n\t\t}\n\t}\n\n\tprivate _createMarkerForOffset(marker: IMarker, offset: number): IMarker {\n\t\tif (offset === 0) {\n\t\t\treturn marker;\n\t\t} else {\n\t\t\tconst offsetMarker = this._terminal?.registerMarker(-this._terminal.buffer.active.cursorY + marker.line - this._terminal.buffer.active.baseY + offset);\n\t\t\tif (offsetMarker) {\n\t\t\t\treturn offsetMarker;\n\t\t\t} else {\n\t\t\t\tthrow new Error(`Could not register marker with offset ${marker.line}, ${offset}`);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _registerTemporaryDecoration(marker: IMarker, endMarker?: IMarker): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tthis._resetNavigationDecorations();\n\t\tconst color = this._themeService.getColorTheme().getColor(TERMINAL_OVERVIEW_RULER_CURSOR_FOREGROUND_COLOR);\n\t\tconst startLine = marker.line;\n\t\tconst decorationCount = endMarker ? endMarker.line - startLine + 1 : 1;\n\n\t\tfor (let i = 0; i < decorationCount; i++) {\n\t\t\tconst decoration = this._terminal.registerDecoration({\n\t\t\t\tmarker: this._createMarkerForOffset(marker, i),\n\t\t\t\twidth: this._terminal.cols,\n\t\t\t\toverviewRulerOptions: {\n\t\t\t\t\tcolor: color?.toString() || '#a0a0a0cc'\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (decoration) {\n\t\t\t\tthis._navigationDecorations?.push(decoration);\n\t\t\t\tlet renderedElement: HTMLElement | undefined;\n\n\t\t\t\tdecoration.onRender(element => {\n\t\t\t\t\tif (!renderedElement) {\n\t\t\t\t\t\trenderedElement = element;\n\t\t\t\t\t\tif (decorationCount > 1) {\n\t\t\t\t\t\t\telement.classList.add('terminal-scroll-highlight');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telement.classList.add('terminal-scroll-highlight', 'terminal-scroll-highlight-outline');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (this._terminal?.element) {\n\t\t\t\t\t\t\telement.style.marginLeft = `-${getComputedStyle(this._terminal.element).paddingLeft}`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tdecoration.onDispose(() => { this._navigationDecorations = this._navigationDecorations?.filter(d => d !== decoration); });\n\t\t\t\t// Number picked to align with symbol highlight in the editor\n\t\t\t\ttimeout(350).then(() => {\n\t\t\t\t\tif (renderedElement) {\n\t\t\t\t\t\trenderedElement.classList.remove('terminal-scroll-highlight-outline');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _getTargetScrollLine(terminal: Terminal, marker: IMarker, position: ScrollPosition) {\n\t\t// Middle is treated at 1/4 of the viewport's size because context below is almost always\n\t\t// more important than context above in the terminal.\n\t\tif (position === ScrollPosition.Middle) {\n\t\t\treturn Math.max(marker.line - Math.floor(terminal.rows / 4), 0);\n\t\t}\n\t\treturn marker.line;\n\t}\n\n\tprivate _isMarkerInViewport(terminal: Terminal, marker: IMarker) {\n\t\tconst viewportY = terminal.buffer.active.viewportY;\n\t\treturn marker.line >= viewportY && marker.line < viewportY + terminal.rows;\n\t}\n\n\tscrollToClosestMarker(startMarkerId: string, endMarkerId?: string, highlight?: boolean | undefined): void {\n\t\tconst detectionCapability = this._capabilities.get(TerminalCapability.BufferMarkDetection);\n\t\tif (!detectionCapability) {\n\t\t\treturn;\n\t\t}\n\t\tconst startMarker = detectionCapability.getMark(startMarkerId);\n\t\tif (!startMarker) {\n\t\t\treturn;\n\t\t}\n\t\tconst endMarker = endMarkerId ? detectionCapability.getMark(endMarkerId) : startMarker;\n\t\tthis._scrollToMarker(startMarker, ScrollPosition.Top, endMarker, !highlight);\n\t}\n\n\tselectToPreviousMark(): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._selectionStart === null) {\n\t\t\tthis._selectionStart = this._currentMarker;\n\t\t}\n\t\tif (this._capabilities.has(TerminalCapability.CommandDetection)) {\n\t\t\tthis.scrollToPreviousMark(ScrollPosition.Middle, true, true);\n\t\t} else {\n\t\t\tthis.scrollToPreviousMark(ScrollPosition.Middle, true, false);\n\t\t}\n\t\tselectLines(this._terminal, this._currentMarker, this._selectionStart);\n\t}\n\n\tselectToNextMark(): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._selectionStart === null) {\n\t\t\tthis._selectionStart = this._currentMarker;\n\t\t}\n\t\tif (this._capabilities.has(TerminalCapability.CommandDetection)) {\n\t\t\tthis.scrollToNextMark(ScrollPosition.Middle, true, true);\n\t\t} else {\n\t\t\tthis.scrollToNextMark(ScrollPosition.Middle, true, false);\n\t\t}\n\t\tselectLines(this._terminal, this._currentMarker, this._selectionStart);\n\t}\n\n\tselectToPreviousLine(): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._selectionStart === null) {\n\t\t\tthis._selectionStart = this._currentMarker;\n\t\t}\n\t\tthis.scrollToPreviousLine(this._terminal, ScrollPosition.Middle, true);\n\t\tselectLines(this._terminal, this._currentMarker, this._selectionStart);\n\t}\n\n\tselectToNextLine(): void {\n\t\tif (!this._terminal) {\n\t\t\treturn;\n\t\t}\n\t\tif (this._selectionStart === null) {\n\t\t\tthis._selectionStart = this._currentMarker;\n\t\t}\n\t\tthis.scrollToNextLine(this._terminal, ScrollPosition.Middle, true);\n\t\tselectLines(this._terminal, this._currentMarker, this._selectionStart);\n\t}\n\n\tscrollToPreviousLine(xterm: Terminal, scrollPosition: ScrollPosition = ScrollPosition.Middle, retainSelection: boolean = false): void {\n\t\tif (!retainSelection) {\n\t\t\tthis._selectionStart = null;\n\t\t}\n\n\t\tif (this._currentMarker === Boundary.Top) {\n\t\t\txterm.scrollToTop();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._currentMarker === Boundary.Bottom) {\n\t\t\tthis._currentMarker = this._registerMarkerOrThrow(xterm, this._getOffset(xterm) - 1);\n\t\t} else {\n\t\t\tconst offset = this._getOffset(xterm);\n\t\t\tif (this._isDisposable) {\n\t\t\t\tthis._currentMarker.dispose();\n\t\t\t}\n\t\t\tthis._currentMarker = this._registerMarkerOrThrow(xterm, offset - 1);\n\t\t}\n\t\tthis._isDisposable = true;\n\t\tthis._scrollToMarker(this._currentMarker, scrollPosition);\n\t}\n\n\tscrollToNextLine(xterm: Terminal, scrollPosition: ScrollPosition = ScrollPosition.Middle, retainSelection: boolean = false): void {\n\t\tif (!retainSelection) {\n\t\t\tthis._selectionStart = null;\n\t\t}\n\n\t\tif (this._currentMarker === Boundary.Bottom) {\n\t\t\txterm.scrollToBottom();\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._currentMarker === Boundary.Top) {\n\t\t\tthis._currentMarker = this._registerMarkerOrThrow(xterm, this._getOffset(xterm) + 1);\n\t\t} else {\n\t\t\tconst offset = this._getOffset(xterm);\n\t\t\tif (this._isDisposable) {\n\t\t\t\tthis._currentMarker.dispose();\n\t\t\t}\n\t\t\tthis._currentMarker = this._registerMarkerOrThrow(xterm, offset + 1);\n\t\t}\n\t\tthis._isDisposable = true;\n\t\tthis._scrollToMarker(this._currentMarker, scrollPosition);\n\t}\n\n\tprivate _registerMarkerOrThrow(xterm: Terminal, cursorYOffset: number): IMarker {\n\t\tconst marker = xterm.registerMarker(cursorYOffset);\n\t\tif (!marker) {\n\t\t\tthrow new Error(`Could not create marker for ${cursorYOffset}`);\n\t\t}\n\t\treturn marker;\n\t}\n\n\tprivate _getOffset(xterm: Terminal): number {\n\t\tif (this._currentMarker === Boundary.Bottom) {\n\t\t\treturn 0;\n\t\t} else if (this._currentMarker === Boundary.Top) {\n\t\t\treturn 0 - (xterm.buffer.active.baseY + xterm.buffer.active.cursorY);\n\t\t} else {\n\t\t\tlet offset = getLine(xterm, this._currentMarker);\n\t\t\toffset -= xterm.buffer.active.baseY + xterm.buffer.active.cursorY;\n\t\t\treturn offset;\n\t\t}\n\t}\n\n\tprivate _findPreviousMarker(xterm: Terminal, skipEmptyCommands: boolean = false): number {\n\t\tif (this._currentMarker === Boundary.Top) {\n\t\t\treturn 0;\n\t\t} else if (this._currentMarker === Boundary.Bottom) {\n\t\t\treturn this._getMarkers(skipEmptyCommands).length - 1;\n\t\t}\n\n\t\tlet i;\n\t\tfor (i = this._getMarkers(skipEmptyCommands).length - 1; i >= 0; i--) {\n\t\t\tif (this._getMarkers(skipEmptyCommands)[i].line < this._currentMarker.line) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tprivate _findNextMarker(xterm: Terminal, skipEmptyCommands: boolean = false): number {\n\t\tif (this._currentMarker === Boundary.Top) {\n\t\t\treturn 0;\n\t\t} else if (this._currentMarker === Boundary.Bottom) {\n\t\t\treturn this._getMarkers(skipEmptyCommands).length - 1;\n\t\t}\n\n\t\tlet i;\n\t\tfor (i = 0; i < this._getMarkers(skipEmptyCommands).length; i++) {\n\t\t\tif (this._getMarkers(skipEmptyCommands)[i].line > this._currentMarker.line) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn this._getMarkers(skipEmptyCommands).length;\n\t}\n}\n\nexport function getLine(xterm: Terminal, marker: IMarker | Boundary): number {\n\t// Use the _second last_ row as the last row is likely the prompt\n\tif (marker === Boundary.Bottom) {\n\t\treturn xterm.buffer.active.baseY + xterm.rows - 1;\n\t}\n\n\tif (marker === Boundary.Top) {\n\t\treturn 0;\n\t}\n\n\treturn marker.line;\n}\n\nexport function selectLines(xterm: Terminal, start: IMarker | Boundary, end: IMarker | Boundary | null): void {\n\tif (end === null) {\n\t\tend = Boundary.Bottom;\n\t}\n\n\tlet startLine = getLine(xterm, start);\n\tlet endLine = getLine(xterm, end);\n\n\tif (startLine > endLine) {\n\t\tconst temp = startLine;\n\t\tstartLine = endLine;\n\t\tendLine = temp;\n\t}\n\n\t// Subtract a line as the marker is on the line the command run, we do not want the next\n\t// command in the selection for the current command\n\tendLine -= 1;\n\n\txterm.selectLines(startLine, endLine);\n}\n"]}