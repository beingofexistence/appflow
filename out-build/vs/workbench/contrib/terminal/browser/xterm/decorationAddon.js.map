{"version":3,"sources":["vs/workbench/contrib/terminal/browser/xterm/decorationAddon.ts"],"names":[],"mappings":"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","file":"decorationAddon.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\nimport { IAction, Separator } from 'vs/base/common/actions';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable, IDisposable, dispose, toDisposable } from 'vs/base/common/lifecycle';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { localize } from 'vs/nls';\nimport { AudioCue, IAudioCueService } from 'vs/platform/audioCues/browser/audioCueService';\nimport { IClipboardService } from 'vs/platform/clipboard/common/clipboardService';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { INotificationService, Severity } from 'vs/platform/notification/common/notification';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { IQuickInputService, IQuickPickItem } from 'vs/platform/quickinput/common/quickInput';\nimport { CommandInvalidationReason, ICommandDetectionCapability, IMarkProperties, ITerminalCapabilityStore, ITerminalCommand, TerminalCapability } from 'vs/platform/terminal/common/capabilities/capabilities';\nimport { TerminalSettingId } from 'vs/platform/terminal/common/terminal';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { terminalDecorationError, terminalDecorationIncomplete, terminalDecorationMark, terminalDecorationSuccess } from 'vs/workbench/contrib/terminal/browser/terminalIcons';\nimport { DecorationSelector, TerminalDecorationHoverManager, updateLayout } from 'vs/workbench/contrib/terminal/browser/xterm/decorationStyles';\nimport { TERMINAL_COMMAND_DECORATION_DEFAULT_BACKGROUND_COLOR, TERMINAL_COMMAND_DECORATION_ERROR_BACKGROUND_COLOR, TERMINAL_COMMAND_DECORATION_SUCCESS_BACKGROUND_COLOR } from 'vs/workbench/contrib/terminal/common/terminalColorRegistry';\nimport { ILifecycleService } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport type { IDecoration, ITerminalAddon, Terminal } from 'xterm';\n\ninterface IDisposableDecoration { decoration: IDecoration; disposables: IDisposable[]; exitCode?: number; markProperties?: IMarkProperties }\n\nexport class DecorationAddon extends Disposable implements ITerminalAddon {\n\tprotected _terminal: Terminal | undefined;\n\tprivate _capabilityDisposables: Map<TerminalCapability, IDisposable[]> = new Map();\n\tprivate _decorations: Map<number, IDisposableDecoration> = new Map();\n\tprivate _placeholderDecoration: IDecoration | undefined;\n\tprivate _showGutterDecorations?: boolean;\n\tprivate _showOverviewRulerDecorations?: boolean;\n\tprivate _terminalDecorationHoverService: TerminalDecorationHoverManager;\n\n\tprivate readonly _onDidRequestRunCommand = this._register(new Emitter<{ command: ITerminalCommand; copyAsHtml?: boolean }>());\n\treadonly onDidRequestRunCommand = this._onDidRequestRunCommand.event;\n\n\tconstructor(\n\t\tprivate readonly _capabilities: ITerminalCapabilityStore,\n\t\t@IClipboardService private readonly _clipboardService: IClipboardService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService,\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@IOpenerService private readonly _openerService: IOpenerService,\n\t\t@IQuickInputService private readonly _quickInputService: IQuickInputService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IAudioCueService private readonly _audioCueService: IAudioCueService,\n\t\t@INotificationService private readonly _notificationService: INotificationService\n\t) {\n\t\tsuper();\n\t\tthis._register(toDisposable(() => this._dispose()));\n\t\tthis._register(this._configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(TerminalSettingId.FontSize) || e.affectsConfiguration(TerminalSettingId.LineHeight)) {\n\t\t\t\tthis.refreshLayouts();\n\t\t\t} else if (e.affectsConfiguration('workbench.colorCustomizations')) {\n\t\t\t\tthis._refreshStyles(true);\n\t\t\t} else if (e.affectsConfiguration(TerminalSettingId.ShellIntegrationDecorationsEnabled)) {\n\t\t\t\tthis._removeCapabilityDisposables(TerminalCapability.CommandDetection);\n\t\t\t\tthis._updateDecorationVisibility();\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._themeService.onDidColorThemeChange(() => this._refreshStyles(true)));\n\t\tthis._updateDecorationVisibility();\n\t\tthis._register(this._capabilities.onDidAddCapabilityType(c => this._createCapabilityDisposables(c)));\n\t\tthis._register(this._capabilities.onDidRemoveCapabilityType(c => this._removeCapabilityDisposables(c)));\n\t\tthis._register(lifecycleService.onWillShutdown(() => this._disposeAllDecorations()));\n\t\tthis._terminalDecorationHoverService = instantiationService.createInstance(TerminalDecorationHoverManager);\n\t}\n\n\tprivate _removeCapabilityDisposables(c: TerminalCapability): void {\n\t\tconst disposables = this._capabilityDisposables.get(c);\n\t\tif (disposables) {\n\t\t\tdispose(disposables);\n\t\t}\n\t\tthis._capabilityDisposables.delete(c);\n\t}\n\n\tprivate _createCapabilityDisposables(c: TerminalCapability): void {\n\t\tlet disposables: IDisposable[] = [];\n\t\tconst capability = this._capabilities.get(c);\n\t\tif (!capability || this._capabilityDisposables.has(c)) {\n\t\t\treturn;\n\t\t}\n\t\tswitch (capability.type) {\n\t\t\tcase TerminalCapability.BufferMarkDetection:\n\t\t\t\tdisposables = [capability.onMarkAdded(mark => this.registerMarkDecoration(mark))];\n\t\t\t\tbreak;\n\t\t\tcase TerminalCapability.CommandDetection:\n\t\t\t\tdisposables = this._getCommandDetectionListeners(capability);\n\t\t\t\tbreak;\n\t\t}\n\t\tthis._capabilityDisposables.set(c, disposables);\n\t}\n\n\tregisterMarkDecoration(mark: IMarkProperties): IDecoration | undefined {\n\t\tif (!this._terminal || (!this._showGutterDecorations && !this._showOverviewRulerDecorations)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (mark.hidden) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this.registerCommandDecoration(undefined, undefined, mark);\n\t}\n\n\tprivate _updateDecorationVisibility(): void {\n\t\tconst showDecorations = this._configurationService.getValue(TerminalSettingId.ShellIntegrationDecorationsEnabled);\n\t\tthis._showGutterDecorations = (showDecorations === 'both' || showDecorations === 'gutter');\n\t\tthis._showOverviewRulerDecorations = (showDecorations === 'both' || showDecorations === 'overviewRuler');\n\t\tthis._disposeAllDecorations();\n\t\tif (this._showGutterDecorations || this._showOverviewRulerDecorations) {\n\t\t\tthis._attachToCommandCapability();\n\t\t\tthis._updateGutterDecorationVisibility();\n\t\t}\n\t\tconst currentCommand = this._capabilities.get(TerminalCapability.CommandDetection)?.executingCommandObject;\n\t\tif (currentCommand) {\n\t\t\tthis.registerCommandDecoration(currentCommand, true);\n\t\t}\n\t}\n\n\tprivate _disposeAllDecorations(): void {\n\t\tthis._placeholderDecoration?.dispose();\n\t\tfor (const value of this._decorations.values()) {\n\t\t\tvalue.decoration.dispose();\n\t\t\tdispose(value.disposables);\n\t\t}\n\t}\n\n\tprivate _updateGutterDecorationVisibility(): void {\n\t\tconst commandDecorationElements = document.querySelectorAll(DecorationSelector.CommandDecoration);\n\t\tfor (const commandDecorationElement of commandDecorationElements) {\n\t\t\tthis._updateCommandDecorationVisibility(commandDecorationElement);\n\t\t}\n\t}\n\n\tprivate _updateCommandDecorationVisibility(commandDecorationElement: Element): void {\n\t\tif (this._showGutterDecorations) {\n\t\t\tcommandDecorationElement.classList.remove(DecorationSelector.Hide);\n\t\t} else {\n\t\t\tcommandDecorationElement.classList.add(DecorationSelector.Hide);\n\t\t}\n\t}\n\n\tpublic refreshLayouts(): void {\n\t\tupdateLayout(this._configurationService, this._placeholderDecoration?.element);\n\t\tfor (const decoration of this._decorations) {\n\t\t\tupdateLayout(this._configurationService, decoration[1].decoration.element);\n\t\t}\n\t}\n\n\tprivate _refreshStyles(refreshOverviewRulerColors?: boolean): void {\n\t\tif (refreshOverviewRulerColors) {\n\t\t\tfor (const decoration of this._decorations.values()) {\n\t\t\t\tconst color = this._getDecorationCssColor(decoration)?.toString() ?? '';\n\t\t\t\tif (decoration.decoration.options?.overviewRulerOptions) {\n\t\t\t\t\tdecoration.decoration.options.overviewRulerOptions.color = color;\n\t\t\t\t} else if (decoration.decoration.options) {\n\t\t\t\t\tdecoration.decoration.options.overviewRulerOptions = { color };\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._updateClasses(this._placeholderDecoration?.element);\n\t\tfor (const decoration of this._decorations.values()) {\n\t\t\tthis._updateClasses(decoration.decoration.element, decoration.exitCode, decoration.markProperties);\n\t\t}\n\t}\n\n\tprivate _dispose(): void {\n\t\tthis._terminalDecorationHoverService.dispose();\n\t\tfor (const disposable of this._capabilityDisposables.values()) {\n\t\t\tdispose(disposable);\n\t\t}\n\t\tthis.clearDecorations();\n\t}\n\n\tprivate _clearPlaceholder(): void {\n\t\tthis._placeholderDecoration?.dispose();\n\t\tthis._placeholderDecoration = undefined;\n\t}\n\n\tpublic clearDecorations(): void {\n\t\tthis._placeholderDecoration?.marker.dispose();\n\t\tthis._clearPlaceholder();\n\t\tthis._disposeAllDecorations();\n\t\tthis._decorations.clear();\n\t}\n\n\tprivate _attachToCommandCapability(): void {\n\t\tif (this._capabilities.has(TerminalCapability.CommandDetection)) {\n\t\t\tthis._getCommandDetectionListeners(this._capabilities.get(TerminalCapability.CommandDetection)!);\n\t\t}\n\t}\n\n\tprivate _getCommandDetectionListeners(capability: ICommandDetectionCapability): IDisposable[] {\n\t\tif (this._capabilityDisposables.has(TerminalCapability.CommandDetection)) {\n\t\t\tconst disposables = this._capabilityDisposables.get(TerminalCapability.CommandDetection)!;\n\t\t\tdispose(disposables);\n\t\t\tthis._capabilityDisposables.delete(capability.type);\n\t\t}\n\t\tconst commandDetectionListeners = [];\n\t\t// Command started\n\t\tif (capability.executingCommandObject?.marker) {\n\t\t\tthis.registerCommandDecoration(capability.executingCommandObject, true);\n\t\t}\n\t\tcommandDetectionListeners.push(capability.onCommandStarted(command => this.registerCommandDecoration(command, true)));\n\t\t// Command finished\n\t\tfor (const command of capability.commands) {\n\t\t\tthis.registerCommandDecoration(command);\n\t\t}\n\t\tcommandDetectionListeners.push(capability.onCommandFinished(command => {\n\t\t\tthis.registerCommandDecoration(command);\n\t\t\tif (command.exitCode) {\n\t\t\t\tthis._audioCueService.playAudioCue(AudioCue.terminalCommandFailed);\n\t\t\t}\n\t\t}));\n\t\t// Command invalidated\n\t\tcommandDetectionListeners.push(capability.onCommandInvalidated(commands => {\n\t\t\tfor (const command of commands) {\n\t\t\t\tconst id = command.marker?.id;\n\t\t\t\tif (id) {\n\t\t\t\t\tconst match = this._decorations.get(id);\n\t\t\t\t\tif (match) {\n\t\t\t\t\t\tmatch.decoration.dispose();\n\t\t\t\t\t\tdispose(match.disposables);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\t// Current command invalidated\n\t\tcommandDetectionListeners.push(capability.onCurrentCommandInvalidated((request) => {\n\t\t\tif (request.reason === CommandInvalidationReason.NoProblemsReported) {\n\t\t\t\tconst lastDecoration = Array.from(this._decorations.entries())[this._decorations.size - 1];\n\t\t\t\tlastDecoration?.[1].decoration.dispose();\n\t\t\t} else if (request.reason === CommandInvalidationReason.Windows) {\n\t\t\t\tthis._clearPlaceholder();\n\t\t\t}\n\t\t}));\n\t\treturn commandDetectionListeners;\n\t}\n\n\tactivate(terminal: Terminal): void {\n\t\tthis._terminal = terminal;\n\t\tthis._attachToCommandCapability();\n\t}\n\n\tregisterCommandDecoration(command?: ITerminalCommand, beforeCommandExecution?: boolean, markProperties?: IMarkProperties): IDecoration | undefined {\n\t\tif (!this._terminal || (beforeCommandExecution && !command) || (!this._showGutterDecorations && !this._showOverviewRulerDecorations)) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst marker = command?.marker || markProperties?.marker;\n\t\tif (!marker) {\n\t\t\tthrow new Error(`cannot add a decoration for a command ${JSON.stringify(command)} with no marker`);\n\t\t}\n\t\tthis._clearPlaceholder();\n\t\tconst color = this._getDecorationCssColor(command)?.toString() ?? '';\n\t\tconst decoration = this._terminal.registerDecoration({\n\t\t\tmarker,\n\t\t\toverviewRulerOptions: this._showOverviewRulerDecorations ? (beforeCommandExecution\n\t\t\t\t? { color, position: 'left' }\n\t\t\t\t: { color, position: command?.exitCode ? 'right' : 'left' }) : undefined\n\t\t});\n\t\tif (!decoration) {\n\t\t\treturn undefined;\n\t\t}\n\t\tif (beforeCommandExecution) {\n\t\t\tthis._placeholderDecoration = decoration;\n\t\t}\n\t\tdecoration.onRender(element => {\n\t\t\tif (element.classList.contains(DecorationSelector.OverviewRuler)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this._decorations.get(decoration.marker.id)) {\n\t\t\t\tdecoration.onDispose(() => this._decorations.delete(decoration.marker.id));\n\t\t\t\tthis._decorations.set(decoration.marker.id,\n\t\t\t\t\t{\n\t\t\t\t\t\tdecoration,\n\t\t\t\t\t\tdisposables: this._createDisposables(element, command, markProperties),\n\t\t\t\t\t\texitCode: command?.exitCode,\n\t\t\t\t\t\tmarkProperties: command?.markProperties\n\t\t\t\t\t});\n\t\t\t}\n\t\t\tif (!element.classList.contains(DecorationSelector.Codicon) || command?.marker?.line === 0) {\n\t\t\t\t// first render or buffer was cleared\n\t\t\t\tupdateLayout(this._configurationService, element);\n\t\t\t\tthis._updateClasses(element, command?.exitCode, command?.markProperties || markProperties);\n\t\t\t}\n\t\t});\n\t\treturn decoration;\n\t}\n\n\tprivate _createDisposables(element: HTMLElement, command?: ITerminalCommand, markProperties?: IMarkProperties): IDisposable[] {\n\t\tif (command?.exitCode === undefined && !command?.markProperties) {\n\t\t\treturn [];\n\t\t} else if (command?.markProperties || markProperties) {\n\t\t\treturn [this._terminalDecorationHoverService.createHover(element, command || markProperties, markProperties?.hoverMessage)];\n\t\t}\n\t\treturn [this._createContextMenu(element, command), this._terminalDecorationHoverService.createHover(element, command)];\n\t}\n\n\tprivate _updateClasses(element?: HTMLElement, exitCode?: number, markProperties?: IMarkProperties): void {\n\t\tif (!element) {\n\t\t\treturn;\n\t\t}\n\t\tfor (const classes of element.classList) {\n\t\t\telement.classList.remove(classes);\n\t\t}\n\t\telement.classList.add(DecorationSelector.CommandDecoration, DecorationSelector.Codicon, DecorationSelector.XtermDecoration);\n\n\t\tif (markProperties) {\n\t\t\telement.classList.add(DecorationSelector.DefaultColor, ...ThemeIcon.asClassNameArray(terminalDecorationMark));\n\t\t\tif (!markProperties.hoverMessage) {\n\t\t\t\t//disable the mouse pointer\n\t\t\t\telement.classList.add(DecorationSelector.Default);\n\t\t\t}\n\t\t} else {\n\t\t\t// command decoration\n\t\t\tthis._updateCommandDecorationVisibility(element);\n\t\t\tif (exitCode === undefined) {\n\t\t\t\telement.classList.add(DecorationSelector.DefaultColor, DecorationSelector.Default);\n\t\t\t\telement.classList.add(...ThemeIcon.asClassNameArray(terminalDecorationIncomplete));\n\t\t\t} else if (exitCode) {\n\t\t\t\telement.classList.add(DecorationSelector.ErrorColor);\n\t\t\t\telement.classList.add(...ThemeIcon.asClassNameArray(terminalDecorationError));\n\t\t\t} else {\n\t\t\t\telement.classList.add(...ThemeIcon.asClassNameArray(terminalDecorationSuccess));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _createContextMenu(element: HTMLElement, command: ITerminalCommand): IDisposable {\n\t\t// When the xterm Decoration gets disposed of, its element gets removed from the dom\n\t\t// along with its listeners\n\t\treturn dom.addDisposableListener(element, dom.EventType.CLICK, async () => {\n\t\t\tthis._terminalDecorationHoverService.hideHover();\n\t\t\tconst actions = await this._getCommandActions(command);\n\t\t\tthis._contextMenuService.showContextMenu({ getAnchor: () => element, getActions: () => actions });\n\t\t});\n\t}\n\n\tprivate async _getCommandActions(command: ITerminalCommand): Promise<IAction[]> {\n\t\tconst actions: IAction[] = [];\n\t\tif (command.command !== '') {\n\t\t\tconst labelRun = localize(\"terminal.rerunCommand\", 'Rerun Command');\n\t\t\tactions.push({\n\t\t\t\tclass: undefined, tooltip: labelRun, id: 'terminal.rerunCommand', label: labelRun, enabled: true,\n\t\t\t\trun: async () => {\n\t\t\t\t\tif (command.command === '') {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (!command.isTrusted) {\n\t\t\t\t\t\tconst shouldRun = await new Promise<boolean>(r => {\n\t\t\t\t\t\t\tthis._notificationService.prompt(Severity.Info, localize('rerun', 'Do you want to run the command: {0}', command.command), [{\n\t\t\t\t\t\t\t\tlabel: localize('yes', 'Yes'),\n\t\t\t\t\t\t\t\trun: () => r(true)\n\t\t\t\t\t\t\t}, {\n\t\t\t\t\t\t\t\tlabel: localize('no', 'No'),\n\t\t\t\t\t\t\t\trun: () => r(false)\n\t\t\t\t\t\t\t}]);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (!shouldRun) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis._onDidRequestRunCommand.fire({ command });\n\t\t\t\t}\n\t\t\t});\n\t\t\t// The second section is the clipboard section\n\t\t\tactions.push(new Separator());\n\t\t\tconst labelCopy = localize(\"terminal.copyCommand\", 'Copy Command');\n\t\t\tactions.push({\n\t\t\t\tclass: undefined, tooltip: labelCopy, id: 'terminal.copyCommand', label: labelCopy, enabled: true,\n\t\t\t\trun: () => this._clipboardService.writeText(command.command)\n\t\t\t});\n\t\t}\n\t\tif (command.hasOutput()) {\n\t\t\tconst labelCopyCommandAndOutput = localize(\"terminal.copyCommandAndOutput\", 'Copy Command and Output');\n\t\t\tactions.push({\n\t\t\t\tclass: undefined, tooltip: labelCopyCommandAndOutput, id: 'terminal.copyCommandAndOutput', label: labelCopyCommandAndOutput, enabled: true,\n\t\t\t\trun: () => {\n\t\t\t\t\tconst output = command.getOutput();\n\t\t\t\t\tif (typeof output === 'string') {\n\t\t\t\t\t\tthis._clipboardService.writeText(`${command.command !== '' ? command.command + '\\n' : ''}${output}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst labelText = localize(\"terminal.copyOutput\", 'Copy Output');\n\t\t\tactions.push({\n\t\t\t\tclass: undefined, tooltip: labelText, id: 'terminal.copyOutput', label: labelText, enabled: true,\n\t\t\t\trun: () => {\n\t\t\t\t\tconst text = command.getOutput();\n\t\t\t\t\tif (typeof text === 'string') {\n\t\t\t\t\t\tthis._clipboardService.writeText(text);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst labelHtml = localize(\"terminal.copyOutputAsHtml\", 'Copy Output as HTML');\n\t\t\tactions.push({\n\t\t\t\tclass: undefined, tooltip: labelHtml, id: 'terminal.copyOutputAsHtml', label: labelHtml, enabled: true,\n\t\t\t\trun: () => this._onDidRequestRunCommand.fire({ command, copyAsHtml: true })\n\t\t\t});\n\t\t}\n\t\tif (actions.length > 0) {\n\t\t\tactions.push(new Separator());\n\t\t}\n\t\tconst labelRunRecent = localize('workbench.action.terminal.runRecentCommand', \"Run Recent Command\");\n\t\tactions.push({\n\t\t\tclass: undefined, tooltip: labelRunRecent, id: 'workbench.action.terminal.runRecentCommand', label: labelRunRecent, enabled: true,\n\t\t\trun: () => this._commandService.executeCommand('workbench.action.terminal.runRecentCommand')\n\t\t});\n\t\tconst labelGoToRecent = localize('workbench.action.terminal.goToRecentDirectory', \"Go To Recent Directory\");\n\t\tactions.push({\n\t\t\tclass: undefined, tooltip: labelRunRecent, id: 'workbench.action.terminal.goToRecentDirectory', label: labelGoToRecent, enabled: true,\n\t\t\trun: () => this._commandService.executeCommand('workbench.action.terminal.goToRecentDirectory')\n\t\t});\n\n\t\tactions.push(new Separator());\n\n\t\tconst labelConfigure = localize(\"terminal.configureCommandDecorations\", 'Configure Command Decorations');\n\t\tactions.push({\n\t\t\tclass: undefined, tooltip: labelConfigure, id: 'terminal.configureCommandDecorations', label: labelConfigure, enabled: true,\n\t\t\trun: () => this._showConfigureCommandDecorationsQuickPick()\n\t\t});\n\t\tconst labelAbout = localize(\"terminal.learnShellIntegration\", 'Learn About Shell Integration');\n\t\tactions.push({\n\t\t\tclass: undefined, tooltip: labelAbout, id: 'terminal.learnShellIntegration', label: labelAbout, enabled: true,\n\t\t\trun: () => this._openerService.open('https://code.visualstudio.com/docs/terminal/shell-integration')\n\t\t});\n\t\treturn actions;\n\t}\n\n\tprivate async _showConfigureCommandDecorationsQuickPick() {\n\t\tconst quickPick = this._quickInputService.createQuickPick();\n\t\tquickPick.items = [\n\t\t\t{ id: 'a', label: localize('toggleVisibility', 'Toggle visibility') },\n\t\t];\n\t\tquickPick.canSelectMany = false;\n\t\tquickPick.onDidAccept(async e => {\n\t\t\tquickPick.hide();\n\t\t\tconst result = quickPick.activeItems[0];\n\t\t\tswitch (result.id) {\n\t\t\t\tcase 'a': this._showToggleVisibilityQuickPick(); break;\n\t\t\t}\n\t\t});\n\t\tquickPick.show();\n\t}\n\n\tprivate _showToggleVisibilityQuickPick() {\n\t\tconst quickPick = this._quickInputService.createQuickPick();\n\t\tquickPick.hideInput = true;\n\t\tquickPick.hideCheckAll = true;\n\t\tquickPick.canSelectMany = true;\n\t\tquickPick.title = localize('toggleVisibility', 'Toggle visibility');\n\t\tconst configValue = this._configurationService.getValue(TerminalSettingId.ShellIntegrationDecorationsEnabled);\n\t\tconst gutterIcon: IQuickPickItem = {\n\t\t\tlabel: localize('gutter', 'Gutter command decorations'),\n\t\t\tpicked: configValue !== 'never' && configValue !== 'overviewRuler'\n\t\t};\n\t\tconst overviewRulerIcon: IQuickPickItem = {\n\t\t\tlabel: localize('overviewRuler', 'Overview ruler command decorations'),\n\t\t\tpicked: configValue !== 'never' && configValue !== 'gutter'\n\t\t};\n\t\tquickPick.items = [gutterIcon, overviewRulerIcon];\n\t\tconst selectedItems: IQuickPickItem[] = [];\n\t\tif (configValue !== 'never') {\n\t\t\tif (configValue !== 'gutter') {\n\t\t\t\tselectedItems.push(gutterIcon);\n\t\t\t}\n\t\t\tif (configValue !== 'overviewRuler') {\n\t\t\t\tselectedItems.push(overviewRulerIcon);\n\t\t\t}\n\t\t}\n\t\tquickPick.selectedItems = selectedItems;\n\t\tquickPick.onDidChangeSelection(async e => {\n\t\t\tlet newValue: 'both' | 'gutter' | 'overviewRuler' | 'never' = 'never';\n\t\t\tif (e.includes(gutterIcon)) {\n\t\t\t\tif (e.includes(overviewRulerIcon)) {\n\t\t\t\t\tnewValue = 'both';\n\t\t\t\t} else {\n\t\t\t\t\tnewValue = 'gutter';\n\t\t\t\t}\n\t\t\t} else if (e.includes(overviewRulerIcon)) {\n\t\t\t\tnewValue = 'overviewRuler';\n\t\t\t}\n\t\t\tawait this._configurationService.updateValue(TerminalSettingId.ShellIntegrationDecorationsEnabled, newValue);\n\t\t});\n\t\tquickPick.ok = false;\n\t\tquickPick.show();\n\t}\n\n\tprivate _getDecorationCssColor(decorationOrCommand?: IDisposableDecoration | ITerminalCommand): string | undefined {\n\t\tlet colorId: string;\n\t\tif (decorationOrCommand?.exitCode === undefined) {\n\t\t\tcolorId = TERMINAL_COMMAND_DECORATION_DEFAULT_BACKGROUND_COLOR;\n\t\t} else {\n\t\t\tcolorId = decorationOrCommand.exitCode ? TERMINAL_COMMAND_DECORATION_ERROR_BACKGROUND_COLOR : TERMINAL_COMMAND_DECORATION_SUCCESS_BACKGROUND_COLOR;\n\t\t}\n\t\treturn this._themeService.getColorTheme().getColor(colorId)?.toString();\n\t}\n}\n"]}