{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/terminal/browser/xterm/suggestAddon.ts"],"names":[],"mappings":"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","file":"suggestAddon.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\nimport { SimpleCompletionItem } from 'vs/workbench/services/suggest/browser/simpleCompletionItem';\nimport { LineContext, SimpleCompletionModel } from 'vs/workbench/services/suggest/browser/simpleCompletionModel';\nimport { ISimpleSelectedSuggestion, SimpleSuggestWidget } from 'vs/workbench/services/suggest/browser/simpleSuggestWidget';\nimport { timeout } from 'vs/base/common/async';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { editorSuggestWidgetSelectedBackground } from 'vs/editor/contrib/suggest/browser/suggestWidget';\nimport { IContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { activeContrastBorder } from 'vs/platform/theme/common/colorRegistry';\nimport { ISuggestController } from 'vs/workbench/contrib/terminal/browser/terminal';\nimport { TerminalStorageKeys } from 'vs/workbench/contrib/terminal/common/terminalStorageKeys';\nimport type { ITerminalAddon, Terminal } from 'xterm';\nimport { getListStyles } from 'vs/platform/theme/browser/defaultStyles';\n\nconst enum ShellIntegrationOscPs {\n\t// TODO: Pull from elsewhere\n\tVSCode = 633\n}\n\nconst enum VSCodeOscPt {\n\tCompletions = 'Completions',\n\tCompletionsBash = 'CompletionsBash',\n\tCompletionsBashFirstWord = 'CompletionsBashFirstWord'\n}\n\n/**\n * A map of the pwsh result type enum's value to the corresponding icon to use in completions.\n *\n * | Value | Name              | Description\n * |-------|-------------------|------------\n * | 0     | Text              | An unknown result type, kept as text only\n * | 1     | History           | A history result type like the items out of get-history\n * | 2     | Command           | A command result type like the items out of get-command\n * | 3     | ProviderItem      | A provider item\n * | 4     | ProviderContainer | A provider container\n * | 5     | Property          | A property result type like the property items out of get-member\n * | 6     | Method            | A method result type like the method items out of get-member\n * | 7     | ParameterName     | A parameter name result type like the Parameters property out of get-command items\n * | 8     | ParameterValue    | A parameter value result type\n * | 9     | Variable          | A variable result type like the items out of get-childitem variable:\n * | 10    | Namespace         | A namespace\n * | 11    | Type              | A type name\n * | 12    | Keyword           | A keyword\n * | 13    | DynamicKeyword    | A dynamic keyword\n *\n * @see https://docs.microsoft.com/en-us/dotnet/api/system.management.automation.completionresulttype?view=powershellsdk-7.0.0\n */\nconst pwshTypeToIconMap: { [type: string]: ThemeIcon | undefined } = {\n\t0: Codicon.symbolText,\n\t1: Codicon.history,\n\t2: Codicon.symbolMethod,\n\t3: Codicon.symbolFile,\n\t4: Codicon.folder,\n\t5: Codicon.symbolProperty,\n\t6: Codicon.symbolMethod,\n\t7: Codicon.symbolVariable,\n\t8: Codicon.symbolValue,\n\t9: Codicon.symbolVariable,\n\t10: Codicon.symbolNamespace,\n\t11: Codicon.symbolInterface,\n\t12: Codicon.symbolKeyword,\n\t13: Codicon.symbolKeyword\n};\n\nexport class SuggestAddon extends Disposable implements ITerminalAddon, ISuggestController {\n\tprivate _terminal?: Terminal;\n\tprivate _container?: HTMLElement;\n\tprivate _suggestWidget?: SimpleSuggestWidget;\n\tprivate _enableWidget: boolean = true;\n\tprivate _leadingLineContent?: string;\n\tprivate _additionalInput?: string;\n\tprivate _cursorIndexStart: number = 0;\n\tprivate _cursorIndexDelta: number = 0;\n\tprivate _inputQueue?: string[];\n\n\tprivate readonly _onBell = this._register(new Emitter<void>());\n\treadonly onBell = this._onBell.event;\n\tprivate readonly _onAcceptedCompletion = this._register(new Emitter<string>());\n\treadonly onAcceptedCompletion = this._onAcceptedCompletion.event;\n\n\tconstructor(\n\t\tprivate readonly _terminalSuggestWidgetVisibleContextKey: IContextKey<boolean>,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t}\n\n\tactivate(xterm: Terminal): void {\n\t\tthis._terminal = xterm;\n\t\tthis._register(xterm.parser.registerOscHandler(ShellIntegrationOscPs.VSCode, data => {\n\t\t\treturn this._handleVSCodeSequence(data);\n\t\t}));\n\t\tthis._register(xterm.onData(e => {\n\t\t\tthis._handleTerminalInput(e);\n\t\t}));\n\t}\n\n\tsetContainer(container: HTMLElement): void {\n\t\tthis._container = container;\n\t}\n\n\tprivate _handleVSCodeSequence(data: string): boolean {\n\t\tif (!this._terminal) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Pass the sequence along to the capability\n\t\tconst [command, ...args] = data.split(';');\n\t\tswitch (command) {\n\t\t\tcase VSCodeOscPt.Completions:\n\t\t\t\tthis._handleCompletionsSequence(this._terminal, data, command, args);\n\t\t\t\treturn true;\n\t\t\tcase VSCodeOscPt.CompletionsBash:\n\t\t\t\tthis._handleCompletionsBashSequence(this._terminal, data, command, args);\n\t\t\t\treturn true;\n\t\t\tcase VSCodeOscPt.CompletionsBashFirstWord:\n\t\t\t\treturn this._handleCompletionsBashFirstWordSequence(this._terminal, data, command, args);\n\t\t}\n\n\t\t// Unrecognized sequence\n\t\treturn false;\n\t}\n\n\tprivate _handleCompletionsSequence(terminal: Terminal, data: string, command: string, args: string[]): void {\n\t\t// Nothing to handle if the terminal is not attached\n\t\tif (!terminal.element || !this._enableWidget) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst replacementIndex = parseInt(args[0]);\n\t\tconst replacementLength = parseInt(args[1]);\n\t\tthis._cursorIndexStart = parseInt(args[2]);\n\t\tif (!args[3]) {\n\t\t\tthis._onBell.fire();\n\t\t\treturn;\n\t\t}\n\n\t\tlet completionList: IPwshCompletion[] | IPwshCompletion = JSON.parse(data.slice(command.length + args[0].length + args[1].length + args[2].length + 4/*semi-colons*/));\n\t\tif (!Array.isArray(completionList)) {\n\t\t\tcompletionList = [completionList];\n\t\t}\n\t\tconst completions = completionList.map((e: any) => {\n\t\t\treturn new SimpleCompletionItem({\n\t\t\t\tlabel: e.CompletionText,\n\t\t\t\ticon: pwshTypeToIconMap[e.ResultType],\n\t\t\t\tdetail: e.ToolTip\n\t\t\t});\n\t\t});\n\n\t\tthis._leadingLineContent = completions[0].completion.label.slice(0, replacementLength);\n\t\tthis._cursorIndexDelta = 0;\n\t\tconst model = new SimpleCompletionModel(completions, new LineContext(this._leadingLineContent, replacementIndex), replacementIndex, replacementLength);\n\t\tif (completions.length === 1) {\n\t\t\tconst insertText = completions[0].completion.label.substring(replacementLength);\n\t\t\tif (insertText.length === 0) {\n\t\t\t\tthis._onBell.fire();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis._handleCompletionModel(model);\n\t}\n\n\t// TODO: These aren't persisted across reloads\n\t// TODO: Allow triggering anywhere in the first word based on the cached completions\n\tprivate _cachedBashAliases: Set<SimpleCompletionItem> = new Set();\n\tprivate _cachedBashBuiltins: Set<SimpleCompletionItem> = new Set();\n\tprivate _cachedBashCommands: Set<SimpleCompletionItem> = new Set();\n\tprivate _cachedBashKeywords: Set<SimpleCompletionItem> = new Set();\n\tprivate _cachedFirstWord?: SimpleCompletionItem[];\n\tprivate _handleCompletionsBashFirstWordSequence(terminal: Terminal, data: string, command: string, args: string[]): boolean {\n\t\tconst type = args[0];\n\t\tconst completionList: string[] = data.slice(command.length + type.length + 2/*semi-colons*/).split(';');\n\t\tlet set: Set<SimpleCompletionItem>;\n\t\tswitch (type) {\n\t\t\tcase 'alias': set = this._cachedBashAliases; break;\n\t\t\tcase 'builtin': set = this._cachedBashBuiltins; break;\n\t\t\tcase 'command': set = this._cachedBashCommands; break;\n\t\t\tcase 'keyword': set = this._cachedBashKeywords; break;\n\t\t\tdefault: return false;\n\t\t}\n\t\tset.clear();\n\t\tconst distinctLabels: Set<string> = new Set();\n\t\tfor (const label of completionList) {\n\t\t\tdistinctLabels.add(label);\n\t\t}\n\t\tfor (const label of distinctLabels) {\n\t\t\tset.add(new SimpleCompletionItem({\n\t\t\t\tlabel,\n\t\t\t\ticon: Codicon.symbolString,\n\t\t\t\tdetail: type\n\t\t\t}));\n\t\t}\n\t\t// Invalidate compound list cache\n\t\tthis._cachedFirstWord = undefined;\n\t\treturn true;\n\t}\n\n\tprivate _handleCompletionsBashSequence(terminal: Terminal, data: string, command: string, args: string[]): void {\n\t\t// Nothing to handle if the terminal is not attached\n\t\tif (!terminal.element) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet replacementIndex = parseInt(args[0]);\n\t\tconst replacementLength = parseInt(args[1]);\n\t\tif (!args[2]) {\n\t\t\tthis._onBell.fire();\n\t\t\treturn;\n\t\t}\n\n\t\tconst completionList: string[] = data.slice(command.length + args[0].length + args[1].length + args[2].length + 4/*semi-colons*/).split(';');\n\t\t// TODO: Create a trigger suggest command which encapsulates sendSequence and uses cached if available\n\t\tlet completions: SimpleCompletionItem[];\n\t\t// TODO: This 100 is a hack just for the prototype, this should get it based on some terminal input model\n\t\tif (replacementIndex !== 100 && completionList.length > 0) {\n\t\t\tcompletions = completionList.map(label => {\n\t\t\t\treturn new SimpleCompletionItem({\n\t\t\t\t\tlabel: label,\n\t\t\t\t\ticon: Codicon.symbolProperty\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treplacementIndex = 0;\n\t\t\tif (!this._cachedFirstWord) {\n\t\t\t\tthis._cachedFirstWord = [\n\t\t\t\t\t...this._cachedBashAliases,\n\t\t\t\t\t...this._cachedBashBuiltins,\n\t\t\t\t\t...this._cachedBashCommands,\n\t\t\t\t\t...this._cachedBashKeywords\n\t\t\t\t];\n\t\t\t\tthis._cachedFirstWord.sort((a, b) => {\n\t\t\t\t\tconst aCode = a.completion.label.charCodeAt(0);\n\t\t\t\t\tconst bCode = b.completion.label.charCodeAt(0);\n\t\t\t\t\tconst isANonAlpha = aCode < 65 || aCode > 90 && aCode < 97 || aCode > 122 ? 1 : 0;\n\t\t\t\t\tconst isBNonAlpha = bCode < 65 || bCode > 90 && bCode < 97 || bCode > 122 ? 1 : 0;\n\t\t\t\t\tif (isANonAlpha !== isBNonAlpha) {\n\t\t\t\t\t\treturn isANonAlpha - isBNonAlpha;\n\t\t\t\t\t}\n\t\t\t\t\treturn a.completion.label.localeCompare(b.completion.label);\n\t\t\t\t});\n\t\t\t}\n\t\t\tcompletions = this._cachedFirstWord;\n\t\t}\n\t\tif (completions.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._leadingLineContent = completions[0].completion.label.slice(0, replacementLength);\n\t\tconst model = new SimpleCompletionModel(completions, new LineContext(this._leadingLineContent, replacementIndex), replacementIndex, replacementLength);\n\t\tif (completions.length === 1) {\n\t\t\tconst insertText = completions[0].completion.label.substring(replacementLength);\n\t\t\tif (insertText.length === 0) {\n\t\t\t\tthis._onBell.fire();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthis._handleCompletionModel(model);\n\t}\n\n\tprivate _handleCompletionModel(model: SimpleCompletionModel): void {\n\t\tif (model.items.length === 0 || !this._terminal?.element) {\n\t\t\treturn;\n\t\t}\n\t\tif (model.items.length === 1) {\n\t\t\tthis.acceptSelectedSuggestion({\n\t\t\t\titem: model.items[0],\n\t\t\t\tmodel: model\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tconst suggestWidget = this._ensureSuggestWidget(this._terminal);\n\t\tthis._additionalInput = undefined;\n\t\tconst dimensions = {\n\t\t\twidth: (this._terminal as any)._core._renderService.dimensions.device.cell.width,\n\t\t\theight: (this._terminal as any)._core._renderService.dimensions.device.cell.height,\n\t\t};\n\t\tif (!dimensions.width || !dimensions.height) {\n\t\t\treturn;\n\t\t}\n\t\t// TODO: What do frozen and auto do?\n\t\tconst xtermBox = this._terminal.element.getBoundingClientRect();\n\t\t// TODO: Layer breaker, unsafe and won't work for terminal editors\n\t\tconst panelElement = dom.findParentWithClass(this._container!, 'panel')!.offsetParent as HTMLElement;\n\t\tconst panelBox = panelElement.getBoundingClientRect();\n\t\tsuggestWidget.showSuggestions(model, 0, false, false, {\n\t\t\tleft: (xtermBox.left - panelBox.left) + this._terminal.buffer.active.cursorX * dimensions.width,\n\t\t\ttop: (xtermBox.top - panelBox.top) + this._terminal.buffer.active.cursorY * dimensions.height,\n\t\t\theight: dimensions.height\n\t\t});\n\n\t\t// Flush the input queue if any characters were typed after a trigger character\n\t\tif (this._inputQueue) {\n\t\t\tconst inputQueue = this._inputQueue;\n\t\t\tthis._inputQueue = undefined;\n\t\t\tfor (const data of inputQueue) {\n\t\t\t\tthis._handleTerminalInput(data);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _ensureSuggestWidget(terminal: Terminal): SimpleSuggestWidget {\n\t\tthis._terminalSuggestWidgetVisibleContextKey.set(true);\n\t\tif (!this._suggestWidget) {\n\t\t\tthis._suggestWidget = this._register(this._instantiationService.createInstance(\n\t\t\t\tSimpleSuggestWidget,\n\t\t\t\tdom.findParentWithClass(this._container!, 'panel')!,\n\t\t\t\tthis._instantiationService.createInstance(PersistedWidgetSize),\n\t\t\t\t{}\n\t\t\t));\n\t\t\tthis._suggestWidget.list.style(getListStyles({\n\t\t\t\tlistInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n\t\t\t\tlistInactiveFocusOutline: activeContrastBorder\n\t\t\t}));\n\t\t\tthis._suggestWidget.onDidSelect(async e => this.acceptSelectedSuggestion(e));\n\t\t\tthis._suggestWidget.onDidHide(() => this._terminalSuggestWidgetVisibleContextKey.set(false));\n\t\t\tthis._suggestWidget.onDidShow(() => this._terminalSuggestWidgetVisibleContextKey.set(true));\n\t\t}\n\t\treturn this._suggestWidget;\n\t}\n\n\tselectPreviousSuggestion(): void {\n\t\tthis._suggestWidget?.selectPrevious();\n\t}\n\n\tselectPreviousPageSuggestion(): void {\n\t\tthis._suggestWidget?.selectPreviousPage();\n\t}\n\n\tselectNextSuggestion(): void {\n\t\tthis._suggestWidget?.selectNext();\n\t}\n\n\tselectNextPageSuggestion(): void {\n\t\tthis._suggestWidget?.selectNextPage();\n\t}\n\n\tacceptSelectedSuggestion(suggestion?: Pick<ISimpleSelectedSuggestion, 'item' | 'model'>): void {\n\t\tif (!suggestion) {\n\t\t\tsuggestion = this._suggestWidget?.getFocusedItem();\n\t\t}\n\t\tif (suggestion && this._leadingLineContent) {\n\t\t\tthis._suggestWidget?.hide();\n\n\t\t\t// Send the completion\n\t\t\tthis._onAcceptedCompletion.fire([\n\t\t\t\t// TODO: Right arrow to end of the replacement\n\t\t\t\t// Left arrow to end of the replacement\n\t\t\t\t'\\x1b[D'.repeat(Math.max(suggestion.model.replacementLength - this._cursorIndexStart + this._cursorIndexDelta, 0)),\n\t\t\t\t// Delete to remove additional input\n\t\t\t\t'\\x1b[3~'.repeat(this._additionalInput?.length ?? 0),\n\t\t\t\t// Backspace to remove the replacement\n\t\t\t\t'\\x7F'.repeat(suggestion.model.replacementLength),\n\t\t\t\t// Write the completion\n\t\t\t\tsuggestion.item.completion.label,\n\t\t\t].join(''));\n\n\t\t\t// Disable completions triggering the widget temporarily to avoid completion requests\n\t\t\t// caused by the completion itself to show.\n\t\t\tthis._enableWidget = false;\n\t\t\t// TODO: Disable the widget in a more sophisticated way\n\t\t\ttimeout(100).then(e => this._enableWidget = true);\n\t\t}\n\t}\n\n\thideSuggestWidget(): void {\n\t\tthis._suggestWidget?.hide();\n\t}\n\n\thandleNonXtermData(data: string): void {\n\t\tthis._handleTerminalInput(data);\n\t}\n\n\tprivate _handleTerminalInput(data: string): void {\n\t\tif (!this._terminal || !this._enableWidget || !this._terminalSuggestWidgetVisibleContextKey.get()) {\n\t\t\t// HACK: Buffer any input to be evaluated when the completions come in, this is needed\n\t\t\t// because conpty may \"render\" the completion request after input characters that\n\t\t\t// actually come after it. This can happen when typing quickly after a trigger\n\t\t\t// character, especially on a freshly launched session.\n\t\t\tif (data === '-') {\n\t\t\t\tthis._inputQueue = [];\n\t\t\t} else {\n\t\t\t\tthis._inputQueue?.push(data);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tlet handled = false;\n\n\t\t// Backspace\n\t\tif (data === '\\x7f') {\n\t\t\tif (this._additionalInput && this._additionalInput.length > 0 && this._cursorIndexDelta > 0) {\n\t\t\t\thandled = true;\n\t\t\t\tthis._additionalInput = this._additionalInput.substring(0, this._cursorIndexDelta-- - 1) + this._additionalInput.substring(this._cursorIndexDelta);\n\t\t\t}\n\t\t}\n\t\t// Delete\n\t\tif (data === '\\x1b[3~') {\n\t\t\tif (this._additionalInput && this._additionalInput.length > 0 && this._cursorIndexDelta < this._additionalInput.length - 1) {\n\t\t\t\thandled = true;\n\t\t\t\tthis._additionalInput = this._additionalInput.substring(0, this._cursorIndexDelta) + this._additionalInput.substring(this._cursorIndexDelta + 1);\n\t\t\t}\n\t\t}\n\t\t// Left\n\t\tif (data === '\\x1b[D') {\n\t\t\t// If left goes beyond where the completion was requested, hide\n\t\t\tif (this._cursorIndexDelta > 0) {\n\t\t\t\thandled = true;\n\t\t\t\tthis._cursorIndexDelta--;\n\t\t\t}\n\t\t}\n\t\t// Right\n\t\tif (data === '\\x1b[C') {\n\t\t\thandled = true;\n\t\t\tthis._cursorIndexDelta += 1;\n\t\t}\n\t\tif (data.match(/^[a-z0-9]$/i)) {\n\n\t\t\t// TODO: There is a race here where the completions may come through after new character presses because of conpty's rendering!\n\n\t\t\thandled = true;\n\t\t\tif (this._additionalInput === undefined) {\n\t\t\t\tthis._additionalInput = '';\n\t\t\t}\n\t\t\tthis._additionalInput += data;\n\t\t\tthis._cursorIndexDelta++;\n\t\t}\n\t\tif (handled) {\n\t\t\t// typed -> moved cursor RIGHT -> update UI\n\t\t\tif (this._terminalSuggestWidgetVisibleContextKey.get()) {\n\t\t\t\tthis._suggestWidget?.setLineContext(new LineContext(this._leadingLineContent! + (this._additionalInput ?? ''), this._additionalInput?.length ?? 0));\n\t\t\t}\n\n\t\t\t// Hide and clear model if there are no more items\n\t\t\tif ((this._suggestWidget as any)._completionModel?.items.length === 0) {\n\t\t\t\tthis._additionalInput = undefined;\n\t\t\t\tthis.hideSuggestWidget();\n\t\t\t\t// TODO: Don't request every time; refine completions\n\t\t\t\t// this._onAcceptedCompletion.fire('\\x1b[24~e');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// TODO: Share code\n\t\t\t// TODO: Expose on xterm.js\n\t\t\tconst dimensions = {\n\t\t\t\twidth: (this._terminal as any)._core._renderService.dimensions.device.cell.width,\n\t\t\t\theight: (this._terminal as any)._core._renderService.dimensions.device.cell.height,\n\t\t\t};\n\t\t\tif (!dimensions.width || !dimensions.height) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// TODO: What do frozen and auto do?\n\t\t\tconst xtermBox = this._terminal.element!.getBoundingClientRect();\n\t\t\t// TODO: Layer breaker, unsafe and won't work for terminal editors\n\t\t\tconst panelElement = dom.findParentWithClass(this._container!, 'panel')!.offsetParent as HTMLElement;\n\t\t\tconst panelBox = panelElement.getBoundingClientRect();\n\t\t\tthis._suggestWidget?.showSuggestions((this._suggestWidget as any)._completionModel, 0, false, false, {\n\t\t\t\tleft: (xtermBox.left - panelBox.left) + this._terminal.buffer.active.cursorX * dimensions.width,\n\t\t\t\ttop: (xtermBox.top - panelBox.top) + this._terminal.buffer.active.cursorY * dimensions.height,\n\t\t\t\theight: dimensions.height\n\t\t\t});\n\t\t} else {\n\t\t\tthis._additionalInput = undefined;\n\t\t\tthis.hideSuggestWidget();\n\t\t\t// TODO: Don't request every time; refine completions\n\t\t\t// this._onAcceptedCompletion.fire('\\x1b[24~e');\n\t\t}\n\t}\n}\n\ninterface IPwshCompletion {\n\tCompletionText: string;\n\tListItemText: string;\n\tResultType: number;\n\tToolTip: string;\n}\n\nclass PersistedWidgetSize {\n\n\tprivate readonly _key = TerminalStorageKeys.TerminalSuggestSize;\n\n\tconstructor(\n\t\t@IStorageService private readonly _storageService: IStorageService\n\t) {\n\t}\n\n\trestore(): dom.Dimension | undefined {\n\t\tconst raw = this._storageService.get(this._key, StorageScope.PROFILE) ?? '';\n\t\ttry {\n\t\t\tconst obj = JSON.parse(raw);\n\t\t\tif (dom.Dimension.is(obj)) {\n\t\t\t\treturn dom.Dimension.lift(obj);\n\t\t\t}\n\t\t} catch {\n\t\t\t// ignore\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tstore(size: dom.Dimension) {\n\t\tthis._storageService.store(this._key, JSON.stringify(size), StorageScope.PROFILE, StorageTarget.MACHINE);\n\t}\n\n\treset(): void {\n\t\tthis._storageService.remove(this._key, StorageScope.PROFILE);\n\t}\n}\n"]}