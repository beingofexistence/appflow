{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/contrib/terminal/browser/terminalStatusList.ts"],"names":[],"mappings":"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","file":"terminalStatusList.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from 'vs/base/common/codicons';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport Severity from 'vs/base/common/severity';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { TerminalSettingId } from 'vs/platform/terminal/common/terminal';\nimport { listErrorForeground, listWarningForeground } from 'vs/platform/theme/common/colorRegistry';\nimport { spinningLoading } from 'vs/platform/theme/common/iconRegistry';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { ITerminalStatus } from 'vs/workbench/contrib/terminal/common/terminal';\n\n/**\n * The set of _internal_ terminal statuses, other components building on the terminal should put\n * their statuses within their component.\n */\nexport const enum TerminalStatus {\n\tBell = 'bell',\n\tDisconnected = 'disconnected',\n\tRelaunchNeeded = 'relaunch-needed',\n\tEnvironmentVariableInfoChangesActive = 'env-var-info-changes-active',\n\tShellIntegrationAttentionNeeded = 'shell-integration-attention-needed'\n}\n\nexport interface ITerminalStatusList {\n\t/** Gets the most recent, highest severity status. */\n\treadonly primary: ITerminalStatus | undefined;\n\t/** Gets all active statues. */\n\treadonly statuses: ITerminalStatus[];\n\n\treadonly onDidAddStatus: Event<ITerminalStatus>;\n\treadonly onDidRemoveStatus: Event<ITerminalStatus>;\n\treadonly onDidChangePrimaryStatus: Event<ITerminalStatus | undefined>;\n\n\t/**\n\t * Adds a status to the list.\n\t * @param status The status object. Ideally a single status object that does not change will be\n\t * shared as this call will no-op if the status is already set (checked by by object reference).\n\t * @param duration An optional duration in milliseconds of the status, when specified the status\n\t * will remove itself when the duration elapses unless the status gets re-added.\n\t */\n\tadd(status: ITerminalStatus, duration?: number): void;\n\tremove(status: ITerminalStatus): void;\n\tremove(statusId: string): void;\n\ttoggle(status: ITerminalStatus, value: boolean): void;\n}\n\nexport class TerminalStatusList extends Disposable implements ITerminalStatusList {\n\tprivate readonly _statuses: Map<string, ITerminalStatus> = new Map();\n\tprivate readonly _statusTimeouts: Map<string, number> = new Map();\n\n\tprivate readonly _onDidAddStatus = this._register(new Emitter<ITerminalStatus>());\n\tget onDidAddStatus(): Event<ITerminalStatus> { return this._onDidAddStatus.event; }\n\tprivate readonly _onDidRemoveStatus = this._register(new Emitter<ITerminalStatus>());\n\tget onDidRemoveStatus(): Event<ITerminalStatus> { return this._onDidRemoveStatus.event; }\n\tprivate readonly _onDidChangePrimaryStatus = this._register(new Emitter<ITerminalStatus | undefined>());\n\tget onDidChangePrimaryStatus(): Event<ITerminalStatus | undefined> { return this._onDidChangePrimaryStatus.event; }\n\n\tconstructor(\n\t\t@IConfigurationService private readonly _configurationService: IConfigurationService\n\t) {\n\t\tsuper();\n\t}\n\n\tget primary(): ITerminalStatus | undefined {\n\t\tlet result: ITerminalStatus | undefined;\n\t\tfor (const s of this._statuses.values()) {\n\t\t\tif (!result || s.severity >= result.severity) {\n\t\t\t\tresult = s;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tget statuses(): ITerminalStatus[] { return Array.from(this._statuses.values()); }\n\n\tadd(status: ITerminalStatus, duration?: number) {\n\t\tstatus = this._applyAnimationSetting(status);\n\t\tconst outTimeout = this._statusTimeouts.get(status.id);\n\t\tif (outTimeout) {\n\t\t\twindow.clearTimeout(outTimeout);\n\t\t\tthis._statusTimeouts.delete(status.id);\n\t\t}\n\t\tif (duration && duration > 0) {\n\t\t\tconst timeout = window.setTimeout(() => this.remove(status), duration);\n\t\t\tthis._statusTimeouts.set(status.id, timeout);\n\t\t}\n\t\tconst existingStatus = this._statuses.get(status.id);\n\t\tif (existingStatus && existingStatus !== status) {\n\t\t\tthis._onDidRemoveStatus.fire(existingStatus);\n\t\t\tthis._statuses.delete(existingStatus.id);\n\t\t}\n\t\tif (!this._statuses.has(status.id)) {\n\t\t\tconst oldPrimary = this.primary;\n\t\t\tthis._statuses.set(status.id, status);\n\t\t\tthis._onDidAddStatus.fire(status);\n\t\t\tconst newPrimary = this.primary;\n\t\t\tif (oldPrimary !== newPrimary) {\n\t\t\t\tthis._onDidChangePrimaryStatus.fire(newPrimary);\n\t\t\t}\n\t\t}\n\t}\n\n\tremove(status: ITerminalStatus): void;\n\tremove(statusId: string): void;\n\tremove(statusOrId: ITerminalStatus | string): void {\n\t\tconst status = typeof statusOrId === 'string' ? this._statuses.get(statusOrId) : statusOrId;\n\t\t// Verify the status is the same as the one passed in\n\t\tif (status && this._statuses.get(status.id)) {\n\t\t\tconst wasPrimary = this.primary?.id === status.id;\n\t\t\tthis._statuses.delete(status.id);\n\t\t\tthis._onDidRemoveStatus.fire(status);\n\t\t\tif (wasPrimary) {\n\t\t\t\tthis._onDidChangePrimaryStatus.fire(this.primary);\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggle(status: ITerminalStatus, value: boolean) {\n\t\tif (value) {\n\t\t\tthis.add(status);\n\t\t} else {\n\t\t\tthis.remove(status);\n\t\t}\n\t}\n\n\tprivate _applyAnimationSetting(status: ITerminalStatus): ITerminalStatus {\n\t\tif (!status.icon || ThemeIcon.getModifier(status.icon) !== 'spin' || this._configurationService.getValue(TerminalSettingId.TabsEnableAnimation)) {\n\t\t\treturn status;\n\t\t}\n\t\tlet icon;\n\t\t// Loading without animation is just a curved line that doesn't mean anything\n\t\tif (status.icon.id === spinningLoading.id) {\n\t\t\ticon = Codicon.play;\n\t\t} else {\n\t\t\ticon = ThemeIcon.modify(status.icon, undefined);\n\t\t}\n\t\t// Clone the status when changing the icon so that setting changes are applied without a\n\t\t// reload being needed\n\t\treturn {\n\t\t\t...status,\n\t\t\ticon\n\t\t};\n\t}\n}\n\nexport function getColorForSeverity(severity: Severity): string {\n\tswitch (severity) {\n\t\tcase Severity.Error:\n\t\t\treturn listErrorForeground;\n\t\tcase Severity.Warning:\n\t\t\treturn listWarningForeground;\n\t\tdefault:\n\t\t\treturn '';\n\t}\n}\n"]}