{"version":3,"sources":["vs/workbench/contrib/chat/browser/actions/chatTitleActions.ts"],"names":[],"mappings":"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","file":"chatTitleActions.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Codicon } from 'vs/base/common/codicons';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { marked } from 'vs/base/common/marked/marked';\nimport { ServicesAccessor } from 'vs/editor/browser/editorExtensions';\nimport { IBulkEditService } from 'vs/editor/browser/services/bulkEditService';\nimport { localize } from 'vs/nls';\nimport { Action2, MenuId, registerAction2 } from 'vs/platform/actions/common/actions';\nimport { ContextKeyExpr } from 'vs/platform/contextkey/common/contextkey';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { ResourceNotebookCellEdit } from 'vs/workbench/contrib/bulkEdit/browser/bulkCellEdits';\nimport { CHAT_CATEGORY } from 'vs/workbench/contrib/chat/browser/actions/chatActions';\nimport { IChatWidgetService } from 'vs/workbench/contrib/chat/browser/chat';\nimport { CONTEXT_IN_CHAT_INPUT, CONTEXT_IN_CHAT_SESSION, CONTEXT_REQUEST, CONTEXT_RESPONSE, CONTEXT_RESPONSE_FILTERED, CONTEXT_RESPONSE_VOTE } from 'vs/workbench/contrib/chat/common/chatContextKeys';\nimport { IChatService, IChatUserActionEvent, InteractiveSessionVoteDirection } from 'vs/workbench/contrib/chat/common/chatService';\nimport { isRequestVM, isResponseVM } from 'vs/workbench/contrib/chat/common/chatViewModel';\nimport { INotebookEditor } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { CellEditType, CellKind, NOTEBOOK_EDITOR_ID } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { NOTEBOOK_IS_ACTIVE_EDITOR } from 'vs/workbench/contrib/notebook/common/notebookContextKeys';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\n\nexport function registerChatTitleActions() {\n\tregisterAction2(class MarkHelpfulAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.markHelpful',\n\t\t\t\ttitle: {\n\t\t\t\t\tvalue: localize('interactive.helpful.label', \"Helpful\"),\n\t\t\t\t\toriginal: 'Helpful'\n\t\t\t\t},\n\t\t\t\tf1: false,\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\ticon: Codicon.thumbsup,\n\t\t\t\ttoggled: CONTEXT_RESPONSE_VOTE.isEqualTo('up'),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.ChatMessageTitle,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 1,\n\t\t\t\t\twhen: CONTEXT_RESPONSE\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\tconst item = args[0];\n\t\t\tif (!isResponseVM(item)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst chatService = accessor.get(IChatService);\n\t\t\tchatService.notifyUserAction(<IChatUserActionEvent>{\n\t\t\t\tproviderId: item.providerId,\n\t\t\t\taction: {\n\t\t\t\t\tkind: 'vote',\n\t\t\t\t\tdirection: InteractiveSessionVoteDirection.Up,\n\t\t\t\t\tresponseId: item.providerResponseId\n\t\t\t\t}\n\t\t\t});\n\t\t\titem.setVote(InteractiveSessionVoteDirection.Up);\n\t\t}\n\t});\n\n\tregisterAction2(class MarkUnhelpfulAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.markUnhelpful',\n\t\t\t\ttitle: {\n\t\t\t\t\tvalue: localize('interactive.unhelpful.label', \"Unhelpful\"),\n\t\t\t\t\toriginal: 'Unhelpful'\n\t\t\t\t},\n\t\t\t\tf1: false,\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\ticon: Codicon.thumbsdown,\n\t\t\t\ttoggled: CONTEXT_RESPONSE_VOTE.isEqualTo('down'),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.ChatMessageTitle,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 2,\n\t\t\t\t\twhen: CONTEXT_RESPONSE\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\tconst item = args[0];\n\t\t\tif (!isResponseVM(item)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst chatService = accessor.get(IChatService);\n\t\t\tchatService.notifyUserAction(<IChatUserActionEvent>{\n\t\t\t\tproviderId: item.providerId,\n\t\t\t\taction: {\n\t\t\t\t\tkind: 'vote',\n\t\t\t\t\tdirection: InteractiveSessionVoteDirection.Down,\n\t\t\t\t\tresponseId: item.providerResponseId\n\t\t\t\t}\n\t\t\t});\n\t\t\titem.setVote(InteractiveSessionVoteDirection.Down);\n\t\t}\n\t});\n\n\tregisterAction2(class InsertToNotebookAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.insertIntoNotebook',\n\t\t\t\ttitle: {\n\t\t\t\t\tvalue: localize('interactive.insertIntoNotebook.label', \"Insert into Notebook\"),\n\t\t\t\t\toriginal: 'Insert into Notebook'\n\t\t\t\t},\n\t\t\t\tf1: false,\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\ticon: Codicon.insert,\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.ChatMessageTitle,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\tisHiddenByDefault: true,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_IS_ACTIVE_EDITOR, CONTEXT_RESPONSE, CONTEXT_RESPONSE_FILTERED.negate())\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tasync run(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\tconst item = args[0];\n\t\t\tif (!isResponseVM(item)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst editorService = accessor.get(IEditorService);\n\n\t\t\tif (editorService.activeEditorPane?.getId() === NOTEBOOK_EDITOR_ID) {\n\t\t\t\tconst notebookEditor = editorService.activeEditorPane.getControl() as INotebookEditor;\n\n\t\t\t\tif (!notebookEditor.hasModel()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (notebookEditor.isReadOnly) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst value = item.response.asString();\n\t\t\t\tconst splitContents = splitMarkdownAndCodeBlocks(value);\n\n\t\t\t\tconst focusRange = notebookEditor.getFocus();\n\t\t\t\tconst index = Math.max(focusRange.end, 0);\n\t\t\t\tconst bulkEditService = accessor.get(IBulkEditService);\n\n\t\t\t\tawait bulkEditService.apply(\n\t\t\t\t\t[\n\t\t\t\t\t\tnew ResourceNotebookCellEdit(notebookEditor.textModel.uri,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\t\t\t\tindex: index,\n\t\t\t\t\t\t\t\tcount: 0,\n\t\t\t\t\t\t\t\tcells: splitContents.map(content => {\n\t\t\t\t\t\t\t\t\tconst kind = content.type === 'markdown' ? CellKind.Markup : CellKind.Code;\n\t\t\t\t\t\t\t\t\tconst language = content.type === 'markdown' ? 'markdown' : content.language;\n\t\t\t\t\t\t\t\t\tconst mime = content.type === 'markdown' ? 'text/markdown' : `text/x-${content.language}`;\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\tcellKind: kind,\n\t\t\t\t\t\t\t\t\t\tlanguage,\n\t\t\t\t\t\t\t\t\t\tmime,\n\t\t\t\t\t\t\t\t\t\tsource: content.content,\n\t\t\t\t\t\t\t\t\t\toutputs: [],\n\t\t\t\t\t\t\t\t\t\tmetadata: {}\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t)\n\t\t\t\t\t],\n\t\t\t\t\t{ quotableLabel: 'Insert into Notebook' }\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\n\tregisterAction2(class RemoveAction extends Action2 {\n\t\tconstructor() {\n\t\t\tsuper({\n\t\t\t\tid: 'workbench.action.chat.remove',\n\t\t\t\ttitle: {\n\t\t\t\t\tvalue: localize('chat.remove.label', \"Remove Request and Response\"),\n\t\t\t\t\toriginal: 'Remove Request and Response'\n\t\t\t\t},\n\t\t\t\tf1: false,\n\t\t\t\tcategory: CHAT_CATEGORY,\n\t\t\t\ticon: Codicon.x,\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyCode.Delete,\n\t\t\t\t\tmac: {\n\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Backspace,\n\t\t\t\t\t},\n\t\t\t\t\twhen: ContextKeyExpr.and(CONTEXT_IN_CHAT_SESSION, CONTEXT_IN_CHAT_INPUT.negate()),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t},\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.ChatMessageTitle,\n\t\t\t\t\tgroup: 'navigation',\n\t\t\t\t\torder: 2,\n\t\t\t\t\twhen: CONTEXT_REQUEST\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\trun(accessor: ServicesAccessor, ...args: any[]) {\n\t\t\tlet item = args[0];\n\t\t\tif (!isRequestVM(item)) {\n\t\t\t\tconst chatWidgetService = accessor.get(IChatWidgetService);\n\t\t\t\tconst widget = chatWidgetService.lastFocusedWidget;\n\t\t\t\titem = widget?.getFocus();\n\t\t\t}\n\n\t\t\tconst providerRequestId = isRequestVM(item) ? item.providerRequestId :\n\t\t\t\tisResponseVM(item) ? item.providerResponseId : undefined;\n\n\t\t\tif (providerRequestId) {\n\t\t\t\tconst chatService = accessor.get(IChatService);\n\t\t\t\tchatService.removeRequest(item.sessionId, providerRequestId);\n\t\t\t}\n\t\t}\n\t});\n}\n\ninterface MarkdownContent {\n\ttype: 'markdown';\n\tcontent: string;\n}\n\ninterface CodeContent {\n\ttype: 'code';\n\tlanguage: string;\n\tcontent: string;\n}\n\ntype Content = MarkdownContent | CodeContent;\n\nfunction splitMarkdownAndCodeBlocks(markdown: string): Content[] {\n\tconst lexer = new marked.Lexer();\n\tconst tokens = lexer.lex(markdown);\n\n\tconst splitContent: Content[] = [];\n\n\tlet markdownPart = '';\n\ttokens.forEach((token) => {\n\t\tif (token.type === 'code') {\n\t\t\tif (markdownPart.trim()) {\n\t\t\t\tsplitContent.push({ type: 'markdown', content: markdownPart });\n\t\t\t\tmarkdownPart = '';\n\t\t\t}\n\t\t\tsplitContent.push({\n\t\t\t\ttype: 'code',\n\t\t\t\tlanguage: token.lang || '',\n\t\t\t\tcontent: token.text,\n\t\t\t});\n\t\t} else {\n\t\t\tmarkdownPart += token.raw;\n\t\t}\n\t});\n\n\tif (markdownPart.trim()) {\n\t\tsplitContent.push({ type: 'markdown', content: markdownPart });\n\t}\n\n\treturn splitContent;\n}\n"]}