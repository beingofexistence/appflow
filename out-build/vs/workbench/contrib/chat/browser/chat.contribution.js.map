{"version":3,"sources":["vs/workbench/contrib/chat/browser/chat.contribution.ts"],"names":[],"mappings":"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","file":"chat.contribution.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { Schemas } from 'vs/base/common/network';\nimport { isMacintosh } from 'vs/base/common/platform';\nimport * as nls from 'vs/nls';\nimport { Extensions as ConfigurationExtensions, IConfigurationRegistry } from 'vs/platform/configuration/common/configurationRegistry';\nimport { SyncDescriptor } from 'vs/platform/instantiation/common/descriptors';\nimport { InstantiationType, registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { EditorPaneDescriptor, IEditorPaneRegistry } from 'vs/workbench/browser/editor';\nimport { IWorkbenchContributionsRegistry, Extensions as WorkbenchExtensions } from 'vs/workbench/common/contributions';\nimport { EditorExtensions, IEditorFactoryRegistry } from 'vs/workbench/common/editor';\nimport { registerChatActions } from 'vs/workbench/contrib/chat/browser/actions/chatActions';\nimport { registerChatCodeBlockActions } from 'vs/workbench/contrib/chat/browser/actions/chatCodeblockActions';\nimport { registerChatCopyActions } from 'vs/workbench/contrib/chat/browser/actions/chatCopyActions';\nimport { registerChatExecuteActions } from 'vs/workbench/contrib/chat/browser/actions/chatExecuteActions';\nimport { registerQuickChatActions } from 'vs/workbench/contrib/chat/browser/actions/chatQuickInputActions';\nimport { registerChatTitleActions } from 'vs/workbench/contrib/chat/browser/actions/chatTitleActions';\nimport { registerChatExportActions } from 'vs/workbench/contrib/chat/browser/actions/chatImportExport';\nimport { IChatAccessibilityService, IChatWidget, IChatWidgetService, IQuickChatService } from 'vs/workbench/contrib/chat/browser/chat';\nimport { ChatContributionService } from 'vs/workbench/contrib/chat/browser/chatContributionServiceImpl';\nimport { ChatEditor, IChatEditorOptions } from 'vs/workbench/contrib/chat/browser/chatEditor';\nimport { ChatEditorInput, ChatEditorInputSerializer } from 'vs/workbench/contrib/chat/browser/chatEditorInput';\nimport { ChatWidgetService } from 'vs/workbench/contrib/chat/browser/chatWidget';\nimport 'vs/workbench/contrib/chat/browser/contrib/chatInputEditorContrib';\nimport 'vs/workbench/contrib/chat/browser/contrib/chatHistoryVariables';\nimport { IChatContributionService } from 'vs/workbench/contrib/chat/common/chatContributionService';\nimport { IChatService } from 'vs/workbench/contrib/chat/common/chatService';\nimport { ChatService } from 'vs/workbench/contrib/chat/common/chatServiceImpl';\nimport { ChatWidgetHistoryService, IChatWidgetHistoryService } from 'vs/workbench/contrib/chat/common/chatWidgetHistoryService';\nimport { IEditorResolverService, RegisteredEditorPriority } from 'vs/workbench/services/editor/common/editorResolverService';\nimport { LifecyclePhase } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport '../common/chatColors';\nimport { registerMoveActions } from 'vs/workbench/contrib/chat/browser/actions/chatMoveActions';\nimport { ACTION_ID_CLEAR_CHAT, registerClearActions } from 'vs/workbench/contrib/chat/browser/actions/chatClearActions';\nimport { AccessibleViewType, IAccessibleViewService } from 'vs/workbench/contrib/accessibility/browser/accessibleView';\nimport { isResponseVM } from 'vs/workbench/contrib/chat/common/chatViewModel';\nimport { CONTEXT_IN_CHAT_SESSION } from 'vs/workbench/contrib/chat/common/chatContextKeys';\nimport { ChatAccessibilityService } from 'vs/workbench/contrib/chat/browser/chatAccessibilityService';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { AccessibilityVerbositySettingId } from 'vs/workbench/contrib/accessibility/browser/accessibilityConfiguration';\nimport { ChatWelcomeMessageModel } from 'vs/workbench/contrib/chat/common/chatModel';\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\nimport { ChatProviderService, IChatProviderService } from 'vs/workbench/contrib/chat/common/chatProvider';\nimport { ChatSlashCommandService, IChatSlashCommandService } from 'vs/workbench/contrib/chat/common/chatSlashCommands';\nimport { alertFocusChange } from 'vs/workbench/contrib/accessibility/browser/accessibilityContributions';\nimport { AccessibleViewAction } from 'vs/workbench/contrib/accessibility/browser/accessibleViewActions';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { ChatVariablesService, IChatVariablesService } from 'vs/workbench/contrib/chat/common/chatVariables';\nimport { registerChatFileTreeActions } from 'vs/workbench/contrib/chat/browser/actions/chatFileTreeActions';\nimport { QuickChatService } from 'vs/workbench/contrib/chat/browser/chatQuick';\nimport { ChatAgentService, IChatAgentService } from 'vs/workbench/contrib/chat/common/chatAgents';\n\n// Register configuration\nconst configurationRegistry = Registry.as<IConfigurationRegistry>(ConfigurationExtensions.Configuration);\nconfigurationRegistry.registerConfiguration({\n\tid: 'chatSidebar',\n\ttitle: nls.localize('interactiveSessionConfigurationTitle', \"Chat\"),\n\ttype: 'object',\n\tproperties: {\n\t\t'chat.editor.fontSize': {\n\t\t\ttype: 'number',\n\t\t\tdescription: nls.localize('interactiveSession.editor.fontSize', \"Controls the font size in pixels in chat codeblocks.\"),\n\t\t\tdefault: isMacintosh ? 12 : 14,\n\t\t},\n\t\t'chat.editor.fontFamily': {\n\t\t\ttype: 'string',\n\t\t\tdescription: nls.localize('interactiveSession.editor.fontFamily', \"Controls the font family in chat codeblocks.\"),\n\t\t\tdefault: 'default'\n\t\t},\n\t\t'chat.editor.fontWeight': {\n\t\t\ttype: 'string',\n\t\t\tdescription: nls.localize('interactiveSession.editor.fontWeight', \"Controls the font weight in chat codeblocks.\"),\n\t\t\tdefault: 'default'\n\t\t},\n\t\t'chat.editor.wordWrap': {\n\t\t\ttype: 'string',\n\t\t\tdescription: nls.localize('interactiveSession.editor.wordWrap', \"Controls whether lines should wrap in chat codeblocks.\"),\n\t\t\tdefault: 'off',\n\t\t\tenum: ['on', 'off']\n\t\t},\n\t\t'chat.editor.lineHeight': {\n\t\t\ttype: 'number',\n\t\t\tdescription: nls.localize('interactiveSession.editor.lineHeight', \"Controls the line height in pixels in chat codeblocks. Use 0 to compute the line height from the font size.\"),\n\t\t\tdefault: 0\n\t\t}\n\t}\n});\n\n\nRegistry.as<IEditorPaneRegistry>(EditorExtensions.EditorPane).registerEditorPane(\n\tEditorPaneDescriptor.create(\n\t\tChatEditor,\n\t\tChatEditorInput.EditorID,\n\t\tnls.localize('chat', \"Chat\")\n\t),\n\t[\n\t\tnew SyncDescriptor(ChatEditorInput)\n\t]\n);\n\nclass ChatResolverContribution extends Disposable {\n\tconstructor(\n\t\t@IEditorResolverService editorResolverService: IEditorResolverService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(editorResolverService.registerEditor(\n\t\t\t`${Schemas.vscodeChatSesssion}:**/**`,\n\t\t\t{\n\t\t\t\tid: ChatEditorInput.EditorID,\n\t\t\t\tlabel: nls.localize('chat', \"Chat\"),\n\t\t\t\tpriority: RegisteredEditorPriority.builtin\n\t\t\t},\n\t\t\t{\n\t\t\t\tsinglePerResource: true,\n\t\t\t\tcanSupportResource: resource => resource.scheme === Schemas.vscodeChatSesssion\n\t\t\t},\n\t\t\t{\n\t\t\t\tcreateEditorInput: ({ resource, options }) => {\n\t\t\t\t\treturn { editor: instantiationService.createInstance(ChatEditorInput, resource, options as IChatEditorOptions), options };\n\t\t\t\t}\n\t\t\t}\n\t\t));\n\t}\n}\n\nclass ChatAccessibleViewContribution extends Disposable {\n\tstatic ID: 'chatAccessibleViewContribution';\n\tconstructor() {\n\t\tsuper();\n\t\tthis._register(AccessibleViewAction.addImplementation(100, 'panelChat', accessor => {\n\t\t\tconst accessibleViewService = accessor.get(IAccessibleViewService);\n\t\t\tconst widgetService = accessor.get(IChatWidgetService);\n\t\t\tconst codeEditorService = accessor.get(ICodeEditorService);\n\t\t\treturn renderAccessibleView(accessibleViewService, widgetService, codeEditorService, true);\n\t\t\tfunction renderAccessibleView(accessibleViewService: IAccessibleViewService, widgetService: IChatWidgetService, codeEditorService: ICodeEditorService, initialRender?: boolean): boolean {\n\t\t\t\tconst widget = widgetService.lastFocusedWidget;\n\t\t\t\tif (!widget) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst chatInputFocused = initialRender && !!codeEditorService.getFocusedCodeEditor();\n\t\t\t\tif (initialRender && chatInputFocused) {\n\t\t\t\t\twidget.focusLastMessage();\n\t\t\t\t}\n\n\t\t\t\tif (!widget) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst verifiedWidget: IChatWidget = widget;\n\t\t\t\tconst focusedItem = verifiedWidget.getFocus();\n\n\t\t\t\tif (!focusedItem) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\twidget.focus(focusedItem);\n\t\t\t\tconst isWelcome = focusedItem instanceof ChatWelcomeMessageModel;\n\t\t\t\tlet responseContent = isResponseVM(focusedItem) ? focusedItem.response.asString() : undefined;\n\t\t\t\tif (isWelcome) {\n\t\t\t\t\tconst welcomeReplyContents = [];\n\t\t\t\t\tfor (const content of focusedItem.content) {\n\t\t\t\t\t\tif (Array.isArray(content)) {\n\t\t\t\t\t\t\twelcomeReplyContents.push(...content.map(m => m.message));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twelcomeReplyContents.push((content as IMarkdownString).value);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresponseContent = welcomeReplyContents.join('\\n');\n\t\t\t\t}\n\t\t\t\tif (!responseContent) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst responses = verifiedWidget.viewModel?.getItems().filter(i => isResponseVM(i));\n\t\t\t\tconst length = responses?.length;\n\t\t\t\tconst responseIndex = responses?.findIndex(i => i === focusedItem);\n\n\t\t\t\taccessibleViewService.show({\n\t\t\t\t\tverbositySettingKey: AccessibilityVerbositySettingId.Chat,\n\t\t\t\t\tprovideContent(): string { return responseContent!; },\n\t\t\t\t\tonClose() {\n\t\t\t\t\t\tverifiedWidget.reveal(focusedItem);\n\t\t\t\t\t\tif (chatInputFocused) {\n\t\t\t\t\t\t\tverifiedWidget.focusInput();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tverifiedWidget.focus(focusedItem);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tnext() {\n\t\t\t\t\t\tverifiedWidget.moveFocus(focusedItem, 'next');\n\t\t\t\t\t\talertFocusChange(responseIndex, length, 'next');\n\t\t\t\t\t\trenderAccessibleView(accessibleViewService, widgetService, codeEditorService);\n\t\t\t\t\t},\n\t\t\t\t\tprevious() {\n\t\t\t\t\t\tverifiedWidget.moveFocus(focusedItem, 'previous');\n\t\t\t\t\t\talertFocusChange(responseIndex, length, 'previous');\n\t\t\t\t\t\trenderAccessibleView(accessibleViewService, widgetService, codeEditorService);\n\t\t\t\t\t},\n\t\t\t\t\toptions: { type: AccessibleViewType.View }\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}, CONTEXT_IN_CHAT_SESSION));\n\t}\n}\n\nclass ChatSlashStaticSlashCommandsContribution extends Disposable {\n\n\tconstructor(\n\t\t@IChatSlashCommandService slashCommandService: IChatSlashCommandService,\n\t\t@ICommandService commandService: ICommandService,\n\t) {\n\t\tsuper();\n\t\tthis._store.add(slashCommandService.registerSlashCommand({\n\t\t\tcommand: 'clear',\n\t\t\tdetail: nls.localize('clear', \"Clear the session\"),\n\t\t\tsortText: 'z_clear',\n\t\t\texecuteImmediately: true\n\t\t}, async () => {\n\t\t\tcommandService.executeCommand(ACTION_ID_CLEAR_CHAT);\n\t\t}));\n\t}\n}\n\nconst workbenchContributionsRegistry = Registry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench);\nworkbenchContributionsRegistry.registerWorkbenchContribution(ChatResolverContribution, LifecyclePhase.Starting);\nworkbenchContributionsRegistry.registerWorkbenchContribution(ChatAccessibleViewContribution, LifecyclePhase.Eventually);\nworkbenchContributionsRegistry.registerWorkbenchContribution(ChatSlashStaticSlashCommandsContribution, LifecyclePhase.Eventually);\nRegistry.as<IEditorFactoryRegistry>(EditorExtensions.EditorFactory).registerEditorSerializer(ChatEditorInput.TypeID, ChatEditorInputSerializer);\n\nregisterChatActions();\nregisterChatCopyActions();\nregisterChatCodeBlockActions();\nregisterChatFileTreeActions();\nregisterChatTitleActions();\nregisterChatExecuteActions();\nregisterQuickChatActions();\nregisterChatExportActions();\nregisterMoveActions();\nregisterClearActions();\n\nregisterSingleton(IChatService, ChatService, InstantiationType.Delayed);\nregisterSingleton(IChatContributionService, ChatContributionService, InstantiationType.Delayed);\nregisterSingleton(IChatWidgetService, ChatWidgetService, InstantiationType.Delayed);\nregisterSingleton(IQuickChatService, QuickChatService, InstantiationType.Delayed);\nregisterSingleton(IChatAccessibilityService, ChatAccessibilityService, InstantiationType.Delayed);\nregisterSingleton(IChatWidgetHistoryService, ChatWidgetHistoryService, InstantiationType.Delayed);\nregisterSingleton(IChatProviderService, ChatProviderService, InstantiationType.Delayed);\nregisterSingleton(IChatSlashCommandService, ChatSlashCommandService, InstantiationType.Delayed);\nregisterSingleton(IChatAgentService, ChatAgentService, InstantiationType.Delayed);\nregisterSingleton(IChatVariablesService, ChatVariablesService, InstantiationType.Delayed);\n"]}