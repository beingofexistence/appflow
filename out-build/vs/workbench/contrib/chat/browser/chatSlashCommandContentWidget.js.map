{"version":3,"sources":["vs/workbench/contrib/chat/browser/chatSlashCommandContentWidget.ts"],"names":[],"mappings":"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","file":"chatSlashCommandContentWidget.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./chatSlashCommandContentWidget';\nimport { IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { Range } from 'vs/editor/common/core/range';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { ContentWidgetPositionPreference, ICodeEditor, IContentWidget } from 'vs/editor/browser/editorBrowser';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { localize } from 'vs/nls';\nimport * as aria from 'vs/base/browser/ui/aria/aria';\n\nexport class SlashCommandContentWidget extends Disposable implements IContentWidget {\n\tprivate _domNode = document.createElement('div');\n\tprivate _lastSlashCommandText: string | undefined;\n\tprivate _isVisible = false;\n\n\tconstructor(private _editor: ICodeEditor) {\n\t\tsuper();\n\n\t\tthis._domNode.toggleAttribute('hidden', true);\n\t\tthis._domNode.classList.add('chat-slash-command-content-widget');\n\n\t\t// If backspace at a slash command boundary, remove the slash command\n\t\tthis._register(this._editor.onKeyDown((e) => this._handleKeyDown(e)));\n\t}\n\n\toverride dispose() {\n\t\tthis._editor.removeContentWidget(this);\n\t\tsuper.dispose();\n\t}\n\n\tshow() {\n\t\tif (this._isVisible) {\n\t\t\treturn;\n\t\t}\n\t\tthis._isVisible = true;\n\t\tthis._domNode.toggleAttribute('hidden', false);\n\t\tthis._editor.addContentWidget(this);\n\t}\n\n\thide() {\n\t\tthis._isVisible = false;\n\t\tthis._domNode.toggleAttribute('hidden', true);\n\t\tthis._editor.removeContentWidget(this);\n\t}\n\n\tsetCommandText(slashCommand: string) {\n\t\tthis._domNode.innerText = `/${slashCommand} `;\n\t\tthis._lastSlashCommandText = slashCommand;\n\t}\n\n\tgetId() { return 'chat-slash-command-content-widget'; }\n\tgetDomNode() { return this._domNode; }\n\tgetPosition() { return { position: { lineNumber: 1, column: 1 }, preference: [ContentWidgetPositionPreference.EXACT] }; }\n\n\tprivate _handleKeyDown(e: IKeyboardEvent) {\n\t\tif (e.keyCode !== KeyCode.Backspace) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst firstLine = this._editor.getModel()?.getLineContent(1);\n\t\tconst selection = this._editor.getSelection();\n\t\tconst withSlash = `/${this._lastSlashCommandText} `;\n\t\tif (!firstLine?.startsWith(withSlash) || !selection?.isEmpty() || selection?.startLineNumber !== 1 || selection?.startColumn !== withSlash.length + 1) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Allow to undo the backspace\n\t\tthis._editor.executeEdits('chat-slash-command', [{\n\t\t\trange: new Range(1, 1, 1, selection.startColumn),\n\t\t\ttext: null\n\t\t}]);\n\n\t\t// Announce the deletion\n\t\taria.alert(localize('exited slash command mode', 'Exited {0} mode', this._lastSlashCommandText));\n\t}\n}\n"]}