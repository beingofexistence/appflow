{"version":3,"sources":["vs/workbench/electron-sandbox/window.ts"],"names":[],"mappings":"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","file":"window.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { URI } from 'vs/base/common/uri';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { equals } from 'vs/base/common/objects';\nimport { EventType, EventHelper, addDisposableListener, ModifierKeyEmitter } from 'vs/base/browser/dom';\nimport { Separator, WorkbenchActionExecutedClassification, WorkbenchActionExecutedEvent } from 'vs/base/common/actions';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { EditorResourceAccessor, IUntitledTextResourceEditorInput, SideBySideEditor, pathsToEditors, IResourceDiffEditorInput, IUntypedEditorInput, IEditorPane, isResourceEditorInput, IResourceMergeEditorInput } from 'vs/workbench/common/editor';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { WindowMinimumSize, IOpenFileRequest, IWindowsConfiguration, getTitleBarStyle, IAddFoldersRequest, INativeRunActionInWindowRequest, INativeRunKeybindingInWindowRequest, INativeOpenFileRequest } from 'vs/platform/window/common/window';\nimport { ITitleService } from 'vs/workbench/services/title/common/titleService';\nimport { IWorkbenchThemeService } from 'vs/workbench/services/themes/common/workbenchThemeService';\nimport { applyZoom } from 'vs/platform/window/electron-sandbox/window';\nimport { setFullscreen, getZoomLevel } from 'vs/base/browser/browser';\nimport { ICommandService, CommandsRegistry } from 'vs/platform/commands/common/commands';\nimport { IResourceEditorInput } from 'vs/platform/editor/common/editor';\nimport { ipcRenderer, process } from 'vs/base/parts/sandbox/electron-sandbox/globals';\nimport { IWorkspaceEditingService } from 'vs/workbench/services/workspaces/common/workspaceEditing';\nimport { IMenuService, MenuId, IMenu, MenuItemAction, MenuRegistry } from 'vs/platform/actions/common/actions';\nimport { ICommandAction } from 'vs/platform/action/common/action';\nimport { createAndFillInActionBarActions } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { RunOnceScheduler } from 'vs/base/common/async';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { LifecyclePhase, ILifecycleService, WillShutdownEvent, ShutdownReason, BeforeShutdownErrorEvent, BeforeShutdownEvent } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport { IWorkspaceFolderCreationData } from 'vs/platform/workspaces/common/workspaces';\nimport { IIntegrityService } from 'vs/workbench/services/integrity/common/integrity';\nimport { isWindows, isMacintosh, isCI } from 'vs/base/common/platform';\nimport { IProductService } from 'vs/platform/product/common/productService';\nimport { INotificationService, NeverShowAgainScope, NotificationPriority, Severity } from 'vs/platform/notification/common/notification';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { INativeWorkbenchEnvironmentService } from 'vs/workbench/services/environment/electron-sandbox/environmentService';\nimport { IAccessibilityService, AccessibilitySupport } from 'vs/platform/accessibility/common/accessibility';\nimport { WorkbenchState, IWorkspaceContextService } from 'vs/platform/workspace/common/workspace';\nimport { coalesce } from 'vs/base/common/arrays';\nimport { ConfigurationTarget, IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { assertIsDefined } from 'vs/base/common/types';\nimport { IOpenerService, OpenOptions } from 'vs/platform/opener/common/opener';\nimport { Schemas } from 'vs/base/common/network';\nimport { INativeHostService } from 'vs/platform/native/common/native';\nimport { posix } from 'vs/base/common/path';\nimport { ITunnelService, extractLocalHostUriMetaDataForPortMapping } from 'vs/platform/tunnel/common/tunnel';\nimport { IWorkbenchLayoutService, Parts, positionFromString, Position } from 'vs/workbench/services/layout/browser/layoutService';\nimport { IWorkingCopyService } from 'vs/workbench/services/workingCopy/common/workingCopyService';\nimport { WorkingCopyCapabilities } from 'vs/workbench/services/workingCopy/common/workingCopy';\nimport { AutoSaveMode, IFilesConfigurationService } from 'vs/workbench/services/filesConfiguration/common/filesConfigurationService';\nimport { Event } from 'vs/base/common/event';\nimport { IRemoteAuthorityResolverService } from 'vs/platform/remote/common/remoteAuthorityResolver';\nimport { IAddressProvider, IAddress } from 'vs/platform/remote/common/remoteAgentConnection';\nimport { IEditorGroupsService } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { IDialogService } from 'vs/platform/dialogs/common/dialogs';\nimport { AuthInfo } from 'vs/base/parts/sandbox/electron-sandbox/electronTypes';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IInstantiationService, ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { whenEditorClosed } from 'vs/workbench/browser/editor';\nimport { ISharedProcessService } from 'vs/platform/ipc/electron-sandbox/services';\nimport { IProgressService, ProgressLocation } from 'vs/platform/progress/common/progress';\nimport { toErrorMessage } from 'vs/base/common/errorMessage';\nimport { registerWindowDriver } from 'vs/platform/driver/electron-sandbox/driver';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { dirname } from 'vs/base/common/resources';\nimport { IBannerService } from 'vs/workbench/services/banner/browser/bannerService';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { IUriIdentityService } from 'vs/platform/uriIdentity/common/uriIdentity';\nimport { IPreferencesService } from 'vs/workbench/services/preferences/common/preferences';\nimport { IUtilityProcessWorkerWorkbenchService } from 'vs/workbench/services/utilityProcess/electron-sandbox/utilityProcessWorkerWorkbenchService';\n\nexport class NativeWindow extends Disposable {\n\n\tprivate touchBarMenu: IMenu | undefined;\n\tprivate readonly touchBarDisposables = this._register(new DisposableStore());\n\tprivate lastInstalledTouchedBar: ICommandAction[][] | undefined;\n\n\tprivate readonly customTitleContextMenuDisposable = this._register(new DisposableStore());\n\n\tprivate readonly addFoldersScheduler = this._register(new RunOnceScheduler(() => this.doAddFolders(), 100));\n\tprivate pendingFoldersToAdd: URI[] = [];\n\n\tprivate readonly closeEmptyWindowScheduler = this._register(new RunOnceScheduler(() => this.onDidAllEditorsClose(), 50));\n\n\tprivate isDocumentedEdited = false;\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IEditorGroupsService private readonly editorGroupService: IEditorGroupsService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITitleService private readonly titleService: ITitleService,\n\t\t@IWorkbenchThemeService protected themeService: IWorkbenchThemeService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IWorkspaceEditingService private readonly workspaceEditingService: IWorkspaceEditingService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@IIntegrityService private readonly integrityService: IIntegrityService,\n\t\t@INativeWorkbenchEnvironmentService private readonly environmentService: INativeWorkbenchEnvironmentService,\n\t\t@IAccessibilityService private readonly accessibilityService: IAccessibilityService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@INativeHostService private readonly nativeHostService: INativeHostService,\n\t\t@ITunnelService private readonly tunnelService: ITunnelService,\n\t\t@IWorkbenchLayoutService private readonly layoutService: IWorkbenchLayoutService,\n\t\t@IWorkingCopyService private readonly workingCopyService: IWorkingCopyService,\n\t\t@IFilesConfigurationService private readonly filesConfigurationService: IFilesConfigurationService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IRemoteAuthorityResolverService private readonly remoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@ISharedProcessService private readonly sharedProcessService: ISharedProcessService,\n\t\t@IProgressService private readonly progressService: IProgressService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IBannerService private readonly bannerService: IBannerService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService,\n\t\t@IPreferencesService private readonly preferencesService: IPreferencesService,\n\t\t@IUtilityProcessWorkerWorkbenchService private readonly utilityProcessWorkerWorkbenchService: IUtilityProcessWorkerWorkbenchService\n\t) {\n\t\tsuper();\n\n\t\tthis.registerListeners();\n\t\tthis.create();\n\t}\n\n\tprivate registerListeners(): void {\n\n\t\t// Layout\n\t\tthis._register(addDisposableListener(window, EventType.RESIZE, e => this.onWindowResize(e)));\n\n\t\t// React to editor input changes\n\t\tthis._register(this.editorService.onDidActiveEditorChange(() => this.updateTouchbarMenu()));\n\n\t\t// Prevent opening a real URL inside the window\n\t\tfor (const event of [EventType.DRAG_OVER, EventType.DROP]) {\n\t\t\twindow.document.body.addEventListener(event, (e: DragEvent) => {\n\t\t\t\tEventHelper.stop(e);\n\t\t\t});\n\t\t}\n\n\t\t// Support `runAction` event\n\t\tipcRenderer.on('vscode:runAction', async (event: unknown, request: INativeRunActionInWindowRequest) => {\n\t\t\tconst args: unknown[] = request.args || [];\n\n\t\t\t// If we run an action from the touchbar, we fill in the currently active resource\n\t\t\t// as payload because the touch bar items are context aware depending on the editor\n\t\t\tif (request.from === 'touchbar') {\n\t\t\t\tconst activeEditor = this.editorService.activeEditor;\n\t\t\t\tif (activeEditor) {\n\t\t\t\t\tconst resource = EditorResourceAccessor.getOriginalUri(activeEditor, { supportSideBySide: SideBySideEditor.PRIMARY });\n\t\t\t\t\tif (resource) {\n\t\t\t\t\t\targs.push(resource);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\targs.push({ from: request.from });\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tawait this.commandService.executeCommand(request.id, ...args);\n\n\t\t\t\tthis.telemetryService.publicLog2<WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification>('workbenchActionExecuted', { id: request.id, from: request.from });\n\t\t\t} catch (error) {\n\t\t\t\tthis.notificationService.error(error);\n\t\t\t}\n\t\t});\n\n\t\t// Support runKeybinding event\n\t\tipcRenderer.on('vscode:runKeybinding', (event: unknown, request: INativeRunKeybindingInWindowRequest) => {\n\t\t\tif (document.activeElement) {\n\t\t\t\tthis.keybindingService.dispatchByUserSettingsLabel(request.userSettingsLabel, document.activeElement);\n\t\t\t}\n\t\t});\n\n\t\t// Error reporting from main\n\t\tipcRenderer.on('vscode:reportError', (event: unknown, error: string) => {\n\t\t\tif (error) {\n\t\t\t\tonUnexpectedError(JSON.parse(error));\n\t\t\t}\n\t\t});\n\n\t\t// Support openFiles event for existing and new files\n\t\tipcRenderer.on('vscode:openFiles', (event: unknown, request: IOpenFileRequest) => { this.onOpenFiles(request); });\n\n\t\t// Support addFolders event if we have a workspace opened\n\t\tipcRenderer.on('vscode:addFolders', (event: unknown, request: IAddFoldersRequest) => { this.onAddFoldersRequest(request); });\n\n\t\t// Message support\n\t\tipcRenderer.on('vscode:showInfoMessage', (event: unknown, message: string) => { this.notificationService.info(message); });\n\n\t\t// Shell Environment Issue Notifications\n\t\tipcRenderer.on('vscode:showResolveShellEnvError', (event: unknown, message: string) => {\n\t\t\tthis.notificationService.prompt(\n\t\t\t\tSeverity.Error,\n\t\t\t\tmessage,\n\t\t\t\t[{\n\t\t\t\t\tlabel: localize('restart', \"Restart\"),\n\t\t\t\t\trun: () => this.nativeHostService.relaunch()\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('configure', \"Configure\"),\n\t\t\t\t\trun: () => this.preferencesService.openUserSettings({ query: 'application.shellEnvironmentResolutionTimeout' })\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: localize('learnMore', \"Learn More\"),\n\t\t\t\t\trun: () => this.openerService.open('https://go.microsoft.com/fwlink/?linkid=2149667')\n\t\t\t\t}]\n\t\t\t);\n\t\t});\n\n\t\tipcRenderer.on('vscode:showCredentialsError', (event: unknown, message: string) => {\n\t\t\tthis.notificationService.prompt(\n\t\t\t\tSeverity.Error,\n\t\t\t\tlocalize('keychainWriteError', \"Writing login information to the keychain failed with error '{0}'.\", message),\n\t\t\t\t[{\n\t\t\t\t\tlabel: localize('troubleshooting', \"Troubleshooting Guide\"),\n\t\t\t\t\trun: () => this.openerService.open('https://go.microsoft.com/fwlink/?linkid=2190713')\n\t\t\t\t}]\n\t\t\t);\n\t\t});\n\n\t\tipcRenderer.on('vscode:showTranslatedBuildWarning', (event: unknown, message: string) => {\n\t\t\tthis.notificationService.prompt(\n\t\t\t\tSeverity.Warning,\n\t\t\t\tlocalize(\"runningTranslated\", \"You are running an emulated version of {0}. For better performance download the native arm64 version of {0} build for your machine.\", this.productService.nameLong),\n\t\t\t\t[{\n\t\t\t\t\tlabel: localize('downloadArmBuild', \"Download\"),\n\t\t\t\t\trun: () => {\n\t\t\t\t\t\tconst quality = this.productService.quality;\n\t\t\t\t\t\tconst stableURL = 'https://code.visualstudio.com/docs/?dv=osx';\n\t\t\t\t\t\tconst insidersURL = 'https://code.visualstudio.com/docs/?dv=osx&build=insiders';\n\t\t\t\t\t\tthis.openerService.open(quality === 'stable' ? stableURL : insidersURL);\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t);\n\t\t});\n\n\t\t// Fullscreen Events\n\t\tipcRenderer.on('vscode:enterFullScreen', async () => { setFullscreen(true); });\n\t\tipcRenderer.on('vscode:leaveFullScreen', async () => { setFullscreen(false); });\n\n\t\t// Proxy Login Dialog\n\t\tipcRenderer.on('vscode:openProxyAuthenticationDialog', async (event: unknown, payload: { authInfo: AuthInfo; username?: string; password?: string; replyChannel: string }) => {\n\t\t\tconst rememberCredentialsKey = 'window.rememberProxyCredentials';\n\t\t\tconst rememberCredentials = this.storageService.getBoolean(rememberCredentialsKey, StorageScope.APPLICATION);\n\t\t\tconst result = await this.dialogService.input({\n\t\t\t\ttype: 'warning',\n\t\t\t\tmessage: localize('proxyAuthRequired', \"Proxy Authentication Required\"),\n\t\t\t\tprimaryButton: localize({ key: 'loginButton', comment: ['&& denotes a mnemonic'] }, \"&&Log In\"),\n\t\t\t\tinputs:\n\t\t\t\t\t[\n\t\t\t\t\t\t{ placeholder: localize('username', \"Username\"), value: payload.username },\n\t\t\t\t\t\t{ placeholder: localize('password', \"Password\"), type: 'password', value: payload.password }\n\t\t\t\t\t],\n\t\t\t\tdetail: localize('proxyDetail', \"The proxy {0} requires a username and password.\", `${payload.authInfo.host}:${payload.authInfo.port}`),\n\t\t\t\tcheckbox: {\n\t\t\t\t\tlabel: localize('rememberCredentials', \"Remember my credentials\"),\n\t\t\t\t\tchecked: rememberCredentials\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Reply back to the channel without result to indicate\n\t\t\t// that the login dialog was cancelled\n\t\t\tif (!result.confirmed || !result.values) {\n\t\t\t\tipcRenderer.send(payload.replyChannel);\n\t\t\t}\n\n\t\t\t// Other reply back with the picked credentials\n\t\t\telse {\n\n\t\t\t\t// Update state based on checkbox\n\t\t\t\tif (result.checkboxChecked) {\n\t\t\t\t\tthis.storageService.store(rememberCredentialsKey, true, StorageScope.APPLICATION, StorageTarget.MACHINE);\n\t\t\t\t} else {\n\t\t\t\t\tthis.storageService.remove(rememberCredentialsKey, StorageScope.APPLICATION);\n\t\t\t\t}\n\n\t\t\t\t// Reply back to main side with credentials\n\t\t\t\tconst [username, password] = result.values;\n\t\t\t\tipcRenderer.send(payload.replyChannel, { username, password, remember: !!result.checkboxChecked });\n\t\t\t}\n\t\t});\n\n\t\t// Accessibility support changed event\n\t\tipcRenderer.on('vscode:accessibilitySupportChanged', (event: unknown, accessibilitySupportEnabled: boolean) => {\n\t\t\tthis.accessibilityService.setAccessibilitySupport(accessibilitySupportEnabled ? AccessibilitySupport.Enabled : AccessibilitySupport.Disabled);\n\t\t});\n\n\t\t// Allow to update settings around allowed UNC Host\n\t\tipcRenderer.on('vscode:configureAllowedUNCHost', (event: unknown, host: string) => {\n\t\t\tif (!isWindows) {\n\t\t\t\treturn; // only supported on Windows\n\t\t\t}\n\n\t\t\tconst allowedUncHosts = new Set<string>();\n\n\t\t\tconst configuredAllowedUncHosts = this.configurationService.getValue<string[] | undefined>('security.allowedUNCHosts',) ?? [];\n\t\t\tif (Array.isArray(configuredAllowedUncHosts)) {\n\t\t\t\tfor (const configuredAllowedUncHost of configuredAllowedUncHosts) {\n\t\t\t\t\tif (typeof configuredAllowedUncHost === 'string') {\n\t\t\t\t\t\tallowedUncHosts.add(configuredAllowedUncHost);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!allowedUncHosts.has(host)) {\n\t\t\t\tallowedUncHosts.add(host);\n\n\t\t\t\tthis.configurationService.updateValue('security.allowedUNCHosts', [...allowedUncHosts.values()], ConfigurationTarget.USER);\n\t\t\t}\n\t\t});\n\n\t\t// Zoom level changes\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('window.zoomLevel')) {\n\t\t\t\tthis.updateWindowZoomLevel();\n\t\t\t} else if (e.affectsConfiguration('keyboard.touchbar.enabled') || e.affectsConfiguration('keyboard.touchbar.ignored')) {\n\t\t\t\tthis.updateTouchbarMenu();\n\t\t\t}\n\t\t}));\n\n\t\t// Listen to visible editor changes\n\t\tthis._register(this.editorService.onDidVisibleEditorsChange(() => this.onDidChangeVisibleEditors()));\n\n\t\t// Listen to editor closing (if we run with --wait)\n\t\tconst filesToWait = this.environmentService.filesToWait;\n\t\tif (filesToWait) {\n\t\t\tthis.trackClosedWaitFiles(filesToWait.waitMarkerFileUri, coalesce(filesToWait.paths.map(path => path.fileUri)));\n\t\t}\n\n\t\t// macOS OS integration\n\t\tif (isMacintosh) {\n\t\t\tthis._register(this.editorService.onDidActiveEditorChange(() => {\n\t\t\t\tconst file = EditorResourceAccessor.getOriginalUri(this.editorService.activeEditor, { supportSideBySide: SideBySideEditor.PRIMARY, filterByScheme: Schemas.file });\n\n\t\t\t\t// Represented Filename\n\t\t\t\tthis.nativeHostService.setRepresentedFilename(file?.fsPath ?? '');\n\n\t\t\t\t// Custom title menu\n\t\t\t\tthis.provideCustomTitleContextMenu(file?.fsPath);\n\t\t\t}));\n\t\t}\n\n\t\t// Maximize/Restore on doubleclick (for macOS custom title)\n\t\tif (isMacintosh && getTitleBarStyle(this.configurationService) === 'custom') {\n\t\t\tconst titlePart = assertIsDefined(this.layoutService.getContainer(Parts.TITLEBAR_PART));\n\n\t\t\tthis._register(addDisposableListener(titlePart, EventType.DBLCLICK, e => {\n\t\t\t\tEventHelper.stop(e);\n\n\t\t\t\tthis.nativeHostService.handleTitleDoubleClick();\n\t\t\t}));\n\t\t}\n\n\t\t// Document edited: indicate for dirty working copies\n\t\tthis._register(this.workingCopyService.onDidChangeDirty(workingCopy => {\n\t\t\tconst gotDirty = workingCopy.isDirty();\n\t\t\tif (gotDirty && !(workingCopy.capabilities & WorkingCopyCapabilities.Untitled) && this.filesConfigurationService.getAutoSaveMode() === AutoSaveMode.AFTER_SHORT_DELAY) {\n\t\t\t\treturn; // do not indicate dirty of working copies that are auto saved after short delay\n\t\t\t}\n\n\t\t\tthis.updateDocumentEdited(gotDirty ? true : undefined);\n\t\t}));\n\n\t\tthis.updateDocumentEdited(undefined);\n\n\t\t// Detect minimize / maximize\n\t\tthis._register(Event.any(\n\t\t\tEvent.map(Event.filter(this.nativeHostService.onDidMaximizeWindow, id => id === this.nativeHostService.windowId), () => true),\n\t\t\tEvent.map(Event.filter(this.nativeHostService.onDidUnmaximizeWindow, id => id === this.nativeHostService.windowId), () => false)\n\t\t)(e => this.onDidChangeWindowMaximized(e)));\n\n\t\tthis.onDidChangeWindowMaximized(this.environmentService.window.maximized ?? false);\n\n\t\t// Detect panel position to determine minimum width\n\t\tthis._register(this.layoutService.onDidChangePanelPosition(pos => this.onDidChangePanelPosition(positionFromString(pos))));\n\t\tthis.onDidChangePanelPosition(this.layoutService.getPanelPosition());\n\n\t\t// Lifecycle\n\t\tthis._register(this.lifecycleService.onBeforeShutdown(e => this.onBeforeShutdown(e)));\n\t\tthis._register(this.lifecycleService.onBeforeShutdownError(e => this.onBeforeShutdownError(e)));\n\t\tthis._register(this.lifecycleService.onWillShutdown(e => this.onWillShutdown(e)));\n\t}\n\n\tprivate onBeforeShutdown({ veto, reason }: BeforeShutdownEvent): void {\n\t\tif (reason === ShutdownReason.CLOSE) {\n\t\t\tconst confirmBeforeCloseSetting = this.configurationService.getValue<'always' | 'never' | 'keyboardOnly'>('window.confirmBeforeClose');\n\n\t\t\tconst confirmBeforeClose = confirmBeforeCloseSetting === 'always' || (confirmBeforeCloseSetting === 'keyboardOnly' && ModifierKeyEmitter.getInstance().isModifierPressed);\n\t\t\tif (confirmBeforeClose) {\n\n\t\t\t\t// When we need to confirm on close or quit, veto the shutdown\n\t\t\t\t// with a long running promise to figure out whether shutdown\n\t\t\t\t// can proceed or not.\n\n\t\t\t\treturn veto((async () => {\n\t\t\t\t\tlet actualReason: ShutdownReason = reason;\n\t\t\t\t\tif (reason === ShutdownReason.CLOSE && !isMacintosh) {\n\t\t\t\t\t\tconst windowCount = await this.nativeHostService.getWindowCount();\n\t\t\t\t\t\tif (windowCount === 1) {\n\t\t\t\t\t\t\tactualReason = ShutdownReason.QUIT; // Windows/Linux: closing last window means to QUIT\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tlet confirmed = true;\n\t\t\t\t\tif (confirmBeforeClose) {\n\t\t\t\t\t\tconfirmed = await this.instantiationService.invokeFunction(accessor => NativeWindow.confirmOnShutdown(accessor, actualReason));\n\t\t\t\t\t}\n\n\t\t\t\t\t// Progress for long running shutdown\n\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\tthis.progressOnBeforeShutdown(reason);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn !confirmed;\n\t\t\t\t})(), 'veto.confirmBeforeClose');\n\t\t\t}\n\t\t}\n\n\t\t// Progress for long running shutdown\n\t\tthis.progressOnBeforeShutdown(reason);\n\t}\n\n\tprivate progressOnBeforeShutdown(reason: ShutdownReason): void {\n\t\tthis.progressService.withProgress({\n\t\t\tlocation: ProgressLocation.Window, \t// use window progress to not be too annoying about this operation\n\t\t\tdelay: 800,\t\t\t\t\t\t\t// delay so that it only appears when operation takes a long time\n\t\t\ttitle: this.toShutdownLabel(reason, false),\n\t\t}, () => {\n\t\t\treturn Event.toPromise(Event.any(\n\t\t\t\tthis.lifecycleService.onWillShutdown, \t// dismiss this dialog when we shutdown\n\t\t\t\tthis.lifecycleService.onShutdownVeto, \t// or when shutdown was vetoed\n\t\t\t\tthis.dialogService.onWillShowDialog\t\t// or when a dialog asks for input\n\t\t\t));\n\t\t});\n\t}\n\n\tstatic async confirmOnShutdown(accessor: ServicesAccessor, reason: ShutdownReason): Promise<boolean> {\n\t\tconst dialogService = accessor.get(IDialogService);\n\t\tconst configurationService = accessor.get(IConfigurationService);\n\n\t\tconst message = reason === ShutdownReason.QUIT ?\n\t\t\t(isMacintosh ? localize('quitMessageMac', \"Are you sure you want to quit?\") : localize('quitMessage', \"Are you sure you want to exit?\")) :\n\t\t\tlocalize('closeWindowMessage', \"Are you sure you want to close the window?\");\n\t\tconst primaryButton = reason === ShutdownReason.QUIT ?\n\t\t\t(isMacintosh ? localize({ key: 'quitButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Quit\") : localize({ key: 'exitButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Exit\")) :\n\t\t\tlocalize({ key: 'closeWindowButtonLabel', comment: ['&& denotes a mnemonic'] }, \"&&Close Window\");\n\n\t\tconst res = await dialogService.confirm({\n\t\t\tmessage,\n\t\t\tprimaryButton,\n\t\t\tcheckbox: {\n\t\t\t\tlabel: localize('doNotAskAgain', \"Do not ask me again\")\n\t\t\t}\n\t\t});\n\n\t\t// Update setting if checkbox checked\n\t\tif (res.checkboxChecked) {\n\t\t\tawait configurationService.updateValue('window.confirmBeforeClose', 'never');\n\t\t}\n\n\t\treturn res.confirmed;\n\t}\n\n\tprivate onBeforeShutdownError({ error, reason }: BeforeShutdownErrorEvent): void {\n\t\tthis.dialogService.error(this.toShutdownLabel(reason, true), localize('shutdownErrorDetail', \"Error: {0}\", toErrorMessage(error)));\n\t}\n\n\tprivate onWillShutdown({ reason, force, joiners }: WillShutdownEvent): void {\n\n\t\t// Delay so that the dialog only appears after timeout\n\t\tconst shutdownDialogScheduler = new RunOnceScheduler(() => {\n\t\t\tconst pendingJoiners = joiners();\n\n\t\t\tthis.progressService.withProgress({\n\t\t\t\tlocation: ProgressLocation.Dialog, \t\t\t\t// use a dialog to prevent the user from making any more interactions now\n\t\t\t\tbuttons: [this.toForceShutdownLabel(reason)],\t// allow to force shutdown anyway\n\t\t\t\tcancellable: false,\t\t\t\t\t\t\t\t// do not allow to cancel\n\t\t\t\tsticky: true,\t\t\t\t\t\t\t\t\t// do not allow to dismiss\n\t\t\t\ttitle: this.toShutdownLabel(reason, false),\n\t\t\t\tdetail: pendingJoiners.length > 0 ? localize('willShutdownDetail', \"The following operations are still running: \\n{0}\", pendingJoiners.map(joiner => `- ${joiner.label}`).join('\\n')) : undefined\n\t\t\t}, () => {\n\t\t\t\treturn Event.toPromise(this.lifecycleService.onDidShutdown); // dismiss this dialog when we actually shutdown\n\t\t\t}, () => {\n\t\t\t\tforce();\n\t\t\t});\n\t\t}, 1200);\n\t\tshutdownDialogScheduler.schedule();\n\n\t\t// Dispose scheduler when we actually shutdown\n\t\tEvent.once(this.lifecycleService.onDidShutdown)(() => shutdownDialogScheduler.dispose());\n\t}\n\n\tprivate toShutdownLabel(reason: ShutdownReason, isError: boolean): string {\n\t\tif (isError) {\n\t\t\tswitch (reason) {\n\t\t\t\tcase ShutdownReason.CLOSE:\n\t\t\t\t\treturn localize('shutdownErrorClose', \"An unexpected error prevented the window to close\");\n\t\t\t\tcase ShutdownReason.QUIT:\n\t\t\t\t\treturn localize('shutdownErrorQuit', \"An unexpected error prevented the application to quit\");\n\t\t\t\tcase ShutdownReason.RELOAD:\n\t\t\t\t\treturn localize('shutdownErrorReload', \"An unexpected error prevented the window to reload\");\n\t\t\t\tcase ShutdownReason.LOAD:\n\t\t\t\t\treturn localize('shutdownErrorLoad', \"An unexpected error prevented to change the workspace\");\n\t\t\t}\n\t\t}\n\n\t\tswitch (reason) {\n\t\t\tcase ShutdownReason.CLOSE:\n\t\t\t\treturn localize('shutdownTitleClose', \"Closing the window is taking a bit longer...\");\n\t\t\tcase ShutdownReason.QUIT:\n\t\t\t\treturn localize('shutdownTitleQuit', \"Quitting the application is taking a bit longer...\");\n\t\t\tcase ShutdownReason.RELOAD:\n\t\t\t\treturn localize('shutdownTitleReload', \"Reloading the window is taking a bit longer...\");\n\t\t\tcase ShutdownReason.LOAD:\n\t\t\t\treturn localize('shutdownTitleLoad', \"Changing the workspace is taking a bit longer...\");\n\t\t}\n\t}\n\n\tprivate toForceShutdownLabel(reason: ShutdownReason): string {\n\t\tswitch (reason) {\n\t\t\tcase ShutdownReason.CLOSE:\n\t\t\t\treturn localize('shutdownForceClose', \"Close Anyway\");\n\t\t\tcase ShutdownReason.QUIT:\n\t\t\t\treturn localize('shutdownForceQuit', \"Quit Anyway\");\n\t\t\tcase ShutdownReason.RELOAD:\n\t\t\t\treturn localize('shutdownForceReload', \"Reload Anyway\");\n\t\t\tcase ShutdownReason.LOAD:\n\t\t\t\treturn localize('shutdownForceLoad', \"Change Anyway\");\n\t\t}\n\t}\n\n\tprivate onWindowResize(e: UIEvent): void {\n\t\tif (e.target === window) {\n\t\t\tthis.layoutService.layout();\n\t\t}\n\t}\n\n\tprivate updateDocumentEdited(documentEdited: true | undefined): void {\n\t\tlet setDocumentEdited: boolean;\n\t\tif (typeof documentEdited === 'boolean') {\n\t\t\tsetDocumentEdited = documentEdited;\n\t\t} else {\n\t\t\tsetDocumentEdited = this.workingCopyService.hasDirty;\n\t\t}\n\n\t\tif ((!this.isDocumentedEdited && setDocumentEdited) || (this.isDocumentedEdited && !setDocumentEdited)) {\n\t\t\tthis.isDocumentedEdited = setDocumentEdited;\n\n\t\t\tthis.nativeHostService.setDocumentEdited(setDocumentEdited);\n\t\t}\n\t}\n\n\tprivate onDidChangeWindowMaximized(maximized: boolean): void {\n\t\tthis.layoutService.updateWindowMaximizedState(maximized);\n\t}\n\n\tprivate getWindowMinimumWidth(panelPosition: Position = this.layoutService.getPanelPosition()): number {\n\n\t\t// if panel is on the side, then return the larger minwidth\n\t\tconst panelOnSide = panelPosition === Position.LEFT || panelPosition === Position.RIGHT;\n\t\tif (panelOnSide) {\n\t\t\treturn WindowMinimumSize.WIDTH_WITH_VERTICAL_PANEL;\n\t\t}\n\n\t\treturn WindowMinimumSize.WIDTH;\n\t}\n\n\tprivate onDidChangePanelPosition(pos: Position): void {\n\t\tconst minWidth = this.getWindowMinimumWidth(pos);\n\n\t\tthis.nativeHostService.setMinimumSize(minWidth, undefined);\n\t}\n\n\tprivate onDidChangeVisibleEditors(): void {\n\n\t\t// Close when empty: check if we should close the window based on the setting\n\t\t// Overruled by: window has a workspace opened or this window is for extension development\n\t\t// or setting is disabled. Also enabled when running with --wait from the command line.\n\t\tconst visibleEditorPanes = this.editorService.visibleEditorPanes;\n\t\tif (visibleEditorPanes.length === 0 && this.contextService.getWorkbenchState() === WorkbenchState.EMPTY && !this.environmentService.isExtensionDevelopment) {\n\t\t\tconst closeWhenEmpty = this.configurationService.getValue('window.closeWhenEmpty');\n\t\t\tif (closeWhenEmpty || this.environmentService.args.wait) {\n\t\t\t\tthis.closeEmptyWindowScheduler.schedule();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onDidAllEditorsClose(): void {\n\t\tconst visibleEditorPanes = this.editorService.visibleEditorPanes.length;\n\t\tif (visibleEditorPanes === 0) {\n\t\t\tthis.nativeHostService.closeWindow();\n\t\t}\n\t}\n\n\tprivate updateWindowZoomLevel(): void {\n\t\tconst windowConfig = this.configurationService.getValue<IWindowsConfiguration>();\n\t\tconst windowZoomLevel = typeof windowConfig.window?.zoomLevel === 'number' ? windowConfig.window.zoomLevel : 0;\n\n\t\tif (getZoomLevel() !== windowZoomLevel) {\n\t\t\tapplyZoom(windowZoomLevel);\n\t\t}\n\t}\n\n\tprivate provideCustomTitleContextMenu(filePath: string | undefined): void {\n\n\t\t// Clear old menu\n\t\tthis.customTitleContextMenuDisposable.clear();\n\n\t\t// Provide new menu if a file is opened and we are on a custom title\n\t\tif (!filePath || getTitleBarStyle(this.configurationService) !== 'custom') {\n\t\t\treturn;\n\t\t}\n\n\t\t// Split up filepath into segments\n\t\tconst segments = filePath.split(posix.sep);\n\t\tfor (let i = segments.length; i > 0; i--) {\n\t\t\tconst isFile = (i === segments.length);\n\n\t\t\tlet pathOffset = i;\n\t\t\tif (!isFile) {\n\t\t\t\tpathOffset++; // for segments which are not the file name we want to open the folder\n\t\t\t}\n\n\t\t\tconst path = URI.file(segments.slice(0, pathOffset).join(posix.sep));\n\n\t\t\tlet label: string;\n\t\t\tif (!isFile) {\n\t\t\t\tlabel = this.labelService.getUriBasenameLabel(dirname(path));\n\t\t\t} else {\n\t\t\t\tlabel = this.labelService.getUriBasenameLabel(path);\n\t\t\t}\n\n\t\t\tconst commandId = `workbench.action.revealPathInFinder${i}`;\n\t\t\tthis.customTitleContextMenuDisposable.add(CommandsRegistry.registerCommand(commandId, () => this.nativeHostService.showItemInFolder(path.fsPath)));\n\t\t\tthis.customTitleContextMenuDisposable.add(MenuRegistry.appendMenuItem(MenuId.TitleBarTitleContext, { command: { id: commandId, title: label || posix.sep }, order: -i }));\n\t\t}\n\t}\n\n\tprivate create(): void {\n\n\t\t// Handle open calls\n\t\tthis.setupOpenHandlers();\n\n\t\t// Notify some services about lifecycle phases\n\t\tthis.lifecycleService.when(LifecyclePhase.Ready).then(() => this.nativeHostService.notifyReady());\n\t\tthis.lifecycleService.when(LifecyclePhase.Restored).then(() => {\n\t\t\tthis.sharedProcessService.notifyRestored();\n\t\t\tthis.utilityProcessWorkerWorkbenchService.notifyRestored();\n\t\t});\n\n\t\t// Check for situations that are worth warning the user about\n\t\tthis.handleWarnings();\n\n\t\t// Touchbar menu (if enabled)\n\t\tthis.updateTouchbarMenu();\n\n\t\t// Smoke Test Driver\n\t\tif (this.environmentService.enableSmokeTestDriver) {\n\t\t\tthis.setupDriver();\n\t\t}\n\t}\n\n\tprivate async handleWarnings(): Promise<void> {\n\n\t\t// Check for cyclic dependencies\n\t\tif (typeof require.hasDependencyCycle === 'function' && require.hasDependencyCycle()) {\n\t\t\tif (isCI) {\n\t\t\t\tthis.logService.error('Error: There is a dependency cycle in the AMD modules that needs to be resolved!');\n\t\t\t\tthis.nativeHostService.exit(37); // running on a build machine, just exit without showing a dialog\n\t\t\t} else {\n\t\t\t\tthis.dialogService.error(localize('loaderCycle', \"There is a dependency cycle in the AMD modules that needs to be resolved!\"));\n\t\t\t\tthis.nativeHostService.openDevTools();\n\t\t\t}\n\t\t}\n\n\t\t// After restored phase is fine for the following ones\n\t\tawait this.lifecycleService.when(LifecyclePhase.Restored);\n\n\t\t// Integrity / Root warning\n\t\t(async () => {\n\t\t\tconst isAdmin = await this.nativeHostService.isAdmin();\n\t\t\tconst { isPure } = await this.integrityService.isPure();\n\n\t\t\t// Update to title\n\t\t\tthis.titleService.updateProperties({ isPure, isAdmin });\n\n\t\t\t// Show warning message (unix only)\n\t\t\tif (isAdmin && !isWindows) {\n\t\t\t\tthis.notificationService.warn(localize('runningAsRoot', \"It is not recommended to run {0} as root user.\", this.productService.nameShort));\n\t\t\t}\n\t\t})();\n\n\t\t// Installation Dir Warning\n\t\tif (this.environmentService.isBuilt) {\n\t\t\tlet installLocationUri: URI;\n\t\t\tif (isMacintosh) {\n\t\t\t\t// appRoot = /Applications/Visual Studio Code - Insiders.app/Contents/Resources/app\n\t\t\t\tinstallLocationUri = dirname(dirname(dirname(URI.file(this.environmentService.appRoot))));\n\t\t\t} else {\n\t\t\t\t// appRoot = C:\\Users\\<name>\\AppData\\Local\\Programs\\Microsoft VS Code Insiders\\resources\\app\n\t\t\t\t// appRoot = /usr/share/code-insiders/resources/app\n\t\t\t\tinstallLocationUri = dirname(dirname(URI.file(this.environmentService.appRoot)));\n\t\t\t}\n\n\t\t\tfor (const folder of this.contextService.getWorkspace().folders) {\n\t\t\t\tif (this.uriIdentityService.extUri.isEqualOrParent(folder.uri, installLocationUri)) {\n\t\t\t\t\tthis.bannerService.show({\n\t\t\t\t\t\tid: 'appRootWarning.banner',\n\t\t\t\t\t\tmessage: localize('appRootWarning.banner', \"Files you store within the installation folder ('{0}') may be OVERWRITTEN or DELETED IRREVERSIBLY without warning at update time.\", this.labelService.getUriLabel(installLocationUri)),\n\t\t\t\t\t\ticon: Codicon.warning\n\t\t\t\t\t});\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Windows 32-bit warning\n\t\tif (isWindows && this.environmentService.os.arch === 'ia32') {\n\t\t\tconst message = localize('windows32eolmessage', \"You are running {0} 32-bit, which will soon stop receiving updates on Windows. Consider upgrading to the 64-bit build.\", this.productService.nameLong);\n\t\t\tconst actions = [{\n\t\t\t\tlabel: localize('windowseolBannerLearnMore', \"Learn More\"),\n\t\t\t\thref: 'https://aka.ms/vscode-faq-old-windows'\n\t\t\t}];\n\n\t\t\tthis.bannerService.show({\n\t\t\t\tid: 'windows32eol.banner',\n\t\t\t\tmessage,\n\t\t\t\tariaLabel: localize('windowseolarialabel', \"{0}. Use navigation keys to access banner actions.\", message),\n\t\t\t\tactions,\n\t\t\t\ticon: Codicon.warning\n\t\t\t});\n\n\t\t\tthis.notificationService.prompt(\n\t\t\t\tSeverity.Warning,\n\t\t\t\tmessage,\n\t\t\t\t[{\n\t\t\t\t\tlabel: localize('learnMore', \"Learn More\"),\n\t\t\t\t\trun: () => this.openerService.open(URI.parse('https://aka.ms/vscode-faq-old-windows'))\n\t\t\t\t}],\n\t\t\t\t{\n\t\t\t\t\tneverShowAgain: { id: 'windows32eol', isSecondary: true, scope: NeverShowAgainScope.APPLICATION },\n\t\t\t\t\tpriority: NotificationPriority.URGENT,\n\t\t\t\t\tsticky: true\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\t// macOS 10.13 and 10.14 warning\n\t\tif (isMacintosh) {\n\t\t\tconst majorVersion = this.environmentService.os.release.split('.')[0];\n\t\t\tconst eolReleases = new Map<string, string>([\n\t\t\t\t['17', 'macOS High Sierra'],\n\t\t\t\t['18', 'macOS Mojave'],\n\t\t\t]);\n\n\t\t\tif (eolReleases.has(majorVersion)) {\n\t\t\t\tconst message = localize('macoseolmessage', \"{0} on {1} will soon stop receiving updates. Consider upgrading your macOS version.\", this.productService.nameLong, eolReleases.get(majorVersion));\n\t\t\t\tconst actions = [{\n\t\t\t\t\tlabel: localize('macoseolBannerLearnMore', \"Learn More\"),\n\t\t\t\t\thref: 'https://aka.ms/vscode-faq-old-macOS'\n\t\t\t\t}];\n\n\t\t\t\tthis.bannerService.show({\n\t\t\t\t\tid: 'macoseol.banner',\n\t\t\t\t\tmessage,\n\t\t\t\t\tariaLabel: localize('macoseolarialabel', \"{0}. Use navigation keys to access banner actions.\", message),\n\t\t\t\t\tactions,\n\t\t\t\t\ticon: Codicon.warning\n\t\t\t\t});\n\n\t\t\t\tthis.notificationService.prompt(\n\t\t\t\t\tSeverity.Warning,\n\t\t\t\t\tmessage,\n\t\t\t\t\t[{\n\t\t\t\t\t\tlabel: localize('learnMore', \"Learn More\"),\n\t\t\t\t\t\trun: () => this.openerService.open(URI.parse('https://aka.ms/vscode-faq-old-macOS'))\n\t\t\t\t\t}],\n\t\t\t\t\t{\n\t\t\t\t\t\tneverShowAgain: { id: 'macoseol', isSecondary: true, scope: NeverShowAgainScope.APPLICATION },\n\t\t\t\t\t\tpriority: NotificationPriority.URGENT,\n\t\t\t\t\t\tsticky: true\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Slow shell environment progress indicator\n\t\tconst shellEnv = process.shellEnv();\n\t\tthis.progressService.withProgress({\n\t\t\ttitle: localize('resolveShellEnvironment', \"Resolving shell environment...\"),\n\t\t\tlocation: ProgressLocation.Window,\n\t\t\tdelay: 1600,\n\t\t\tbuttons: [localize('learnMore', \"Learn More\")]\n\t\t}, () => shellEnv, () => this.openerService.open('https://go.microsoft.com/fwlink/?linkid=2149667'));\n\t}\n\n\tprivate setupDriver(): void {\n\t\tconst that = this;\n\t\tlet pendingQuit = false;\n\n\t\tregisterWindowDriver(this.instantiationService, {\n\t\t\tasync exitApplication(): Promise<void> {\n\t\t\t\tif (pendingQuit) {\n\t\t\t\t\tthat.logService.info('[driver] not handling exitApplication() due to pending quit() call');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthat.logService.info('[driver] handling exitApplication()');\n\n\t\t\t\tpendingQuit = true;\n\t\t\t\treturn that.nativeHostService.quit();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate setupOpenHandlers(): void {\n\n\t\t// Block window.open() calls\n\t\twindow.open = function (): Window | null {\n\t\t\tthrow new Error('Prevented call to window.open(). Use IOpenerService instead!');\n\t\t};\n\n\t\t// Handle external open() calls\n\t\tthis.openerService.setDefaultExternalOpener({\n\t\t\topenExternal: async (href: string) => {\n\t\t\t\tconst success = await this.nativeHostService.openExternal(href);\n\t\t\t\tif (!success) {\n\t\t\t\t\tconst fileCandidate = URI.parse(href);\n\t\t\t\t\tif (fileCandidate.scheme === Schemas.file) {\n\t\t\t\t\t\t// if opening failed, and this is a file, we can still try to reveal it\n\t\t\t\t\t\tawait this.nativeHostService.showItemInFolder(fileCandidate.fsPath);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\n\t\t// Register external URI resolver\n\t\tthis.openerService.registerExternalUriResolver({\n\t\t\tresolveExternalUri: async (uri: URI, options?: OpenOptions) => {\n\t\t\t\tif (options?.allowTunneling) {\n\t\t\t\t\tconst portMappingRequest = extractLocalHostUriMetaDataForPortMapping(uri);\n\t\t\t\t\tif (portMappingRequest) {\n\t\t\t\t\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\t\t\t\t\tconst addressProvider: IAddressProvider | undefined = remoteAuthority ? {\n\t\t\t\t\t\t\tgetAddress: async (): Promise<IAddress> => {\n\t\t\t\t\t\t\t\treturn (await this.remoteAuthorityResolverService.resolveAuthority(remoteAuthority)).authority;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} : undefined;\n\t\t\t\t\t\tlet tunnel = await this.tunnelService.getExistingTunnel(portMappingRequest.address, portMappingRequest.port);\n\t\t\t\t\t\tif (!tunnel || (typeof tunnel === 'string')) {\n\t\t\t\t\t\t\ttunnel = await this.tunnelService.openTunnel(addressProvider, portMappingRequest.address, portMappingRequest.port);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (tunnel && (typeof tunnel !== 'string')) {\n\t\t\t\t\t\t\tconst constTunnel = tunnel;\n\t\t\t\t\t\t\tconst addressAsUri = URI.parse(constTunnel.localAddress);\n\t\t\t\t\t\t\tconst resolved = addressAsUri.scheme.startsWith(uri.scheme) ? addressAsUri : uri.with({ authority: constTunnel.localAddress });\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tresolved,\n\t\t\t\t\t\t\t\tdispose: () => constTunnel.dispose(),\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!options?.openExternal) {\n\t\t\t\t\tconst canHandleResource = await this.fileService.canHandleResource(uri);\n\t\t\t\t\tif (canHandleResource) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tresolved: URI.from({\n\t\t\t\t\t\t\t\tscheme: this.productService.urlProtocol,\n\t\t\t\t\t\t\t\tpath: 'workspace',\n\t\t\t\t\t\t\t\tquery: uri.toString()\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tdispose() { }\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate updateTouchbarMenu(): void {\n\t\tif (!isMacintosh) {\n\t\t\treturn; // macOS only\n\t\t}\n\n\t\t// Dispose old\n\t\tthis.touchBarDisposables.clear();\n\t\tthis.touchBarMenu = undefined;\n\n\t\t// Create new (delayed)\n\t\tconst scheduler: RunOnceScheduler = this.touchBarDisposables.add(new RunOnceScheduler(() => this.doUpdateTouchbarMenu(scheduler), 300));\n\t\tscheduler.schedule();\n\t}\n\n\tprivate doUpdateTouchbarMenu(scheduler: RunOnceScheduler): void {\n\t\tif (!this.touchBarMenu) {\n\t\t\tconst scopedContextKeyService = this.editorService.activeEditorPane?.scopedContextKeyService || this.editorGroupService.activeGroup.scopedContextKeyService;\n\t\t\tthis.touchBarMenu = this.menuService.createMenu(MenuId.TouchBarContext, scopedContextKeyService);\n\t\t\tthis.touchBarDisposables.add(this.touchBarMenu);\n\t\t\tthis.touchBarDisposables.add(this.touchBarMenu.onDidChange(() => scheduler.schedule()));\n\t\t}\n\n\t\tconst actions: Array<MenuItemAction | Separator> = [];\n\n\t\tconst disabled = this.configurationService.getValue('keyboard.touchbar.enabled') === false;\n\t\tconst touchbarIgnored = this.configurationService.getValue('keyboard.touchbar.ignored');\n\t\tconst ignoredItems = Array.isArray(touchbarIgnored) ? touchbarIgnored : [];\n\n\t\t// Fill actions into groups respecting order\n\t\tcreateAndFillInActionBarActions(this.touchBarMenu, undefined, actions);\n\n\t\t// Convert into command action multi array\n\t\tconst items: ICommandAction[][] = [];\n\t\tlet group: ICommandAction[] = [];\n\t\tif (!disabled) {\n\t\t\tfor (const action of actions) {\n\n\t\t\t\t// Command\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tif (ignoredItems.indexOf(action.item.id) >= 0) {\n\t\t\t\t\t\tcontinue; // ignored\n\t\t\t\t\t}\n\n\t\t\t\t\tgroup.push(action.item);\n\t\t\t\t}\n\n\t\t\t\t// Separator\n\t\t\t\telse if (action instanceof Separator) {\n\t\t\t\t\tif (group.length) {\n\t\t\t\t\t\titems.push(group);\n\t\t\t\t\t}\n\n\t\t\t\t\tgroup = [];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (group.length) {\n\t\t\t\titems.push(group);\n\t\t\t}\n\t\t}\n\n\t\t// Only update if the actions have changed\n\t\tif (!equals(this.lastInstalledTouchedBar, items)) {\n\t\t\tthis.lastInstalledTouchedBar = items;\n\t\t\tthis.nativeHostService.updateTouchBar(items);\n\t\t}\n\t}\n\n\tprivate onAddFoldersRequest(request: IAddFoldersRequest): void {\n\n\t\t// Buffer all pending requests\n\t\tthis.pendingFoldersToAdd.push(...request.foldersToAdd.map(folder => URI.revive(folder)));\n\n\t\t// Delay the adding of folders a bit to buffer in case more requests are coming\n\t\tif (!this.addFoldersScheduler.isScheduled()) {\n\t\t\tthis.addFoldersScheduler.schedule();\n\t\t}\n\t}\n\n\tprivate doAddFolders(): void {\n\t\tconst foldersToAdd: IWorkspaceFolderCreationData[] = [];\n\n\t\tfor (const folder of this.pendingFoldersToAdd) {\n\t\t\tfoldersToAdd.push(({ uri: folder }));\n\t\t}\n\n\t\tthis.pendingFoldersToAdd = [];\n\n\t\tthis.workspaceEditingService.addFolders(foldersToAdd);\n\t}\n\n\tprivate async onOpenFiles(request: INativeOpenFileRequest): Promise<void> {\n\t\tconst diffMode = !!(request.filesToDiff && (request.filesToDiff.length === 2));\n\t\tconst mergeMode = !!(request.filesToMerge && (request.filesToMerge.length === 4));\n\n\t\tconst inputs = coalesce(await pathsToEditors(mergeMode ? request.filesToMerge : diffMode ? request.filesToDiff : request.filesToOpenOrCreate, this.fileService, this.logService));\n\t\tif (inputs.length) {\n\t\t\tconst openedEditorPanes = await this.openResources(inputs, diffMode, mergeMode);\n\n\t\t\tif (request.filesToWait) {\n\n\t\t\t\t// In wait mode, listen to changes to the editors and wait until the files\n\t\t\t\t// are closed that the user wants to wait for. When this happens we delete\n\t\t\t\t// the wait marker file to signal to the outside that editing is done.\n\t\t\t\t// However, it is possible that opening of the editors failed, as such we\n\t\t\t\t// check for whether editor panes got opened and otherwise delete the marker\n\t\t\t\t// right away.\n\n\t\t\t\tif (openedEditorPanes.length) {\n\t\t\t\t\treturn this.trackClosedWaitFiles(URI.revive(request.filesToWait.waitMarkerFileUri), coalesce(request.filesToWait.paths.map(path => URI.revive(path.fileUri))));\n\t\t\t\t} else {\n\t\t\t\t\treturn this.fileService.del(URI.revive(request.filesToWait.waitMarkerFileUri));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async trackClosedWaitFiles(waitMarkerFile: URI, resourcesToWaitFor: URI[]): Promise<void> {\n\n\t\t// Wait for the resources to be closed in the text editor...\n\t\tawait this.instantiationService.invokeFunction(accessor => whenEditorClosed(accessor, resourcesToWaitFor));\n\n\t\t// ...before deleting the wait marker file\n\t\tawait this.fileService.del(waitMarkerFile);\n\t}\n\n\tprivate async openResources(resources: Array<IResourceEditorInput | IUntitledTextResourceEditorInput>, diffMode: boolean, mergeMode: boolean): Promise<readonly IEditorPane[]> {\n\t\tconst editors: IUntypedEditorInput[] = [];\n\n\t\tif (mergeMode && isResourceEditorInput(resources[0]) && isResourceEditorInput(resources[1]) && isResourceEditorInput(resources[2]) && isResourceEditorInput(resources[3])) {\n\t\t\tconst mergeEditor: IResourceMergeEditorInput = {\n\t\t\t\tinput1: { resource: resources[0].resource },\n\t\t\t\tinput2: { resource: resources[1].resource },\n\t\t\t\tbase: { resource: resources[2].resource },\n\t\t\t\tresult: { resource: resources[3].resource },\n\t\t\t\toptions: { pinned: true }\n\t\t\t};\n\t\t\teditors.push(mergeEditor);\n\t\t} else if (diffMode && isResourceEditorInput(resources[0]) && isResourceEditorInput(resources[1])) {\n\t\t\tconst diffEditor: IResourceDiffEditorInput = {\n\t\t\t\toriginal: { resource: resources[0].resource },\n\t\t\t\tmodified: { resource: resources[1].resource },\n\t\t\t\toptions: { pinned: true }\n\t\t\t};\n\t\t\teditors.push(diffEditor);\n\t\t} else {\n\t\t\teditors.push(...resources);\n\t\t}\n\n\t\treturn this.editorService.openEditors(editors, undefined, { validateTrust: true });\n\t}\n}\n"]}