{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/electron-sandbox/parts/titlebar/titlebarPart.ts"],"names":[],"mappings":"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","file":"titlebarPart.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getZoomFactor, isWCOEnabled } from 'vs/base/browser/browser';\nimport { $, addDisposableListener, append, EventType, hide, show } from 'vs/base/browser/dom';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IConfigurationService, IConfigurationChangeEvent } from 'vs/platform/configuration/common/configuration';\nimport { IStorageService } from 'vs/platform/storage/common/storage';\nimport { INativeWorkbenchEnvironmentService } from 'vs/workbench/services/environment/electron-sandbox/environmentService';\nimport { IHostService } from 'vs/workbench/services/host/browser/host';\nimport { isMacintosh, isWindows, isLinux, isNative } from 'vs/base/common/platform';\nimport { MenuId } from 'vs/platform/actions/common/actions';\nimport { TitlebarPart as BrowserTitleBarPart } from 'vs/workbench/browser/parts/titlebar/titlebarPart';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { IWorkbenchLayoutService } from 'vs/workbench/services/layout/browser/layoutService';\nimport { INativeHostService } from 'vs/platform/native/common/native';\nimport { getTitleBarStyle, useWindowControlsOverlay } from 'vs/platform/window/common/window';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { ThemeIcon } from 'vs/base/common/themables';\nimport { NativeMenubarControl } from 'vs/workbench/electron-sandbox/parts/titlebar/menubarControl';\nimport { IHoverService } from 'vs/workbench/services/hover/browser/hover';\n\nexport class TitlebarPart extends BrowserTitleBarPart {\n\tprivate maxRestoreControl: HTMLElement | undefined;\n\tprivate resizer: HTMLElement | undefined;\n\tprivate cachedWindowControlStyles: { bgColor: string; fgColor: string } | undefined;\n\tprivate cachedWindowControlHeight: number | undefined;\n\n\tprivate isBigSurOrNewer(): boolean {\n\t\tconst osVersion = this.environmentService.os.release;\n\t\treturn parseFloat(osVersion) >= 20;\n\t}\n\n\tprivate getMacTitlebarSize() {\n\t\tif (this.isBigSurOrNewer()) { // Big Sur increases title bar height\n\t\t\treturn 28;\n\t\t}\n\n\t\treturn 22;\n\t}\n\n\toverride get minimumHeight(): number {\n\t\tif (!isMacintosh) {\n\t\t\treturn super.minimumHeight;\n\t\t}\n\n\t\treturn (this.isCommandCenterVisible ? 35 : this.getMacTitlebarSize()) / (this.useCounterZoom ? getZoomFactor() : 1);\n\t}\n\toverride get maximumHeight(): number { return this.minimumHeight; }\n\n\tprotected override readonly environmentService: INativeWorkbenchEnvironmentService;\n\n\tconstructor(\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@INativeWorkbenchEnvironmentService environmentService: INativeWorkbenchEnvironmentService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IWorkbenchLayoutService layoutService: IWorkbenchLayoutService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IHostService hostService: IHostService,\n\t\t@INativeHostService private readonly nativeHostService: INativeHostService,\n\t\t@IHoverService hoverService: IHoverService,\n\t) {\n\t\tsuper(contextMenuService, configurationService, environmentService, instantiationService, themeService, storageService, layoutService, contextKeyService, hostService, hoverService);\n\n\t\tthis.environmentService = environmentService;\n\t}\n\n\tprivate onUpdateAppIconDragBehavior(): void {\n\t\tconst setting = this.configurationService.getValue('window.doubleClickIconToClose');\n\t\tif (setting && this.appIcon) {\n\t\t\t(this.appIcon.style as any)['-webkit-app-region'] = 'no-drag';\n\t\t} else if (this.appIcon) {\n\t\t\t(this.appIcon.style as any)['-webkit-app-region'] = 'drag';\n\t\t}\n\t}\n\n\tprivate onDidChangeWindowMaximized(maximized: boolean): void {\n\t\tif (this.maxRestoreControl) {\n\t\t\tif (maximized) {\n\t\t\t\tthis.maxRestoreControl.classList.remove(...ThemeIcon.asClassNameArray(Codicon.chromeMaximize));\n\t\t\t\tthis.maxRestoreControl.classList.add(...ThemeIcon.asClassNameArray(Codicon.chromeRestore));\n\t\t\t} else {\n\t\t\t\tthis.maxRestoreControl.classList.remove(...ThemeIcon.asClassNameArray(Codicon.chromeRestore));\n\t\t\t\tthis.maxRestoreControl.classList.add(...ThemeIcon.asClassNameArray(Codicon.chromeMaximize));\n\t\t\t}\n\t\t}\n\n\t\tif (this.resizer) {\n\t\t\tif (maximized) {\n\t\t\t\thide(this.resizer);\n\t\t\t} else {\n\t\t\t\tshow(this.resizer);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onMenubarFocusChanged(focused: boolean): void {\n\t\tif ((isWindows || isLinux) && this.currentMenubarVisibility !== 'compact' && this.dragRegion) {\n\t\t\tif (focused) {\n\t\t\t\thide(this.dragRegion);\n\t\t\t} else {\n\t\t\t\tshow(this.dragRegion);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected override onMenubarVisibilityChanged(visible: boolean): void {\n\t\t// Hide title when toggling menu bar\n\t\tif ((isWindows || isLinux) && this.currentMenubarVisibility === 'toggle' && visible) {\n\t\t\t// Hack to fix issue #52522 with layered webkit-app-region elements appearing under cursor\n\t\t\tif (this.dragRegion) {\n\t\t\t\thide(this.dragRegion);\n\t\t\t\tsetTimeout(() => show(this.dragRegion!), 50);\n\t\t\t}\n\t\t}\n\n\t\tsuper.onMenubarVisibilityChanged(visible);\n\t}\n\n\tprotected override onConfigurationChanged(event: IConfigurationChangeEvent): void {\n\t\tsuper.onConfigurationChanged(event);\n\n\t\tif (event.affectsConfiguration('window.doubleClickIconToClose')) {\n\t\t\tif (this.appIcon) {\n\t\t\t\tthis.onUpdateAppIconDragBehavior();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected override installMenubar(): void {\n\t\tsuper.installMenubar();\n\n\t\tif (this.menubar) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.customMenubar) {\n\t\t\tthis._register(this.customMenubar.onFocusStateChange(e => this.onMenubarFocusChanged(e)));\n\t\t}\n\t}\n\n\tprotected override createContentArea(parent: HTMLElement): HTMLElement {\n\t\tconst ret = super.createContentArea(parent);\n\n\t\t// Native menu controller\n\t\tif (isMacintosh || getTitleBarStyle(this.configurationService) === 'native') {\n\t\t\tthis._register(this.instantiationService.createInstance(NativeMenubarControl));\n\t\t}\n\n\t\t// App Icon (Native Windows/Linux)\n\t\tif (this.appIcon) {\n\t\t\tthis.onUpdateAppIconDragBehavior();\n\n\t\t\tthis._register(addDisposableListener(this.appIcon, EventType.DBLCLICK, (e => {\n\t\t\t\tthis.nativeHostService.closeWindow();\n\t\t\t})));\n\t\t}\n\n\t\t// Window Controls (Native Windows/Linux)\n\t\tif (!isMacintosh && getTitleBarStyle(this.configurationService) !== 'native' && !isWCOEnabled() && this.primaryWindowControls) {\n\t\t\t// Minimize\n\t\t\tconst minimizeIcon = append(this.primaryWindowControls, $('div.window-icon.window-minimize' + ThemeIcon.asCSSSelector(Codicon.chromeMinimize)));\n\t\t\tthis._register(addDisposableListener(minimizeIcon, EventType.CLICK, e => {\n\t\t\t\tthis.nativeHostService.minimizeWindow();\n\t\t\t}));\n\n\t\t\t// Restore\n\t\t\tthis.maxRestoreControl = append(this.primaryWindowControls, $('div.window-icon.window-max-restore'));\n\t\t\tthis._register(addDisposableListener(this.maxRestoreControl, EventType.CLICK, async e => {\n\t\t\t\tconst maximized = await this.nativeHostService.isMaximized();\n\t\t\t\tif (maximized) {\n\t\t\t\t\treturn this.nativeHostService.unmaximizeWindow();\n\t\t\t\t}\n\n\t\t\t\treturn this.nativeHostService.maximizeWindow();\n\t\t\t}));\n\n\t\t\t// Close\n\t\t\tconst closeIcon = append(this.primaryWindowControls, $('div.window-icon.window-close' + ThemeIcon.asCSSSelector(Codicon.chromeClose)));\n\t\t\tthis._register(addDisposableListener(closeIcon, EventType.CLICK, e => {\n\t\t\t\tthis.nativeHostService.closeWindow();\n\t\t\t}));\n\n\t\t\t// Resizer\n\t\t\tthis.resizer = append(this.rootContainer, $('div.resizer'));\n\n\t\t\tthis._register(this.layoutService.onDidChangeWindowMaximized(maximized => this.onDidChangeWindowMaximized(maximized)));\n\t\t\tthis.onDidChangeWindowMaximized(this.layoutService.isWindowMaximized());\n\t\t}\n\n\t\t// Window System Context Menu\n\t\t// See https://github.com/electron/electron/issues/24893\n\t\tif (isWindows && getTitleBarStyle(this.configurationService) === 'custom') {\n\t\t\tthis._register(this.nativeHostService.onDidTriggerSystemContextMenu(({ windowId, x, y }) => {\n\t\t\t\tif (this.nativeHostService.windowId !== windowId) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst zoomFactor = getZoomFactor();\n\t\t\t\tthis.onContextMenu(new MouseEvent('mouseup', { clientX: x / zoomFactor, clientY: y / zoomFactor }), MenuId.TitleBarContext);\n\t\t\t}));\n\t\t}\n\n\t\treturn ret;\n\t}\n\n\toverride updateStyles(): void {\n\t\tsuper.updateStyles();\n\n\t\t// WCO styles only supported on Windows currently\n\t\tif (useWindowControlsOverlay(this.configurationService)) {\n\t\t\tif (!this.cachedWindowControlStyles ||\n\t\t\t\tthis.cachedWindowControlStyles.bgColor !== this.element.style.backgroundColor ||\n\t\t\t\tthis.cachedWindowControlStyles.fgColor !== this.element.style.color) {\n\t\t\t\tthis.nativeHostService.updateWindowControls({ backgroundColor: this.element.style.backgroundColor, foregroundColor: this.element.style.color });\n\t\t\t}\n\t\t}\n\t}\n\n\toverride layout(width: number, height: number): void {\n\t\tsuper.layout(width, height);\n\n\t\tif (useWindowControlsOverlay(this.configurationService) ||\n\t\t\t(isMacintosh && isNative && getTitleBarStyle(this.configurationService) === 'custom')) {\n\t\t\t// When the user goes into full screen mode, the height of the title bar becomes 0.\n\t\t\t// Instead, set it back to the default titlebar height for Catalina users\n\t\t\t// so that they can have the traffic lights rendered at the proper offset.\n\t\t\t// Ref https://github.com/microsoft/vscode/issues/159862\n\t\t\tconst newHeight = (height > 0 || this.isBigSurOrNewer()) ?\n\t\t\t\tMath.round(height * getZoomFactor()) : this.getMacTitlebarSize();\n\t\t\tif (newHeight !== this.cachedWindowControlHeight) {\n\t\t\t\tthis.cachedWindowControlHeight = newHeight;\n\t\t\t\tthis.nativeHostService.updateWindowControls({ height: newHeight });\n\t\t\t}\n\t\t}\n\t}\n}\n"]}