{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/browser/codeeditor.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;;IA4BzF,IAAM,IAAI,GAAV,MAAM,IAA0B,SAAQ,eAAG;;QASjD,YAA4B,CAAmC;YAC9D,KAAK,EAAE,CAAC;YADoC,MAAC,GAAD,CAAC,CAAiB;YAP9C,MAAC,GAAqB,IAAI,CAAC,CAAC,CAAS,IAAI,WAAG,EAAY,CAAC,CAAC;YAClE,uBAAkB,GAAG,IAAI,CAAC,CAAC,CAAmB,KAAK,CAAC;YAErD,MAAC,GAA2C,IAAI,CAAC;YACjD,MAAC,GAA4B,IAAI,CAAC;YACzB,MAAC,GAAmB,IAAI,CAAC,CAAC,CAAS,IAAI,eAAG,EAAc,CAAC,CAAC;QAI3E,CAAC;QAED,oBAAoB;YACnB,IAAI,IAAI,CAAC,CAAC,IAAS,IAAI,CAAC,CAAC,EAA2B;gBACnD,MAAM,YAAY,GAAG,IAAI,CAAC,CAAC,CAA0B;gBACrD,IAAI,CAAC,CAAC,CAAM,iBAAiB,CAAC,CAAC,QAAQ,EAAE,EAAE;oBAC1C,QAAQ,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC;gBACzC,CAAC,CAAC,CAAC;gBACH,IAAI,CAAC,CAAC,CAAmB,IAAI,EAAE,CAAC;aAChC;YAED,IAAI,CAAC,CAAC,GAA4B,IAAI,CAAC;QACxC,CAAC;QAED,cAAc,CAAC,KAAgC,EAAE,MAAY;YAC5D,MAAM,GAAG,MAAM,IAAI,IAAI,CAAC,CAAC,CAAS,KAAK,CAAC,CAAC;YACzC,IAAI,IAAA,mBAAG,EAAU,MAAM,CAAC,EAAE;gBACzB,IAAI,CAAC,CAAC,CAAgB,MAAM,EAAE,KAAK,CAAC,CAAC;aACrC;iBAAM,IAAI,IAAA,mBAAG,EAAe,MAAM,CAAC,IAAI,IAAA,mBAAG,EAAU,MAAM,CAAC,gBAAgB,CAAC,EAAE;gBAC9E,IAAI,CAAC,CAAC,CAAgB,MAAM,CAAC,gBAAgB,EAAE,KAAK,CAAC,CAAC;aACtD;QACF,CAAC;QAEO,CAAC,CAAgB,MAAmB,EAAE,cAAyC;YACtF,IAAI,CAAC,oBAAoB,EAAE,CAAC;YAE5B,MAAM,CAAC,iBAAiB,CAAC,CAAC,cAA+C,EAAE,EAAE;gBAC5E,IAAI,CAAC,CAAC,GAA4B,cAAc,CAAC,aAAa,CAAC,cAAc,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAA8B,cAAc,CAAC,WAAW,CAAC,CAAC,CAAC;YACvJ,CAAC,CAAC,CAAC;YAEH,IAAI,CAAC,CAAC,CAAS,MAAM,CAAC,CAAC;QACxB,CAAC;QAEO,CAAC,CAAS,aAAwC;YACzD,MAAM,QAAQ,GAAG,IAAI,CAAC,CAAC,CAAa,YAAY,EAAE,QAAQ,CAAC;YAC3D,IAAI,QAAQ,IAAI,IAAA,eAAG,EAAK,QAAQ,EAAE,aAAa,CAAC,QAAQ,CAAC,IAAI,IAAA,mBAAG,EAAU,IAAI,CAAC,CAAC,CAAa,uBAAuB,CAAC,EAAE;gBACtH,OAAO,IAAI,CAAC,CAAC,CAAa,uBAAuB,CAAC;aAClD;YAED,OAAO,SAAS,CAAC;QAClB,CAAC;QAEO,CAAC,CAAS,MAAmB;YACpC,IAAI,IAAI,CAAC,CAAC,KAAU,MAAM,EAAE;gBAC3B,IAAI,CAAC,CAAC,CAAiB,KAAK,EAAE,CAAC;gBAC/B,IAAI,CAAC,CAAC,GAAQ,MAAM,CAAC;gBACrB,IAAI,CAAC,CAAC,CAAiB,GAAG,CAAC,IAAI,CAAC,CAAC,CAAM,yBAAyB,CAAC,CAAC,CAA8B,EAAE,EAAE;oBACnG,IACC,CAAC,CAAC,MAAM,sCAA8B;2BACnC,CAAC,CAAC,MAAM,wCAAgC;2BACxC,CAAC,CAAC,MAAM,oCAA4B;2BACpC,CAAC,CAAC,MAAM,oCAA4B,EACtC;wBACD,IAAI,CAAC,oBAAoB,EAAE,CAAC;qBAC5B;gBACF,CAAC,CAAC,CAAC,CAAC;gBACJ,IAAI,CAAC,CAAC,CAAiB,GAAG,CAAC,IAAI,CAAC,CAAC,CAAM,gBAAgB,CAAC,GAAG,EAAE,GAAG,IAAI,CAAC,oBAAoB,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;gBACjG,IAAI,CAAC,CAAC,CAAiB,GAAG,CAAC,IAAI,CAAC,CAAC,CAAM,YAAY,CAAC,GAAG,EAAE;oBACxD,IAAI,CAAC,oBAAoB,EAAE,CAAC;oBAC5B,IAAI,CAAC,CAAC,GAAQ,IAAI,CAAC;gBACpB,CAAC,CAAC,CAAC,CAAC;aACJ;QACF,CAAC;iBAEuB,MAAC,GAA6B,eAAG,CAAoB,QAAQ,CAAC;YACrF,WAAW,EAAE,kCAAkC;YAC/C,UAAU,4DAAoD;YAC9D,SAAS,EAAE,gBAAgB;YAC3B,WAAW,EAAE,IAAI;SACjB,CALwB,AAKvB,CAAC;iBAEqB,MAAC,GAAkB,eAAG,CAAoB,QAAQ,CAAC;YAC1E,WAAW,EAAE,4BAA4B;YACzC,UAAU,4DAAoD;YAC9D,SAAS,EAAE,gBAAgB;SAC3B,CAJwB,AAIvB,CAAC;QAEK,CAAC,CAA8B,cAAuB,IAAI;YACjE,OAAO,CAAC,WAAW,CAAC,CAAC,CAAC,MAAI,CAAsB,CAAC,CAA2B,CAAC,CAAC,MAAI,CAAsB,CAAC,CAAgB,CAAC;QAC3H,CAAC;QAEQ,OAAO;YACf,KAAK,CAAC,OAAO,EAAE,CAAC;YAEhB,IAAI,IAAI,CAAC,CAAC,EAAO,QAAQ,EAAE,EAAE;gBAC5B,IAAI,CAAC,oBAAoB,EAAE,CAAC;gBAC5B,IAAI,CAAC,CAAC,GAAQ,IAAI,CAAC;aACnB;QACF,CAAC;;IAnGW,oBAAI;mBAAJ,IAAI;QASH,WAAA,mBAAG,CAAA;OATJ,IAAI,CAoGhB;IAEM,IAAM,IAAI,GAAV,MAAM,IAA0B,SAAQ,mBAAI;QAElD,YACS,CAAmB,EAC3B,KAAa,EACb,gBAA+B,EACX,iBAAsB;YAE1C,KAAK,CACJ,gBAAgB,IAAI,iBAAiB,CAAC,gBAAgB,CAAC,gBAAgB,CAAC;gBACvE,CAAC,CAAC,GAAG,KAAK,KAAK,iBAAiB,CAAC,gBAAgB,CAAC,gBAAgB,CAAE,CAAC,QAAQ,EAAE,GAAG;gBAClF,CAAC,CAAC,KAAK,CACR,CAAC;YATM,MAAC,GAAD,CAAC,CAAkB;QAU5B,CAAC;QAED,KAAK;YACJ,OAAO,0CAA0C,CAAC;QACnD,CAAC;QAED,WAAW;YACV,OAAO;gBACN,UAAU,6DAAqD;aAC/D,CAAC;QACH,CAAC;QAEQ,MAAM;YACd,KAAK,CAAC,MAAM,EAAE,CAAC;YACf,IAAI,CAAC,CAAC,CAAM,gBAAgB,CAAC,IAAI,CAAC,CAAC;QACpC,CAAC;QAEQ,OAAO;YACf,IAAI,CAAC,CAAC,CAAM,mBAAmB,CAAC,IAAI,CAAC,CAAC;YACtC,KAAK,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;KAED,CAAA;IAnCY,oBAAI;mBAAJ,IAAI;QAMd,WAAA,gBAAG,CAAA;OANO,IAAI,CAmChB;IAEM,IAAM,IAAI,GAAV,MAAM,IAAwB,SAAQ,mBAAI;iBAChC,OAAE,GAAG,kCAAH,AAAqC,CAAC;QAExD,YACkB,CAAmB,EACI,CAAyB,EACnD,WAAgB,EACV,iBAAsB;YAE1C,KAAK,CAAC,aAAG,CAAI,aAAa,EAAE,WAAW,EAAE,iBAAiB,CAAC,CAAC;YAL3C,MAAC,GAAD,CAAC,CAAkB;YACI,MAAC,GAAD,CAAC,CAAwB;YAKjE,IAAI,CAAC,CAAC,EAAO,CAAC;QACf,CAAC;QAEkB,CAAC,CAAY,MAAe;YAC9C,OAAO,IAAI,CAAC,CAAC,CAAoB,cAAc,CAAC,IAAI,EAAuB,IAAI,CAAC,CAAC,EAAO,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,EAAE,CAAC,CAAC;QAClH,CAAC;QAEkB,CAAC;YACnB,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,YAAiB,8BAAG,CAAsB,IAAI,IAAI,CAAC,CAAC,EAAO,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,CAAM,SAAS,oCAA2B,CAAC;QAC3I,CAAC;QAEkB,CAAC;YACnB,OAAO,IAAI,CAAC,CAAC,CAAM,QAAQ,EAAE,EAAE,GAAG,CAAC;QACpC,CAAC;;IAvBW,oBAAI;mBAAJ,IAAI;QAKd,WAAA,mBAAG,CAAA;QACH,WAAA,aAAG,CAAA;QACH,WAAA,gBAAG,CAAA;OAPO,IAAI,CAwBhB","file":"codeeditor.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAction } from 'vs/base/common/actions';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { isEqual } from 'vs/base/common/resources';\nimport { URI } from 'vs/base/common/uri';\nimport { ICodeEditor, IOverlayWidget, IOverlayWidgetPosition, OverlayWidgetPositionPreference, isCodeEditor, isCompositeEditor } from 'vs/editor/browser/editorBrowser';\nimport { EmbeddedCodeEditorWidget } from 'vs/editor/browser/widget/embeddedCodeEditorWidget';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { CursorChangeReason, ICursorPositionChangedEvent } from 'vs/editor/common/cursorEvents';\nimport { IEditorContribution } from 'vs/editor/common/editorCommon';\nimport { IModelDecorationsChangeAccessor, TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { AbstractFloatingClickMenu, FloatingClickWidget } from 'vs/platform/actions/browser/floatingMenu';\nimport { IMenuService, MenuId } from 'vs/platform/actions/common/actions';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\n\nexport interface IRangeHighlightDecoration {\n\tresource: URI;\n\trange: IRange;\n\tisWholeLine?: boolean;\n}\n\nexport class RangeHighlightDecorations extends Disposable {\n\n\tprivate readonly _onHighlightRemoved = this._register(new Emitter<void>());\n\treadonly onHighlightRemoved = this._onHighlightRemoved.event;\n\n\tprivate rangeHighlightDecorationId: string | null = null;\n\tprivate editor: ICodeEditor | null = null;\n\tprivate readonly editorDisposables = this._register(new DisposableStore());\n\n\tconstructor(@IEditorService private readonly editorService: IEditorService) {\n\t\tsuper();\n\t}\n\n\tremoveHighlightRange() {\n\t\tif (this.editor && this.rangeHighlightDecorationId) {\n\t\t\tconst decorationId = this.rangeHighlightDecorationId;\n\t\t\tthis.editor.changeDecorations((accessor) => {\n\t\t\t\taccessor.removeDecoration(decorationId);\n\t\t\t});\n\t\t\tthis._onHighlightRemoved.fire();\n\t\t}\n\n\t\tthis.rangeHighlightDecorationId = null;\n\t}\n\n\thighlightRange(range: IRangeHighlightDecoration, editor?: any) {\n\t\teditor = editor ?? this.getEditor(range);\n\t\tif (isCodeEditor(editor)) {\n\t\t\tthis.doHighlightRange(editor, range);\n\t\t} else if (isCompositeEditor(editor) && isCodeEditor(editor.activeCodeEditor)) {\n\t\t\tthis.doHighlightRange(editor.activeCodeEditor, range);\n\t\t}\n\t}\n\n\tprivate doHighlightRange(editor: ICodeEditor, selectionRange: IRangeHighlightDecoration) {\n\t\tthis.removeHighlightRange();\n\n\t\teditor.changeDecorations((changeAccessor: IModelDecorationsChangeAccessor) => {\n\t\t\tthis.rangeHighlightDecorationId = changeAccessor.addDecoration(selectionRange.range, this.createRangeHighlightDecoration(selectionRange.isWholeLine));\n\t\t});\n\n\t\tthis.setEditor(editor);\n\t}\n\n\tprivate getEditor(resourceRange: IRangeHighlightDecoration): ICodeEditor | undefined {\n\t\tconst resource = this.editorService.activeEditor?.resource;\n\t\tif (resource && isEqual(resource, resourceRange.resource) && isCodeEditor(this.editorService.activeTextEditorControl)) {\n\t\t\treturn this.editorService.activeTextEditorControl;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate setEditor(editor: ICodeEditor) {\n\t\tif (this.editor !== editor) {\n\t\t\tthis.editorDisposables.clear();\n\t\t\tthis.editor = editor;\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeCursorPosition((e: ICursorPositionChangedEvent) => {\n\t\t\t\tif (\n\t\t\t\t\te.reason === CursorChangeReason.NotSet\n\t\t\t\t\t|| e.reason === CursorChangeReason.Explicit\n\t\t\t\t\t|| e.reason === CursorChangeReason.Undo\n\t\t\t\t\t|| e.reason === CursorChangeReason.Redo\n\t\t\t\t) {\n\t\t\t\t\tthis.removeHighlightRange();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeModel(() => { this.removeHighlightRange(); }));\n\t\t\tthis.editorDisposables.add(this.editor.onDidDispose(() => {\n\t\t\t\tthis.removeHighlightRange();\n\t\t\t\tthis.editor = null;\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate static readonly _WHOLE_LINE_RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tdescription: 'codeeditor-range-highlight-whole',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight',\n\t\tisWholeLine: true\n\t});\n\n\tprivate static readonly _RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tdescription: 'codeeditor-range-highlight',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight'\n\t});\n\n\tprivate createRangeHighlightDecoration(isWholeLine: boolean = true): ModelDecorationOptions {\n\t\treturn (isWholeLine ? RangeHighlightDecorations._WHOLE_LINE_RANGE_HIGHLIGHT : RangeHighlightDecorations._RANGE_HIGHLIGHT);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tif (this.editor?.getModel()) {\n\t\t\tthis.removeHighlightRange();\n\t\t\tthis.editor = null;\n\t\t}\n\t}\n}\n\nexport class FloatingEditorClickWidget extends FloatingClickWidget implements IOverlayWidget {\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\tlabel: string,\n\t\tkeyBindingAction: string | null,\n\t\t@IKeybindingService keybindingService: IKeybindingService\n\t) {\n\t\tsuper(\n\t\t\tkeyBindingAction && keybindingService.lookupKeybinding(keyBindingAction)\n\t\t\t\t? `${label} (${keybindingService.lookupKeybinding(keyBindingAction)!.getLabel()})`\n\t\t\t\t: label\n\t\t);\n\t}\n\n\tgetId(): string {\n\t\treturn 'editor.overlayWidget.floatingClickWidget';\n\t}\n\n\tgetPosition(): IOverlayWidgetPosition {\n\t\treturn {\n\t\t\tpreference: OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER\n\t\t};\n\t}\n\n\toverride render() {\n\t\tsuper.render();\n\t\tthis.editor.addOverlayWidget(this);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.editor.removeOverlayWidget(this);\n\t\tsuper.dispose();\n\t}\n\n}\n\nexport class FloatingEditorClickMenu extends AbstractFloatingClickMenu implements IEditorContribution {\n\tstatic readonly ID = 'editor.contrib.floatingClickMenu';\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper(MenuId.EditorContent, menuService, contextKeyService);\n\t\tthis.render();\n\t}\n\n\tprotected override createWidget(action: IAction): FloatingClickWidget {\n\t\treturn this.instantiationService.createInstance(FloatingEditorClickWidget, this.editor, action.label, action.id);\n\t}\n\n\tprotected override isVisible() {\n\t\treturn !(this.editor instanceof EmbeddedCodeEditorWidget) && this.editor?.hasModel() && !this.editor.getOption(EditorOption.inDiffEditor);\n\t}\n\n\tprotected override getActionArg(): unknown {\n\t\treturn this.editor.getModel()?.uri;\n\t}\n}\n"]}