{"version":3,"sources":["vs/workbench/browser/parts/titlebar/commandCenterControl.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;;IAmBzF,IAAM,IAAI,GAAV,MAAM,IAAI;QAShB,YACC,WAAiB,EACjB,aAA6B,EACN,oBAAyB,EAC5B,iBAAsB,EACtB,iBAAsB;YAZ1B,MAAC,GAAc,IAAI,eAAG,EAAc,CAAC;YAErC,MAAC,GAAwB,IAAI,WAAG,EAAY,CAAC;YACrD,0BAAqB,GAAgB,IAAI,CAAC,CAAC,CAAsB,KAAK,CAAC;YAEvE,YAAO,GAAgB,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAS7D,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC;YAE7C,MAAM,YAAY,GAAG,oBAAoB,CAAC,cAAc,CAAC,aAAG,EAAmB,IAAI,CAAC,OAAO,EAAE,aAAG,CAAI,aAAa,EAAE;gBAClH,WAAW,EAAE,aAAG,CAAI,eAAe;gBACnC,kBAAkB,mCAA2B;gBAC7C,cAAc,EAAE;oBACf,YAAY,EAAE,GAAG,EAAE,CAAC,IAAI;iBACxB;gBACD,eAAe,EAAE,eAAe;gBAChC,sBAAsB,EAAE,CAAC,MAAM,EAAE,EAAE;oBAClC,IAAI,MAAM,YAAY,aAAG,IAAkB,MAAM,CAAC,IAAI,CAAC,OAAO,KAAK,aAAG,CAAI,mBAAmB,EAAE;wBAC9F,OAAO,oBAAoB,CAAC,cAAc,CAAC,2BAA2B,EAAE,MAAM,EAAE,WAAW,EAAE,aAAa,EAAE,EAAE,CAAC,CAAC;qBAChH;yBAAM;wBACN,OAAO,IAAA,6BAAG,EAAkB,oBAAoB,EAAE,MAAM,EAAE,EAAE,aAAa,EAAE,CAAC,CAAC;qBAC7E;gBACF,CAAC;aACD,CAAC,CAAC;YAEH,IAAI,CAAC,CAAC,CAAY,GAAG,CAAC,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAc,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC;YACvF,IAAI,CAAC,CAAC,CAAY,GAAG,CAAC,iBAAiB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAc,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC;YACtF,IAAI,CAAC,CAAC,CAAY,GAAG,CAAC,YAAY,CAAC,CAAC;QACrC,CAAC;QAEO,CAAC,CAAc,IAAa;YACnC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC,CAAC;YAC7C,IAAI,CAAC,CAAC,CAAsB,IAAI,EAAE,CAAC;QACpC,CAAC;QAED,OAAO;YACN,IAAI,CAAC,CAAC,CAAY,OAAO,EAAE,CAAC;QAC7B,CAAC;KACD,CAAA;IA/CY,oBAAI;mBAAJ,IAAI;QAYd,WAAA,mBAAG,CAAA;QACH,WAAA,gBAAG,CAAA;QACH,WAAA,gBAAG,CAAA;OAdO,IAAI,CA+ChB;IAGD,IAAM,2BAA2B,GAAjC,MAAM,2BAA4B,SAAQ,qBAAG;;iBAEpB,MAAC,GAAqB,qCAArB,AAA0D,CAAC;QAEpF,YACkB,CAAa,EACb,CAAkB,EAClB,CAA8B,EAC/C,OAAmC,EACP,CAAuB,EACpB,CAAkB;YAEjD,KAAK,CAAC,SAAS,EAAE,CAAC,CAAQ,OAAO,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YAP9B,MAAC,GAAD,CAAC,CAAY;YACb,MAAC,GAAD,CAAC,CAAiB;YAClB,MAAC,GAAD,CAAC,CAA6B;YAEnB,MAAC,GAAD,CAAC,CAAsB;YACpB,MAAC,GAAD,CAAC,CAAiB;QAGlD,CAAC;QAEQ,MAAM,CAAC,SAAsB;YACrC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;YACxB,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,uBAAuB,CAAC,CAAC;YACjD,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,CAAC,CAAQ,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;YAE3E,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,CAAM,GAAG,CAAC,IAAA,oBAAG,EAAc,IAAI,CAAC,CAAC,EAAe,SAAS,EAAE,IAAI,CAAC,CAAC,EAAW,CAAC,CAAC,CAAC;YAEnG,mDAAmD;YACnD,IAAI,CAAC,CAAC,CAAM,GAAG,CAAC,IAAI,CAAC,CAAC,CAAY,WAAW,CAAC,GAAG,EAAE;gBAClD,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAW,CAAC,CAAC;YACjC,CAAC,CAAC,CAAC,CAAC;YAEJ,MAAM,MAAM,GAA2B,EAAE,CAAC;YAC1C,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,CAAC,CAAQ,OAAO,EAAE;gBAC3C,IAAI,MAAM,YAAY,aAAG,EAAY;oBACpC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;iBAC5B;qBAAM;oBACN,MAAM,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC;iBACtB;aACD;YAGD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACvC,MAAM,KAAK,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;gBAExB,iBAAiB;gBACjB,MAAM,OAAO,GAAG,IAAI,CAAC,CAAC,CAAa,cAAc,CAAC,aAAG,EAAe,SAAS,EAAE;oBAC9E,kBAAkB,oCAA2B;oBAC7C,eAAe,EAAE,qBAAqB;oBACtC,sBAAsB,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,EAAE;wBAC3C,OAAO,GAAG;4BACT,GAAG,OAAO;4BACV,aAAa,EAAE,IAAI,CAAC,CAAC;yBACrB,CAAC;wBAEF,IAAI,MAAM,CAAC,EAAE,KAAK,6BAA2B,CAAC,CAAC,EAAoB;4BAClE,OAAO,IAAA,6BAAG,EAAkB,IAAI,CAAC,CAAC,EAAc,MAAM,EAAE,OAAO,CAAC,CAAC;yBACjE;wBAED,MAAM,IAAI,GAAG,IAAI,CAAC;wBAElB,OAAO,IAAI,CAAC,CAAC,CAAa,cAAc,CAAC,MAAM,0BAA2B,SAAQ,qBAAG;4BAEpF;gCACC,KAAK,CAAC,SAAS,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC;4BACnC,CAAC;4BAEQ,MAAM,CAAC,SAAsB;gCACrC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;gCACxB,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,2BAA2B,CAAC,CAAC;gCAExD,MAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;gCAE3B,gBAAgB;gCAChB,MAAM,UAAU,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;gCAClD,UAAU,CAAC,SAAS,GAAG,MAAM,CAAC,KAAK,IAAI,EAAE,CAAC;gCAC1C,UAAU,CAAC,SAAS,CAAC,GAAG,CAAC,aAAa,CAAC,CAAC;gCAExC,sDAAsD;gCACtD,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,EAAU,CAAC;gCAC/B,MAAM,YAAY,GAAG,QAAQ,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;gCACpD,YAAY,CAAC,SAAS,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;gCAC3C,YAAY,CAAC,SAAS,GAAG,KAAK,CAAC;gCAC/B,IAAA,SAAG,EAAG,SAAS,EAAE,UAAU,EAAE,YAAY,CAAC,CAAC;gCAE3C,MAAM,KAAK,GAAG,IAAI,CAAC,CAAC,CAAM,GAAG,CAAC,IAAA,oBAAG,EAAc,IAAI,CAAC,CAAC,EAAe,SAAS,EAAE,IAAI,CAAC,CAAC,EAAW,CAAC,CAAC,CAAC;gCAEnG,mDAAmD;gCACnD,IAAI,CAAC,CAAC,CAAM,GAAG,CAAC,IAAI,CAAC,CAAC,CAAY,WAAW,CAAC,GAAG,EAAE;oCAClD,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,EAAW,CAAC,CAAC;oCAChC,YAAY,CAAC,SAAS,GAAG,IAAI,CAAC,CAAC,EAAU,CAAC;gCAC3C,CAAC,CAAC,CAAC,CAAC;4BACL,CAAC;4BAEkB,CAAC;gCACnB,OAAO,IAAI,CAAC,CAAC,EAAW,CAAC;4BAC1B,CAAC;4BAEO,CAAC;gCACR,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,GAAG,IAAI,CAAC,CAAC,CAAY,mBAAmB,EAAE,CAAC;gCACnE,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,CAAY,mBAAmB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAY,cAAc,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAY,aAAa,CAAC;gCAC3H,IAAI,CAAC,KAAK,EAAE;oCACX,KAAK,GAAG,IAAA,cAAQ,EAAC,CAAW,EAAE,IAAQ,CAAC,CAAC;iCACxC;gCACD,IAAI,MAAM,EAAE;oCACX,KAAK,GAAG,IAAA,cAAQ,EAAC,CAAQ,EAAE,IAAS,EAAE,MAAM,EAAE,KAAK,CAAC,CAAC;iCACrD;gCACD,IAAI,MAAM,EAAE;oCACX,KAAK,GAAG,IAAA,cAAQ,EAAC,CAAQ,EAAE,IAAS,EAAE,KAAK,EAAE,MAAM,CAAC,CAAC;iCACrD;gCACD,OAAO,KAAK,CAAC;4BACd,CAAC;yBACD,CAAC,CAAC;oBACJ,CAAC;iBACD,CAAC,CAAC;gBACH,OAAO,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;gBAC1B,IAAI,CAAC,CAAC,CAAM,GAAG,CAAC,OAAO,CAAC,CAAC;aACzB;QACF,CAAC;QAEkB,CAAC;YAEnB,4BAA4B;YAC5B,MAAM,EAAE,GAAG,IAAI,CAAC,CAAC,CAAkB,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE,QAAQ,EAAE,CAAC;YAChF,MAAM,KAAK,GAAG,EAAE;gBACf,CAAC,CAAC,IAAA,cAAQ,EAAC,CAAO,EAAE,IAA6B,EAAE,IAAI,CAAC,CAAC,CAAY,aAAa,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC,CAAY,KAAK,CAAC;gBAChH,CAAC,CAAC,IAAA,cAAQ,EAAC,CAAQ,EAAE,IAAuB,EAAE,IAAI,CAAC,CAAC,CAAY,aAAa,EAAE,IAAI,CAAC,CAAC,CAAY,KAAK,CAAC,CAAC;YAEzG,OAAO,KAAK,CAAC;QACd,CAAC;;IA5HI,2BAA2B;QAS9B,WAAA,gBAAG,CAAA;QACH,WAAA,mBAAG,CAAA;OAVA,2BAA2B,CA6HhC;IAED,aAAG,CAAU,cAAc,CAAC,aAAG,CAAI,aAAa,EAAE;QACjD,OAAO,EAAE,aAAG,CAAI,mBAAmB;QACnC,KAAK,EAAE,IAAA,cAAQ,EAAC,CAAQ,EAAE,IAAgB,CAAC;QAC3C,IAAI,EAAE,cAAG,CAAK,MAAM;QACpB,KAAK,EAAE,GAAG;KACV,CAAC,CAAC","file":"commandCenterControl.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { reset } from 'vs/base/browser/dom';\nimport { BaseActionViewItem, IBaseActionViewItemOptions } from 'vs/base/browser/ui/actionbar/actionViewItems';\nimport { IHoverDelegate } from 'vs/base/browser/ui/iconLabel/iconHoverDelegate';\nimport { setupCustomHover } from 'vs/base/browser/ui/iconLabel/iconLabelHover';\nimport { IAction, SubmenuAction } from 'vs/base/common/actions';\nimport { Codicon } from 'vs/base/common/codicons';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { localize } from 'vs/nls';\nimport { createActionViewItem } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { HiddenItemStrategy, MenuWorkbenchToolBar, WorkbenchToolBar } from 'vs/platform/actions/browser/toolbar';\nimport { MenuId, MenuRegistry, SubmenuItemAction } from 'vs/platform/actions/common/actions';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IQuickInputService } from 'vs/platform/quickinput/common/quickInput';\nimport { WindowTitle } from 'vs/workbench/browser/parts/titlebar/windowTitle';\n\nexport class CommandCenterControl {\n\n\tprivate readonly _disposables = new DisposableStore();\n\n\tprivate readonly _onDidChangeVisibility = new Emitter<void>();\n\treadonly onDidChangeVisibility: Event<void> = this._onDidChangeVisibility.event;\n\n\treadonly element: HTMLElement = document.createElement('div');\n\n\tconstructor(\n\t\twindowTitle: WindowTitle,\n\t\thoverDelegate: IHoverDelegate,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IQuickInputService quickInputService: IQuickInputService,\n\t\t@IKeybindingService keybindingService: IKeybindingService\n\t) {\n\t\tthis.element.classList.add('command-center');\n\n\t\tconst titleToolbar = instantiationService.createInstance(MenuWorkbenchToolBar, this.element, MenuId.CommandCenter, {\n\t\t\tcontextMenu: MenuId.TitleBarContext,\n\t\t\thiddenItemStrategy: HiddenItemStrategy.Ignore,\n\t\t\ttoolbarOptions: {\n\t\t\t\tprimaryGroup: () => true,\n\t\t\t},\n\t\t\ttelemetrySource: 'commandCenter',\n\t\t\tactionViewItemProvider: (action) => {\n\t\t\t\tif (action instanceof SubmenuItemAction && action.item.submenu === MenuId.CommandCenterCenter) {\n\t\t\t\t\treturn instantiationService.createInstance(CommandCenterCenterViewItem, action, windowTitle, hoverDelegate, {});\n\t\t\t\t} else {\n\t\t\t\t\treturn createActionViewItem(instantiationService, action, { hoverDelegate });\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._disposables.add(quickInputService.onShow(this._setVisibility.bind(this, false)));\n\t\tthis._disposables.add(quickInputService.onHide(this._setVisibility.bind(this, true)));\n\t\tthis._disposables.add(titleToolbar);\n\t}\n\n\tprivate _setVisibility(show: boolean): void {\n\t\tthis.element.classList.toggle('hide', !show);\n\t\tthis._onDidChangeVisibility.fire();\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t}\n}\n\n\nclass CommandCenterCenterViewItem extends BaseActionViewItem {\n\n\tprivate static readonly _quickOpenCommandId = 'workbench.action.quickOpenWithModes';\n\n\tconstructor(\n\t\tprivate readonly _submenu: SubmenuItemAction,\n\t\tprivate readonly _windowTitle: WindowTitle,\n\t\tprivate readonly _hoverDelegate: IHoverDelegate,\n\t\toptions: IBaseActionViewItemOptions,\n\t\t@IKeybindingService private _keybindingService: IKeybindingService,\n\t\t@IInstantiationService private _instaService: IInstantiationService,\n\t) {\n\t\tsuper(undefined, _submenu.actions[0], options);\n\t}\n\n\toverride render(container: HTMLElement): void {\n\t\tsuper.render(container);\n\t\tcontainer.classList.add('command-center-center');\n\t\tcontainer.classList.toggle('multiple', (this._submenu.actions.length > 1));\n\n\t\tconst hover = this._store.add(setupCustomHover(this._hoverDelegate, container, this.getTooltip()));\n\n\t\t// update label & tooltip when window title changes\n\t\tthis._store.add(this._windowTitle.onDidChange(() => {\n\t\t\thover.update(this.getTooltip());\n\t\t}));\n\n\t\tconst groups: (readonly IAction[])[] = [];\n\t\tfor (const action of this._submenu.actions) {\n\t\t\tif (action instanceof SubmenuAction) {\n\t\t\t\tgroups.push(action.actions);\n\t\t\t} else {\n\t\t\t\tgroups.push([action]);\n\t\t\t}\n\t\t}\n\n\n\t\tfor (let i = 0; i < groups.length; i++) {\n\t\t\tconst group = groups[i];\n\n\t\t\t// nested toolbar\n\t\t\tconst toolbar = this._instaService.createInstance(WorkbenchToolBar, container, {\n\t\t\t\thiddenItemStrategy: HiddenItemStrategy.NoHide,\n\t\t\t\ttelemetrySource: 'commandCenterCenter',\n\t\t\t\tactionViewItemProvider: (action, options) => {\n\t\t\t\t\toptions = {\n\t\t\t\t\t\t...options,\n\t\t\t\t\t\thoverDelegate: this._hoverDelegate,\n\t\t\t\t\t};\n\n\t\t\t\t\tif (action.id !== CommandCenterCenterViewItem._quickOpenCommandId) {\n\t\t\t\t\t\treturn createActionViewItem(this._instaService, action, options);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst that = this;\n\n\t\t\t\t\treturn this._instaService.createInstance(class CommandCenterQuickPickItem extends BaseActionViewItem {\n\n\t\t\t\t\t\tconstructor() {\n\t\t\t\t\t\t\tsuper(undefined, action, options);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\toverride render(container: HTMLElement): void {\n\t\t\t\t\t\t\tsuper.render(container);\n\t\t\t\t\t\t\tcontainer.classList.toggle('command-center-quick-pick');\n\n\t\t\t\t\t\t\tconst action = this.action;\n\n\t\t\t\t\t\t\t// icon (search)\n\t\t\t\t\t\t\tconst searchIcon = document.createElement('span');\n\t\t\t\t\t\t\tsearchIcon.className = action.class ?? '';\n\t\t\t\t\t\t\tsearchIcon.classList.add('search-icon');\n\n\t\t\t\t\t\t\t// label: just workspace name and optional decorations\n\t\t\t\t\t\t\tconst label = this._getLabel();\n\t\t\t\t\t\t\tconst labelElement = document.createElement('span');\n\t\t\t\t\t\t\tlabelElement.classList.add('search-label');\n\t\t\t\t\t\t\tlabelElement.innerText = label;\n\t\t\t\t\t\t\treset(container, searchIcon, labelElement);\n\n\t\t\t\t\t\t\tconst hover = this._store.add(setupCustomHover(that._hoverDelegate, container, this.getTooltip()));\n\n\t\t\t\t\t\t\t// update label & tooltip when window title changes\n\t\t\t\t\t\t\tthis._store.add(that._windowTitle.onDidChange(() => {\n\t\t\t\t\t\t\t\thover.update(this.getTooltip());\n\t\t\t\t\t\t\t\tlabelElement.innerText = this._getLabel();\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tprotected override getTooltip() {\n\t\t\t\t\t\t\treturn that.getTooltip();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tprivate _getLabel(): string {\n\t\t\t\t\t\t\tconst { prefix, suffix } = that._windowTitle.getTitleDecorations();\n\t\t\t\t\t\t\tlet label = that._windowTitle.isCustomTitleFormat() ? that._windowTitle.getWindowTitle() : that._windowTitle.workspaceName;\n\t\t\t\t\t\t\tif (!label) {\n\t\t\t\t\t\t\t\tlabel = localize('label.dfl', \"Search\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (prefix) {\n\t\t\t\t\t\t\t\tlabel = localize('label1', \"{0} {1}\", prefix, label);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (suffix) {\n\t\t\t\t\t\t\t\tlabel = localize('label2', \"{0} {1}\", label, suffix);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn label;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\ttoolbar.setActions(group);\n\t\t\tthis._store.add(toolbar);\n\t\t}\n\t}\n\n\tprotected override getTooltip() {\n\n\t\t// tooltip: full windowTitle\n\t\tconst kb = this._keybindingService.lookupKeybinding(this.action.id)?.getLabel();\n\t\tconst title = kb\n\t\t\t? localize('title', \"Search {0} ({1}) \\u2014 {2}\", this._windowTitle.workspaceName, kb, this._windowTitle.value)\n\t\t\t: localize('title2', \"Search {0} \\u2014 {1}\", this._windowTitle.workspaceName, this._windowTitle.value);\n\n\t\treturn title;\n\t}\n}\n\nMenuRegistry.appendMenuItem(MenuId.CommandCenter, {\n\tsubmenu: MenuId.CommandCenterCenter,\n\ttitle: localize('title3', \"Command Center\"),\n\ticon: Codicon.shield,\n\torder: 101,\n});\n"]}