{"version":3,"sources":["vs/workbench/browser/parts/titlebar/menubarControl.ts"],"names":[],"mappings":"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","file":"menubarControl.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/menubarControl';\nimport { localize } from 'vs/nls';\nimport { IMenuService, MenuId, IMenu, SubmenuItemAction, registerAction2, Action2, MenuItemAction, MenuRegistry } from 'vs/platform/actions/common/actions';\nimport { MenuBarVisibility, getTitleBarStyle, IWindowOpenable, getMenuBarVisibility } from 'vs/platform/window/common/window';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IAction, Action, SubmenuAction, Separator, IActionRunner, ActionRunner, WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification, toAction } from 'vs/base/common/actions';\nimport { addDisposableListener, Dimension, EventType } from 'vs/base/browser/dom';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { isMacintosh, isWeb, isIOS, isNative } from 'vs/base/common/platform';\nimport { IConfigurationService, IConfigurationChangeEvent } from 'vs/platform/configuration/common/configuration';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { IRecentlyOpened, isRecentFolder, IRecent, isRecentWorkspace, IWorkspacesService } from 'vs/platform/workspaces/common/workspaces';\nimport { RunOnceScheduler } from 'vs/base/common/async';\nimport { URI } from 'vs/base/common/uri';\nimport { ILabelService, Verbosity } from 'vs/platform/label/common/label';\nimport { IUpdateService, StateType } from 'vs/platform/update/common/update';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { INotificationService, Severity } from 'vs/platform/notification/common/notification';\nimport { IPreferencesService } from 'vs/workbench/services/preferences/common/preferences';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\nimport { MenuBar, IMenuBarOptions } from 'vs/base/browser/ui/menu/menubar';\nimport { Direction } from 'vs/base/browser/ui/menu/menu';\nimport { mnemonicMenuLabel, unmnemonicLabel } from 'vs/base/common/labels';\nimport { IAccessibilityService } from 'vs/platform/accessibility/common/accessibility';\nimport { IWorkbenchLayoutService } from 'vs/workbench/services/layout/browser/layoutService';\nimport { isFullscreen } from 'vs/base/browser/browser';\nimport { IHostService } from 'vs/workbench/services/host/browser/host';\nimport { BrowserFeatures } from 'vs/base/browser/canIUse';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { IsMacNativeContext, IsWebContext } from 'vs/platform/contextkey/common/contextkeys';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { OpenRecentAction } from 'vs/workbench/browser/actions/windowActions';\nimport { isICommandActionToggleInfo } from 'vs/platform/action/common/action';\nimport { createAndFillInContextMenuActions } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { defaultMenuStyles } from 'vs/platform/theme/browser/defaultStyles';\n\nexport type IOpenRecentAction = IAction & { uri: URI; remoteAuthority?: string };\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarFileMenu,\n\ttitle: {\n\t\tvalue: 'File',\n\t\toriginal: 'File',\n\t\tmnemonicTitle: localize({ key: 'mFile', comment: ['&& denotes a mnemonic'] }, \"&&File\"),\n\t},\n\torder: 1\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarEditMenu,\n\ttitle: {\n\t\tvalue: 'Edit',\n\t\toriginal: 'Edit',\n\t\tmnemonicTitle: localize({ key: 'mEdit', comment: ['&& denotes a mnemonic'] }, \"&&Edit\")\n\t},\n\torder: 2\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarSelectionMenu,\n\ttitle: {\n\t\tvalue: 'Selection',\n\t\toriginal: 'Selection',\n\t\tmnemonicTitle: localize({ key: 'mSelection', comment: ['&& denotes a mnemonic'] }, \"&&Selection\")\n\t},\n\torder: 3\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarViewMenu,\n\ttitle: {\n\t\tvalue: 'View',\n\t\toriginal: 'View',\n\t\tmnemonicTitle: localize({ key: 'mView', comment: ['&& denotes a mnemonic'] }, \"&&View\")\n\t},\n\torder: 4\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarGoMenu,\n\ttitle: {\n\t\tvalue: 'Go',\n\t\toriginal: 'Go',\n\t\tmnemonicTitle: localize({ key: 'mGoto', comment: ['&& denotes a mnemonic'] }, \"&&Go\")\n\t},\n\torder: 5\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarTerminalMenu,\n\ttitle: {\n\t\tvalue: 'Terminal',\n\t\toriginal: 'Terminal',\n\t\tmnemonicTitle: localize({ key: 'mTerminal', comment: ['&& denotes a mnemonic'] }, \"&&Terminal\")\n\t},\n\torder: 7\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarHelpMenu,\n\ttitle: {\n\t\tvalue: 'Help',\n\t\toriginal: 'Help',\n\t\tmnemonicTitle: localize({ key: 'mHelp', comment: ['&& denotes a mnemonic'] }, \"&&Help\")\n\t},\n\torder: 8\n});\n\nMenuRegistry.appendMenuItem(MenuId.MenubarMainMenu, {\n\tsubmenu: MenuId.MenubarPreferencesMenu,\n\ttitle: {\n\t\tvalue: 'Preferences',\n\t\toriginal: 'Preferences',\n\t\tmnemonicTitle: localize({ key: 'mPreferences', comment: ['&& denotes a mnemonic'] }, \"Preferences\")\n\t},\n\twhen: IsMacNativeContext,\n\torder: 9\n});\n\nexport abstract class MenubarControl extends Disposable {\n\n\tprotected keys = [\n\t\t'window.menuBarVisibility',\n\t\t'window.enableMenuBarMnemonics',\n\t\t'window.customMenuBarAltFocus',\n\t\t'workbench.sideBar.location',\n\t\t'window.nativeTabs'\n\t];\n\n\tprotected mainMenu: IMenu;\n\tprotected menus: {\n\t\t[index: string]: IMenu | undefined;\n\t} = {};\n\n\tprotected topLevelTitles: { [menu: string]: string } = {};\n\n\tprotected mainMenuDisposables: DisposableStore;\n\n\tprotected recentlyOpened: IRecentlyOpened = { files: [], workspaces: [] };\n\n\tprotected menuUpdater: RunOnceScheduler;\n\n\tprotected static readonly MAX_MENU_RECENT_ENTRIES = 10;\n\n\tconstructor(\n\t\tprotected readonly menuService: IMenuService,\n\t\tprotected readonly workspacesService: IWorkspacesService,\n\t\tprotected readonly contextKeyService: IContextKeyService,\n\t\tprotected readonly keybindingService: IKeybindingService,\n\t\tprotected readonly configurationService: IConfigurationService,\n\t\tprotected readonly labelService: ILabelService,\n\t\tprotected readonly updateService: IUpdateService,\n\t\tprotected readonly storageService: IStorageService,\n\t\tprotected readonly notificationService: INotificationService,\n\t\tprotected readonly preferencesService: IPreferencesService,\n\t\tprotected readonly environmentService: IWorkbenchEnvironmentService,\n\t\tprotected readonly accessibilityService: IAccessibilityService,\n\t\tprotected readonly hostService: IHostService,\n\t\tprotected readonly commandService: ICommandService\n\t) {\n\n\t\tsuper();\n\n\t\tthis.mainMenu = this._register(this.menuService.createMenu(MenuId.MenubarMainMenu, this.contextKeyService));\n\t\tthis.mainMenuDisposables = this._register(new DisposableStore());\n\n\t\tthis.setupMainMenu();\n\n\t\tthis.menuUpdater = this._register(new RunOnceScheduler(() => this.doUpdateMenubar(false), 200));\n\n\t\tthis.notifyUserOfCustomMenubarAccessibility();\n\t}\n\n\tprotected abstract doUpdateMenubar(firstTime: boolean): void;\n\n\tprotected registerListeners(): void {\n\t\t// Listen for window focus changes\n\t\tthis._register(this.hostService.onDidChangeFocus(e => this.onDidChangeWindowFocus(e)));\n\n\t\t// Update when config changes\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => this.onConfigurationUpdated(e)));\n\n\t\t// Listen to update service\n\t\tthis.updateService.onStateChange(() => this.onUpdateStateChange());\n\n\t\t// Listen for changes in recently opened menu\n\t\tthis._register(this.workspacesService.onDidChangeRecentlyOpened(() => { this.onDidChangeRecentlyOpened(); }));\n\n\t\t// Listen to keybindings change\n\t\tthis._register(this.keybindingService.onDidUpdateKeybindings(() => this.updateMenubar()));\n\n\t\t// Update recent menu items on formatter registration\n\t\tthis._register(this.labelService.onDidChangeFormatters(() => { this.onDidChangeRecentlyOpened(); }));\n\n\t\t// Listen for changes on the main menu\n\t\tthis._register(this.mainMenu.onDidChange(() => { this.setupMainMenu(); this.doUpdateMenubar(true); }));\n\t}\n\n\tprotected setupMainMenu(): void {\n\t\tthis.mainMenuDisposables.clear();\n\t\tthis.menus = {};\n\t\tthis.topLevelTitles = {};\n\n\t\tconst [, mainMenuActions] = this.mainMenu.getActions()[0];\n\t\tfor (const mainMenuAction of mainMenuActions) {\n\t\t\tif (mainMenuAction instanceof SubmenuItemAction && typeof mainMenuAction.item.title !== 'string') {\n\t\t\t\tthis.menus[mainMenuAction.item.title.original] = this.mainMenuDisposables.add(this.menuService.createMenu(mainMenuAction.item.submenu, this.contextKeyService, { emitEventsForSubmenuChanges: true }));\n\t\t\t\tthis.topLevelTitles[mainMenuAction.item.title.original] = mainMenuAction.item.title.mnemonicTitle ?? mainMenuAction.item.title.value;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateMenubar(): void {\n\t\tthis.menuUpdater.schedule();\n\t}\n\n\tprotected calculateActionLabel(action: { id: string; label: string }): string {\n\t\tconst label = action.label;\n\t\tswitch (action.id) {\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn label;\n\t}\n\n\tprotected onUpdateStateChange(): void {\n\t\tthis.updateMenubar();\n\t}\n\n\tprotected onUpdateKeybindings(): void {\n\t\tthis.updateMenubar();\n\t}\n\n\tprotected getOpenRecentActions(): (Separator | IOpenRecentAction)[] {\n\t\tif (!this.recentlyOpened) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst { workspaces, files } = this.recentlyOpened;\n\n\t\tconst result = [];\n\n\t\tif (workspaces.length > 0) {\n\t\t\tfor (let i = 0; i < MenubarControl.MAX_MENU_RECENT_ENTRIES && i < workspaces.length; i++) {\n\t\t\t\tresult.push(this.createOpenRecentMenuAction(workspaces[i]));\n\t\t\t}\n\n\t\t\tresult.push(new Separator());\n\t\t}\n\n\t\tif (files.length > 0) {\n\t\t\tfor (let i = 0; i < MenubarControl.MAX_MENU_RECENT_ENTRIES && i < files.length; i++) {\n\t\t\t\tresult.push(this.createOpenRecentMenuAction(files[i]));\n\t\t\t}\n\n\t\t\tresult.push(new Separator());\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprotected onDidChangeWindowFocus(hasFocus: boolean): void {\n\t\t// When we regain focus, update the recent menu items\n\t\tif (hasFocus) {\n\t\t\tthis.onDidChangeRecentlyOpened();\n\t\t}\n\t}\n\n\tprivate onConfigurationUpdated(event: IConfigurationChangeEvent): void {\n\t\tif (this.keys.some(key => event.affectsConfiguration(key))) {\n\t\t\tthis.updateMenubar();\n\t\t}\n\n\t\tif (event.affectsConfiguration('editor.accessibilitySupport')) {\n\t\t\tthis.notifyUserOfCustomMenubarAccessibility();\n\t\t}\n\n\t\t// Since we try not update when hidden, we should\n\t\t// try to update the recently opened list on visibility changes\n\t\tif (event.affectsConfiguration('window.menuBarVisibility')) {\n\t\t\tthis.onDidChangeRecentlyOpened();\n\t\t}\n\t}\n\n\tprivate get menubarHidden(): boolean {\n\t\treturn isMacintosh && isNative ? false : getMenuBarVisibility(this.configurationService) === 'hidden';\n\t}\n\n\tprotected onDidChangeRecentlyOpened(): void {\n\n\t\t// Do not update recently opened when the menubar is hidden #108712\n\t\tif (!this.menubarHidden) {\n\t\t\tthis.workspacesService.getRecentlyOpened().then(recentlyOpened => {\n\t\t\t\tthis.recentlyOpened = recentlyOpened;\n\t\t\t\tthis.updateMenubar();\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate createOpenRecentMenuAction(recent: IRecent): IOpenRecentAction {\n\n\t\tlet label: string;\n\t\tlet uri: URI;\n\t\tlet commandId: string;\n\t\tlet openable: IWindowOpenable;\n\t\tconst remoteAuthority = recent.remoteAuthority;\n\n\t\tif (isRecentFolder(recent)) {\n\t\t\turi = recent.folderUri;\n\t\t\tlabel = recent.label || this.labelService.getWorkspaceLabel(uri, { verbose: Verbosity.LONG });\n\t\t\tcommandId = 'openRecentFolder';\n\t\t\topenable = { folderUri: uri };\n\t\t} else if (isRecentWorkspace(recent)) {\n\t\t\turi = recent.workspace.configPath;\n\t\t\tlabel = recent.label || this.labelService.getWorkspaceLabel(recent.workspace, { verbose: Verbosity.LONG });\n\t\t\tcommandId = 'openRecentWorkspace';\n\t\t\topenable = { workspaceUri: uri };\n\t\t} else {\n\t\t\turi = recent.fileUri;\n\t\t\tlabel = recent.label || this.labelService.getUriLabel(uri);\n\t\t\tcommandId = 'openRecentFile';\n\t\t\topenable = { fileUri: uri };\n\t\t}\n\n\t\tconst ret = toAction({\n\t\t\tid: commandId, label: unmnemonicLabel(label), run: (browserEvent: KeyboardEvent) => {\n\t\t\t\tconst openInNewWindow = browserEvent && ((!isMacintosh && (browserEvent.ctrlKey || browserEvent.shiftKey)) || (isMacintosh && (browserEvent.metaKey || browserEvent.altKey)));\n\n\t\t\t\treturn this.hostService.openWindow([openable], {\n\t\t\t\t\tforceNewWindow: !!openInNewWindow,\n\t\t\t\t\tremoteAuthority: remoteAuthority || null // local window if remoteAuthority is not set or can not be deducted from the openable\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn Object.assign(ret, { uri, remoteAuthority });\n\t}\n\n\tprivate notifyUserOfCustomMenubarAccessibility(): void {\n\t\tif (isWeb || isMacintosh) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst hasBeenNotified = this.storageService.getBoolean('menubar/accessibleMenubarNotified', StorageScope.APPLICATION, false);\n\t\tconst usingCustomMenubar = getTitleBarStyle(this.configurationService) === 'custom';\n\n\t\tif (hasBeenNotified || usingCustomMenubar || !this.accessibilityService.isScreenReaderOptimized()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = localize('menubar.customTitlebarAccessibilityNotification', \"Accessibility support is enabled for you. For the most accessible experience, we recommend the custom title bar style.\");\n\t\tthis.notificationService.prompt(Severity.Info, message, [\n\t\t\t{\n\t\t\t\tlabel: localize('goToSetting', \"Open Settings\"),\n\t\t\t\trun: () => {\n\t\t\t\t\treturn this.preferencesService.openUserSettings({ query: 'window.titleBarStyle' });\n\t\t\t\t}\n\t\t\t}\n\t\t]);\n\n\t\tthis.storageService.store('menubar/accessibleMenubarNotified', true, StorageScope.APPLICATION, StorageTarget.USER);\n\t}\n}\n\nexport class CustomMenubarControl extends MenubarControl {\n\tprivate menubar: MenuBar | undefined;\n\tprivate container: HTMLElement | undefined;\n\tprivate alwaysOnMnemonics: boolean = false;\n\tprivate focusInsideMenubar: boolean = false;\n\tprivate pendingFirstTimeUpdate: boolean = false;\n\tprivate visible: boolean = true;\n\tprivate actionRunner: IActionRunner;\n\tprivate readonly webNavigationMenu = this._register(this.menuService.createMenu(MenuId.MenubarHomeMenu, this.contextKeyService));\n\n\tprivate readonly _onVisibilityChange: Emitter<boolean>;\n\tprivate readonly _onFocusStateChange: Emitter<boolean>;\n\n\tconstructor(\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IWorkspacesService workspacesService: IWorkspacesService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IUpdateService updateService: IUpdateService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@INotificationService notificationService: INotificationService,\n\t\t@IPreferencesService preferencesService: IPreferencesService,\n\t\t@IWorkbenchEnvironmentService environmentService: IWorkbenchEnvironmentService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService,\n\t\t@IWorkbenchLayoutService private readonly layoutService: IWorkbenchLayoutService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IHostService hostService: IHostService,\n\t\t@ICommandService commandService: ICommandService\n\t) {\n\t\tsuper(menuService, workspacesService, contextKeyService, keybindingService, configurationService, labelService, updateService, storageService, notificationService, preferencesService, environmentService, accessibilityService, hostService, commandService);\n\n\t\tthis._onVisibilityChange = this._register(new Emitter<boolean>());\n\t\tthis._onFocusStateChange = this._register(new Emitter<boolean>());\n\n\t\tthis.actionRunner = this._register(new ActionRunner());\n\t\tthis.actionRunner.onDidRun(e => {\n\t\t\tthis.telemetryService.publicLog2<WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification>('workbenchActionExecuted', { id: e.action.id, from: 'menu' });\n\t\t});\n\n\t\tthis.workspacesService.getRecentlyOpened().then((recentlyOpened) => {\n\t\t\tthis.recentlyOpened = recentlyOpened;\n\t\t});\n\n\t\tthis.registerListeners();\n\n\t\tthis.registerActions();\n\t}\n\n\tprotected doUpdateMenubar(firstTime: boolean): void {\n\t\tif (!this.focusInsideMenubar) {\n\t\t\tthis.setupCustomMenubar(firstTime);\n\t\t}\n\n\t\tif (firstTime) {\n\t\t\tthis.pendingFirstTimeUpdate = true;\n\t\t}\n\t}\n\n\tprivate registerActions(): void {\n\t\tconst that = this;\n\n\t\tif (isWeb) {\n\t\t\tthis._register(registerAction2(class extends Action2 {\n\t\t\t\tconstructor() {\n\t\t\t\t\tsuper({\n\t\t\t\t\t\tid: `workbench.actions.menubar.focus`,\n\t\t\t\t\t\ttitle: { value: localize('focusMenu', \"Focus Application Menu\"), original: 'Focus Application Menu' },\n\t\t\t\t\t\tkeybinding: {\n\t\t\t\t\t\t\tprimary: KeyMod.Alt | KeyCode.F10,\n\t\t\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib,\n\t\t\t\t\t\t\twhen: IsWebContext\n\t\t\t\t\t\t},\n\t\t\t\t\t\tf1: true\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tasync run(): Promise<void> {\n\t\t\t\t\tthat.menubar?.toggleFocus();\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate getUpdateAction(): IAction | null {\n\t\tconst state = this.updateService.state;\n\n\t\tswitch (state.type) {\n\t\t\tcase StateType.Idle:\n\t\t\t\treturn new Action('update.check', localize({ key: 'checkForUpdates', comment: ['&& denotes a mnemonic'] }, \"Check for &&Updates...\"), undefined, true, () =>\n\t\t\t\t\tthis.updateService.checkForUpdates(true));\n\n\t\t\tcase StateType.CheckingForUpdates:\n\t\t\t\treturn new Action('update.checking', localize('checkingForUpdates', \"Checking for Updates...\"), undefined, false);\n\n\t\t\tcase StateType.AvailableForDownload:\n\t\t\t\treturn new Action('update.downloadNow', localize({ key: 'download now', comment: ['&& denotes a mnemonic'] }, \"D&&ownload Update\"), undefined, true, () =>\n\t\t\t\t\tthis.updateService.downloadUpdate());\n\n\t\t\tcase StateType.Downloading:\n\t\t\t\treturn new Action('update.downloading', localize('DownloadingUpdate', \"Downloading Update...\"), undefined, false);\n\n\t\t\tcase StateType.Downloaded:\n\t\t\t\treturn new Action('update.install', localize({ key: 'installUpdate...', comment: ['&& denotes a mnemonic'] }, \"Install &&Update...\"), undefined, true, () =>\n\t\t\t\t\tthis.updateService.applyUpdate());\n\n\t\t\tcase StateType.Updating:\n\t\t\t\treturn new Action('update.updating', localize('installingUpdate', \"Installing Update...\"), undefined, false);\n\n\t\t\tcase StateType.Ready:\n\t\t\t\treturn new Action('update.restart', localize({ key: 'restartToUpdate', comment: ['&& denotes a mnemonic'] }, \"Restart to &&Update\"), undefined, true, () =>\n\t\t\t\t\tthis.updateService.quitAndInstall());\n\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\tprivate get currentMenubarVisibility(): MenuBarVisibility {\n\t\treturn getMenuBarVisibility(this.configurationService);\n\t}\n\n\tprivate get currentDisableMenuBarAltFocus(): boolean {\n\t\tconst settingValue = this.configurationService.getValue<boolean>('window.customMenuBarAltFocus');\n\n\t\tlet disableMenuBarAltBehavior = false;\n\t\tif (typeof settingValue === 'boolean') {\n\t\t\tdisableMenuBarAltBehavior = !settingValue;\n\t\t}\n\n\t\treturn disableMenuBarAltBehavior;\n\t}\n\n\tprivate insertActionsBefore(nextAction: IAction, target: IAction[]): void {\n\t\tswitch (nextAction.id) {\n\t\t\tcase OpenRecentAction.ID:\n\t\t\t\ttarget.push(...this.getOpenRecentActions());\n\t\t\t\tbreak;\n\n\t\t\tcase 'workbench.action.showAboutDialog':\n\t\t\t\tif (!isMacintosh && !isWeb) {\n\t\t\t\t\tconst updateAction = this.getUpdateAction();\n\t\t\t\t\tif (updateAction) {\n\t\t\t\t\t\tupdateAction.label = mnemonicMenuLabel(updateAction.label);\n\t\t\t\t\t\ttarget.push(updateAction);\n\t\t\t\t\t\ttarget.push(new Separator());\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate get currentEnableMenuBarMnemonics(): boolean {\n\t\tlet enableMenuBarMnemonics = this.configurationService.getValue<boolean>('window.enableMenuBarMnemonics');\n\t\tif (typeof enableMenuBarMnemonics !== 'boolean') {\n\t\t\tenableMenuBarMnemonics = true;\n\t\t}\n\n\t\treturn enableMenuBarMnemonics && (!isWeb || isFullscreen());\n\t}\n\n\tprivate get currentCompactMenuMode(): Direction | undefined {\n\t\tif (this.currentMenubarVisibility !== 'compact') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Menu bar lives in activity bar and should flow based on its location\n\t\tconst currentSidebarLocation = this.configurationService.getValue<string>('workbench.sideBar.location');\n\t\treturn currentSidebarLocation === 'right' ? Direction.Left : Direction.Right;\n\t}\n\n\tprivate onDidVisibilityChange(visible: boolean): void {\n\t\tthis.visible = visible;\n\t\tthis.onDidChangeRecentlyOpened();\n\t\tthis._onVisibilityChange.fire(visible);\n\t}\n\n\tprivate toActionsArray(menu: IMenu): IAction[] {\n\t\tconst result: IAction[] = [];\n\t\tcreateAndFillInContextMenuActions(menu, { shouldForwardArgs: true }, result);\n\t\treturn result;\n\t}\n\n\tprivate reinstallDisposables = this._register(new DisposableStore());\n\tprivate setupCustomMenubar(firstTime: boolean): void {\n\t\t// If there is no container, we cannot setup the menubar\n\t\tif (!this.container) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (firstTime) {\n\t\t\t// Reset and create new menubar\n\t\t\tif (this.menubar) {\n\t\t\t\tthis.reinstallDisposables.clear();\n\t\t\t}\n\n\t\t\tthis.menubar = this.reinstallDisposables.add(new MenuBar(this.container, this.getMenuBarOptions(), defaultMenuStyles));\n\n\t\t\tthis.accessibilityService.alwaysUnderlineAccessKeys().then(val => {\n\t\t\t\tthis.alwaysOnMnemonics = val;\n\t\t\t\tthis.menubar?.update(this.getMenuBarOptions());\n\t\t\t});\n\n\t\t\tthis.reinstallDisposables.add(this.menubar.onFocusStateChange(focused => {\n\t\t\t\tthis._onFocusStateChange.fire(focused);\n\n\t\t\t\t// When the menubar loses focus, update it to clear any pending updates\n\t\t\t\tif (!focused) {\n\t\t\t\t\tif (this.pendingFirstTimeUpdate) {\n\t\t\t\t\t\tthis.setupCustomMenubar(true);\n\t\t\t\t\t\tthis.pendingFirstTimeUpdate = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.updateMenubar();\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.focusInsideMenubar = false;\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis.reinstallDisposables.add(this.menubar.onVisibilityChange(e => this.onDidVisibilityChange(e)));\n\n\t\t\t// Before we focus the menubar, stop updates to it so that focus-related context keys will work\n\t\t\tthis.reinstallDisposables.add(addDisposableListener(this.container, EventType.FOCUS_IN, () => {\n\t\t\t\tthis.focusInsideMenubar = true;\n\t\t\t}));\n\n\t\t\tthis.reinstallDisposables.add(addDisposableListener(this.container, EventType.FOCUS_OUT, () => {\n\t\t\t\tthis.focusInsideMenubar = false;\n\t\t\t}));\n\n\t\t\t// Fire visibility change for the first install if menu is shown\n\t\t\tif (this.menubar.isVisible) {\n\t\t\t\tthis.onDidVisibilityChange(true);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.menubar?.update(this.getMenuBarOptions());\n\t\t}\n\n\t\t// Update the menu actions\n\t\tconst updateActions = (menuActions: readonly IAction[], target: IAction[], topLevelTitle: string) => {\n\t\t\ttarget.splice(0);\n\n\t\t\tfor (const menuItem of menuActions) {\n\t\t\t\tthis.insertActionsBefore(menuItem, target);\n\n\t\t\t\tif (menuItem instanceof Separator) {\n\t\t\t\t\ttarget.push(menuItem);\n\t\t\t\t} else if (menuItem instanceof SubmenuItemAction || menuItem instanceof MenuItemAction) {\n\t\t\t\t\t// use mnemonicTitle whenever possible\n\t\t\t\t\tlet title = typeof menuItem.item.title === 'string'\n\t\t\t\t\t\t? menuItem.item.title\n\t\t\t\t\t\t: menuItem.item.title.mnemonicTitle ?? menuItem.item.title.value;\n\n\t\t\t\t\tif (menuItem instanceof SubmenuItemAction) {\n\t\t\t\t\t\tconst submenuActions: SubmenuAction[] = [];\n\t\t\t\t\t\tupdateActions(menuItem.actions, submenuActions, topLevelTitle);\n\n\t\t\t\t\t\tif (submenuActions.length > 0) {\n\t\t\t\t\t\t\ttarget.push(new SubmenuAction(menuItem.id, mnemonicMenuLabel(title), submenuActions));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (isICommandActionToggleInfo(menuItem.item.toggled)) {\n\t\t\t\t\t\t\ttitle = menuItem.item.toggled.mnemonicTitle ?? menuItem.item.toggled.title ?? title;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst newAction = new Action(menuItem.id, mnemonicMenuLabel(title), menuItem.class, menuItem.enabled, () => this.commandService.executeCommand(menuItem.id));\n\t\t\t\t\t\tnewAction.tooltip = menuItem.tooltip;\n\t\t\t\t\t\tnewAction.checked = menuItem.checked;\n\t\t\t\t\t\ttarget.push(newAction);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// Append web navigation menu items to the file menu when not compact\n\t\t\tif (topLevelTitle === 'File' && this.currentCompactMenuMode === undefined) {\n\t\t\t\tconst webActions = this.getWebNavigationActions();\n\t\t\t\tif (webActions.length) {\n\t\t\t\t\ttarget.push(...webActions);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tfor (const title of Object.keys(this.topLevelTitles)) {\n\t\t\tconst menu = this.menus[title];\n\t\t\tif (firstTime && menu) {\n\t\t\t\tthis.reinstallDisposables.add(menu.onDidChange(() => {\n\t\t\t\t\tif (!this.focusInsideMenubar) {\n\t\t\t\t\t\tconst actions: IAction[] = [];\n\t\t\t\t\t\tupdateActions(this.toActionsArray(menu), actions, title);\n\t\t\t\t\t\tthis.menubar?.updateMenu({ actions: actions, label: mnemonicMenuLabel(this.topLevelTitles[title]) });\n\t\t\t\t\t}\n\t\t\t\t}));\n\n\t\t\t\t// For the file menu, we need to update if the web nav menu updates as well\n\t\t\t\tif (menu === this.menus.File) {\n\t\t\t\t\tthis.reinstallDisposables.add(this.webNavigationMenu.onDidChange(() => {\n\t\t\t\t\t\tif (!this.focusInsideMenubar) {\n\t\t\t\t\t\t\tconst actions: IAction[] = [];\n\t\t\t\t\t\t\tupdateActions(this.toActionsArray(menu), actions, title);\n\t\t\t\t\t\t\tthis.menubar?.updateMenu({ actions: actions, label: mnemonicMenuLabel(this.topLevelTitles[title]) });\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst actions: IAction[] = [];\n\t\t\tif (menu) {\n\t\t\t\tupdateActions(this.toActionsArray(menu), actions, title);\n\t\t\t}\n\n\t\t\tif (this.menubar) {\n\t\t\t\tif (!firstTime) {\n\t\t\t\t\tthis.menubar.updateMenu({ actions: actions, label: mnemonicMenuLabel(this.topLevelTitles[title]) });\n\t\t\t\t} else {\n\t\t\t\t\tthis.menubar.push({ actions: actions, label: mnemonicMenuLabel(this.topLevelTitles[title]) });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getWebNavigationActions(): IAction[] {\n\t\tif (!isWeb) {\n\t\t\treturn []; // only for web\n\t\t}\n\n\t\tconst webNavigationActions = [];\n\t\tfor (const groups of this.webNavigationMenu.getActions()) {\n\t\t\tconst [, actions] = groups;\n\t\t\tfor (const action of actions) {\n\t\t\t\tif (action instanceof MenuItemAction) {\n\t\t\t\t\tconst title = typeof action.item.title === 'string'\n\t\t\t\t\t\t? action.item.title\n\t\t\t\t\t\t: action.item.title.mnemonicTitle ?? action.item.title.value;\n\t\t\t\t\twebNavigationActions.push(new Action(action.id, mnemonicMenuLabel(title), action.class, action.enabled, async (event?: any) => {\n\t\t\t\t\t\tthis.commandService.executeCommand(action.id, event);\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twebNavigationActions.push(new Separator());\n\t\t}\n\n\t\tif (webNavigationActions.length) {\n\t\t\twebNavigationActions.pop();\n\t\t}\n\n\t\treturn webNavigationActions;\n\t}\n\n\tprivate getMenuBarOptions(): IMenuBarOptions {\n\t\treturn {\n\t\t\tenableMnemonics: this.currentEnableMenuBarMnemonics,\n\t\t\tdisableAltFocus: this.currentDisableMenuBarAltFocus,\n\t\t\tvisibility: this.currentMenubarVisibility,\n\t\t\tactionRunner: this.actionRunner,\n\t\t\tgetKeybinding: (action) => this.keybindingService.lookupKeybinding(action.id),\n\t\t\talwaysOnMnemonics: this.alwaysOnMnemonics,\n\t\t\tcompactMode: this.currentCompactMenuMode,\n\t\t\tgetCompactMenuActions: () => {\n\t\t\t\tif (!isWeb) {\n\t\t\t\t\treturn []; // only for web\n\t\t\t\t}\n\n\t\t\t\treturn this.getWebNavigationActions();\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected override onDidChangeWindowFocus(hasFocus: boolean): void {\n\t\tif (!this.visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.onDidChangeWindowFocus(hasFocus);\n\n\t\tif (this.container) {\n\t\t\tif (hasFocus) {\n\t\t\t\tthis.container.classList.remove('inactive');\n\t\t\t} else {\n\t\t\t\tthis.container.classList.add('inactive');\n\t\t\t\tthis.menubar?.blur();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected override onUpdateStateChange(): void {\n\t\tif (!this.visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.onUpdateStateChange();\n\t}\n\n\tprotected override onDidChangeRecentlyOpened(): void {\n\t\tif (!this.visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.onDidChangeRecentlyOpened();\n\t}\n\n\tprotected override onUpdateKeybindings(): void {\n\t\tif (!this.visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.onUpdateKeybindings();\n\t}\n\n\tprotected override registerListeners(): void {\n\t\tsuper.registerListeners();\n\n\t\tthis._register(addDisposableListener(window, EventType.RESIZE, () => {\n\t\t\tif (this.menubar && !(isIOS && BrowserFeatures.pointerEvents)) {\n\t\t\t\tthis.menubar.blur();\n\t\t\t}\n\t\t}));\n\n\t\t// Mnemonics require fullscreen in web\n\t\tif (isWeb) {\n\t\t\tthis._register(this.layoutService.onDidChangeFullscreen(e => this.updateMenubar()));\n\t\t\tthis._register(this.webNavigationMenu.onDidChange(() => this.updateMenubar()));\n\t\t}\n\t}\n\n\tget onVisibilityChange(): Event<boolean> {\n\t\treturn this._onVisibilityChange.event;\n\t}\n\n\tget onFocusStateChange(): Event<boolean> {\n\t\treturn this._onFocusStateChange.event;\n\t}\n\n\tgetMenubarItemsDimensions(): Dimension {\n\t\tif (this.menubar) {\n\t\t\treturn new Dimension(this.menubar.getWidth(), this.menubar.getHeight());\n\t\t}\n\n\t\treturn new Dimension(0, 0);\n\t}\n\n\tcreate(parent: HTMLElement): HTMLElement {\n\t\tthis.container = parent;\n\n\t\t// Build the menubar\n\t\tif (this.container) {\n\t\t\tthis.doUpdateMenubar(true);\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\tlayout(dimension: Dimension) {\n\t\tthis.menubar?.update(this.getMenuBarOptions());\n\t}\n\n\ttoggleFocus() {\n\t\tthis.menubar?.toggleFocus();\n\t}\n}\n"]}