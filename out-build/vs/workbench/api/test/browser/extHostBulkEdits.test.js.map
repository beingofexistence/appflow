{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/api/test/browser/extHostBulkEdits.test.ts"],"names":[],"mappings":";;;IAeA,KAAK,CAAC,qCAAqC,EAAE,GAAG,EAAE;QAEjD,MAAM,QAAQ,GAAG,SAAG,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QACtC,IAAI,SAAe,CAAa;QAChC,IAAI,sBAAyC,CAAC;QAE9C,KAAK,CAAC,GAAG,EAAE;YACV,sBAAsB,GAAG,IAAK,CAAC;YAE/B,MAAM,WAAW,GAAG,IAAI,sBAAI,EAAa,CAAC;YAC1C,WAAW,CAAC,GAAG,CAAC,sBAAG,CAAS,mBAAmB,EAAE,IAAI,KAAM,SAAQ,IAAA,UAAG,GAA6B;gBACzF,sBAAsB,CAAC,uBAA0C;oBACzE,sBAAsB,GAAG,uBAAuB,CAAC;oBACjD,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC9B,CAAC;aACD,CAAC,CAAC;YACH,MAAM,mBAAmB,GAAG,IAAI,gCAAG,CAAwB,IAAA,sBAAI,EAAmB,IAAI,CAAC,EAAE,IAAI,SAAG,EAAa,CAAC,CAAC;YAC/G,mBAAmB,CAAC,+BAA+B,CAAC;gBACnD,cAAc,EAAE,CAAC;wBAChB,OAAO,EAAE,KAAK;wBACd,UAAU,EAAE,KAAK;wBACjB,GAAG,EAAE,QAAQ;wBACb,SAAS,EAAE,IAAI;wBACf,KAAK,EAAE,CAAC,KAAK,CAAC;wBACd,GAAG,EAAE,IAAI;qBACT,CAAC;aACF,CAAC,CAAC;YACH,SAAS,GAAG,IAAI,uBAAI,CAAa,WAAW,EAAE,mBAAmB,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACxD,MAAM,IAAI,GAAG,IAAI,YAAY,CAAC,GAAG,EAAY,CAAC;YAC9C,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,YAAY,CAAC,GAAG,CAAG,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YACpE,MAAM,SAAS,CAAC,kBAAkB,CAAC,IAAI,EAAE,gBAAG,EAAuB,SAAS,CAAC,CAAC;YAC9E,MAAM,CAAC,WAAW,CAAC,sBAAsB,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAC3D,MAAM,CAAC,KAAK,CAAC,GAAG,sBAAsB,CAAC,KAAK,CAAC;YAC7C,MAAM,CAAC,WAAW,CAAyB,KAAM,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sDAAsD,EAAE,KAAK,IAAI,EAAE;YACvE,MAAM,IAAI,GAAG,IAAI,YAAY,CAAC,GAAG,EAAY,CAAC;YAC9C,IAAI,CAAC,OAAO,CAAC,SAAG,CAAC,KAAK,CAAC,UAAU,CAAC,EAAE,IAAI,YAAY,CAAC,GAAG,CAAG,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,OAAO,CAAC,CAAC;YACjF,MAAM,SAAS,CAAC,kBAAkB,CAAC,IAAI,EAAE,gBAAG,EAAuB,SAAS,CAAC,CAAC;YAC9E,MAAM,CAAC,WAAW,CAAC,sBAAsB,CAAC,KAAK,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAC3D,MAAM,CAAC,KAAK,CAAC,GAAG,sBAAsB,CAAC,KAAK,CAAC;YAC7C,MAAM,CAAC,EAAE,CAAC,OAA+B,KAAM,CAAC,SAAS,KAAK,WAAW,CAAC,CAAC;QAC5E,CAAC,CAAC,CAAC;IAEJ,CAAC,CAAC,CAAC","file":"extHostBulkEdits.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as assert from 'assert';\nimport * as extHostTypes from 'vs/workbench/api/common/extHostTypes';\nimport { MainContext, IWorkspaceEditDto, MainThreadBulkEditsShape, IWorkspaceTextEditDto } from 'vs/workbench/api/common/extHost.protocol';\nimport { URI } from 'vs/base/common/uri';\nimport { mock } from 'vs/base/test/common/mock';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\nimport { SingleProxyRPCProtocol, TestRPCProtocol } from 'vs/workbench/api/test/common/testRPCProtocol';\nimport { NullLogService } from 'vs/platform/log/common/log';\nimport { ExtHostBulkEdits } from 'vs/workbench/api/common/extHostBulkEdits';\nimport { nullExtensionDescription } from 'vs/workbench/services/extensions/common/extensions';\n\nsuite('ExtHostBulkEdits.applyWorkspaceEdit', () => {\n\n\tconst resource = URI.parse('foo:bar');\n\tlet bulkEdits: ExtHostBulkEdits;\n\tlet workspaceResourceEdits: IWorkspaceEditDto;\n\n\tsetup(() => {\n\t\tworkspaceResourceEdits = null!;\n\n\t\tconst rpcProtocol = new TestRPCProtocol();\n\t\trpcProtocol.set(MainContext.MainThreadBulkEdits, new class extends mock<MainThreadBulkEditsShape>() {\n\t\t\toverride $tryApplyWorkspaceEdit(_workspaceResourceEdits: IWorkspaceEditDto): Promise<boolean> {\n\t\t\t\tworkspaceResourceEdits = _workspaceResourceEdits;\n\t\t\t\treturn Promise.resolve(true);\n\t\t\t}\n\t\t});\n\t\tconst documentsAndEditors = new ExtHostDocumentsAndEditors(SingleProxyRPCProtocol(null), new NullLogService());\n\t\tdocumentsAndEditors.$acceptDocumentsAndEditorsDelta({\n\t\t\taddedDocuments: [{\n\t\t\t\tisDirty: false,\n\t\t\t\tlanguageId: 'foo',\n\t\t\t\turi: resource,\n\t\t\t\tversionId: 1337,\n\t\t\t\tlines: ['foo'],\n\t\t\t\tEOL: '\\n',\n\t\t\t}]\n\t\t});\n\t\tbulkEdits = new ExtHostBulkEdits(rpcProtocol, documentsAndEditors);\n\t});\n\n\ttest('uses version id if document available', async () => {\n\t\tconst edit = new extHostTypes.WorkspaceEdit();\n\t\tedit.replace(resource, new extHostTypes.Range(0, 0, 0, 0), 'hello');\n\t\tawait bulkEdits.applyWorkspaceEdit(edit, nullExtensionDescription, undefined);\n\t\tassert.strictEqual(workspaceResourceEdits.edits.length, 1);\n\t\tconst [first] = workspaceResourceEdits.edits;\n\t\tassert.strictEqual((<IWorkspaceTextEditDto>first).versionId, 1337);\n\t});\n\n\ttest('does not use version id if document is not available', async () => {\n\t\tconst edit = new extHostTypes.WorkspaceEdit();\n\t\tedit.replace(URI.parse('foo:bar2'), new extHostTypes.Range(0, 0, 0, 0), 'hello');\n\t\tawait bulkEdits.applyWorkspaceEdit(edit, nullExtensionDescription, undefined);\n\t\tassert.strictEqual(workspaceResourceEdits.edits.length, 1);\n\t\tconst [first] = workspaceResourceEdits.edits;\n\t\tassert.ok(typeof (<IWorkspaceTextEditDto>first).versionId === 'undefined');\n\t});\n\n});\n"]}