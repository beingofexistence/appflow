{"version":3,"sources":["file:///workspace/appflow/src/vs/workbench/api/common/extHostTestItem.ts"],"names":[],"mappings":";;;;IAcA,MAAM,oBAAoB,GAAG,CAC5B,GAAwB,EACxB,YAAgC,EAChC,MAAiE,EACjE,QAA8F,EAC7F,EAAE;QACH,IAAI,KAAK,GAAG,YAAY,CAAC;QACzB,OAAO;YACN,UAAU,EAAE,IAAI;YAChB,YAAY,EAAE,KAAK;YACnB,GAAG;gBACF,OAAO,KAAK,CAAC;YACd,CAAC;YACD,GAAG,CAAC,QAA4B;gBAC/B,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE;oBAC7B,MAAM,QAAQ,GAAG,KAAK,CAAC;oBACvB,KAAK,GAAG,QAAQ,CAAC;oBACjB,GAAG,CAAC,QAAQ,EAAE,CAAC,QAAQ,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC,CAAC;iBAC7C;YACF,CAAC;SACD,CAAC;IACH,CAAC,CAAC;IAIF,MAAM,qBAAqB,GAAG,CAAI,CAAI,EAAE,CAAI,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC;IAEzD,MAAM,eAAe,GAAwG;QAC5H,KAAK,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;YACf,IAAI,CAAC,KAAK,CAAC,EAAE;gBAAE,OAAO,IAAI,CAAC;aAAE;YAC7B,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,EAAE;gBAAE,OAAO,KAAK,CAAC;aAAE;YAC/B,OAAO,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;QACrB,CAAC;QACD,KAAK,EAAE,qBAAqB;QAC5B,WAAW,EAAE,qBAAqB;QAClC,QAAQ,EAAE,qBAAqB;QAC/B,IAAI,EAAE,qBAAqB;QAC3B,KAAK,EAAE,qBAAqB;QAC5B,kBAAkB,EAAE,qBAAqB;QACzC,IAAI,EAAE,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;YACd,IAAI,CAAC,CAAC,MAAM,KAAK,CAAC,CAAC,MAAM,EAAE;gBAC1B,OAAO,KAAK,CAAC;aACb;YAED,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE;gBACjD,OAAO,KAAK,CAAC;aACb;YAED,OAAO,IAAI,CAAC;QACb,CAAC;KACD,CAAC;IAEF,MAAM,UAAU,GAAG,CAAI,EAAuC,EAAyC,EAAE,CACxG,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,iCAAyB,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;IAEvD,MAAM,mBAAmB,GAAG,CAAC,GAAwB,EAAE,KAAa,EAAgE,EAAE,CAAC,CAAC;QACvI,KAAK,EAAE,CAAC,GAAG,EAAE;YACZ,IAAI,KAA+B,CAAC;YACpC,MAAM,WAAW,GAAG,UAAU,CAA2B,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,WAAW,CAAC,GAAG,CAAG,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;YAC1H,OAAO;gBACN,UAAU,EAAE,IAAI;gBAChB,YAAY,EAAE,KAAK;gBACnB,GAAG;oBACF,OAAO,KAAK,CAAC;gBACd,CAAC;gBACD,GAAG,CAAC,QAAkC;oBACrC,GAAG,CAAC,QAAQ,EAAE,CAAC,EAAE,EAAE,wCAAgC,EAAE,CAAC,CAAC;oBACvD,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,KAAK,EAAE,QAAQ,CAAC,EAAE;wBAC5C,KAAK,GAAG,QAAQ,CAAC;wBACjB,GAAG,CAAC,QAAQ,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC,CAAC,CAAC;qBACtC;gBACF,CAAC;aACD,CAAC;QACH,CAAC,CAAC,EAAE;QACJ,KAAK,EAAE,oBAAoB,CAAU,GAAG,EAAE,KAAK,EAAE,eAAe,CAAC,KAAK,EAAE,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;QACzG,WAAW,EAAE,oBAAoB,CAAgB,GAAG,EAAE,SAAS,EAAE,eAAe,CAAC,WAAW,EAAE,UAAU,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,EAAE,WAAW,EAAE,CAAC,CAAC,CAAC;QAC3I,QAAQ,EAAE,oBAAoB,CAAa,GAAG,EAAE,SAAS,EAAE,eAAe,CAAC,QAAQ,EAAE,UAAU,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;QAC5H,kBAAkB,EAAE,oBAAoB,CAAuB,GAAG,EAAE,KAAK,EAAE,eAAe,CAAC,kBAAkB,EAAE,KAAK,CAAC,EAAE,CAAC,CAAC;YACxH,EAAE,kDAA0C;YAC5C,KAAK;SACL,CAAC,CAAC;QACH,IAAI,EAAE,oBAAoB,CAAS,GAAG,EAAE,KAAK,EAAE,eAAe,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;QACpG,KAAK,EAAE,oBAAoB,CAAU,GAAG,EAAE,SAAS,EAAE,eAAe,CAAC,KAAK,EAAE,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,EAAE,KAAK,EAAE,OAAO,CAAC,cAAc,CAAC,UAAU,CAAC,KAAK,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC;QAC/J,IAAI,EAAE,oBAAoB,CAAS,GAAG,EAAE,EAAE,EAAE,eAAe,CAAC,IAAI,EAAE,CAAC,OAAO,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;YACzF,EAAE,iCAAyB;YAC3B,GAAG,EAAE,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC;YACtC,GAAG,EAAE,QAAQ,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC;SACvC,CAAC,CAAC;KACH,CAAC,CAAC;IAEH,MAAM,eAAe,GAAG,CAAC,IAA0B,EAAgB,EAAE;QACpE,MAAM,MAAM,GAAG,YAAG,CAAI,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAC7C,MAAM,QAAQ,GAAG,IAAI,GAAG,CAAU,MAAM,CAAC,YAAY,EAAE,MAAM,CAAC,OAAO,EAAE,IAAI,CAAC,KAAK,EAAE,SAAG,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,SAAS,CAAC,CAAC;QACtH,QAAQ,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,CAAC,EAAE,CAAC,IAAI,CAAC,KAAK,IAAI,SAAS,CAAC,CAAC;QAC3D,QAAQ,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,IAAI,SAAS,CAAC;QACrD,QAAQ,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,IAAI,SAAS,CAAC;QAC/C,QAAQ,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,IAAA,eAAG,EAAgB,CAAC,CAAC,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QAC5F,OAAO,QAAQ,CAAC;IACjB,CAAC,CAAC;IAEK,MAAM,GAAG,GAAiB,CAAC,OAAyB,EAAgB,EAAE;QAC5E,IAAI,IAA8B,CAAC;QACnC,KAAK,MAAM,IAAI,IAAI,OAAO,CAAC,KAAK,EAAE;YACjC,MAAM,IAAI,GAAG,eAAe,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACxC,IAAA,8BAAG,EAAc,IAAI,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC;YACrC,IAAI,GAAG,IAAI,CAAC;SACZ;QAED,OAAO,IAAK,CAAC;IACd,CAAC,CAAC;IATW,QAAA,GAAG,OASd;IAEF,MAAa,GAAG;QAef;;WAEG;QACH,YAAY,YAAoB,EAAE,EAAU,EAAE,KAAa,EAAE,GAA2B;YACvF,IAAI,EAAE,CAAC,QAAQ,sCAA2B,EAAE;gBAC3C,MAAM,IAAI,KAAK,CAAC,gCAAgC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC;aAC7E;YAED,MAAM,GAAG,GAAG,IAAA,8BAAG,EAAiB,IAAI,EAAE,YAAY,CAAC,CAAC;YACpD,MAAM,CAAC,gBAAgB,CAAC,IAAI,EAAE;gBAC7B,EAAE,EAAE;oBACH,KAAK,EAAE,EAAE;oBACT,UAAU,EAAE,IAAI;oBAChB,QAAQ,EAAE,KAAK;iBACf;gBACD,GAAG,EAAE;oBACJ,KAAK,EAAE,GAAG;oBACV,UAAU,EAAE,IAAI;oBAChB,QAAQ,EAAE,KAAK;iBACf;gBACD,MAAM,EAAE;oBACP,UAAU,EAAE,KAAK;oBACjB,GAAG;wBACF,OAAO,GAAG,CAAC,MAAM,YAAY,GAAG,CAAc,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC;oBACxE,CAAC;iBACD;gBACD,QAAQ,EAAE;oBACT,KAAK,EAAE,IAAA,wBAAG,EAAoB,GAAG,EAAE,8BAAG,EAAe,GAAG,CAAU;oBAClE,UAAU,EAAE,IAAI;oBAChB,QAAQ,EAAE,KAAK;iBACf;gBACD,GAAG,mBAAmB,CAAC,GAAG,EAAE,KAAK,CAAC;aAClC,CAAC,CAAC;QACJ,CAAC;KACD;IAjDD,kBAiDC;IAED,MAAa,GAAiB,SAAQ,GAAG;QAGxC,YAAY,YAAoB,EAAE,KAAa;YAC9C,KAAK,CAAC,YAAY,EAAE,YAAY,EAAE,KAAK,EAAE,SAAS,CAAC,CAAC;YAHrC,YAAO,GAAG,IAAI,CAAC;QAI/B,CAAC;KACD;IAND,kBAMC;IAED,MAAa,GAA0B,SAAQ,wBAAgC;QAC9E,YAAY,YAAoB,EAAE,eAAuB,EAAE,OAAY;YACtE,KAAK,CAAC;gBACL,YAAY;gBACZ,kBAAkB,EAAE,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,OAAO,CAAC,WAAW,CAAC,GAAG,CAAC,EAAE,OAAO;gBACnE,SAAS,EAAE,8BAAsE;gBACjF,WAAW,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,QAA2C;gBACvE,IAAI,EAAE,IAAI,GAAG,CAAc,YAAY,EAAE,eAAe,CAAC;gBACzD,WAAW,EAAE,OAAO,CAAC,QAAQ,CAAC,IAAI;aAClC,CAAC,CAAC;QACJ,CAAC;KACD;IAXD,kBAWC","file":"extHostTestItem.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as editorRange from 'vs/editor/common/core/range';\nimport { createPrivateApiFor, getPrivateApiFor, IExtHostTestItemApi } from 'vs/workbench/api/common/extHostTestingPrivateApi';\nimport { TestId, TestIdPathParts } from 'vs/workbench/contrib/testing/common/testId';\nimport { createTestItemChildren, ExtHostTestItemEvent, ITestChildrenLike, ITestItemApi, ITestItemChildren, TestItemCollection, TestItemEventOp } from 'vs/workbench/contrib/testing/common/testItemCollection';\nimport { denamespaceTestTag, ITestItem, ITestItemContext } from 'vs/workbench/contrib/testing/common/testTypes';\nimport type * as vscode from 'vscode';\nimport * as Convert from 'vs/workbench/api/common/extHostTypeConverters';\nimport { URI } from 'vs/base/common/uri';\nimport { ExtHostDocumentsAndEditors } from 'vs/workbench/api/common/extHostDocumentsAndEditors';\n\nconst testItemPropAccessor = <K extends keyof vscode.TestItem>(\n\tapi: IExtHostTestItemApi,\n\tdefaultValue: vscode.TestItem[K],\n\tequals: (a: vscode.TestItem[K], b: vscode.TestItem[K]) => boolean,\n\ttoUpdate: (newValue: vscode.TestItem[K], oldValue: vscode.TestItem[K]) => ExtHostTestItemEvent,\n) => {\n\tlet value = defaultValue;\n\treturn {\n\t\tenumerable: true,\n\t\tconfigurable: false,\n\t\tget() {\n\t\t\treturn value;\n\t\t},\n\t\tset(newValue: vscode.TestItem[K]) {\n\t\t\tif (!equals(value, newValue)) {\n\t\t\t\tconst oldValue = value;\n\t\t\t\tvalue = newValue;\n\t\t\t\tapi.listener?.(toUpdate(newValue, oldValue));\n\t\t\t}\n\t\t},\n\t};\n};\n\ntype WritableProps = Pick<vscode.TestItem, 'range' | 'label' | 'description' | 'sortText' | 'canResolveChildren' | 'busy' | 'error' | 'tags'>;\n\nconst strictEqualComparator = <T>(a: T, b: T) => a === b;\n\nconst propComparators: { [K in keyof Required<WritableProps>]: (a: vscode.TestItem[K], b: vscode.TestItem[K]) => boolean } = {\n\trange: (a, b) => {\n\t\tif (a === b) { return true; }\n\t\tif (!a || !b) { return false; }\n\t\treturn a.isEqual(b);\n\t},\n\tlabel: strictEqualComparator,\n\tdescription: strictEqualComparator,\n\tsortText: strictEqualComparator,\n\tbusy: strictEqualComparator,\n\terror: strictEqualComparator,\n\tcanResolveChildren: strictEqualComparator,\n\ttags: (a, b) => {\n\t\tif (a.length !== b.length) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (a.some(t1 => !b.find(t2 => t1.id === t2.id))) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t},\n};\n\nconst evSetProps = <T>(fn: (newValue: T) => Partial<ITestItem>): (newValue: T) => ExtHostTestItemEvent =>\n\tv => ({ op: TestItemEventOp.SetProp, update: fn(v) });\n\nconst makePropDescriptors = (api: IExtHostTestItemApi, label: string): { [K in keyof Required<WritableProps>]: PropertyDescriptor } => ({\n\trange: (() => {\n\t\tlet value: vscode.Range | undefined;\n\t\tconst updateProps = evSetProps<vscode.Range | undefined>(r => ({ range: editorRange.Range.lift(Convert.Range.from(r)) }));\n\t\treturn {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget() {\n\t\t\t\treturn value;\n\t\t\t},\n\t\t\tset(newValue: vscode.Range | undefined) {\n\t\t\t\tapi.listener?.({ op: TestItemEventOp.DocumentSynced });\n\t\t\t\tif (!propComparators.range(value, newValue)) {\n\t\t\t\t\tvalue = newValue;\n\t\t\t\t\tapi.listener?.(updateProps(newValue));\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t})(),\n\tlabel: testItemPropAccessor<'label'>(api, label, propComparators.label, evSetProps(label => ({ label }))),\n\tdescription: testItemPropAccessor<'description'>(api, undefined, propComparators.description, evSetProps(description => ({ description }))),\n\tsortText: testItemPropAccessor<'sortText'>(api, undefined, propComparators.sortText, evSetProps(sortText => ({ sortText }))),\n\tcanResolveChildren: testItemPropAccessor<'canResolveChildren'>(api, false, propComparators.canResolveChildren, state => ({\n\t\top: TestItemEventOp.UpdateCanResolveChildren,\n\t\tstate,\n\t})),\n\tbusy: testItemPropAccessor<'busy'>(api, false, propComparators.busy, evSetProps(busy => ({ busy }))),\n\terror: testItemPropAccessor<'error'>(api, undefined, propComparators.error, evSetProps(error => ({ error: Convert.MarkdownString.fromStrict(error) || null }))),\n\ttags: testItemPropAccessor<'tags'>(api, [], propComparators.tags, (current, previous) => ({\n\t\top: TestItemEventOp.SetTags,\n\t\tnew: current.map(Convert.TestTag.from),\n\t\told: previous.map(Convert.TestTag.from),\n\t})),\n});\n\nconst toItemFromPlain = (item: ITestItem.Serialized): TestItemImpl => {\n\tconst testId = TestId.fromString(item.extId);\n\tconst testItem = new TestItemImpl(testId.controllerId, testId.localId, item.label, URI.revive(item.uri) || undefined);\n\ttestItem.range = Convert.Range.to(item.range || undefined);\n\ttestItem.description = item.description || undefined;\n\ttestItem.sortText = item.sortText || undefined;\n\ttestItem.tags = item.tags.map(t => Convert.TestTag.to({ id: denamespaceTestTag(t).tagId }));\n\treturn testItem;\n};\n\nexport const toItemFromContext = (context: ITestItemContext): TestItemImpl => {\n\tlet node: TestItemImpl | undefined;\n\tfor (const test of context.tests) {\n\t\tconst next = toItemFromPlain(test.item);\n\t\tgetPrivateApiFor(next).parent = node;\n\t\tnode = next;\n\t}\n\n\treturn node!;\n};\n\nexport class TestItemImpl implements vscode.TestItem {\n\tpublic readonly id!: string;\n\tpublic readonly uri!: vscode.Uri | undefined;\n\tpublic readonly children!: ITestItemChildren<vscode.TestItem>;\n\tpublic readonly parent!: TestItemImpl | undefined;\n\n\tpublic range!: vscode.Range | undefined;\n\tpublic description!: string | undefined;\n\tpublic sortText!: string | undefined;\n\tpublic label!: string;\n\tpublic error!: string | vscode.MarkdownString;\n\tpublic busy!: boolean;\n\tpublic canResolveChildren!: boolean;\n\tpublic tags!: readonly vscode.TestTag[];\n\n\t/**\n\t * Note that data is deprecated and here for back-compat only\n\t */\n\tconstructor(controllerId: string, id: string, label: string, uri: vscode.Uri | undefined) {\n\t\tif (id.includes(TestIdPathParts.Delimiter)) {\n\t\t\tthrow new Error(`Test IDs may not include the ${JSON.stringify(id)} symbol`);\n\t\t}\n\n\t\tconst api = createPrivateApiFor(this, controllerId);\n\t\tObject.defineProperties(this, {\n\t\t\tid: {\n\t\t\t\tvalue: id,\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t},\n\t\t\turi: {\n\t\t\t\tvalue: uri,\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t},\n\t\t\tparent: {\n\t\t\t\tenumerable: false,\n\t\t\t\tget() {\n\t\t\t\t\treturn api.parent instanceof TestItemRootImpl ? undefined : api.parent;\n\t\t\t\t},\n\t\t\t},\n\t\t\tchildren: {\n\t\t\t\tvalue: createTestItemChildren(api, getPrivateApiFor, TestItemImpl),\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t},\n\t\t\t...makePropDescriptors(api, label),\n\t\t});\n\t}\n}\n\nexport class TestItemRootImpl extends TestItemImpl {\n\tpublic readonly _isRoot = true;\n\n\tconstructor(controllerId: string, label: string) {\n\t\tsuper(controllerId, controllerId, label, undefined);\n\t}\n}\n\nexport class ExtHostTestItemCollection extends TestItemCollection<TestItemImpl> {\n\tconstructor(controllerId: string, controllerLabel: string, editors: ExtHostDocumentsAndEditors) {\n\t\tsuper({\n\t\t\tcontrollerId,\n\t\t\tgetDocumentVersion: uri => uri && editors.getDocument(uri)?.version,\n\t\t\tgetApiFor: getPrivateApiFor as (impl: TestItemImpl) => ITestItemApi<TestItemImpl>,\n\t\t\tgetChildren: (item) => item.children as ITestChildrenLike<TestItemImpl>,\n\t\t\troot: new TestItemRootImpl(controllerId, controllerLabel),\n\t\t\ttoITestItem: Convert.TestItem.from,\n\t\t});\n\t}\n}\n"]}