{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/test/common/model/bracketPairColorizer/getBracketPairsInRange.test.ts"],"names":[],"mappings":"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","file":"getBracketPairsInRange.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { DisposableStore, disposeOnReturn } from 'vs/base/common/lifecycle';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from 'vs/base/test/common/utils';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Range } from 'vs/editor/common/core/range';\nimport { StandardTokenType } from 'vs/editor/common/encodedTokenAttributes';\nimport { TokenizationRegistry } from 'vs/editor/common/languages';\nimport { ILanguageService } from 'vs/editor/common/languages/language';\nimport { ILanguageConfigurationService } from 'vs/editor/common/languages/languageConfigurationRegistry';\nimport { TextModel } from 'vs/editor/common/model/textModel';\nimport { BracketPairInfo } from 'vs/editor/common/textModelBracketPairs';\nimport { TokenInfo, TokenizedDocument } from 'vs/editor/test/common/model/bracketPairColorizer/tokenizer.test';\nimport { createModelServices, instantiateTextModel } from 'vs/editor/test/common/testTextModel';\n\nsuite('Bracket Pair Colorizer - getBracketPairsInRange', () => {\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\tfunction createTextModelWithColorizedBracketPairs(store: DisposableStore, text: string): TextModel {\n\t\tconst languageId = 'testLanguage';\n\t\tconst instantiationService = createModelServices(store);\n\t\tconst languageConfigurationService = instantiationService.get(ILanguageConfigurationService);\n\t\tconst languageService = instantiationService.get(ILanguageService);\n\t\tstore.add(languageService.registerLanguage({\n\t\t\tid: languageId,\n\t\t}));\n\n\t\tconst encodedMode1 = languageService.languageIdCodec.encodeLanguageId(languageId);\n\t\tconst document = new TokenizedDocument([\n\t\t\tnew TokenInfo(text, encodedMode1, StandardTokenType.Other, true)\n\t\t]);\n\t\tstore.add(TokenizationRegistry.register(languageId, document.getTokenizationSupport()));\n\n\t\tstore.add(languageConfigurationService.register(languageId, {\n\t\t\tbrackets: [\n\t\t\t\t['<', '>']\n\t\t\t],\n\t\t\tcolorizedBracketPairs: [\n\t\t\t\t['{', '}'],\n\t\t\t\t['[', ']'],\n\t\t\t\t['(', ')'],\n\t\t\t]\n\t\t}));\n\t\tconst textModel = store.add(instantiateTextModel(instantiationService, text, languageId));\n\t\treturn textModel;\n\t}\n\n\ttest('Basic 1', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`{ ( [] ¹ ) [ ² { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tmodel.tokenization.getLineTokens(1).getLanguageId(0);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,1 -> 1,2]',\n\t\t\t\t\t\topenRange: '[1,1 -> 1,2]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t\topenRange: '[1,3 -> 1,4]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,11 -> 1,12]',\n\t\t\t\t\t\topenRange: '[1,11 -> 1,12]',\n\t\t\t\t\t\tcloseRange: '[1,18 -> 1,19]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic 2', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`{ ( [] ¹ ²) [  { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,1 -> 1,2]',\n\t\t\t\t\t\topenRange: '[1,1 -> 1,2]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,3 -> 1,4]',\n\t\t\t\t\t\topenRange: '[1,3 -> 1,4]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic Empty', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ ² { ( [] ) [  { } ] () } []`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Basic All', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { ( [] ) [  { } ] () } [] ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketPairsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(bracketPairToJSON)\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,2 -> 1,3]',\n\t\t\t\t\t\topenRange: '[1,2 -> 1,3]',\n\t\t\t\t\t\tcloseRange: '[1,23 -> 1,24]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,4 -> 1,5]',\n\t\t\t\t\t\topenRange: '[1,4 -> 1,5]',\n\t\t\t\t\t\tcloseRange: '[1,9 -> 1,10]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\trange: '[1,6 -> 1,7]',\n\t\t\t\t\t\topenRange: '[1,6 -> 1,7]',\n\t\t\t\t\t\tcloseRange: '[1,7 -> 1,8]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,11 -> 1,12]',\n\t\t\t\t\t\topenRange: '[1,11 -> 1,12]',\n\t\t\t\t\t\tcloseRange: '[1,18 -> 1,19]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\trange: '[1,14 -> 1,15]',\n\t\t\t\t\t\topenRange: '[1,14 -> 1,15]',\n\t\t\t\t\t\tcloseRange: '[1,16 -> 1,17]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\trange: '[1,20 -> 1,21]',\n\t\t\t\t\t\topenRange: '[1,20 -> 1,21]',\n\t\t\t\t\t\tcloseRange: '[1,21 -> 1,22]',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\trange: '[1,25 -> 1,26]',\n\t\t\t\t\t\topenRange: '[1,25 -> 1,26]',\n\t\t\t\t\t\tcloseRange: '[1,26 -> 1,27]',\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('getBracketsInRange', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { [ ( [ [ (  ) ] ] ) ] } { } ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,2 -> 1,3]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,4 -> 1,5]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,6 -> 1,7]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 3,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: \"[1,8 -> 1,9]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 4,\n\t\t\t\t\t\tlevelEqualBracketType: 2,\n\t\t\t\t\t\trange: \"[1,10 -> 1,11]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 5,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: \"[1,12 -> 1,13]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 5,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: \"[1,15 -> 1,16]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 4,\n\t\t\t\t\t\tlevelEqualBracketType: 2,\n\t\t\t\t\t\trange: \"[1,17 -> 1,18]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 3,\n\t\t\t\t\t\tlevelEqualBracketType: 1,\n\t\t\t\t\t\trange: \"[1,19 -> 1,20]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,21 -> 1,22]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,23 -> 1,24]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,25 -> 1,26]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,27 -> 1,28]\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,29 -> 1,30]\"\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\ttest('Test Error Brackets', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ { () ] ² `);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2))\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, range: b.range.toString(), isInvalid: b.isInvalid }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tisInvalid: true,\n\t\t\t\t\t\trange: \"[1,2 -> 1,3]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tisInvalid: false,\n\t\t\t\t\t\trange: \"[1,4 -> 1,5]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tisInvalid: false,\n\t\t\t\t\t\trange: \"[1,5 -> 1,6]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tisInvalid: true,\n\t\t\t\t\t\trange: \"[1,7 -> 1,8]\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n\n\n\ttest('colorizedBracketsVSBrackets', () => {\n\t\tdisposeOnReturn(store => {\n\t\t\tconst doc = new AnnotatedDocument(`¹ {} [<()>] <{>} ²`);\n\t\t\tconst model = createTextModelWithColorizedBracketPairs(store, doc.text);\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2), true)\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,2 -> 1,3]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,3 -> 1,4]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,5 -> 1,6]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,7 -> 1,8]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,8 -> 1,9]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,10 -> 1,11]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,13 -> 1,14]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: -1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,15 -> 1,16]\",\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\n\t\t\tassert.deepStrictEqual(\n\t\t\t\tmodel.bracketPairs\n\t\t\t\t\t.getBracketsInRange(doc.range(1, 2), false)\n\t\t\t\t\t.map(b => ({ level: b.nestingLevel, levelEqualBracketType: b.nestingLevelOfEqualBracketType, range: b.range.toString() }))\n\t\t\t\t\t.toArray(),\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,2 -> 1,3]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,3 -> 1,4]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,5 -> 1,6]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,6 -> 1,7]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,7 -> 1,8]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 2,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,8 -> 1,9]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,9 -> 1,10]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,10 -> 1,11]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,12 -> 1,13]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,13 -> 1,14]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: 0,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,14 -> 1,15]\",\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlevel: -1,\n\t\t\t\t\t\tlevelEqualBracketType: 0,\n\t\t\t\t\t\trange: \"[1,15 -> 1,16]\",\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t);\n\t\t});\n\t});\n});\n\nfunction bracketPairToJSON(pair: BracketPairInfo): unknown {\n\treturn {\n\t\tlevel: pair.nestingLevel,\n\t\trange: pair.openingBracketRange.toString(),\n\t\topenRange: pair.openingBracketRange.toString(),\n\t\tcloseRange: pair.closingBracketRange?.toString() || null,\n\t};\n}\n\nclass PositionOffsetTransformer {\n\tprivate readonly lineStartOffsetByLineIdx: number[];\n\n\tconstructor(text: string) {\n\t\tthis.lineStartOffsetByLineIdx = [];\n\t\tthis.lineStartOffsetByLineIdx.push(0);\n\t\tfor (let i = 0; i < text.length; i++) {\n\t\t\tif (text.charAt(i) === '\\n') {\n\t\t\t\tthis.lineStartOffsetByLineIdx.push(i + 1);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset(position: Position): number {\n\t\treturn this.lineStartOffsetByLineIdx[position.lineNumber - 1] + position.column - 1;\n\t}\n\n\tgetPosition(offset: number): Position {\n\t\tconst lineNumber = this.lineStartOffsetByLineIdx.findIndex(lineStartOffset => lineStartOffset <= offset);\n\t\treturn new Position(lineNumber + 1, offset - this.lineStartOffsetByLineIdx[lineNumber] + 1);\n\t}\n}\n\nclass AnnotatedDocument {\n\tpublic readonly text: string;\n\tprivate readonly positions: ReadonlyMap<number, Position>;\n\n\tconstructor(src: string) {\n\t\tconst numbers = ['⁰', '¹', '²', '³', '⁴', '⁵', '⁶', '⁷', '⁸', '⁹'];\n\n\t\tlet text = '';\n\t\tconst offsetPositions = new Map<number, number>();\n\n\t\tlet offset = 0;\n\t\tfor (let i = 0; i < src.length; i++) {\n\t\t\tconst idx = numbers.indexOf(src[i]);\n\t\t\tif (idx >= 0) {\n\t\t\t\toffsetPositions.set(idx, offset);\n\t\t\t} else {\n\t\t\t\ttext += src[i];\n\t\t\t\toffset++;\n\t\t\t}\n\t\t}\n\n\t\tthis.text = text;\n\n\t\tconst mapper = new PositionOffsetTransformer(this.text);\n\t\tconst positions = new Map<number, Position>();\n\t\tfor (const [idx, offset] of offsetPositions.entries()) {\n\t\t\tpositions.set(idx, mapper.getPosition(offset));\n\t\t}\n\t\tthis.positions = positions;\n\t}\n\n\trange(start: number, end: number): Range {\n\t\treturn Range.fromPositions(this.positions.get(start)!, this.positions.get(end)!);\n\t}\n}\n"]}