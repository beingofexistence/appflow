{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/contrib/find/browser/findDecorations.ts"],"names":[],"mappings":"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","file":"findDecorations.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { IActiveCodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Range } from 'vs/editor/common/core/range';\nimport { FindMatch, IModelDecorationsChangeAccessor, IModelDeltaDecoration, MinimapPosition, OverviewRulerLane, TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { minimapFindMatch, overviewRulerFindMatchForeground } from 'vs/platform/theme/common/colorRegistry';\nimport { themeColorFromId } from 'vs/platform/theme/common/themeService';\n\nexport class FindDecorations implements IDisposable {\n\n\tprivate readonly _editor: IActiveCodeEditor;\n\tprivate _decorations: string[];\n\tprivate _overviewRulerApproximateDecorations: string[];\n\tprivate _findScopeDecorationIds: string[];\n\tprivate _rangeHighlightDecorationId: string | null;\n\tprivate _highlightedDecorationId: string | null;\n\tprivate _startPosition: Position;\n\n\tconstructor(editor: IActiveCodeEditor) {\n\t\tthis._editor = editor;\n\t\tthis._decorations = [];\n\t\tthis._overviewRulerApproximateDecorations = [];\n\t\tthis._findScopeDecorationIds = [];\n\t\tthis._rangeHighlightDecorationId = null;\n\t\tthis._highlightedDecorationId = null;\n\t\tthis._startPosition = this._editor.getPosition();\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._editor.removeDecorations(this._allDecorations());\n\n\t\tthis._decorations = [];\n\t\tthis._overviewRulerApproximateDecorations = [];\n\t\tthis._findScopeDecorationIds = [];\n\t\tthis._rangeHighlightDecorationId = null;\n\t\tthis._highlightedDecorationId = null;\n\t}\n\n\tpublic reset(): void {\n\t\tthis._decorations = [];\n\t\tthis._overviewRulerApproximateDecorations = [];\n\t\tthis._findScopeDecorationIds = [];\n\t\tthis._rangeHighlightDecorationId = null;\n\t\tthis._highlightedDecorationId = null;\n\t}\n\n\tpublic getCount(): number {\n\t\treturn this._decorations.length;\n\t}\n\n\t/** @deprecated use getFindScopes to support multiple selections */\n\tpublic getFindScope(): Range | null {\n\t\tif (this._findScopeDecorationIds[0]) {\n\t\t\treturn this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]);\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic getFindScopes(): Range[] | null {\n\t\tif (this._findScopeDecorationIds.length) {\n\t\t\tconst scopes = this._findScopeDecorationIds.map(findScopeDecorationId =>\n\t\t\t\tthis._editor.getModel().getDecorationRange(findScopeDecorationId)\n\t\t\t).filter(element => !!element);\n\t\t\tif (scopes.length) {\n\t\t\t\treturn scopes as Range[];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic getStartPosition(): Position {\n\t\treturn this._startPosition;\n\t}\n\n\tpublic setStartPosition(newStartPosition: Position): void {\n\t\tthis._startPosition = newStartPosition;\n\t\tthis.setCurrentFindMatch(null);\n\t}\n\n\tprivate _getDecorationIndex(decorationId: string): number {\n\t\tconst index = this._decorations.indexOf(decorationId);\n\t\tif (index >= 0) {\n\t\t\treturn index + 1;\n\t\t}\n\t\treturn 1;\n\t}\n\n\tpublic getDecorationRangeAt(index: number): Range | null {\n\t\tconst decorationId = index < this._decorations.length ? this._decorations[index] : null;\n\t\tif (decorationId) {\n\t\t\treturn this._editor.getModel().getDecorationRange(decorationId);\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic getCurrentMatchesPosition(desiredRange: Range): number {\n\t\tconst candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\n\t\tfor (const candidate of candidates) {\n\t\t\tconst candidateOpts = candidate.options;\n\t\t\tif (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\n\t\t\t\treturn this._getDecorationIndex(candidate.id);\n\t\t\t}\n\t\t}\n\t\t// We don't know the current match position, so returns zero to show '?' in find widget\n\t\treturn 0;\n\t}\n\n\tpublic setCurrentFindMatch(nextMatch: Range | null): number {\n\t\tlet newCurrentDecorationId: string | null = null;\n\t\tlet matchPosition = 0;\n\t\tif (nextMatch) {\n\t\t\tfor (let i = 0, len = this._decorations.length; i < len; i++) {\n\t\t\t\tconst range = this._editor.getModel().getDecorationRange(this._decorations[i]);\n\t\t\t\tif (nextMatch.equalsRange(range)) {\n\t\t\t\t\tnewCurrentDecorationId = this._decorations[i];\n\t\t\t\t\tmatchPosition = (i + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\n\t\t\tthis._editor.changeDecorations((changeAccessor: IModelDecorationsChangeAccessor) => {\n\t\t\t\tif (this._highlightedDecorationId !== null) {\n\t\t\t\t\tchangeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\n\t\t\t\t\tthis._highlightedDecorationId = null;\n\t\t\t\t}\n\t\t\t\tif (newCurrentDecorationId !== null) {\n\t\t\t\t\tthis._highlightedDecorationId = newCurrentDecorationId;\n\t\t\t\t\tchangeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\n\t\t\t\t}\n\t\t\t\tif (this._rangeHighlightDecorationId !== null) {\n\t\t\t\t\tchangeAccessor.removeDecoration(this._rangeHighlightDecorationId);\n\t\t\t\t\tthis._rangeHighlightDecorationId = null;\n\t\t\t\t}\n\t\t\t\tif (newCurrentDecorationId !== null) {\n\t\t\t\t\tlet rng = this._editor.getModel().getDecorationRange(newCurrentDecorationId)!;\n\t\t\t\t\tif (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\n\t\t\t\t\t\tconst lineBeforeEnd = rng.endLineNumber - 1;\n\t\t\t\t\t\tconst lineBeforeEndMaxColumn = this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\n\t\t\t\t\t\trng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\n\t\t\t\t\t}\n\t\t\t\t\tthis._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn matchPosition;\n\t}\n\n\tpublic set(findMatches: FindMatch[], findScopes: Range[] | null): void {\n\t\tthis._editor.changeDecorations((accessor) => {\n\n\t\t\tlet findMatchesOptions: ModelDecorationOptions = FindDecorations._FIND_MATCH_DECORATION;\n\t\t\tconst newOverviewRulerApproximateDecorations: IModelDeltaDecoration[] = [];\n\n\t\t\tif (findMatches.length > 1000) {\n\t\t\t\t// we go into a mode where the overview ruler gets \"approximate\" decorations\n\t\t\t\t// the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\n\t\t\t\tfindMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\n\n\t\t\t\t// approximate a distance in lines where matches should be merged\n\t\t\t\tconst lineCount = this._editor.getModel().getLineCount();\n\t\t\t\tconst height = this._editor.getLayoutInfo().height;\n\t\t\t\tconst approxPixelsPerLine = height / lineCount;\n\t\t\t\tconst mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\n\n\t\t\t\t// merge decorations as much as possible\n\t\t\t\tlet prevStartLineNumber = findMatches[0].range.startLineNumber;\n\t\t\t\tlet prevEndLineNumber = findMatches[0].range.endLineNumber;\n\t\t\t\tfor (let i = 1, len = findMatches.length; i < len; i++) {\n\t\t\t\t\tconst range = findMatches[i].range;\n\t\t\t\t\tif (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\n\t\t\t\t\t\tif (range.endLineNumber > prevEndLineNumber) {\n\t\t\t\t\t\t\tprevEndLineNumber = range.endLineNumber;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewOverviewRulerApproximateDecorations.push({\n\t\t\t\t\t\t\trange: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n\t\t\t\t\t\t\toptions: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprevStartLineNumber = range.startLineNumber;\n\t\t\t\t\t\tprevEndLineNumber = range.endLineNumber;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tnewOverviewRulerApproximateDecorations.push({\n\t\t\t\t\trange: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n\t\t\t\t\toptions: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Find matches\n\t\t\tconst newFindMatchesDecorations: IModelDeltaDecoration[] = new Array<IModelDeltaDecoration>(findMatches.length);\n\t\t\tfor (let i = 0, len = findMatches.length; i < len; i++) {\n\t\t\t\tnewFindMatchesDecorations[i] = {\n\t\t\t\t\trange: findMatches[i].range,\n\t\t\t\t\toptions: findMatchesOptions\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis._decorations = accessor.deltaDecorations(this._decorations, newFindMatchesDecorations);\n\n\t\t\t// Overview ruler approximate decorations\n\t\t\tthis._overviewRulerApproximateDecorations = accessor.deltaDecorations(this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\n\n\t\t\t// Range highlight\n\t\t\tif (this._rangeHighlightDecorationId) {\n\t\t\t\taccessor.removeDecoration(this._rangeHighlightDecorationId);\n\t\t\t\tthis._rangeHighlightDecorationId = null;\n\t\t\t}\n\n\t\t\t// Find scope\n\t\t\tif (this._findScopeDecorationIds.length) {\n\t\t\t\tthis._findScopeDecorationIds.forEach(findScopeDecorationId => accessor.removeDecoration(findScopeDecorationId));\n\t\t\t\tthis._findScopeDecorationIds = [];\n\t\t\t}\n\t\t\tif (findScopes?.length) {\n\t\t\t\tthis._findScopeDecorationIds = findScopes.map(findScope => accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION));\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic matchBeforePosition(position: Position): Range | null {\n\t\tif (this._decorations.length === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tfor (let i = this._decorations.length - 1; i >= 0; i--) {\n\t\t\tconst decorationId = this._decorations[i];\n\t\t\tconst r = this._editor.getModel().getDecorationRange(decorationId);\n\t\t\tif (!r || r.endLineNumber > position.lineNumber) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (r.endLineNumber < position.lineNumber) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tif (r.endColumn > position.column) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\n\t\treturn this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\n\t}\n\n\tpublic matchAfterPosition(position: Position): Range | null {\n\t\tif (this._decorations.length === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tfor (let i = 0, len = this._decorations.length; i < len; i++) {\n\t\t\tconst decorationId = this._decorations[i];\n\t\t\tconst r = this._editor.getModel().getDecorationRange(decorationId);\n\t\t\tif (!r || r.startLineNumber < position.lineNumber) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (r.startLineNumber > position.lineNumber) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tif (r.startColumn < position.column) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\n\t\treturn this._editor.getModel().getDecorationRange(this._decorations[0]);\n\t}\n\n\tprivate _allDecorations(): string[] {\n\t\tlet result: string[] = [];\n\t\tresult = result.concat(this._decorations);\n\t\tresult = result.concat(this._overviewRulerApproximateDecorations);\n\t\tif (this._findScopeDecorationIds.length) {\n\t\t\tresult.push(...this._findScopeDecorationIds);\n\t\t}\n\t\tif (this._rangeHighlightDecorationId) {\n\t\t\tresult.push(this._rangeHighlightDecorationId);\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic static readonly _CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'current-find-match',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tzIndex: 13,\n\t\tclassName: 'currentFindMatch',\n\t\tshowIfCollapsed: true,\n\t\toverviewRuler: {\n\t\t\tcolor: themeColorFromId(overviewRulerFindMatchForeground),\n\t\t\tposition: OverviewRulerLane.Center\n\t\t},\n\t\tminimap: {\n\t\t\tcolor: themeColorFromId(minimapFindMatch),\n\t\t\tposition: MinimapPosition.Inline\n\t\t}\n\t});\n\n\tpublic static readonly _FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'find-match',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tzIndex: 10,\n\t\tclassName: 'findMatch',\n\t\tshowIfCollapsed: true,\n\t\toverviewRuler: {\n\t\t\tcolor: themeColorFromId(overviewRulerFindMatchForeground),\n\t\t\tposition: OverviewRulerLane.Center\n\t\t},\n\t\tminimap: {\n\t\t\tcolor: themeColorFromId(minimapFindMatch),\n\t\t\tposition: MinimapPosition.Inline\n\t\t}\n\t});\n\n\tpublic static readonly _FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'find-match-no-overview',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'findMatch',\n\t\tshowIfCollapsed: true\n\t});\n\n\tprivate static readonly _FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'find-match-only-overview',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\toverviewRuler: {\n\t\t\tcolor: themeColorFromId(overviewRulerFindMatchForeground),\n\t\t\tposition: OverviewRulerLane.Center\n\t\t}\n\t});\n\n\tprivate static readonly _RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'find-range-highlight',\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight',\n\t\tisWholeLine: true\n\t});\n\n\tprivate static readonly _FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'find-scope',\n\t\tclassName: 'findScope',\n\t\tisWholeLine: true\n\t});\n}\n"]}