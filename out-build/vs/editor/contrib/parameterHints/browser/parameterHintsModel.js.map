{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/contrib/parameterHints/browser/parameterHintsModel.ts"],"names":[],"mappings":"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","file":"parameterHintsModel.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancelablePromise, createCancelablePromise, Delayer } from 'vs/base/common/async';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable, MutableDisposable } from 'vs/base/common/lifecycle';\nimport { ICodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { CharacterSet } from 'vs/editor/common/core/characterClassifier';\nimport { ICursorSelectionChangedEvent } from 'vs/editor/common/cursorEvents';\nimport { LanguageFeatureRegistry } from 'vs/editor/common/languageFeatureRegistry';\nimport * as languages from 'vs/editor/common/languages';\nimport { provideSignatureHelp } from 'vs/editor/contrib/parameterHints/browser/provideSignatureHelp';\n\nexport interface TriggerContext {\n\treadonly triggerKind: languages.SignatureHelpTriggerKind;\n\treadonly triggerCharacter?: string;\n}\n\nnamespace ParameterHintState {\n\texport const enum Type {\n\t\tDefault,\n\t\tActive,\n\t\tPending,\n\t}\n\n\texport const Default = { type: Type.Default } as const;\n\n\texport class Pending {\n\t\treadonly type = Type.Pending;\n\t\tconstructor(\n\t\t\treadonly request: CancelablePromise<languages.SignatureHelpResult | undefined | null>,\n\t\t\treadonly previouslyActiveHints: languages.SignatureHelp | undefined,\n\t\t) { }\n\t}\n\n\texport class Active {\n\t\treadonly type = Type.Active;\n\t\tconstructor(\n\t\t\treadonly hints: languages.SignatureHelp\n\t\t) { }\n\t}\n\n\texport type State = typeof Default | Pending | Active;\n}\n\nexport class ParameterHintsModel extends Disposable {\n\n\tprivate static readonly DEFAULT_DELAY = 120; // ms\n\n\tprivate readonly _onChangedHints = this._register(new Emitter<languages.SignatureHelp | undefined>());\n\tpublic readonly onChangedHints = this._onChangedHints.event;\n\n\tprivate readonly editor: ICodeEditor;\n\tprivate readonly providers: LanguageFeatureRegistry<languages.SignatureHelpProvider>;\n\n\tprivate triggerOnType = false;\n\tprivate _state: ParameterHintState.State = ParameterHintState.Default;\n\tprivate _pendingTriggers: TriggerContext[] = [];\n\n\tprivate readonly _lastSignatureHelpResult = this._register(new MutableDisposable<languages.SignatureHelpResult>());\n\tprivate readonly triggerChars = new CharacterSet();\n\tprivate readonly retriggerChars = new CharacterSet();\n\n\tprivate readonly throttledDelayer: Delayer<boolean>;\n\tprivate triggerId = 0;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tproviders: LanguageFeatureRegistry<languages.SignatureHelpProvider>,\n\t\tdelay: number = ParameterHintsModel.DEFAULT_DELAY\n\t) {\n\t\tsuper();\n\n\t\tthis.editor = editor;\n\t\tthis.providers = providers;\n\n\t\tthis.throttledDelayer = new Delayer(delay);\n\n\t\tthis._register(this.editor.onDidBlurEditorWidget(() => this.cancel()));\n\t\tthis._register(this.editor.onDidChangeConfiguration(() => this.onEditorConfigurationChange()));\n\t\tthis._register(this.editor.onDidChangeModel(e => this.onModelChanged()));\n\t\tthis._register(this.editor.onDidChangeModelLanguage(_ => this.onModelChanged()));\n\t\tthis._register(this.editor.onDidChangeCursorSelection(e => this.onCursorChange(e)));\n\t\tthis._register(this.editor.onDidChangeModelContent(e => this.onModelContentChange()));\n\t\tthis._register(this.providers.onDidChange(this.onModelChanged, this));\n\t\tthis._register(this.editor.onDidType(text => this.onDidType(text)));\n\n\t\tthis.onEditorConfigurationChange();\n\t\tthis.onModelChanged();\n\t}\n\n\tprivate get state() { return this._state; }\n\tprivate set state(value: ParameterHintState.State) {\n\t\tif (this._state.type === ParameterHintState.Type.Pending) {\n\t\t\tthis._state.request.cancel();\n\t\t}\n\t\tthis._state = value;\n\t}\n\n\tcancel(silent: boolean = false): void {\n\t\tthis.state = ParameterHintState.Default;\n\n\t\tthis.throttledDelayer.cancel();\n\n\t\tif (!silent) {\n\t\t\tthis._onChangedHints.fire(undefined);\n\t\t}\n\t}\n\n\ttrigger(context: TriggerContext, delay?: number): void {\n\t\tconst model = this.editor.getModel();\n\t\tif (!model || !this.providers.has(model)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst triggerId = ++this.triggerId;\n\n\t\tthis._pendingTriggers.push(context);\n\t\tthis.throttledDelayer.trigger(() => {\n\t\t\treturn this.doTrigger(triggerId);\n\t\t}, delay)\n\t\t\t.catch(onUnexpectedError);\n\t}\n\n\tpublic next(): void {\n\t\tif (this.state.type !== ParameterHintState.Type.Active) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst length = this.state.hints.signatures.length;\n\t\tconst activeSignature = this.state.hints.activeSignature;\n\t\tconst last = (activeSignature % length) === (length - 1);\n\t\tconst cycle = this.editor.getOption(EditorOption.parameterHints).cycle;\n\n\t\t// If there is only one signature, or we're on last signature of list\n\t\tif ((length < 2 || last) && !cycle) {\n\t\t\tthis.cancel();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateActiveSignature(last && cycle ? 0 : activeSignature + 1);\n\t}\n\n\tpublic previous(): void {\n\t\tif (this.state.type !== ParameterHintState.Type.Active) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst length = this.state.hints.signatures.length;\n\t\tconst activeSignature = this.state.hints.activeSignature;\n\t\tconst first = activeSignature === 0;\n\t\tconst cycle = this.editor.getOption(EditorOption.parameterHints).cycle;\n\n\t\t// If there is only one signature, or we're on first signature of list\n\t\tif ((length < 2 || first) && !cycle) {\n\t\t\tthis.cancel();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.updateActiveSignature(first && cycle ? length - 1 : activeSignature - 1);\n\t}\n\n\tprivate updateActiveSignature(activeSignature: number) {\n\t\tif (this.state.type !== ParameterHintState.Type.Active) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.state = new ParameterHintState.Active({ ...this.state.hints, activeSignature });\n\t\tthis._onChangedHints.fire(this.state.hints);\n\t}\n\n\tprivate async doTrigger(triggerId: number): Promise<boolean> {\n\t\tconst isRetrigger = this.state.type === ParameterHintState.Type.Active || this.state.type === ParameterHintState.Type.Pending;\n\t\tconst activeSignatureHelp = this.getLastActiveHints();\n\t\tthis.cancel(true);\n\n\t\tif (this._pendingTriggers.length === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst context: TriggerContext = this._pendingTriggers.reduce(mergeTriggerContexts);\n\t\tthis._pendingTriggers = [];\n\n\t\tconst triggerContext = {\n\t\t\ttriggerKind: context.triggerKind,\n\t\t\ttriggerCharacter: context.triggerCharacter,\n\t\t\tisRetrigger: isRetrigger,\n\t\t\tactiveSignatureHelp: activeSignatureHelp\n\t\t};\n\n\t\tif (!this.editor.hasModel()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst model = this.editor.getModel();\n\t\tconst position = this.editor.getPosition();\n\n\t\tthis.state = new ParameterHintState.Pending(\n\t\t\tcreateCancelablePromise(token => provideSignatureHelp(this.providers, model, position, triggerContext, token)),\n\t\t\tactiveSignatureHelp);\n\n\t\ttry {\n\t\t\tconst result = await this.state.request;\n\n\t\t\t// Check that we are still resolving the correct signature help\n\t\t\tif (triggerId !== this.triggerId) {\n\t\t\t\tresult?.dispose();\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!result || !result.value.signatures || result.value.signatures.length === 0) {\n\t\t\t\tresult?.dispose();\n\t\t\t\tthis._lastSignatureHelpResult.clear();\n\t\t\t\tthis.cancel();\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tthis.state = new ParameterHintState.Active(result.value);\n\t\t\t\tthis._lastSignatureHelpResult.value = result;\n\t\t\t\tthis._onChangedHints.fire(this.state.hints);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tif (triggerId === this.triggerId) {\n\t\t\t\tthis.state = ParameterHintState.Default;\n\t\t\t}\n\t\t\tonUnexpectedError(error);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate getLastActiveHints(): languages.SignatureHelp | undefined {\n\t\tswitch (this.state.type) {\n\t\t\tcase ParameterHintState.Type.Active: return this.state.hints;\n\t\t\tcase ParameterHintState.Type.Pending: return this.state.previouslyActiveHints;\n\t\t\tdefault: return undefined;\n\t\t}\n\t}\n\n\tprivate get isTriggered(): boolean {\n\t\treturn this.state.type === ParameterHintState.Type.Active\n\t\t\t|| this.state.type === ParameterHintState.Type.Pending\n\t\t\t|| this.throttledDelayer.isTriggered();\n\t}\n\n\tprivate onModelChanged(): void {\n\t\tthis.cancel();\n\n\t\tthis.triggerChars.clear();\n\t\tthis.retriggerChars.clear();\n\n\t\tconst model = this.editor.getModel();\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const support of this.providers.ordered(model)) {\n\t\t\tfor (const ch of support.signatureHelpTriggerCharacters || []) {\n\t\t\t\tif (ch.length) {\n\t\t\t\t\tconst charCode = ch.charCodeAt(0);\n\t\t\t\t\tthis.triggerChars.add(charCode);\n\n\t\t\t\t\t// All trigger characters are also considered retrigger characters\n\t\t\t\t\tthis.retriggerChars.add(charCode);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const ch of support.signatureHelpRetriggerCharacters || []) {\n\t\t\t\tif (ch.length) {\n\t\t\t\t\tthis.retriggerChars.add(ch.charCodeAt(0));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onDidType(text: string) {\n\t\tif (!this.triggerOnType) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst lastCharIndex = text.length - 1;\n\t\tconst triggerCharCode = text.charCodeAt(lastCharIndex);\n\n\t\tif (this.triggerChars.has(triggerCharCode) || this.isTriggered && this.retriggerChars.has(triggerCharCode)) {\n\t\t\tthis.trigger({\n\t\t\t\ttriggerKind: languages.SignatureHelpTriggerKind.TriggerCharacter,\n\t\t\t\ttriggerCharacter: text.charAt(lastCharIndex),\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate onCursorChange(e: ICursorSelectionChangedEvent): void {\n\t\tif (e.source === 'mouse') {\n\t\t\tthis.cancel();\n\t\t} else if (this.isTriggered) {\n\t\t\tthis.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n\t\t}\n\t}\n\n\tprivate onModelContentChange(): void {\n\t\tif (this.isTriggered) {\n\t\t\tthis.trigger({ triggerKind: languages.SignatureHelpTriggerKind.ContentChange });\n\t\t}\n\t}\n\n\tprivate onEditorConfigurationChange(): void {\n\t\tthis.triggerOnType = this.editor.getOption(EditorOption.parameterHints).enabled;\n\n\t\tif (!this.triggerOnType) {\n\t\t\tthis.cancel();\n\t\t}\n\t}\n\n\toverride dispose(): void {\n\t\tthis.cancel(true);\n\t\tsuper.dispose();\n\t}\n}\n\nfunction mergeTriggerContexts(previous: TriggerContext, current: TriggerContext) {\n\tswitch (current.triggerKind) {\n\t\tcase languages.SignatureHelpTriggerKind.Invoke:\n\t\t\t// Invoke overrides previous triggers.\n\t\t\treturn current;\n\n\t\tcase languages.SignatureHelpTriggerKind.ContentChange:\n\t\t\t// Ignore content changes triggers\n\t\t\treturn previous;\n\n\t\tcase languages.SignatureHelpTriggerKind.TriggerCharacter:\n\t\tdefault:\n\t\t\treturn current;\n\t}\n}\n"]}