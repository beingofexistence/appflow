{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/contrib/suggest/test/browser/suggest.test.ts"],"names":[],"mappings":"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","file":"suggest.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as assert from 'assert';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Range } from 'vs/editor/common/core/range';\nimport { TextModel } from 'vs/editor/common/model/textModel';\nimport { CompletionItemKind, CompletionItemProvider } from 'vs/editor/common/languages';\nimport { CompletionOptions, provideSuggestionItems, SnippetSortOrder } from 'vs/editor/contrib/suggest/browser/suggest';\nimport { createTextModel } from 'vs/editor/test/common/testTextModel';\nimport { LanguageFeatureRegistry } from 'vs/editor/common/languageFeatureRegistry';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from 'vs/base/test/common/utils';\n\n\nsuite('Suggest', function () {\n\tlet model: TextModel;\n\tlet registration: IDisposable;\n\tlet registry: LanguageFeatureRegistry<CompletionItemProvider>;\n\n\tsetup(function () {\n\t\tregistry = new LanguageFeatureRegistry();\n\t\tmodel = createTextModel('FOO\\nbar\\BAR\\nfoo', undefined, undefined, URI.parse('foo:bar/path'));\n\t\tregistration = registry.register({ pattern: 'bar/path', scheme: 'foo' }, {\n\t\t\t_debugDisplayName: 'test',\n\t\t\tprovideCompletionItems(_doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'aaa',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'aaa',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'zzz',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'zzz',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'fff',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'fff',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t});\n\n\tteardown(() => {\n\t\tregistration.dispose();\n\t\tmodel.dispose();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('sort - snippet inline', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Inline));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'aaa');\n\t\tassert.strictEqual(items[1].completion.label, 'fff');\n\t\tassert.strictEqual(items[2].completion.label, 'zzz');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('sort - snippet top', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Top));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'aaa');\n\t\tassert.strictEqual(items[1].completion.label, 'zzz');\n\t\tassert.strictEqual(items[2].completion.label, 'fff');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('sort - snippet bottom', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Bottom));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'fff');\n\t\tassert.strictEqual(items[1].completion.label, 'aaa');\n\t\tassert.strictEqual(items[2].completion.label, 'zzz');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('sort - snippet none', async function () {\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(undefined, new Set<CompletionItemKind>().add(CompletionItemKind.Snippet)));\n\t\tassert.strictEqual(items.length, 1);\n\t\tassert.strictEqual(items[0].completion.label, 'fff');\n\t\tdisposable.dispose();\n\t});\n\n\ttest('only from', function (callback) {\n\n\t\tconst foo: any = {\n\t\t\ttriggerCharacters: [],\n\t\t\tprovideCompletionItems() {\n\t\t\t\treturn {\n\t\t\t\t\tcurrentWord: '',\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'jjj',\n\t\t\t\t\t\ttype: 'property',\n\t\t\t\t\t\tinsertText: 'jjj'\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\tconst registration = registry.register({ pattern: 'bar/path', scheme: 'foo' }, foo);\n\n\t\tprovideSuggestionItems(registry, model, new Position(1, 1), new CompletionOptions(undefined, undefined, new Set<CompletionItemProvider>().add(foo))).then(({ items, disposable }) => {\n\t\t\tregistration.dispose();\n\n\t\t\tassert.strictEqual(items.length, 1);\n\t\t\tassert.ok(items[0].provider === foo);\n\t\t\tdisposable.dispose();\n\t\t\tcallback();\n\t\t});\n\t});\n\n\ttest('Ctrl+space completions stopped working with the latest Insiders, #97650', async function () {\n\n\n\t\tconst foo = new class implements CompletionItemProvider {\n\n\t\t\t_debugDisplayName = 'test';\n\t\t\ttriggerCharacters = [];\n\n\t\t\tprovideCompletionItems() {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'one',\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tinsertText: 'one',\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tinsert: new Range(0, 0, 0, 0),\n\t\t\t\t\t\t\treplace: new Range(0, 0, 0, 10)\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'two',\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tinsertText: 'two',\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tinsert: new Range(0, 0, 0, 0),\n\t\t\t\t\t\t\treplace: new Range(0, 1, 0, 10)\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tconst registration = registry.register({ pattern: 'bar/path', scheme: 'foo' }, foo);\n\t\tconst { items, disposable } = await provideSuggestionItems(registry, model, new Position(0, 0), new CompletionOptions(undefined, undefined, new Set<CompletionItemProvider>().add(foo)));\n\t\tregistration.dispose();\n\n\t\tassert.strictEqual(items.length, 2);\n\t\tconst [a, b] = items;\n\n\t\tassert.strictEqual(a.completion.label, 'one');\n\t\tassert.strictEqual(a.isInvalid, false);\n\t\tassert.strictEqual(b.completion.label, 'two');\n\t\tassert.strictEqual(b.isInvalid, true);\n\t\tdisposable.dispose();\n\t});\n});\n"]}