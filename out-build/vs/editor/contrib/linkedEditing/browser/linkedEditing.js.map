{"version":3,"sources":["vs/editor/contrib/linkedEditing/browser/linkedEditing.ts"],"names":[],"mappings":"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","file":"linkedEditing.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as arrays from 'vs/base/common/arrays';\nimport { CancelablePromise, createCancelablePromise, Delayer, first } from 'vs/base/common/async';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Color } from 'vs/base/common/color';\nimport { isCancellationError, onUnexpectedError, onUnexpectedExternalError } from 'vs/base/common/errors';\nimport { Event } from 'vs/base/common/event';\nimport { KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport * as strings from 'vs/base/common/strings';\nimport { URI } from 'vs/base/common/uri';\nimport { ICodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { EditorAction, EditorCommand, EditorContributionInstantiation, registerEditorAction, registerEditorCommand, registerEditorContribution, registerModelAndPositionCommand, ServicesAccessor } from 'vs/editor/browser/editorExtensions';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { IPosition, Position } from 'vs/editor/common/core/position';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport { IEditorContribution, IEditorDecorationsCollection } from 'vs/editor/common/editorCommon';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { IModelDeltaDecoration, ITextModel, TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { LinkedEditingRangeProvider, LinkedEditingRanges } from 'vs/editor/common/languages';\nimport { ILanguageConfigurationService } from 'vs/editor/common/languages/languageConfigurationRegistry';\nimport * as nls from 'vs/nls';\nimport { ContextKeyExpr, IContextKey, IContextKeyService, RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { ILanguageFeaturesService } from 'vs/editor/common/services/languageFeatures';\nimport { registerColor } from 'vs/platform/theme/common/colorRegistry';\nimport { LanguageFeatureRegistry } from 'vs/editor/common/languageFeatureRegistry';\nimport { ISingleEditOperation } from 'vs/editor/common/core/editOperation';\nimport { IFeatureDebounceInformation, ILanguageFeatureDebounceService } from 'vs/editor/common/services/languageFeatureDebounce';\nimport { StopWatch } from 'vs/base/common/stopwatch';\nimport 'vs/css!./linkedEditing';\n\nexport const CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE = new RawContextKey<boolean>('LinkedEditingInputVisible', false);\n\nconst DECORATION_CLASS_NAME = 'linked-editing-decoration';\n\nexport class LinkedEditingContribution extends Disposable implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.linkedEditing';\n\n\tprivate static readonly DECORATION = ModelDecorationOptions.register({\n\t\tdescription: 'linked-editing',\n\t\tstickiness: TrackedRangeStickiness.AlwaysGrowsWhenTypingAtEdges,\n\t\tclassName: DECORATION_CLASS_NAME\n\t});\n\n\tstatic get(editor: ICodeEditor): LinkedEditingContribution | null {\n\t\treturn editor.getContribution<LinkedEditingContribution>(LinkedEditingContribution.ID);\n\t}\n\n\tprivate _debounceDuration: number | undefined;\n\n\tprivate readonly _editor: ICodeEditor;\n\tprivate readonly _providers: LanguageFeatureRegistry<LinkedEditingRangeProvider>;\n\tprivate _enabled: boolean;\n\n\tprivate readonly _visibleContextKey: IContextKey<boolean>;\n\tprivate readonly _debounceInformation: IFeatureDebounceInformation;\n\n\tprivate _rangeUpdateTriggerPromise: Promise<any> | null;\n\tprivate _rangeSyncTriggerPromise: Promise<any> | null;\n\n\tprivate _currentRequest: CancelablePromise<any> | null;\n\tprivate _currentRequestPosition: Position | null;\n\tprivate _currentRequestModelVersion: number | null;\n\n\tprivate _currentDecorations: IEditorDecorationsCollection; // The one at index 0 is the reference one\n\tprivate _syncRangesToken: number = 0;\n\n\tprivate _languageWordPattern: RegExp | null;\n\tprivate _currentWordPattern: RegExp | null;\n\tprivate _ignoreChangeEvent: boolean;\n\n\tprivate readonly _localToDispose = this._register(new DisposableStore());\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t\t@ILanguageConfigurationService private readonly languageConfigurationService: ILanguageConfigurationService,\n\t\t@ILanguageFeatureDebounceService languageFeatureDebounceService: ILanguageFeatureDebounceService\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._providers = languageFeaturesService.linkedEditingRangeProvider;\n\t\tthis._enabled = false;\n\t\tthis._visibleContextKey = CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n\t\tthis._debounceInformation = languageFeatureDebounceService.for(this._providers, 'Linked Editing', { max: 200 });\n\n\t\tthis._currentDecorations = this._editor.createDecorationsCollection();\n\t\tthis._languageWordPattern = null;\n\t\tthis._currentWordPattern = null;\n\t\tthis._ignoreChangeEvent = false;\n\t\tthis._localToDispose = this._register(new DisposableStore());\n\n\t\tthis._rangeUpdateTriggerPromise = null;\n\t\tthis._rangeSyncTriggerPromise = null;\n\n\t\tthis._currentRequest = null;\n\t\tthis._currentRequestPosition = null;\n\t\tthis._currentRequestModelVersion = null;\n\n\t\tthis._register(this._editor.onDidChangeModel(() => this.reinitialize(true)));\n\n\t\tthis._register(this._editor.onDidChangeConfiguration(e => {\n\t\t\tif (e.hasChanged(EditorOption.linkedEditing) || e.hasChanged(EditorOption.renameOnType)) {\n\t\t\t\tthis.reinitialize(false);\n\t\t\t}\n\t\t}));\n\t\tthis._register(this._providers.onDidChange(() => this.reinitialize(false)));\n\t\tthis._register(this._editor.onDidChangeModelLanguage(() => this.reinitialize(true)));\n\n\t\tthis.reinitialize(true);\n\t}\n\n\tprivate reinitialize(forceRefresh: boolean) {\n\t\tconst model = this._editor.getModel();\n\t\tconst isEnabled = model !== null && (this._editor.getOption(EditorOption.linkedEditing) || this._editor.getOption(EditorOption.renameOnType)) && this._providers.has(model);\n\t\tif (isEnabled === this._enabled && !forceRefresh) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enabled = isEnabled;\n\n\t\tthis.clearRanges();\n\t\tthis._localToDispose.clear();\n\n\t\tif (!isEnabled || model === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._localToDispose.add(\n\t\t\tEvent.runAndSubscribe(\n\t\t\t\tmodel.onDidChangeLanguageConfiguration,\n\t\t\t\t() => {\n\t\t\t\t\tthis._languageWordPattern = this.languageConfigurationService.getLanguageConfiguration(model.getLanguageId()).getWordDefinition();\n\t\t\t\t}\n\t\t\t)\n\t\t);\n\n\t\tconst rangeUpdateScheduler = new Delayer(this._debounceInformation.get(model));\n\t\tconst triggerRangeUpdate = () => {\n\t\t\tthis._rangeUpdateTriggerPromise = rangeUpdateScheduler.trigger(() => this.updateRanges(), this._debounceDuration ?? this._debounceInformation.get(model));\n\t\t};\n\t\tconst rangeSyncScheduler = new Delayer(0);\n\t\tconst triggerRangeSync = (token: number) => {\n\t\t\tthis._rangeSyncTriggerPromise = rangeSyncScheduler.trigger(() => this._syncRanges(token));\n\t\t};\n\t\tthis._localToDispose.add(this._editor.onDidChangeCursorPosition(() => {\n\t\t\ttriggerRangeUpdate();\n\t\t}));\n\t\tthis._localToDispose.add(this._editor.onDidChangeModelContent((e) => {\n\t\t\tif (!this._ignoreChangeEvent) {\n\t\t\t\tif (this._currentDecorations.length > 0) {\n\t\t\t\t\tconst referenceRange = this._currentDecorations.getRange(0);\n\t\t\t\t\tif (referenceRange && e.changes.every(c => referenceRange.intersectRanges(c.range))) {\n\t\t\t\t\t\ttriggerRangeSync(this._syncRangesToken);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\ttriggerRangeUpdate();\n\t\t}));\n\t\tthis._localToDispose.add({\n\t\t\tdispose: () => {\n\t\t\t\trangeUpdateScheduler.dispose();\n\t\t\t\trangeSyncScheduler.dispose();\n\t\t\t}\n\t\t});\n\t\tthis.updateRanges();\n\t}\n\n\tprivate _syncRanges(token: number): void {\n\t\t// delayed invocation, make sure we're still on\n\t\tif (!this._editor.hasModel() || token !== this._syncRangesToken || this._currentDecorations.length === 0) {\n\t\t\t// nothing to do\n\t\t\treturn;\n\t\t}\n\n\t\tconst model = this._editor.getModel();\n\t\tconst referenceRange = this._currentDecorations.getRange(0);\n\n\t\tif (!referenceRange || referenceRange.startLineNumber !== referenceRange.endLineNumber) {\n\t\t\treturn this.clearRanges();\n\t\t}\n\n\t\tconst referenceValue = model.getValueInRange(referenceRange);\n\t\tif (this._currentWordPattern) {\n\t\t\tconst match = referenceValue.match(this._currentWordPattern);\n\t\t\tconst matchLength = match ? match[0].length : 0;\n\t\t\tif (matchLength !== referenceValue.length) {\n\t\t\t\treturn this.clearRanges();\n\t\t\t}\n\t\t}\n\n\t\tconst edits: ISingleEditOperation[] = [];\n\t\tfor (let i = 1, len = this._currentDecorations.length; i < len; i++) {\n\t\t\tconst mirrorRange = this._currentDecorations.getRange(i);\n\t\t\tif (!mirrorRange) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (mirrorRange.startLineNumber !== mirrorRange.endLineNumber) {\n\t\t\t\tedits.push({\n\t\t\t\t\trange: mirrorRange,\n\t\t\t\t\ttext: referenceValue\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet oldValue = model.getValueInRange(mirrorRange);\n\t\t\t\tlet newValue = referenceValue;\n\t\t\t\tlet rangeStartColumn = mirrorRange.startColumn;\n\t\t\t\tlet rangeEndColumn = mirrorRange.endColumn;\n\n\t\t\t\tconst commonPrefixLength = strings.commonPrefixLength(oldValue, newValue);\n\t\t\t\trangeStartColumn += commonPrefixLength;\n\t\t\t\toldValue = oldValue.substr(commonPrefixLength);\n\t\t\t\tnewValue = newValue.substr(commonPrefixLength);\n\n\t\t\t\tconst commonSuffixLength = strings.commonSuffixLength(oldValue, newValue);\n\t\t\t\trangeEndColumn -= commonSuffixLength;\n\t\t\t\toldValue = oldValue.substr(0, oldValue.length - commonSuffixLength);\n\t\t\t\tnewValue = newValue.substr(0, newValue.length - commonSuffixLength);\n\n\t\t\t\tif (rangeStartColumn !== rangeEndColumn || newValue.length !== 0) {\n\t\t\t\t\tedits.push({\n\t\t\t\t\t\trange: new Range(mirrorRange.startLineNumber, rangeStartColumn, mirrorRange.endLineNumber, rangeEndColumn),\n\t\t\t\t\t\ttext: newValue\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (edits.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tthis._editor.popUndoStop();\n\t\t\tthis._ignoreChangeEvent = true;\n\t\t\tconst prevEditOperationType = this._editor._getViewModel().getPrevEditOperationType();\n\t\t\tthis._editor.executeEdits('linkedEditing', edits);\n\t\t\tthis._editor._getViewModel().setPrevEditOperationType(prevEditOperationType);\n\t\t} finally {\n\t\t\tthis._ignoreChangeEvent = false;\n\t\t}\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis.clearRanges();\n\t\tsuper.dispose();\n\t}\n\n\tpublic clearRanges(): void {\n\t\tthis._visibleContextKey.set(false);\n\t\tthis._currentDecorations.clear();\n\t\tif (this._currentRequest) {\n\t\t\tthis._currentRequest.cancel();\n\t\t\tthis._currentRequest = null;\n\t\t\tthis._currentRequestPosition = null;\n\t\t}\n\t}\n\n\tpublic get currentUpdateTriggerPromise(): Promise<any> {\n\t\treturn this._rangeUpdateTriggerPromise || Promise.resolve();\n\t}\n\n\tpublic get currentSyncTriggerPromise(): Promise<any> {\n\t\treturn this._rangeSyncTriggerPromise || Promise.resolve();\n\t}\n\n\tpublic async updateRanges(force = false): Promise<void> {\n\t\tif (!this._editor.hasModel()) {\n\t\t\tthis.clearRanges();\n\t\t\treturn;\n\t\t}\n\n\t\tconst position = this._editor.getPosition();\n\t\tif (!this._enabled && !force || this._editor.getSelections().length > 1) {\n\t\t\t// disabled or multicursor\n\t\t\tthis.clearRanges();\n\t\t\treturn;\n\t\t}\n\n\t\tconst model = this._editor.getModel();\n\t\tconst modelVersionId = model.getVersionId();\n\t\tif (this._currentRequestPosition && this._currentRequestModelVersion === modelVersionId) {\n\t\t\tif (position.equals(this._currentRequestPosition)) {\n\t\t\t\treturn; // same position\n\t\t\t}\n\t\t\tif (this._currentDecorations.length > 0) {\n\t\t\t\tconst range = this._currentDecorations.getRange(0);\n\t\t\t\tif (range && range.containsPosition(position)) {\n\t\t\t\t\treturn; // just moving inside the existing primary range\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Clear existing decorations while we compute new ones\n\t\tthis.clearRanges();\n\n\t\tthis._currentRequestPosition = position;\n\t\tthis._currentRequestModelVersion = modelVersionId;\n\t\tconst request = createCancelablePromise(async token => {\n\t\t\ttry {\n\t\t\t\tconst sw = new StopWatch(false);\n\t\t\t\tconst response = await getLinkedEditingRanges(this._providers, model, position, token);\n\t\t\t\tthis._debounceInformation.update(model, sw.elapsed());\n\t\t\t\tif (request !== this._currentRequest) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._currentRequest = null;\n\t\t\t\tif (modelVersionId !== model.getVersionId()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tlet ranges: IRange[] = [];\n\t\t\t\tif (response?.ranges) {\n\t\t\t\t\tranges = response.ranges;\n\t\t\t\t}\n\n\t\t\t\tthis._currentWordPattern = response?.wordPattern || this._languageWordPattern;\n\n\t\t\t\tlet foundReferenceRange = false;\n\t\t\t\tfor (let i = 0, len = ranges.length; i < len; i++) {\n\t\t\t\t\tif (Range.containsPosition(ranges[i], position)) {\n\t\t\t\t\t\tfoundReferenceRange = true;\n\t\t\t\t\t\tif (i !== 0) {\n\t\t\t\t\t\t\tconst referenceRange = ranges[i];\n\t\t\t\t\t\t\tranges.splice(i, 1);\n\t\t\t\t\t\t\tranges.unshift(referenceRange);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!foundReferenceRange) {\n\t\t\t\t\t// Cannot do linked editing if the ranges are not where the cursor is...\n\t\t\t\t\tthis.clearRanges();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst decorations: IModelDeltaDecoration[] = ranges.map(range => ({ range: range, options: LinkedEditingContribution.DECORATION }));\n\t\t\t\tthis._visibleContextKey.set(true);\n\t\t\t\tthis._currentDecorations.set(decorations);\n\t\t\t\tthis._syncRangesToken++; // cancel any pending syncRanges call\n\t\t\t} catch (err) {\n\t\t\t\tif (!isCancellationError(err)) {\n\t\t\t\t\tonUnexpectedError(err);\n\t\t\t\t}\n\t\t\t\tif (this._currentRequest === request || !this._currentRequest) {\n\t\t\t\t\t// stop if we are still the latest request\n\t\t\t\t\tthis.clearRanges();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis._currentRequest = request;\n\t\treturn request;\n\t}\n\n\t// for testing\n\tpublic setDebounceDuration(timeInMS: number) {\n\t\tthis._debounceDuration = timeInMS;\n\t}\n\n\t// private printDecorators(model: ITextModel) {\n\t// \treturn this._currentDecorations.map(d => {\n\t// \t\tconst range = model.getDecorationRange(d);\n\t// \t\tif (range) {\n\t// \t\t\treturn this.printRange(range);\n\t// \t\t}\n\t// \t\treturn 'invalid';\n\t// \t}).join(',');\n\t// }\n\n\t// private printChanges(changes: IModelContentChange[]) {\n\t// \treturn changes.map(c => {\n\t// \t\treturn `${this.printRange(c.range)} - ${c.text}`;\n\t// \t}\n\t// \t).join(',');\n\t// }\n\n\t// private printRange(range: IRange) {\n\t// \treturn `${range.startLineNumber},${range.startColumn}/${range.endLineNumber},${range.endColumn}`;\n\t// }\n}\n\nexport class LinkedEditingAction extends EditorAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.linkedEditing',\n\t\t\tlabel: nls.localize('linkedEditing.label', \"Start Linked Editing\"),\n\t\t\talias: 'Start Linked Editing',\n\t\t\tprecondition: ContextKeyExpr.and(EditorContextKeys.writable, EditorContextKeys.hasRenameProvider),\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.F2,\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t}\n\t\t});\n\t}\n\n\toverride runCommand(accessor: ServicesAccessor, args: [URI, IPosition]): void | Promise<void> {\n\t\tconst editorService = accessor.get(ICodeEditorService);\n\t\tconst [uri, pos] = Array.isArray(args) && args || [undefined, undefined];\n\n\t\tif (URI.isUri(uri) && Position.isIPosition(pos)) {\n\t\t\treturn editorService.openCodeEditor({ resource: uri }, editorService.getActiveCodeEditor()).then(editor => {\n\t\t\t\tif (!editor) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\teditor.setPosition(pos);\n\t\t\t\teditor.invokeWithinContext(accessor => {\n\t\t\t\t\tthis.reportTelemetry(accessor, editor);\n\t\t\t\t\treturn this.run(accessor, editor);\n\t\t\t\t});\n\t\t\t}, onUnexpectedError);\n\t\t}\n\n\t\treturn super.runCommand(accessor, args);\n\t}\n\n\trun(_accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\t\tconst controller = LinkedEditingContribution.get(editor);\n\t\tif (controller) {\n\t\t\treturn Promise.resolve(controller.updateRanges(true));\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n}\n\nconst LinkedEditingCommand = EditorCommand.bindToContribution<LinkedEditingContribution>(LinkedEditingContribution.get);\nregisterEditorCommand(new LinkedEditingCommand({\n\tid: 'cancelLinkedEditingInput',\n\tprecondition: CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE,\n\thandler: x => x.clearRanges(),\n\tkbOpts: {\n\t\tkbExpr: EditorContextKeys.editorTextFocus,\n\t\tweight: KeybindingWeight.EditorContrib + 99,\n\t\tprimary: KeyCode.Escape,\n\t\tsecondary: [KeyMod.Shift | KeyCode.Escape]\n\t}\n}));\n\n\nfunction getLinkedEditingRanges(providers: LanguageFeatureRegistry<LinkedEditingRangeProvider>, model: ITextModel, position: Position, token: CancellationToken): Promise<LinkedEditingRanges | undefined | null> {\n\tconst orderedByScore = providers.ordered(model);\n\n\t// in order of score ask the linked editing range provider\n\t// until someone response with a good result\n\t// (good = not null)\n\treturn first<LinkedEditingRanges | undefined | null>(orderedByScore.map(provider => async () => {\n\t\ttry {\n\t\t\treturn await provider.provideLinkedEditingRanges(model, position, token);\n\t\t} catch (e) {\n\t\t\tonUnexpectedExternalError(e);\n\t\t\treturn undefined;\n\t\t}\n\t}), result => !!result && arrays.isNonEmptyArray(result?.ranges));\n}\n\nexport const editorLinkedEditingBackground = registerColor('editor.linkedEditingBackground', { dark: Color.fromHex('#f00').transparent(0.3), light: Color.fromHex('#f00').transparent(0.3), hcDark: Color.fromHex('#f00').transparent(0.3), hcLight: Color.white }, nls.localize('editorLinkedEditingBackground', 'Background color when the editor auto renames on type.'));\n\nregisterModelAndPositionCommand('_executeLinkedEditingProvider', (_accessor, model, position) => {\n\tconst { linkedEditingRangeProvider } = _accessor.get(ILanguageFeaturesService);\n\treturn getLinkedEditingRanges(linkedEditingRangeProvider, model, position, CancellationToken.None);\n});\n\nregisterEditorContribution(LinkedEditingContribution.ID, LinkedEditingContribution, EditorContributionInstantiation.AfterFirstRender);\nregisterEditorAction(LinkedEditingAction);\n"]}