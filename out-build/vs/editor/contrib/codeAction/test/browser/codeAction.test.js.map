{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/contrib/codeAction/test/browser/codeAction.test.ts"],"names":[],"mappings":"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","file":"codeAction.test.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as assert from 'assert';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { ensureNoDisposablesAreLeakedInTestSuite } from 'vs/base/test/common/utils';\nimport { Range } from 'vs/editor/common/core/range';\nimport { LanguageFeatureRegistry } from 'vs/editor/common/languageFeatureRegistry';\nimport * as languages from 'vs/editor/common/languages';\nimport { TextModel } from 'vs/editor/common/model/textModel';\nimport { getCodeActions } from 'vs/editor/contrib/codeAction/browser/codeAction';\nimport { CodeActionItem, CodeActionKind, CodeActionTriggerSource } from 'vs/editor/contrib/codeAction/common/types';\nimport { createTextModel } from 'vs/editor/test/common/testTextModel';\nimport { IMarkerData, MarkerSeverity } from 'vs/platform/markers/common/markers';\nimport { Progress } from 'vs/platform/progress/common/progress';\n\nfunction staticCodeActionProvider(...actions: languages.CodeAction[]): languages.CodeActionProvider {\n\treturn new class implements languages.CodeActionProvider {\n\t\tprovideCodeActions(): languages.CodeActionList {\n\t\t\treturn {\n\t\t\t\tactions: actions,\n\t\t\t\tdispose: () => { }\n\t\t\t};\n\t\t}\n\t};\n}\n\n\nsuite('CodeAction', () => {\n\n\tconst langId = 'fooLang';\n\tconst uri = URI.parse('untitled:path');\n\tlet model: TextModel;\n\tlet registry: LanguageFeatureRegistry<languages.CodeActionProvider>;\n\tconst disposables = new DisposableStore();\n\tconst testData = {\n\t\tdiagnostics: {\n\t\t\tabc: {\n\t\t\t\ttitle: 'bTitle',\n\t\t\t\tdiagnostics: [{\n\t\t\t\t\tstartLineNumber: 1,\n\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\tendLineNumber: 2,\n\t\t\t\t\tendColumn: 1,\n\t\t\t\t\tseverity: MarkerSeverity.Error,\n\t\t\t\t\tmessage: 'abc'\n\t\t\t\t}]\n\t\t\t},\n\t\t\tbcd: {\n\t\t\t\ttitle: 'aTitle',\n\t\t\t\tdiagnostics: [{\n\t\t\t\t\tstartLineNumber: 1,\n\t\t\t\t\tstartColumn: 1,\n\t\t\t\t\tendLineNumber: 2,\n\t\t\t\t\tendColumn: 1,\n\t\t\t\t\tseverity: MarkerSeverity.Error,\n\t\t\t\t\tmessage: 'bcd'\n\t\t\t\t}]\n\t\t\t}\n\t\t},\n\t\tcommand: {\n\t\t\tabc: {\n\t\t\t\tcommand: new class implements languages.Command {\n\t\t\t\t\tid!: '1';\n\t\t\t\t\ttitle!: 'abc';\n\t\t\t\t},\n\t\t\t\ttitle: 'Extract to inner function in function \"test\"'\n\t\t\t}\n\t\t},\n\t\tspelling: {\n\t\t\tbcd: {\n\t\t\t\tdiagnostics: <IMarkerData[]>[],\n\t\t\t\tedit: new class implements languages.WorkspaceEdit {\n\t\t\t\t\tedits!: languages.IWorkspaceTextEdit[];\n\t\t\t\t},\n\t\t\t\ttitle: 'abc'\n\t\t\t}\n\t\t},\n\t\ttsLint: {\n\t\t\tabc: {\n\t\t\t\t$ident: 'funny' + 57,\n\t\t\t\targuments: <IMarkerData[]>[],\n\t\t\t\tid: '_internal_command_delegation',\n\t\t\t\ttitle: 'abc'\n\t\t\t},\n\t\t\tbcd: {\n\t\t\t\t$ident: 'funny' + 47,\n\t\t\t\targuments: <IMarkerData[]>[],\n\t\t\t\tid: '_internal_command_delegation',\n\t\t\t\ttitle: 'bcd'\n\t\t\t}\n\t\t}\n\t};\n\n\tsetup(() => {\n\t\tregistry = new LanguageFeatureRegistry();\n\t\tdisposables.clear();\n\t\tmodel = createTextModel('test1\\ntest2\\ntest3', langId, undefined, uri);\n\t\tdisposables.add(model);\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t});\n\n\tensureNoDisposablesAreLeakedInTestSuite();\n\n\ttest('CodeActions are sorted by type, #38623', async () => {\n\n\t\tconst provider = staticCodeActionProvider(\n\t\t\ttestData.command.abc,\n\t\t\ttestData.diagnostics.bcd,\n\t\t\ttestData.spelling.bcd,\n\t\t\ttestData.tsLint.bcd,\n\t\t\ttestData.tsLint.abc,\n\t\t\ttestData.diagnostics.abc\n\t\t);\n\n\t\tdisposables.add(registry.register('fooLang', provider));\n\n\t\tconst expected = [\n\t\t\t// CodeActions with a diagnostics array are shown first without further sorting\n\t\t\tnew CodeActionItem(testData.diagnostics.bcd, provider),\n\t\t\tnew CodeActionItem(testData.diagnostics.abc, provider),\n\n\t\t\t// CodeActions without diagnostics are shown in the given order without any further sorting\n\t\t\tnew CodeActionItem(testData.command.abc, provider),\n\t\t\tnew CodeActionItem(testData.spelling.bcd, provider),\n\t\t\tnew CodeActionItem(testData.tsLint.bcd, provider),\n\t\t\tnew CodeActionItem(testData.tsLint.abc, provider)\n\t\t];\n\n\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), { type: languages.CodeActionTriggerType.Invoke, triggerAction: CodeActionTriggerSource.Default }, Progress.None, CancellationToken.None));\n\t\tassert.strictEqual(actions.length, 6);\n\t\tassert.deepStrictEqual(actions, expected);\n\t});\n\n\ttest('getCodeActions should filter by scope', async () => {\n\t\tconst provider = staticCodeActionProvider(\n\t\t\t{ title: 'a', kind: 'a' },\n\t\t\t{ title: 'b', kind: 'b' },\n\t\t\t{ title: 'a.b', kind: 'a.b' }\n\t\t);\n\n\t\tdisposables.add(registry.register('fooLang', provider));\n\n\t\t{\n\t\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), { type: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.Default, filter: { include: new CodeActionKind('a') } }, Progress.None, CancellationToken.None));\n\t\t\tassert.strictEqual(actions.length, 2);\n\t\t\tassert.strictEqual(actions[0].action.title, 'a');\n\t\t\tassert.strictEqual(actions[1].action.title, 'a.b');\n\t\t}\n\n\t\t{\n\t\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), { type: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.Default, filter: { include: new CodeActionKind('a.b') } }, Progress.None, CancellationToken.None));\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tassert.strictEqual(actions[0].action.title, 'a.b');\n\t\t}\n\n\t\t{\n\t\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), { type: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.Default, filter: { include: new CodeActionKind('a.b.c') } }, Progress.None, CancellationToken.None));\n\t\t\tassert.strictEqual(actions.length, 0);\n\t\t}\n\t});\n\n\ttest('getCodeActions should forward requested scope to providers', async () => {\n\t\tconst provider = new class implements languages.CodeActionProvider {\n\t\t\tprovideCodeActions(_model: any, _range: Range, context: languages.CodeActionContext, _token: any): languages.CodeActionList {\n\t\t\t\treturn {\n\t\t\t\t\tactions: [\n\t\t\t\t\t\t{ title: context.only || '', kind: context.only }\n\t\t\t\t\t],\n\t\t\t\t\tdispose: () => { }\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tdisposables.add(registry.register('fooLang', provider));\n\n\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), { type: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.Default, filter: { include: new CodeActionKind('a') } }, Progress.None, CancellationToken.None));\n\t\tassert.strictEqual(actions.length, 1);\n\t\tassert.strictEqual(actions[0].action.title, 'a');\n\t});\n\n\ttest('getCodeActions should not return source code action by default', async () => {\n\t\tconst provider = staticCodeActionProvider(\n\t\t\t{ title: 'a', kind: CodeActionKind.Source.value },\n\t\t\t{ title: 'b', kind: 'b' }\n\t\t);\n\n\t\tdisposables.add(registry.register('fooLang', provider));\n\n\t\t{\n\t\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), { type: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.SourceAction }, Progress.None, CancellationToken.None));\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tassert.strictEqual(actions[0].action.title, 'b');\n\t\t}\n\n\t\t{\n\t\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), { type: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.Default, filter: { include: CodeActionKind.Source, includeSourceActions: true } }, Progress.None, CancellationToken.None));\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tassert.strictEqual(actions[0].action.title, 'a');\n\t\t}\n\t});\n\n\ttest('getCodeActions should support filtering out some requested source code actions #84602', async () => {\n\t\tconst provider = staticCodeActionProvider(\n\t\t\t{ title: 'a', kind: CodeActionKind.Source.value },\n\t\t\t{ title: 'b', kind: CodeActionKind.Source.append('test').value },\n\t\t\t{ title: 'c', kind: 'c' }\n\t\t);\n\n\t\tdisposables.add(registry.register('fooLang', provider));\n\n\t\t{\n\t\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), {\n\t\t\t\ttype: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.SourceAction, filter: {\n\t\t\t\t\tinclude: CodeActionKind.Source.append('test'),\n\t\t\t\t\texcludes: [CodeActionKind.Source],\n\t\t\t\t\tincludeSourceActions: true,\n\t\t\t\t}\n\t\t\t}, Progress.None, CancellationToken.None));\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tassert.strictEqual(actions[0].action.title, 'b');\n\t\t}\n\t});\n\n\ttest('getCodeActions no invoke a provider that has been excluded #84602', async () => {\n\t\tconst baseType = CodeActionKind.Refactor;\n\t\tconst subType = CodeActionKind.Refactor.append('sub');\n\n\t\tdisposables.add(registry.register('fooLang', staticCodeActionProvider(\n\t\t\t{ title: 'a', kind: baseType.value }\n\t\t)));\n\n\t\tlet didInvoke = false;\n\t\tdisposables.add(registry.register('fooLang', new class implements languages.CodeActionProvider {\n\n\t\t\tprovidedCodeActionKinds = [subType.value];\n\n\t\t\tprovideCodeActions(): languages.ProviderResult<languages.CodeActionList> {\n\t\t\t\tdidInvoke = true;\n\t\t\t\treturn {\n\t\t\t\t\tactions: [\n\t\t\t\t\t\t{ title: 'x', kind: subType.value }\n\t\t\t\t\t],\n\t\t\t\t\tdispose: () => { }\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\n\t\t{\n\t\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), {\n\t\t\t\ttype: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.Refactor, filter: {\n\t\t\t\t\tinclude: baseType,\n\t\t\t\t\texcludes: [subType],\n\t\t\t\t}\n\t\t\t}, Progress.None, CancellationToken.None));\n\t\t\tassert.strictEqual(didInvoke, false);\n\t\t\tassert.strictEqual(actions.length, 1);\n\t\t\tassert.strictEqual(actions[0].action.title, 'a');\n\t\t}\n\t});\n\n\ttest('getCodeActions should not invoke code action providers filtered out by providedCodeActionKinds', async () => {\n\t\tlet wasInvoked = false;\n\t\tconst provider = new class implements languages.CodeActionProvider {\n\t\t\tprovideCodeActions(): languages.CodeActionList {\n\t\t\t\twasInvoked = true;\n\t\t\t\treturn { actions: [], dispose: () => { } };\n\t\t\t}\n\n\t\t\tprovidedCodeActionKinds = [CodeActionKind.Refactor.value];\n\t\t};\n\n\t\tdisposables.add(registry.register('fooLang', provider));\n\n\t\tconst { validActions: actions } = disposables.add(await getCodeActions(registry, model, new Range(1, 1, 2, 1), {\n\t\t\ttype: languages.CodeActionTriggerType.Auto, triggerAction: CodeActionTriggerSource.Refactor,\n\t\t\tfilter: {\n\t\t\t\tinclude: CodeActionKind.QuickFix\n\t\t\t}\n\t\t}, Progress.None, CancellationToken.None));\n\t\tassert.strictEqual(actions.length, 0);\n\t\tassert.strictEqual(wasInvoked, false);\n\t});\n});\n"]}