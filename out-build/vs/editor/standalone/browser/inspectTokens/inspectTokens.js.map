{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/standalone/browser/inspectTokens/inspectTokens.ts"],"names":[],"mappings":"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","file":"inspectTokens.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./inspectTokens';\nimport { $, append, reset } from 'vs/base/browser/dom';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { Color } from 'vs/base/common/color';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { ContentWidgetPositionPreference, IActiveCodeEditor, ICodeEditor, IContentWidget, IContentWidgetPosition } from 'vs/editor/browser/editorBrowser';\nimport { EditorAction, ServicesAccessor, registerEditorAction, registerEditorContribution, EditorContributionInstantiation } from 'vs/editor/browser/editorExtensions';\nimport { Position } from 'vs/editor/common/core/position';\nimport { IEditorContribution } from 'vs/editor/common/editorCommon';\nimport { ITextModel } from 'vs/editor/common/model';\nimport { IState, ITokenizationSupport, TokenizationRegistry, ILanguageIdCodec, Token } from 'vs/editor/common/languages';\nimport { FontStyle, StandardTokenType, TokenMetadata } from 'vs/editor/common/encodedTokenAttributes';\nimport { NullState, nullTokenize, nullTokenizeEncoded } from 'vs/editor/common/languages/nullTokenize';\nimport { ILanguageService } from 'vs/editor/common/languages/language';\nimport { IStandaloneThemeService } from 'vs/editor/standalone/common/standaloneTheme';\nimport { InspectTokensNLS } from 'vs/editor/common/standaloneStrings';\n\n\nclass InspectTokensController extends Disposable implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.inspectTokens';\n\n\tpublic static get(editor: ICodeEditor): InspectTokensController | null {\n\t\treturn editor.getContribution<InspectTokensController>(InspectTokensController.ID);\n\t}\n\n\tprivate readonly _editor: ICodeEditor;\n\tprivate readonly _languageService: ILanguageService;\n\tprivate _widget: InspectTokensWidget | null;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@IStandaloneThemeService standaloneColorService: IStandaloneThemeService,\n\t\t@ILanguageService languageService: ILanguageService\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._languageService = languageService;\n\t\tthis._widget = null;\n\n\t\tthis._register(this._editor.onDidChangeModel((e) => this.stop()));\n\t\tthis._register(this._editor.onDidChangeModelLanguage((e) => this.stop()));\n\t\tthis._register(TokenizationRegistry.onDidChange((e) => this.stop()));\n\t\tthis._register(this._editor.onKeyUp((e) => e.keyCode === KeyCode.Escape && this.stop()));\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis.stop();\n\t\tsuper.dispose();\n\t}\n\n\tpublic launch(): void {\n\t\tif (this._widget) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tthis._widget = new InspectTokensWidget(this._editor, this._languageService);\n\t}\n\n\tpublic stop(): void {\n\t\tif (this._widget) {\n\t\t\tthis._widget.dispose();\n\t\t\tthis._widget = null;\n\t\t}\n\t}\n}\n\nclass InspectTokens extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.inspectTokens',\n\t\t\tlabel: InspectTokensNLS.inspectTokensAction,\n\t\t\talias: 'Developer: Inspect Tokens',\n\t\t\tprecondition: undefined\n\t\t});\n\t}\n\n\tpublic run(accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\tconst controller = InspectTokensController.get(editor);\n\t\tcontroller?.launch();\n\t}\n}\n\ninterface ICompleteLineTokenization {\n\tstartState: IState;\n\ttokens1: Token[];\n\ttokens2: Uint32Array;\n\tendState: IState;\n}\n\ninterface IDecodedMetadata {\n\tlanguageId: string;\n\ttokenType: StandardTokenType;\n\tfontStyle: FontStyle;\n\tforeground: Color;\n\tbackground: Color;\n}\n\nfunction renderTokenText(tokenText: string): string {\n\tlet result: string = '';\n\tfor (let charIndex = 0, len = tokenText.length; charIndex < len; charIndex++) {\n\t\tconst charCode = tokenText.charCodeAt(charIndex);\n\t\tswitch (charCode) {\n\t\t\tcase CharCode.Tab:\n\t\t\t\tresult += '\\u2192'; // &rarr;\n\t\t\t\tbreak;\n\n\t\t\tcase CharCode.Space:\n\t\t\t\tresult += '\\u00B7'; // &middot;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tresult += String.fromCharCode(charCode);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction getSafeTokenizationSupport(languageIdCodec: ILanguageIdCodec, languageId: string): ITokenizationSupport {\n\tconst tokenizationSupport = TokenizationRegistry.get(languageId);\n\tif (tokenizationSupport) {\n\t\treturn tokenizationSupport;\n\t}\n\tconst encodedLanguageId = languageIdCodec.encodeLanguageId(languageId);\n\treturn {\n\t\tgetInitialState: () => NullState,\n\t\ttokenize: (line: string, hasEOL: boolean, state: IState) => nullTokenize(languageId, state),\n\t\ttokenizeEncoded: (line: string, hasEOL: boolean, state: IState) => nullTokenizeEncoded(encodedLanguageId, state)\n\t};\n}\n\nclass InspectTokensWidget extends Disposable implements IContentWidget {\n\n\tprivate static readonly _ID = 'editor.contrib.inspectTokensWidget';\n\n\t// Editor.IContentWidget.allowEditorOverflow\n\tpublic allowEditorOverflow = true;\n\n\tprivate readonly _editor: IActiveCodeEditor;\n\tprivate readonly _languageService: ILanguageService;\n\tprivate readonly _tokenizationSupport: ITokenizationSupport;\n\tprivate readonly _model: ITextModel;\n\tprivate readonly _domNode: HTMLElement;\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\tlanguageService: ILanguageService\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._languageService = languageService;\n\t\tthis._model = this._editor.getModel();\n\t\tthis._domNode = document.createElement('div');\n\t\tthis._domNode.className = 'tokens-inspect-widget';\n\t\tthis._tokenizationSupport = getSafeTokenizationSupport(this._languageService.languageIdCodec, this._model.getLanguageId());\n\t\tthis._compute(this._editor.getPosition());\n\t\tthis._register(this._editor.onDidChangeCursorPosition((e) => this._compute(this._editor.getPosition())));\n\t\tthis._editor.addContentWidget(this);\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis._editor.removeContentWidget(this);\n\t\tsuper.dispose();\n\t}\n\n\tpublic getId(): string {\n\t\treturn InspectTokensWidget._ID;\n\t}\n\n\tprivate _compute(position: Position): void {\n\t\tconst data = this._getTokensAtLine(position.lineNumber);\n\n\t\tlet token1Index = 0;\n\t\tfor (let i = data.tokens1.length - 1; i >= 0; i--) {\n\t\t\tconst t = data.tokens1[i];\n\t\t\tif (position.column - 1 >= t.offset) {\n\t\t\t\ttoken1Index = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tlet token2Index = 0;\n\t\tfor (let i = (data.tokens2.length >>> 1); i >= 0; i--) {\n\t\t\tif (position.column - 1 >= data.tokens2[(i << 1)]) {\n\t\t\t\ttoken2Index = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tconst lineContent = this._model.getLineContent(position.lineNumber);\n\t\tlet tokenText = '';\n\t\tif (token1Index < data.tokens1.length) {\n\t\t\tconst tokenStartIndex = data.tokens1[token1Index].offset;\n\t\t\tconst tokenEndIndex = token1Index + 1 < data.tokens1.length ? data.tokens1[token1Index + 1].offset : lineContent.length;\n\t\t\ttokenText = lineContent.substring(tokenStartIndex, tokenEndIndex);\n\t\t}\n\t\treset(this._domNode,\n\t\t\t$('h2.tm-token', undefined, renderTokenText(tokenText),\n\t\t\t\t$('span.tm-token-length', undefined, `${tokenText.length} ${tokenText.length === 1 ? 'char' : 'chars'}`)));\n\n\t\tappend(this._domNode, $('hr.tokens-inspect-separator', { 'style': 'clear:both' }));\n\n\t\tconst metadata = (token2Index << 1) + 1 < data.tokens2.length ? this._decodeMetadata(data.tokens2[(token2Index << 1) + 1]) : null;\n\t\tappend(this._domNode, $('table.tm-metadata-table', undefined,\n\t\t\t$('tbody', undefined,\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'language'),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? metadata.languageId : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'token type' as string),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? this._tokenTypeToString(metadata.tokenType) : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'font style' as string),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? this._fontStyleToString(metadata.fontStyle) : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'foreground'),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? Color.Format.CSS.formatHex(metadata.foreground) : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'background'),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? Color.Format.CSS.formatHex(metadata.background) : '-?-'}`)\n\t\t\t\t)\n\t\t\t)\n\t\t));\n\t\tappend(this._domNode, $('hr.tokens-inspect-separator'));\n\n\t\tif (token1Index < data.tokens1.length) {\n\t\t\tappend(this._domNode, $('span.tm-token-type', undefined, data.tokens1[token1Index].type));\n\t\t}\n\n\t\tthis._editor.layoutContentWidget(this);\n\t}\n\n\tprivate _decodeMetadata(metadata: number): IDecodedMetadata {\n\t\tconst colorMap = TokenizationRegistry.getColorMap()!;\n\t\tconst languageId = TokenMetadata.getLanguageId(metadata);\n\t\tconst tokenType = TokenMetadata.getTokenType(metadata);\n\t\tconst fontStyle = TokenMetadata.getFontStyle(metadata);\n\t\tconst foreground = TokenMetadata.getForeground(metadata);\n\t\tconst background = TokenMetadata.getBackground(metadata);\n\t\treturn {\n\t\t\tlanguageId: this._languageService.languageIdCodec.decodeLanguageId(languageId),\n\t\t\ttokenType: tokenType,\n\t\t\tfontStyle: fontStyle,\n\t\t\tforeground: colorMap[foreground],\n\t\t\tbackground: colorMap[background]\n\t\t};\n\t}\n\n\tprivate _tokenTypeToString(tokenType: StandardTokenType): string {\n\t\tswitch (tokenType) {\n\t\t\tcase StandardTokenType.Other: return 'Other';\n\t\t\tcase StandardTokenType.Comment: return 'Comment';\n\t\t\tcase StandardTokenType.String: return 'String';\n\t\t\tcase StandardTokenType.RegEx: return 'RegEx';\n\t\t\tdefault: return '??';\n\t\t}\n\t}\n\n\tprivate _fontStyleToString(fontStyle: FontStyle): string {\n\t\tlet r = '';\n\t\tif (fontStyle & FontStyle.Italic) {\n\t\t\tr += 'italic ';\n\t\t}\n\t\tif (fontStyle & FontStyle.Bold) {\n\t\t\tr += 'bold ';\n\t\t}\n\t\tif (fontStyle & FontStyle.Underline) {\n\t\t\tr += 'underline ';\n\t\t}\n\t\tif (fontStyle & FontStyle.Strikethrough) {\n\t\t\tr += 'strikethrough ';\n\t\t}\n\t\tif (r.length === 0) {\n\t\t\tr = '---';\n\t\t}\n\t\treturn r;\n\t}\n\n\tprivate _getTokensAtLine(lineNumber: number): ICompleteLineTokenization {\n\t\tconst stateBeforeLine = this._getStateBeforeLine(lineNumber);\n\n\t\tconst tokenizationResult1 = this._tokenizationSupport.tokenize(this._model.getLineContent(lineNumber), true, stateBeforeLine);\n\t\tconst tokenizationResult2 = this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(lineNumber), true, stateBeforeLine);\n\n\t\treturn {\n\t\t\tstartState: stateBeforeLine,\n\t\t\ttokens1: tokenizationResult1.tokens,\n\t\t\ttokens2: tokenizationResult2.tokens,\n\t\t\tendState: tokenizationResult1.endState\n\t\t};\n\t}\n\n\tprivate _getStateBeforeLine(lineNumber: number): IState {\n\t\tlet state: IState = this._tokenizationSupport.getInitialState();\n\n\t\tfor (let i = 1; i < lineNumber; i++) {\n\t\t\tconst tokenizationResult = this._tokenizationSupport.tokenize(this._model.getLineContent(i), true, state);\n\t\t\tstate = tokenizationResult.endState;\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tpublic getDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic getPosition(): IContentWidgetPosition {\n\t\treturn {\n\t\t\tposition: this._editor.getPosition(),\n\t\t\tpreference: [ContentWidgetPositionPreference.BELOW, ContentWidgetPositionPreference.ABOVE]\n\t\t};\n\t}\n}\n\nregisterEditorContribution(InspectTokensController.ID, InspectTokensController, EditorContributionInstantiation.Lazy);\nregisterEditorAction(InspectTokens);\n"]}