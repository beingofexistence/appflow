{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/browser/widget/diffEditor/diffEditorWidget.ts"],"names":[],"mappings":"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","file":"diffEditorWidget.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, h } from 'vs/base/browser/dom';\nimport { IBoundarySashes } from 'vs/base/browser/ui/sash/sash';\nimport { findLast } from 'vs/base/common/arraysFind';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { Event } from 'vs/base/common/event';\nimport { toDisposable } from 'vs/base/common/lifecycle';\nimport { IObservable, autorun, autorunWithStore, derived, derivedWithStore, disposableObservableValue, recomputeInitiallyAndOnChange, observableValue, transaction } from 'vs/base/common/observable';\nimport 'vs/css!./style';\nimport { IEditorConstructionOptions } from 'vs/editor/browser/config/editorConfiguration';\nimport { ICodeEditor, IDiffEditor, IDiffEditorConstructionOptions, IMouseTargetViewZone } from 'vs/editor/browser/editorBrowser';\nimport { EditorExtensionsRegistry, IDiffEditorContributionDescription } from 'vs/editor/browser/editorExtensions';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { CodeEditorWidget, ICodeEditorWidgetOptions } from 'vs/editor/browser/widget/codeEditorWidget';\nimport { AccessibleDiffViewer } from 'vs/editor/browser/widget/diffEditor/accessibleDiffViewer';\nimport { DiffEditorDecorations } from 'vs/editor/browser/widget/diffEditor/diffEditorDecorations';\nimport { DiffEditorSash } from 'vs/editor/browser/widget/diffEditor/diffEditorSash';\nimport { HideUnchangedRegionsFeature } from 'vs/editor/browser/widget/diffEditor/hideUnchangedRegionsFeature';\nimport { ViewZoneManager } from 'vs/editor/browser/widget/diffEditor/lineAlignment';\nimport { MovedBlocksLinesPart } from 'vs/editor/browser/widget/diffEditor/movedBlocksLines';\nimport { OverviewRulerPart } from 'vs/editor/browser/widget/diffEditor/overviewRulerPart';\nimport { CSSStyle, ObservableElementSizeObserver, applyStyle, readHotReloadableExport } from 'vs/editor/browser/widget/diffEditor/utils';\nimport { IDiffEditorOptions } from 'vs/editor/common/config/editorOptions';\nimport { IDimension } from 'vs/editor/common/core/dimension';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Range } from 'vs/editor/common/core/range';\nimport { CursorChangeReason } from 'vs/editor/common/cursorEvents';\nimport { IDiffComputationResult, ILineChange } from 'vs/editor/common/diff/legacyLinesDiffComputer';\nimport { DetailedLineRangeMapping } from 'vs/editor/common/diff/rangeMapping';\nimport { EditorType, IDiffEditorModel, IDiffEditorViewModel, IDiffEditorViewState } from 'vs/editor/common/editorCommon';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { IIdentifiedSingleEditOperation } from 'vs/editor/common/model';\nimport { LengthObj } from 'vs/editor/common/model/bracketPairsTextModelPart/bracketPairsTree/length';\nimport { AudioCue, IAudioCueService } from 'vs/platform/audioCues/browser/audioCueService';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\nimport { IEditorProgressService } from 'vs/platform/progress/common/progress';\nimport './colors';\nimport { DelegatingEditor } from './delegatingEditorImpl';\nimport { DiffEditorEditors } from './diffEditorEditors';\nimport { DiffEditorOptions } from './diffEditorOptions';\nimport { DiffEditorViewModel, DiffMapping, DiffState } from './diffEditorViewModel';\n\nexport interface IDiffCodeEditorWidgetOptions {\n\toriginalEditor?: ICodeEditorWidgetOptions;\n\tmodifiedEditor?: ICodeEditorWidgetOptions;\n}\n\nexport class DiffEditorWidget extends DelegatingEditor implements IDiffEditor {\n\tpublic static ENTIRE_DIFF_OVERVIEW_WIDTH = OverviewRulerPart.ENTIRE_DIFF_OVERVIEW_WIDTH;\n\n\tprivate readonly elements = h('div.monaco-diff-editor.side-by-side', { style: { position: 'relative', height: '100%' } }, [\n\t\th('div.noModificationsOverlay@overlay', { style: { position: 'absolute', height: '100%', visibility: 'hidden', } }, [$('span', {}, 'No Changes')]),\n\t\th('div.editor.original@original', { style: { position: 'absolute', height: '100%' } }),\n\t\th('div.editor.modified@modified', { style: { position: 'absolute', height: '100%' } }),\n\t\th('div.accessibleDiffViewer@accessibleDiffViewer', { style: { position: 'absolute', height: '100%' } }),\n\t]);\n\tprivate readonly _diffModel = this._register(disposableObservableValue<DiffEditorViewModel | undefined>('diffModel', undefined));\n\tpublic readonly onDidChangeModel = Event.fromObservableLight(this._diffModel);\n\n\tpublic get onDidContentSizeChange() { return this._editors.onDidContentSizeChange; }\n\n\tprivate readonly _contextKeyService = this._register(this._parentContextKeyService.createScoped(this._domElement));\n\tprivate readonly _instantiationService = this._parentInstantiationService.createChild(\n\t\tnew ServiceCollection([IContextKeyService, this._contextKeyService])\n\t);\n\tprivate readonly _rootSizeObserver: ObservableElementSizeObserver;\n\n\tprivate readonly _sash: IObservable<DiffEditorSash | undefined>;\n\tprivate readonly _boundarySashes = observableValue<IBoundarySashes | undefined>(this, undefined);\n\n\tprivate unchangedRangesFeature!: HideUnchangedRegionsFeature;\n\n\tprivate _accessibleDiffViewerShouldBeVisible = observableValue(this, false);\n\tprivate _accessibleDiffViewerVisible = derived(this, reader =>\n\t\tthis._options.onlyShowAccessibleDiffViewer.read(reader)\n\t\t\t? true\n\t\t\t: this._accessibleDiffViewerShouldBeVisible.read(reader)\n\t);\n\tprivate _accessibleDiffViewer!: AccessibleDiffViewer;\n\tprivate readonly _options: DiffEditorOptions;\n\tprivate readonly _editors: DiffEditorEditors;\n\n\tprivate readonly movedBlocksLinesPart = observableValue<MovedBlocksLinesPart | undefined>(this, undefined);\n\n\tpublic get collapseUnchangedRegions() { return this._options.hideUnchangedRegions.get(); }\n\n\tconstructor(\n\t\tprivate readonly _domElement: HTMLElement,\n\t\toptions: Readonly<IDiffEditorConstructionOptions>,\n\t\tcodeEditorWidgetOptions: IDiffCodeEditorWidgetOptions,\n\t\t@IContextKeyService private readonly _parentContextKeyService: IContextKeyService,\n\t\t@IInstantiationService private readonly _parentInstantiationService: IInstantiationService,\n\t\t@ICodeEditorService codeEditorService: ICodeEditorService,\n\t\t@IAudioCueService private readonly _audioCueService: IAudioCueService,\n\t\t@IEditorProgressService private readonly _editorProgressService: IEditorProgressService,\n\t) {\n\t\tsuper();\n\t\tcodeEditorService.willCreateDiffEditor();\n\n\t\tthis._contextKeyService.createKey('isInDiffEditor', true);\n\n\t\tthis._domElement.appendChild(this.elements.root);\n\t\tthis._register(toDisposable(() => this._domElement.removeChild(this.elements.root)));\n\n\t\tthis._rootSizeObserver = this._register(new ObservableElementSizeObserver(this.elements.root, options.dimension));\n\t\tthis._rootSizeObserver.setAutomaticLayout(options.automaticLayout ?? false);\n\n\t\tthis._options = new DiffEditorOptions(options, this._rootSizeObserver.width);\n\n\t\tthis._contextKeyService.createKey(EditorContextKeys.isEmbeddedDiffEditor.key, false);\n\t\tconst isEmbeddedDiffEditorKey = EditorContextKeys.isEmbeddedDiffEditor.bindTo(this._contextKeyService);\n\t\tthis._register(autorun(reader => {\n\t\t\t/** @description update isEmbeddedDiffEditorKey */\n\t\t\tisEmbeddedDiffEditorKey.set(this._options.isInEmbeddedEditor.read(reader));\n\t\t}));\n\n\t\tconst comparingMovedCodeKey = EditorContextKeys.comparingMovedCode.bindTo(this._contextKeyService);\n\t\tthis._register(autorun(reader => {\n\t\t\t/** @description update comparingMovedCodeKey */\n\t\t\tcomparingMovedCodeKey.set(!!this._diffModel.read(reader)?.movedTextToCompare.read(reader));\n\t\t}));\n\n\t\tconst diffEditorRenderSideBySideInlineBreakpointReachedContextKeyValue = EditorContextKeys.diffEditorRenderSideBySideInlineBreakpointReached.bindTo(this._contextKeyService);\n\t\tthis._register(autorun(reader => {\n\t\t\t/** @description update accessibleDiffViewerVisible context key */\n\t\t\tdiffEditorRenderSideBySideInlineBreakpointReachedContextKeyValue.set(this._options.couldShowInlineViewBecauseOfSize.read(reader));\n\t\t}));\n\n\t\tthis._editors = this._register(this._instantiationService.createInstance(\n\t\t\tDiffEditorEditors,\n\t\t\tthis.elements.original,\n\t\t\tthis.elements.modified,\n\t\t\tthis._options,\n\t\t\tcodeEditorWidgetOptions,\n\t\t\t(i, c, o, o2) => this._createInnerEditor(i, c, o, o2)\n\t\t));\n\n\t\tthis._sash = derivedWithStore(this, (reader, store) => {\n\t\t\tconst showSash = this._options.renderSideBySide.read(reader);\n\t\t\tthis.elements.root.classList.toggle('side-by-side', showSash);\n\t\t\tif (!showSash) { return undefined; }\n\t\t\tconst result = store.add(new DiffEditorSash(\n\t\t\t\tthis._options,\n\t\t\t\tthis.elements.root,\n\t\t\t\t{\n\t\t\t\t\theight: this._rootSizeObserver.height,\n\t\t\t\t\twidth: this._rootSizeObserver.width.map((w, reader) => w - (this._options.renderOverviewRuler.read(reader) ? OverviewRulerPart.ENTIRE_DIFF_OVERVIEW_WIDTH : 0)),\n\t\t\t\t}\n\t\t\t));\n\t\t\tstore.add(autorun(reader => {\n\t\t\t\t/** @description setBoundarySashes */\n\t\t\t\tconst boundarySashes = this._boundarySashes.read(reader);\n\t\t\t\tif (boundarySashes) {\n\t\t\t\t\tresult.setBoundarySashes(boundarySashes);\n\t\t\t\t}\n\t\t\t}));\n\t\t\treturn result;\n\t\t});\n\t\tthis._register(recomputeInitiallyAndOnChange(this._sash));\n\n\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\t/** @description UnchangedRangesFeature */\n\t\t\tthis.unchangedRangesFeature = store.add(\n\t\t\t\tthis._instantiationService.createInstance(readHotReloadableExport(HideUnchangedRegionsFeature, reader), this._editors, this._diffModel, this._options)\n\t\t\t);\n\t\t}));\n\n\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\t/** @description DiffEditorDecorations */\n\t\t\tstore.add(new (readHotReloadableExport(DiffEditorDecorations, reader))(this._editors, this._diffModel, this._options));\n\t\t}));\n\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\t/** @description ViewZoneManager */\n\t\t\tstore.add(this._instantiationService.createInstance(\n\t\t\t\treadHotReloadableExport(ViewZoneManager, reader),\n\t\t\t\tthis._editors,\n\t\t\t\tthis._diffModel,\n\t\t\t\tthis._options,\n\t\t\t\tthis,\n\t\t\t\t() => this.unchangedRangesFeature.isUpdatingViewZones,\n\t\t\t));\n\t\t}));\n\n\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\t/** @description OverviewRulerPart */\n\t\t\tstore.add(this._instantiationService.createInstance(\n\t\t\t\treadHotReloadableExport(OverviewRulerPart, reader),\n\t\t\t\tthis._editors,\n\t\t\t\tthis.elements.root,\n\t\t\t\tthis._diffModel,\n\t\t\t\tthis._rootSizeObserver.width,\n\t\t\t\tthis._rootSizeObserver.height,\n\t\t\t\tthis._layoutInfo.map(i => i.modifiedEditor),\n\t\t\t\tthis._options,\n\t\t\t));\n\t\t}));\n\n\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\t/** @description _accessibleDiffViewer */\n\t\t\tthis._accessibleDiffViewer = store.add(this._register(this._instantiationService.createInstance(\n\t\t\t\treadHotReloadableExport(AccessibleDiffViewer, reader),\n\t\t\t\tthis.elements.accessibleDiffViewer,\n\t\t\t\tthis._accessibleDiffViewerVisible,\n\t\t\t\t(visible, tx) => this._accessibleDiffViewerShouldBeVisible.set(visible, tx),\n\t\t\t\tthis._options.onlyShowAccessibleDiffViewer.map(v => !v),\n\t\t\t\tthis._rootSizeObserver.width,\n\t\t\t\tthis._rootSizeObserver.height,\n\t\t\t\tthis._diffModel.map((m, r) => m?.diff.read(r)?.mappings.map(m => m.lineRangeMapping)),\n\t\t\t\tthis._editors,\n\t\t\t)));\n\t\t}));\n\t\tconst visibility = this._accessibleDiffViewerVisible.map<CSSStyle['visibility']>(v => v ? 'hidden' : 'visible');\n\t\tthis._register(applyStyle(this.elements.modified, { visibility }));\n\t\tthis._register(applyStyle(this.elements.original, { visibility }));\n\n\t\tthis._createDiffEditorContributions();\n\n\t\tcodeEditorService.addDiffEditor(this);\n\n\t\tthis._register(recomputeInitiallyAndOnChange(this._layoutInfo));\n\n\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\tthis.movedBlocksLinesPart.set(store.add(new (readHotReloadableExport(MovedBlocksLinesPart, reader))(\n\t\t\t\tthis.elements.root,\n\t\t\t\tthis._diffModel,\n\t\t\t\tthis._layoutInfo.map(i => i.originalEditor),\n\t\t\t\tthis._layoutInfo.map(i => i.modifiedEditor),\n\t\t\t\tthis._editors,\n\t\t\t)), undefined);\n\t\t}));\n\n\t\tthis._register(applyStyle(this.elements.overlay, {\n\t\t\twidth: this._layoutInfo.map((i, r) => i.originalEditor.width + (this._options.renderSideBySide.read(r) ? 0 : i.modifiedEditor.width)),\n\t\t\tvisibility: derived(reader => /** @description visibility */(this._options.hideUnchangedRegions.read(reader) && this._diffModel.read(reader)?.diff.read(reader)?.mappings.length === 0)\n\t\t\t\t? 'visible' : 'hidden'\n\t\t\t),\n\t\t}));\n\n\t\t// Revert change when an arrow is clicked.\n\t\tthis._register(this._editors.modified.onMouseDown(event => {\n\t\t\tif (!event.event.rightButton && event.target.position && event.target.element?.className.includes('arrow-revert-change')) {\n\t\t\t\tconst lineNumber = event.target.position.lineNumber;\n\t\t\t\tconst viewZone = event.target as IMouseTargetViewZone | undefined;\n\n\t\t\t\tconst model = this._diffModel.get();\n\t\t\t\tif (!model) { return; }\n\t\t\t\tconst diffs = model.diff.get()?.mappings;\n\t\t\t\tif (!diffs) { return; }\n\t\t\t\tconst diff = diffs.find(d =>\n\t\t\t\t\tviewZone?.detail.afterLineNumber === d.lineRangeMapping.modified.startLineNumber - 1 ||\n\t\t\t\t\td.lineRangeMapping.modified.startLineNumber === lineNumber\n\t\t\t\t);\n\t\t\t\tif (!diff) { return; }\n\t\t\t\tthis.revert(diff.lineRangeMapping);\n\n\t\t\t\tevent.event.stopPropagation();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(Event.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition, (e) => {\n\t\t\tif (e?.reason === CursorChangeReason.Explicit) {\n\t\t\t\tconst diff = this._diffModel.get()?.diff.get()?.mappings.find(m => m.lineRangeMapping.modified.contains(e.position.lineNumber));\n\t\t\t\tif (diff?.lineRangeMapping.modified.isEmpty) {\n\t\t\t\t\tthis._audioCueService.playAudioCue(AudioCue.diffLineDeleted, { source: 'diffEditor.cursorPositionChanged' });\n\t\t\t\t} else if (diff?.lineRangeMapping.original.isEmpty) {\n\t\t\t\t\tthis._audioCueService.playAudioCue(AudioCue.diffLineInserted, { source: 'diffEditor.cursorPositionChanged' });\n\t\t\t\t} else if (diff) {\n\t\t\t\t\tthis._audioCueService.playAudioCue(AudioCue.diffLineModified, { source: 'diffEditor.cursorPositionChanged' });\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tconst isDiffUpToDate = this._diffModel.map((m, reader) => m?.isDiffUpToDate.read(reader));\n\t\tthis._register(autorunWithStore((reader, store) => {\n\t\t\tif (isDiffUpToDate.read(reader) === false) {\n\t\t\t\tconst r = this._editorProgressService.show(true, 1000);\n\t\t\t\tstore.add(toDisposable(() => r.done()));\n\t\t\t}\n\t\t}));\n\t}\n\n\tpublic getViewWidth(): number {\n\t\treturn this._rootSizeObserver.width.get();\n\t}\n\n\tpublic getContentHeight() {\n\t\treturn this._editors.modified.getContentHeight();\n\t}\n\n\tprotected _createInnerEditor(instantiationService: IInstantiationService, container: HTMLElement, options: Readonly<IEditorConstructionOptions>, editorWidgetOptions: ICodeEditorWidgetOptions): CodeEditorWidget {\n\t\tconst editor = instantiationService.createInstance(CodeEditorWidget, container, options, editorWidgetOptions);\n\t\treturn editor;\n\t}\n\n\tprivate readonly _layoutInfo = derived(this, reader => {\n\t\tconst width = this._rootSizeObserver.width.read(reader);\n\t\tconst height = this._rootSizeObserver.height.read(reader);\n\t\tconst sashLeft = this._sash.read(reader)?.sashLeft.read(reader);\n\n\t\tconst originalWidth = sashLeft ?? Math.max(5, this._editors.original.getLayoutInfo().decorationsLeft);\n\t\tconst modifiedWidth = width - originalWidth - (this._options.renderOverviewRuler.read(reader) ? OverviewRulerPart.ENTIRE_DIFF_OVERVIEW_WIDTH : 0);\n\n\t\tconst movedBlocksLinesWidth = this.movedBlocksLinesPart.read(reader)?.width.read(reader) ?? 0;\n\t\tconst originalWidthWithoutMovedBlockLines = originalWidth - movedBlocksLinesWidth;\n\t\tthis.elements.original.style.width = originalWidthWithoutMovedBlockLines + 'px';\n\t\tthis.elements.original.style.left = '0px';\n\n\t\tthis.elements.modified.style.width = modifiedWidth + 'px';\n\t\tthis.elements.modified.style.left = originalWidth + 'px';\n\n\t\tthis._editors.original.layout({ width: originalWidthWithoutMovedBlockLines, height });\n\t\tthis._editors.modified.layout({ width: modifiedWidth, height });\n\n\t\treturn {\n\t\t\tmodifiedEditor: this._editors.modified.getLayoutInfo(),\n\t\t\toriginalEditor: this._editors.original.getLayoutInfo(),\n\t\t};\n\t});\n\n\tprivate _createDiffEditorContributions() {\n\t\tconst contributions: IDiffEditorContributionDescription[] = EditorExtensionsRegistry.getDiffEditorContributions();\n\t\tfor (const desc of contributions) {\n\t\t\ttry {\n\t\t\t\tthis._register(this._instantiationService.createInstance(desc.ctor, this));\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected override get _targetEditor(): CodeEditorWidget { return this._editors.modified; }\n\n\toverride getEditorType(): string { return EditorType.IDiffEditor; }\n\n\toverride onVisible(): void {\n\t\t// TODO: Only compute diffs when diff editor is visible\n\t\tthis._editors.original.onVisible();\n\t\tthis._editors.modified.onVisible();\n\t}\n\n\toverride onHide(): void {\n\t\tthis._editors.original.onHide();\n\t\tthis._editors.modified.onHide();\n\t}\n\n\toverride layout(dimension?: IDimension | undefined): void { this._rootSizeObserver.observe(dimension); }\n\n\toverride hasTextFocus(): boolean { return this._editors.original.hasTextFocus() || this._editors.modified.hasTextFocus(); }\n\n\tpublic override saveViewState(): IDiffEditorViewState {\n\t\tconst originalViewState = this._editors.original.saveViewState();\n\t\tconst modifiedViewState = this._editors.modified.saveViewState();\n\t\treturn {\n\t\t\toriginal: originalViewState,\n\t\t\tmodified: modifiedViewState,\n\t\t\tmodelState: this._diffModel.get()?.serializeState(),\n\t\t};\n\t}\n\n\tpublic override restoreViewState(s: IDiffEditorViewState): void {\n\t\tif (s && s.original && s.modified) {\n\t\t\tconst diffEditorState = s as IDiffEditorViewState;\n\t\t\tthis._editors.original.restoreViewState(diffEditorState.original);\n\t\t\tthis._editors.modified.restoreViewState(diffEditorState.modified);\n\t\t\tif (diffEditorState.modelState) {\n\t\t\t\tthis._diffModel.get()?.restoreSerializedState(diffEditorState.modelState as any);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic createViewModel(model: IDiffEditorModel): IDiffEditorViewModel {\n\t\treturn this._instantiationService.createInstance(DiffEditorViewModel, model, this._options, this);\n\t}\n\n\toverride getModel(): IDiffEditorModel | null { return this._diffModel.get()?.model ?? null; }\n\n\toverride setModel(model: IDiffEditorModel | null | IDiffEditorViewModel): void {\n\t\tif (!model && this._diffModel.get()) {\n\t\t\t// Transitioning from a model to no-model\n\t\t\tthis._accessibleDiffViewer.close();\n\t\t}\n\n\t\tconst vm = model ? ('model' in model) ? model : this.createViewModel(model) : undefined;\n\t\tthis._editors.original.setModel(vm ? vm.model.original : null);\n\t\tthis._editors.modified.setModel(vm ? vm.model.modified : null);\n\t\ttransaction(tx => {\n\t\t\tthis._diffModel.set(vm as (DiffEditorViewModel | undefined), tx);\n\t\t});\n\t}\n\n\t/**\n\t * @param changedOptions Only has values for top-level options that have actually changed.\n\t */\n\toverride updateOptions(changedOptions: IDiffEditorOptions): void {\n\t\tthis._options.updateOptions(changedOptions);\n\t}\n\n\tgetContainerDomNode(): HTMLElement { return this._domElement; }\n\tgetOriginalEditor(): ICodeEditor { return this._editors.original; }\n\tgetModifiedEditor(): ICodeEditor { return this._editors.modified; }\n\n\tsetBoundarySashes(sashes: IBoundarySashes): void {\n\t\tthis._boundarySashes.set(sashes, undefined);\n\t}\n\n\tprivate readonly _diffValue = this._diffModel.map((m, r) => m?.diff.read(r));\n\treadonly onDidUpdateDiff: Event<void> = Event.fromObservableLight(this._diffValue);\n\n\tget ignoreTrimWhitespace(): boolean { return this._options.ignoreTrimWhitespace.get(); }\n\n\tget maxComputationTime(): number { return this._options.maxComputationTimeMs.get(); }\n\n\tget renderSideBySide(): boolean { return this._options.renderSideBySide.get(); }\n\n\t/**\n\t * @deprecated Use `this.getDiffComputationResult().changes2` instead.\n\t */\n\tgetLineChanges(): ILineChange[] | null {\n\t\tconst diffState = this._diffModel.get()?.diff.get();\n\t\tif (!diffState) { return null; }\n\t\treturn toLineChanges(diffState);\n\t}\n\n\tgetDiffComputationResult(): IDiffComputationResult | null {\n\t\tconst diffState = this._diffModel.get()?.diff.get();\n\t\tif (!diffState) { return null; }\n\n\t\treturn {\n\t\t\tchanges: this.getLineChanges()!,\n\t\t\tchanges2: diffState.mappings.map(m => m.lineRangeMapping),\n\t\t\tidentical: diffState.identical,\n\t\t\tquitEarly: diffState.quitEarly,\n\t\t};\n\t}\n\n\trevert(diff: DetailedLineRangeMapping): void {\n\t\tconst model = this._diffModel.get()?.model;\n\t\tif (!model) { return; }\n\n\t\tconst changes: IIdentifiedSingleEditOperation[] = diff.innerChanges\n\t\t\t? diff.innerChanges.map<IIdentifiedSingleEditOperation>(c => ({\n\t\t\t\trange: c.modifiedRange,\n\t\t\t\ttext: model.original.getValueInRange(c.originalRange)\n\t\t\t}))\n\t\t\t: [\n\t\t\t\t{\n\t\t\t\t\trange: diff.modified.toExclusiveRange(),\n\t\t\t\t\ttext: model.original.getValueInRange(diff.original.toExclusiveRange())\n\t\t\t\t}\n\t\t\t];\n\n\t\tthis._editors.modified.executeEdits('diffEditor', changes);\n\t}\n\n\tprivate _goTo(diff: DiffMapping): void {\n\t\tthis._editors.modified.setPosition(new Position(diff.lineRangeMapping.modified.startLineNumber, 1));\n\t\tthis._editors.modified.revealRangeInCenter(diff.lineRangeMapping.modified.toExclusiveRange());\n\t}\n\n\tgoToDiff(target: 'previous' | 'next'): void {\n\t\tconst diffs = this._diffModel.get()?.diff.get()?.mappings;\n\t\tif (!diffs || diffs.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst curLineNumber = this._editors.modified.getPosition()!.lineNumber;\n\n\t\tlet diff: DiffMapping | undefined;\n\t\tif (target === 'next') {\n\t\t\tdiff = diffs.find(d => d.lineRangeMapping.modified.startLineNumber > curLineNumber) ?? diffs[0];\n\t\t} else {\n\t\t\tdiff = findLast(diffs, d => d.lineRangeMapping.modified.startLineNumber < curLineNumber) ?? diffs[diffs.length - 1];\n\t\t}\n\t\tthis._goTo(diff);\n\n\t\tif (diff.lineRangeMapping.modified.isEmpty) {\n\t\t\tthis._audioCueService.playAudioCue(AudioCue.diffLineDeleted, { source: 'diffEditor.goToDiff' });\n\t\t} else if (diff.lineRangeMapping.original.isEmpty) {\n\t\t\tthis._audioCueService.playAudioCue(AudioCue.diffLineInserted, { source: 'diffEditor.goToDiff' });\n\t\t} else if (diff) {\n\t\t\tthis._audioCueService.playAudioCue(AudioCue.diffLineModified, { source: 'diffEditor.goToDiff' });\n\t\t}\n\t}\n\n\trevealFirstDiff(): void {\n\t\tconst diffModel = this._diffModel.get();\n\t\tif (!diffModel) {\n\t\t\treturn;\n\t\t}\n\t\t// wait for the diff computation to finish\n\t\tthis.waitForDiff().then(() => {\n\t\t\tconst diffs = diffModel.diff.get()?.mappings;\n\t\t\tif (!diffs || diffs.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._goTo(diffs[0]);\n\t\t});\n\t}\n\n\taccessibleDiffViewerNext(): void { this._accessibleDiffViewer.next(); }\n\n\taccessibleDiffViewerPrev(): void { this._accessibleDiffViewer.prev(); }\n\n\tasync waitForDiff(): Promise<void> {\n\t\tconst diffModel = this._diffModel.get();\n\t\tif (!diffModel) { return; }\n\t\tawait diffModel.waitForDiff();\n\t}\n\n\tmapToOtherSide(): { destination: CodeEditorWidget; destinationSelection: Range | undefined } {\n\t\tconst isModifiedFocus = this._editors.modified.hasWidgetFocus();\n\t\tconst source = isModifiedFocus ? this._editors.modified : this._editors.original;\n\t\tconst destination = isModifiedFocus ? this._editors.original : this._editors.modified;\n\n\t\tlet destinationSelection: Range | undefined;\n\n\t\tconst sourceSelection = source.getSelection();\n\t\tif (sourceSelection) {\n\t\t\tconst mappings = this._diffModel.get()?.diff.get()?.mappings.map(m => isModifiedFocus ? m.lineRangeMapping.flip() : m.lineRangeMapping);\n\t\t\tif (mappings) {\n\t\t\t\tconst newRange1 = translatePosition(sourceSelection.getStartPosition(), mappings);\n\t\t\t\tconst newRange2 = translatePosition(sourceSelection.getEndPosition(), mappings);\n\t\t\t\tdestinationSelection = Range.plusRange(newRange1, newRange2);\n\t\t\t}\n\t\t}\n\t\treturn { destination, destinationSelection };\n\t}\n\n\tswitchSide(): void {\n\t\tconst { destination, destinationSelection } = this.mapToOtherSide();\n\t\tdestination.focus();\n\t\tif (destinationSelection) {\n\t\t\tdestination.setSelection(destinationSelection);\n\t\t}\n\t}\n\n\texitCompareMove(): void {\n\t\tconst model = this._diffModel.get();\n\t\tif (!model) { return; }\n\t\tmodel.movedTextToCompare.set(undefined, undefined);\n\t}\n\n\tcollapseAllUnchangedRegions(): void {\n\t\tconst unchangedRegions = this._diffModel.get()?.unchangedRegions.get();\n\t\tif (!unchangedRegions) { return; }\n\t\ttransaction(tx => {\n\t\t\tfor (const region of unchangedRegions) {\n\t\t\t\tregion.collapseAll(tx);\n\t\t\t}\n\t\t});\n\t}\n\n\tshowAllUnchangedRegions(): void {\n\t\tconst unchangedRegions = this._diffModel.get()?.unchangedRegions.get();\n\t\tif (!unchangedRegions) { return; }\n\t\ttransaction(tx => {\n\t\t\tfor (const region of unchangedRegions) {\n\t\t\t\tregion.showAll(tx);\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction translatePosition(posInOriginal: Position, mappings: DetailedLineRangeMapping[]): Range {\n\tconst mapping = findLast(mappings, m => m.original.startLineNumber <= posInOriginal.lineNumber);\n\tif (!mapping) {\n\t\t// No changes before the position\n\t\treturn Range.fromPositions(posInOriginal);\n\t}\n\n\tif (mapping.original.endLineNumberExclusive <= posInOriginal.lineNumber) {\n\t\tconst newLineNumber = posInOriginal.lineNumber - mapping.original.endLineNumberExclusive + mapping.modified.endLineNumberExclusive;\n\t\treturn Range.fromPositions(new Position(newLineNumber, posInOriginal.column));\n\t}\n\n\tif (!mapping.innerChanges) {\n\t\t// Only for legacy algorithm\n\t\treturn Range.fromPositions(new Position(mapping.modified.startLineNumber, 1));\n\t}\n\n\tconst innerMapping = findLast(mapping.innerChanges, m => m.originalRange.getStartPosition().isBeforeOrEqual(posInOriginal));\n\tif (!innerMapping) {\n\t\tconst newLineNumber = posInOriginal.lineNumber - mapping.original.startLineNumber + mapping.modified.startLineNumber;\n\t\treturn Range.fromPositions(new Position(newLineNumber, posInOriginal.column));\n\t}\n\n\tif (innerMapping.originalRange.containsPosition(posInOriginal)) {\n\t\treturn innerMapping.modifiedRange;\n\t} else {\n\t\tconst l = lengthBetweenPositions(innerMapping.originalRange.getEndPosition(), posInOriginal);\n\t\treturn Range.fromPositions(addLength(innerMapping.modifiedRange.getEndPosition(), l));\n\t}\n}\n\nfunction lengthBetweenPositions(position1: Position, position2: Position): LengthObj {\n\tif (position1.lineNumber === position2.lineNumber) {\n\t\treturn new LengthObj(0, position2.column - position1.column);\n\t} else {\n\t\treturn new LengthObj(position2.lineNumber - position1.lineNumber, position2.column - 1);\n\t}\n}\n\nfunction addLength(position: Position, length: LengthObj): Position {\n\tif (length.lineCount === 0) {\n\t\treturn new Position(position.lineNumber, position.column + length.columnCount);\n\t} else {\n\t\treturn new Position(position.lineNumber + length.lineCount, length.columnCount + 1);\n\t}\n}\n\nfunction toLineChanges(state: DiffState): ILineChange[] {\n\treturn state.mappings.map(x => {\n\t\tconst m = x.lineRangeMapping;\n\t\tlet originalStartLineNumber: number;\n\t\tlet originalEndLineNumber: number;\n\t\tlet modifiedStartLineNumber: number;\n\t\tlet modifiedEndLineNumber: number;\n\t\tlet innerChanges = m.innerChanges;\n\n\t\tif (m.original.isEmpty) {\n\t\t\t// Insertion\n\t\t\toriginalStartLineNumber = m.original.startLineNumber - 1;\n\t\t\toriginalEndLineNumber = 0;\n\t\t\tinnerChanges = undefined;\n\t\t} else {\n\t\t\toriginalStartLineNumber = m.original.startLineNumber;\n\t\t\toriginalEndLineNumber = m.original.endLineNumberExclusive - 1;\n\t\t}\n\n\t\tif (m.modified.isEmpty) {\n\t\t\t// Deletion\n\t\t\tmodifiedStartLineNumber = m.modified.startLineNumber - 1;\n\t\t\tmodifiedEndLineNumber = 0;\n\t\t\tinnerChanges = undefined;\n\t\t} else {\n\t\t\tmodifiedStartLineNumber = m.modified.startLineNumber;\n\t\t\tmodifiedEndLineNumber = m.modified.endLineNumberExclusive - 1;\n\t\t}\n\n\t\treturn {\n\t\t\toriginalStartLineNumber,\n\t\t\toriginalEndLineNumber,\n\t\t\tmodifiedStartLineNumber,\n\t\t\tmodifiedEndLineNumber,\n\t\t\tcharChanges: innerChanges?.map(m => ({\n\t\t\t\toriginalStartLineNumber: m.originalRange.startLineNumber,\n\t\t\t\toriginalStartColumn: m.originalRange.startColumn,\n\t\t\t\toriginalEndLineNumber: m.originalRange.endLineNumber,\n\t\t\t\toriginalEndColumn: m.originalRange.endColumn,\n\t\t\t\tmodifiedStartLineNumber: m.modifiedRange.startLineNumber,\n\t\t\t\tmodifiedStartColumn: m.modifiedRange.startColumn,\n\t\t\t\tmodifiedEndLineNumber: m.modifiedRange.endLineNumber,\n\t\t\t\tmodifiedEndColumn: m.modifiedRange.endColumn,\n\t\t\t}))\n\t\t};\n\t});\n}\n"]}