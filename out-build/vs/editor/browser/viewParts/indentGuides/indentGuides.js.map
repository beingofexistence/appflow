{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/browser/viewParts/indentGuides/indentGuides.ts"],"names":[],"mappings":"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","file":"indentGuides.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./indentGuides';\nimport { DynamicViewOverlay } from 'vs/editor/browser/view/dynamicViewOverlay';\nimport { editorBracketHighlightingForeground1, editorBracketHighlightingForeground2, editorBracketHighlightingForeground3, editorBracketHighlightingForeground4, editorBracketHighlightingForeground5, editorBracketHighlightingForeground6, editorBracketPairGuideActiveBackground1, editorBracketPairGuideActiveBackground2, editorBracketPairGuideActiveBackground3, editorBracketPairGuideActiveBackground4, editorBracketPairGuideActiveBackground5, editorBracketPairGuideActiveBackground6, editorBracketPairGuideBackground1, editorBracketPairGuideBackground2, editorBracketPairGuideBackground3, editorBracketPairGuideBackground4, editorBracketPairGuideBackground5, editorBracketPairGuideBackground6, editorIndentGuide1, editorIndentGuide2, editorIndentGuide3, editorIndentGuide4, editorIndentGuide5, editorIndentGuide6, editorActiveIndentGuide1, editorActiveIndentGuide2, editorActiveIndentGuide3, editorActiveIndentGuide4, editorActiveIndentGuide5, editorActiveIndentGuide6 } from 'vs/editor/common/core/editorColorRegistry';\nimport { RenderingContext } from 'vs/editor/browser/view/renderingContext';\nimport { ViewContext } from 'vs/editor/common/viewModel/viewContext';\nimport * as viewEvents from 'vs/editor/common/viewEvents';\nimport { registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { EditorOption, InternalGuidesOptions } from 'vs/editor/common/config/editorOptions';\nimport { Position } from 'vs/editor/common/core/position';\nimport { ArrayQueue } from 'vs/base/common/arrays';\nimport { Color } from 'vs/base/common/color';\nimport { isDefined } from 'vs/base/common/types';\nimport { BracketPairGuidesClassNames } from 'vs/editor/common/model/guidesTextModelPart';\nimport { IndentGuide, HorizontalGuidesState } from 'vs/editor/common/textModelGuides';\n\nexport class IndentGuidesOverlay extends DynamicViewOverlay {\n\n\tprivate readonly _context: ViewContext;\n\tprivate _primaryPosition: Position | null;\n\tprivate _lineHeight: number;\n\tprivate _spaceWidth: number;\n\tprivate _renderResult: string[] | null;\n\tprivate _maxIndentLeft: number;\n\tprivate _bracketPairGuideOptions: InternalGuidesOptions;\n\n\tconstructor(context: ViewContext) {\n\t\tsuper();\n\t\tthis._context = context;\n\t\tthis._primaryPosition = null;\n\n\t\tconst options = this._context.configuration.options;\n\t\tconst wrappingInfo = options.get(EditorOption.wrappingInfo);\n\t\tconst fontInfo = options.get(EditorOption.fontInfo);\n\n\t\tthis._lineHeight = options.get(EditorOption.lineHeight);\n\t\tthis._spaceWidth = fontInfo.spaceWidth;\n\t\tthis._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\n\t\tthis._bracketPairGuideOptions = options.get(EditorOption.guides);\n\n\t\tthis._renderResult = null;\n\n\t\tthis._context.addEventHandler(this);\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis._context.removeEventHandler(this);\n\t\tthis._renderResult = null;\n\t\tsuper.dispose();\n\t}\n\n\t// --- begin event handlers\n\n\tpublic override onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): boolean {\n\t\tconst options = this._context.configuration.options;\n\t\tconst wrappingInfo = options.get(EditorOption.wrappingInfo);\n\t\tconst fontInfo = options.get(EditorOption.fontInfo);\n\n\t\tthis._lineHeight = options.get(EditorOption.lineHeight);\n\t\tthis._spaceWidth = fontInfo.spaceWidth;\n\t\tthis._maxIndentLeft = wrappingInfo.wrappingColumn === -1 ? -1 : (wrappingInfo.wrappingColumn * fontInfo.typicalHalfwidthCharacterWidth);\n\t\tthis._bracketPairGuideOptions = options.get(EditorOption.guides);\n\n\t\treturn true;\n\t}\n\tpublic override onCursorStateChanged(e: viewEvents.ViewCursorStateChangedEvent): boolean {\n\t\tconst selection = e.selections[0];\n\t\tconst newPosition = selection.getPosition();\n\t\tif (!this._primaryPosition?.equals(newPosition)) {\n\t\t\tthis._primaryPosition = newPosition;\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\tpublic override onDecorationsChanged(e: viewEvents.ViewDecorationsChangedEvent): boolean {\n\t\t// true for inline decorations\n\t\treturn true;\n\t}\n\tpublic override onFlushed(e: viewEvents.ViewFlushedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLinesChanged(e: viewEvents.ViewLinesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLinesDeleted(e: viewEvents.ViewLinesDeletedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLinesInserted(e: viewEvents.ViewLinesInsertedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onScrollChanged(e: viewEvents.ViewScrollChangedEvent): boolean {\n\t\treturn e.scrollTopChanged;// || e.scrollWidthChanged;\n\t}\n\tpublic override onZonesChanged(e: viewEvents.ViewZonesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLanguageConfigurationChanged(e: viewEvents.ViewLanguageConfigurationEvent): boolean {\n\t\treturn true;\n\t}\n\n\t// --- end event handlers\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\tif (!this._bracketPairGuideOptions.indentation && this._bracketPairGuideOptions.bracketPairs === false) {\n\t\t\tthis._renderResult = null;\n\t\t\treturn;\n\t\t}\n\n\t\tconst visibleStartLineNumber = ctx.visibleRange.startLineNumber;\n\t\tconst visibleEndLineNumber = ctx.visibleRange.endLineNumber;\n\t\tconst scrollWidth = ctx.scrollWidth;\n\t\tconst lineHeight = this._lineHeight;\n\n\t\tconst activeCursorPosition = this._primaryPosition;\n\n\t\tconst indents = this.getGuidesByLine(\n\t\t\tvisibleStartLineNumber,\n\t\t\tMath.min(visibleEndLineNumber + 1, this._context.viewModel.getLineCount()),\n\t\t\tactiveCursorPosition\n\t\t);\n\n\t\tconst output: string[] = [];\n\t\tfor (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n\t\t\tconst lineIndex = lineNumber - visibleStartLineNumber;\n\t\t\tconst indent = indents[lineIndex];\n\t\t\tlet result = '';\n\t\t\tconst leftOffset = ctx.visibleRangeForPosition(new Position(lineNumber, 1))?.left ?? 0;\n\t\t\tfor (const guide of indent) {\n\t\t\t\tconst left =\n\t\t\t\t\tguide.column === -1\n\t\t\t\t\t\t? leftOffset + (guide.visibleColumn - 1) * this._spaceWidth\n\t\t\t\t\t\t: ctx.visibleRangeForPosition(\n\t\t\t\t\t\t\tnew Position(lineNumber, guide.column)\n\t\t\t\t\t\t)!.left;\n\n\t\t\t\tif (left > scrollWidth || (this._maxIndentLeft > 0 && left > this._maxIndentLeft)) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst className = guide.horizontalLine ? (guide.horizontalLine.top ? 'horizontal-top' : 'horizontal-bottom') : 'vertical';\n\n\t\t\t\tconst width = guide.horizontalLine\n\t\t\t\t\t? (ctx.visibleRangeForPosition(\n\t\t\t\t\t\tnew Position(lineNumber, guide.horizontalLine.endColumn)\n\t\t\t\t\t)?.left ?? (left + this._spaceWidth)) - left\n\t\t\t\t\t: this._spaceWidth;\n\n\t\t\t\tresult += `<div class=\"core-guide ${guide.className} ${className}\" style=\"left:${left}px;height:${lineHeight}px;width:${width}px\"></div>`;\n\t\t\t}\n\t\t\toutput[lineIndex] = result;\n\t\t}\n\t\tthis._renderResult = output;\n\t}\n\n\tprivate getGuidesByLine(\n\t\tvisibleStartLineNumber: number,\n\t\tvisibleEndLineNumber: number,\n\t\tactiveCursorPosition: Position | null\n\t): IndentGuide[][] {\n\t\tconst bracketGuides = this._bracketPairGuideOptions.bracketPairs !== false\n\t\t\t? this._context.viewModel.getBracketGuidesInRangeByLine(\n\t\t\t\tvisibleStartLineNumber,\n\t\t\t\tvisibleEndLineNumber,\n\t\t\t\tactiveCursorPosition,\n\t\t\t\t{\n\t\t\t\t\thighlightActive: this._bracketPairGuideOptions.highlightActiveBracketPair,\n\t\t\t\t\thorizontalGuides: this._bracketPairGuideOptions.bracketPairsHorizontal === true\n\t\t\t\t\t\t? HorizontalGuidesState.Enabled\n\t\t\t\t\t\t: this._bracketPairGuideOptions.bracketPairsHorizontal === 'active'\n\t\t\t\t\t\t\t? HorizontalGuidesState.EnabledForActive\n\t\t\t\t\t\t\t: HorizontalGuidesState.Disabled,\n\t\t\t\t\tincludeInactive: this._bracketPairGuideOptions.bracketPairs === true,\n\t\t\t\t}\n\t\t\t)\n\t\t\t: null;\n\n\t\tconst indentGuides = this._bracketPairGuideOptions.indentation\n\t\t\t? this._context.viewModel.getLinesIndentGuides(\n\t\t\t\tvisibleStartLineNumber,\n\t\t\t\tvisibleEndLineNumber\n\t\t\t)\n\t\t\t: null;\n\n\t\tlet activeIndentStartLineNumber = 0;\n\t\tlet activeIndentEndLineNumber = 0;\n\t\tlet activeIndentLevel = 0;\n\n\t\tif (this._bracketPairGuideOptions.highlightActiveIndentation !== false && activeCursorPosition) {\n\t\t\tconst activeIndentInfo = this._context.viewModel.getActiveIndentGuide(activeCursorPosition.lineNumber, visibleStartLineNumber, visibleEndLineNumber);\n\t\t\tactiveIndentStartLineNumber = activeIndentInfo.startLineNumber;\n\t\t\tactiveIndentEndLineNumber = activeIndentInfo.endLineNumber;\n\t\t\tactiveIndentLevel = activeIndentInfo.indent;\n\t\t}\n\n\t\tconst { indentSize } = this._context.viewModel.model.getOptions();\n\n\t\tconst result: IndentGuide[][] = [];\n\t\tfor (let lineNumber = visibleStartLineNumber; lineNumber <= visibleEndLineNumber; lineNumber++) {\n\t\t\tconst lineGuides = new Array<IndentGuide>();\n\t\t\tresult.push(lineGuides);\n\n\t\t\tconst bracketGuidesInLine = bracketGuides ? bracketGuides[lineNumber - visibleStartLineNumber] : [];\n\t\t\tconst bracketGuidesInLineQueue = new ArrayQueue(bracketGuidesInLine);\n\n\t\t\tconst indentGuidesInLine = indentGuides ? indentGuides[lineNumber - visibleStartLineNumber] : 0;\n\n\t\t\tfor (let indentLvl = 1; indentLvl <= indentGuidesInLine; indentLvl++) {\n\t\t\t\tconst indentGuide = (indentLvl - 1) * indentSize + 1;\n\t\t\t\tconst isActive =\n\t\t\t\t\t// Disable active indent guide if there are bracket guides.\n\t\t\t\t\t(this._bracketPairGuideOptions.highlightActiveIndentation === 'always' || bracketGuidesInLine.length === 0) &&\n\t\t\t\t\tactiveIndentStartLineNumber <= lineNumber &&\n\t\t\t\t\tlineNumber <= activeIndentEndLineNumber &&\n\t\t\t\t\tindentLvl === activeIndentLevel;\n\t\t\t\tlineGuides.push(...bracketGuidesInLineQueue.takeWhile(g => g.visibleColumn < indentGuide) || []);\n\t\t\t\tconst peeked = bracketGuidesInLineQueue.peek();\n\t\t\t\tif (!peeked || peeked.visibleColumn !== indentGuide || peeked.horizontalLine) {\n\t\t\t\t\tlineGuides.push(\n\t\t\t\t\t\tnew IndentGuide(\n\t\t\t\t\t\t\tindentGuide,\n\t\t\t\t\t\t\t-1,\n\t\t\t\t\t\t\t`core-guide-indent lvl-${(indentLvl - 1) % 30}` + (isActive ? ' indent-active' : ''),\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t-1,\n\t\t\t\t\t\t\t-1,\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tlineGuides.push(...bracketGuidesInLineQueue.takeWhile(g => true) || []);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tpublic render(startLineNumber: number, lineNumber: number): string {\n\t\tif (!this._renderResult) {\n\t\t\treturn '';\n\t\t}\n\t\tconst lineIndex = lineNumber - startLineNumber;\n\t\tif (lineIndex < 0 || lineIndex >= this._renderResult.length) {\n\t\t\treturn '';\n\t\t}\n\t\treturn this._renderResult[lineIndex];\n\t}\n}\n\nfunction transparentToUndefined(color: Color | undefined): Color | undefined {\n\tif (color && color.isTransparent()) {\n\t\treturn undefined;\n\t}\n\treturn color;\n}\n\nregisterThemingParticipant((theme, collector) => {\n\n\tconst colors = [\n\t\t{ bracketColor: editorBracketHighlightingForeground1, guideColor: editorBracketPairGuideBackground1, guideColorActive: editorBracketPairGuideActiveBackground1 },\n\t\t{ bracketColor: editorBracketHighlightingForeground2, guideColor: editorBracketPairGuideBackground2, guideColorActive: editorBracketPairGuideActiveBackground2 },\n\t\t{ bracketColor: editorBracketHighlightingForeground3, guideColor: editorBracketPairGuideBackground3, guideColorActive: editorBracketPairGuideActiveBackground3 },\n\t\t{ bracketColor: editorBracketHighlightingForeground4, guideColor: editorBracketPairGuideBackground4, guideColorActive: editorBracketPairGuideActiveBackground4 },\n\t\t{ bracketColor: editorBracketHighlightingForeground5, guideColor: editorBracketPairGuideBackground5, guideColorActive: editorBracketPairGuideActiveBackground5 },\n\t\t{ bracketColor: editorBracketHighlightingForeground6, guideColor: editorBracketPairGuideBackground6, guideColorActive: editorBracketPairGuideActiveBackground6 }\n\t];\n\tconst colorProvider = new BracketPairGuidesClassNames();\n\n\tconst indentColors = [\n\t\t{ indentColor: editorIndentGuide1, indentColorActive: editorActiveIndentGuide1 },\n\t\t{ indentColor: editorIndentGuide2, indentColorActive: editorActiveIndentGuide2 },\n\t\t{ indentColor: editorIndentGuide3, indentColorActive: editorActiveIndentGuide3 },\n\t\t{ indentColor: editorIndentGuide4, indentColorActive: editorActiveIndentGuide4 },\n\t\t{ indentColor: editorIndentGuide5, indentColorActive: editorActiveIndentGuide5 },\n\t\t{ indentColor: editorIndentGuide6, indentColorActive: editorActiveIndentGuide6 },\n\t];\n\n\tconst colorValues = colors\n\t\t.map(c => {\n\t\t\tconst bracketColor = theme.getColor(c.bracketColor);\n\t\t\tconst guideColor = theme.getColor(c.guideColor);\n\t\t\tconst guideColorActive = theme.getColor(c.guideColorActive);\n\n\t\t\tconst effectiveGuideColor = transparentToUndefined(transparentToUndefined(guideColor) ?? bracketColor?.transparent(0.3));\n\t\t\tconst effectiveGuideColorActive = transparentToUndefined(transparentToUndefined(guideColorActive) ?? bracketColor);\n\n\t\t\tif (!effectiveGuideColor || !effectiveGuideColorActive) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tguideColor: effectiveGuideColor,\n\t\t\t\tguideColorActive: effectiveGuideColorActive,\n\t\t\t};\n\t\t})\n\t\t.filter(isDefined);\n\n\tconst indentColorValues = indentColors\n\t\t.map(c => {\n\t\t\tconst indentColor = theme.getColor(c.indentColor);\n\t\t\tconst indentColorActive = theme.getColor(c.indentColorActive);\n\n\t\t\tconst effectiveIndentColor = transparentToUndefined(indentColor);\n\t\t\tconst effectiveIndentColorActive = transparentToUndefined(indentColorActive);\n\n\t\t\tif (!effectiveIndentColor || !effectiveIndentColorActive) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tindentColor: effectiveIndentColor,\n\t\t\t\tindentColorActive: effectiveIndentColorActive,\n\t\t\t};\n\t\t})\n\t\t.filter(isDefined);\n\n\tif (colorValues.length > 0) {\n\t\tfor (let level = 0; level < 30; level++) {\n\t\t\tconst colors = colorValues[level % colorValues.length];\n\t\t\tcollector.addRule(`.monaco-editor .${colorProvider.getInlineClassNameOfLevel(level).replace(/ /g, '.')} { --guide-color: ${colors.guideColor}; --guide-color-active: ${colors.guideColorActive}; }`);\n\t\t}\n\n\t\tcollector.addRule(`.monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }`);\n\t\tcollector.addRule(`.monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }`);\n\t\tcollector.addRule(`.monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }`);\n\n\t\tcollector.addRule(`.monaco-editor .vertical.${colorProvider.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`);\n\t\tcollector.addRule(`.monaco-editor .horizontal-top.${colorProvider.activeClassName} { border-top: 1px solid var(--guide-color-active); }`);\n\t\tcollector.addRule(`.monaco-editor .horizontal-bottom.${colorProvider.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`);\n\t}\n\n\tif (indentColorValues.length > 0) {\n\t\tfor (let level = 0; level < 30; level++) {\n\t\t\tconst colors = indentColorValues[level % indentColorValues.length];\n\t\t\tcollector.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${level} { --indent-color: ${colors.indentColor}; --indent-color-active: ${colors.indentColorActive}; }`);\n\t\t}\n\n\t\tcollector.addRule(`.monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }`);\n\t\tcollector.addRule(`.monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }`);\n\t}\n});\n"]}