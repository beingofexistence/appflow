{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/browser/viewParts/blockDecorations/blockDecorations.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;IAUhG,MAAa,GAAiB,SAAQ,cAAG;QASxC,YAAY,OAAY;YACvB,KAAK,CAAC,OAAO,CAAC,CAAC;YANC,MAAC,GAAoC,EAAE,CAAC;YAEjD,MAAC,GAAsB,CAAC,CAAC,CAAC;YAC1B,MAAC,GAAqB,CAAC,CAAC;YAK/B,IAAI,CAAC,OAAO,GAAG,IAAA,iBAAG,EAA4B,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;YAC7E,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;YAClD,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;YACjD,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,4BAA4B,CAAC,CAAC;YAExD,IAAI,CAAC,CAAC,EAAO,CAAC;QACf,CAAC;QAEO,CAAC;YACR,IAAI,SAAS,GAAG,KAAK,CAAC;YACtB,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAC;YACpD,MAAM,UAAU,GAAG,OAAO,CAAC,GAAG,mCAAyB,CAAC;YACxD,MAAM,eAAe,GAAG,UAAU,CAAC,YAAY,GAAG,UAAU,CAAC,sBAAsB,CAAC;YAEpF,IAAI,IAAI,CAAC,CAAC,KAAgB,eAAe,EAAE;gBAC1C,IAAI,CAAC,CAAC,GAAc,eAAe,CAAC;gBACpC,SAAS,GAAG,IAAI,CAAC;aACjB;YAED,MAAM,cAAc,GAAG,UAAU,CAAC,WAAW,CAAC;YAC9C,IAAI,IAAI,CAAC,CAAC,KAAe,cAAc,EAAE;gBACxC,IAAI,CAAC,CAAC,GAAa,cAAc,CAAC;gBAClC,SAAS,GAAG,IAAI,CAAC;aACjB;YAED,OAAO,SAAS,CAAC;QAClB,CAAC;QAEe,OAAO;YACtB,KAAK,CAAC,OAAO,EAAE,CAAC;QACjB,CAAC;QAED,2BAA2B;QAEX,sBAAsB,CAAC,CAAiB;YACvD,OAAO,IAAI,CAAC,CAAC,EAAO,CAAC;QACtB,CAAC;QACe,eAAe,CAAC,CAAiB;YAChD,OAAO,CAAC,CAAC,gBAAgB,IAAI,CAAC,CAAC,iBAAiB,CAAC;QAClD,CAAC;QACe,oBAAoB,CAAC,CAAiB;YACrD,OAAO,IAAI,CAAC;QACb,CAAC;QAEe,cAAc,CAAC,CAAiB;YAC/C,OAAO,IAAI,CAAC;QACb,CAAC;QAED,yBAAyB;QAClB,aAAa,CAAC,GAAQ;YAC5B,kBAAkB;QACnB,CAAC;QAEM,MAAM,CAAC,GAAQ;YACrB,IAAI,KAAK,GAAG,CAAC,CAAC;YACd,MAAM,WAAW,GAAG,GAAG,CAAC,wBAAwB,EAAE,CAAC;YACnD,KAAK,MAAM,UAAU,IAAI,WAAW,EAAE;gBACrC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,cAAc,EAAE;oBACvC,SAAS;iBACT;gBAED,IAAI,KAAK,GAAG,IAAI,CAAC,CAAC,CAAM,KAAK,CAAC,CAAC;gBAC/B,IAAI,CAAC,KAAK,EAAE;oBACX,KAAK,GAAG,IAAI,CAAC,CAAC,CAAM,KAAK,CAAC,GAAG,IAAA,iBAAG,EAAe,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;oBAC9E,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;iBAChC;gBAED,IAAI,GAAW,CAAC;gBAChB,IAAI,MAAc,CAAC;gBAEnB,IAAI,UAAU,CAAC,OAAO,CAAC,eAAe,EAAE;oBACvC,sBAAsB;oBACtB,GAAG,GAAG,GAAG,CAAC,gCAAgC,CAAC,UAAU,CAAC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;oBAClF,MAAM,GAAG,GAAG,CAAC,gCAAgC,CAAC,UAAU,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;iBACpF;qBAAM;oBACN,GAAG,GAAG,GAAG,CAAC,8BAA8B,CAAC,UAAU,CAAC,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;oBACjF,MAAM,GAAG,UAAU,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,oBAAoB;wBAC9E,CAAC,CAAC,GAAG,CAAC,8BAA8B,CAAC,UAAU,CAAC,KAAK,CAAC,eAAe,EAAE,KAAK,CAAC;wBAC7E,CAAC,CAAC,GAAG,CAAC,gCAAgC,CAAC,UAAU,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;iBAC9E;gBAED,MAAM,CAAC,UAAU,EAAE,YAAY,EAAE,aAAa,EAAE,WAAW,CAAC,GAAG,UAAU,CAAC,OAAO,CAAC,YAAY,IAAI,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;gBAE/G,KAAK,CAAC,YAAY,CAAC,yBAAyB,GAAG,UAAU,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC;gBAClF,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,GAAa,WAAW,CAAC,CAAC;gBAC9C,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,GAAc,WAAW,GAAG,YAAY,CAAC,CAAC;gBAC/D,KAAK,CAAC,MAAM,CAAC,GAAG,GAAG,GAAG,CAAC,SAAS,GAAG,UAAU,CAAC,CAAC;gBAC/C,KAAK,CAAC,SAAS,CAAC,MAAM,GAAG,GAAG,GAAG,UAAU,GAAG,aAAa,CAAC,CAAC;gBAE3D,KAAK,EAAE,CAAC;aACR;YAED,KAAK,IAAI,CAAC,GAAG,KAAK,EAAE,CAAC,GAAG,IAAI,CAAC,CAAC,CAAM,MAAM,EAAE,CAAC,EAAE,EAAE;gBAChD,IAAI,CAAC,CAAC,CAAM,CAAC,CAAC,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;aAChC;YACD,IAAI,CAAC,CAAC,CAAM,MAAM,GAAG,KAAK,CAAC;QAC5B,CAAC;KACD;IA7GD,kBA6GC","file":"blockDecorations.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { createFastDomNode, FastDomNode } from 'vs/base/browser/fastDomNode';\nimport 'vs/css!./blockDecorations';\nimport { RenderingContext, RestrictedRenderingContext } from 'vs/editor/browser/view/renderingContext';\nimport { ViewPart } from 'vs/editor/browser/view/viewPart';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport * as viewEvents from 'vs/editor/common/viewEvents';\nimport { ViewContext } from 'vs/editor/common/viewModel/viewContext';\n\nexport class BlockDecorations extends ViewPart {\n\n\tpublic domNode: FastDomNode<HTMLElement>;\n\n\tprivate readonly blocks: FastDomNode<HTMLElement>[] = [];\n\n\tprivate contentWidth: number = -1;\n\tprivate contentLeft: number = 0;\n\n\tconstructor(context: ViewContext) {\n\t\tsuper(context);\n\n\t\tthis.domNode = createFastDomNode<HTMLElement>(document.createElement('div'));\n\t\tthis.domNode.setAttribute('role', 'presentation');\n\t\tthis.domNode.setAttribute('aria-hidden', 'true');\n\t\tthis.domNode.setClassName('blockDecorations-container');\n\n\t\tthis.update();\n\t}\n\n\tprivate update(): boolean {\n\t\tlet didChange = false;\n\t\tconst options = this._context.configuration.options;\n\t\tconst layoutInfo = options.get(EditorOption.layoutInfo);\n\t\tconst newContentWidth = layoutInfo.contentWidth - layoutInfo.verticalScrollbarWidth;\n\n\t\tif (this.contentWidth !== newContentWidth) {\n\t\t\tthis.contentWidth = newContentWidth;\n\t\t\tdidChange = true;\n\t\t}\n\n\t\tconst newContentLeft = layoutInfo.contentLeft;\n\t\tif (this.contentLeft !== newContentLeft) {\n\t\t\tthis.contentLeft = newContentLeft;\n\t\t\tdidChange = true;\n\t\t}\n\n\t\treturn didChange;\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\t}\n\n\t// --- begin event handlers\n\n\tpublic override onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): boolean {\n\t\treturn this.update();\n\t}\n\tpublic override onScrollChanged(e: viewEvents.ViewScrollChangedEvent): boolean {\n\t\treturn e.scrollTopChanged || e.scrollLeftChanged;\n\t}\n\tpublic override onDecorationsChanged(e: viewEvents.ViewDecorationsChangedEvent): boolean {\n\t\treturn true;\n\t}\n\n\tpublic override onZonesChanged(e: viewEvents.ViewZonesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\n\t// --- end event handlers\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\t// Nothing to read\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): void {\n\t\tlet count = 0;\n\t\tconst decorations = ctx.getDecorationsInViewport();\n\t\tfor (const decoration of decorations) {\n\t\t\tif (!decoration.options.blockClassName) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet block = this.blocks[count];\n\t\t\tif (!block) {\n\t\t\t\tblock = this.blocks[count] = createFastDomNode(document.createElement('div'));\n\t\t\t\tthis.domNode.appendChild(block);\n\t\t\t}\n\n\t\t\tlet top: number;\n\t\t\tlet bottom: number;\n\n\t\t\tif (decoration.options.blockIsAfterEnd) {\n\t\t\t\t// range must be empty\n\t\t\t\ttop = ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, false);\n\t\t\t\tbottom = ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, true);\n\t\t\t} else {\n\t\t\t\ttop = ctx.getVerticalOffsetForLineNumber(decoration.range.startLineNumber, true);\n\t\t\t\tbottom = decoration.range.isEmpty() && !decoration.options.blockDoesNotCollapse\n\t\t\t\t\t? ctx.getVerticalOffsetForLineNumber(decoration.range.startLineNumber, false)\n\t\t\t\t\t: ctx.getVerticalOffsetAfterLineNumber(decoration.range.endLineNumber, true);\n\t\t\t}\n\n\t\t\tconst [paddingTop, paddingRight, paddingBottom, paddingLeft] = decoration.options.blockPadding ?? [0, 0, 0, 0];\n\n\t\t\tblock.setClassName('blockDecorations-block ' + decoration.options.blockClassName);\n\t\t\tblock.setLeft(this.contentLeft - paddingLeft);\n\t\t\tblock.setWidth(this.contentWidth + paddingLeft + paddingRight);\n\t\t\tblock.setTop(top - ctx.scrollTop - paddingTop);\n\t\t\tblock.setHeight(bottom - top + paddingTop + paddingBottom);\n\n\t\t\tcount++;\n\t\t}\n\n\t\tfor (let i = count; i < this.blocks.length; i++) {\n\t\t\tthis.blocks[i].domNode.remove();\n\t\t}\n\t\tthis.blocks.length = count;\n\t}\n}\n"]}