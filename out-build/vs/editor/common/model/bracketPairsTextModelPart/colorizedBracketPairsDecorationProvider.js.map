{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/common/model/bracketPairsTextModelPart/colorizedBracketPairsDecorationProvider.ts"],"names":[],"mappings":"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","file":"colorizedBracketPairsDecorationProvider.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Color } from 'vs/base/common/color';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { Range } from 'vs/editor/common/core/range';\nimport { BracketPairColorizationOptions, IModelDecoration } from 'vs/editor/common/model';\nimport { BracketInfo } from 'vs/editor/common/textModelBracketPairs';\nimport { DecorationProvider } from 'vs/editor/common/model/decorationProvider';\nimport { TextModel } from 'vs/editor/common/model/textModel';\nimport {\n\teditorBracketHighlightingForeground1, editorBracketHighlightingForeground2, editorBracketHighlightingForeground3, editorBracketHighlightingForeground4, editorBracketHighlightingForeground5, editorBracketHighlightingForeground6, editorBracketHighlightingUnexpectedBracketForeground\n} from 'vs/editor/common/core/editorColorRegistry';\nimport { registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { IModelOptionsChangedEvent } from 'vs/editor/common/textModelEvents';\n\nexport class ColorizedBracketPairsDecorationProvider extends Disposable implements DecorationProvider {\n\tprivate colorizationOptions: BracketPairColorizationOptions;\n\tprivate readonly colorProvider = new ColorProvider();\n\n\tprivate readonly onDidChangeEmitter = new Emitter<void>();\n\tpublic readonly onDidChange = this.onDidChangeEmitter.event;\n\n\tconstructor(private readonly textModel: TextModel) {\n\t\tsuper();\n\n\t\tthis.colorizationOptions = textModel.getOptions().bracketPairColorizationOptions;\n\n\t\tthis._register(textModel.bracketPairs.onDidChange(e => {\n\t\t\tthis.onDidChangeEmitter.fire();\n\t\t}));\n\t}\n\n\t//#region TextModel events\n\n\tpublic handleDidChangeOptions(e: IModelOptionsChangedEvent): void {\n\t\tthis.colorizationOptions = this.textModel.getOptions().bracketPairColorizationOptions;\n\t}\n\n\t//#endregion\n\n\tgetDecorationsInRange(range: Range, ownerId?: number, filterOutValidation?: boolean, onlyMinimapDecorations?: boolean): IModelDecoration[] {\n\t\tif (onlyMinimapDecorations) {\n\t\t\t// Bracket pair colorization decorations are not rendered in the minimap\n\t\t\treturn [];\n\t\t}\n\t\tif (ownerId === undefined) {\n\t\t\treturn [];\n\t\t}\n\t\tif (!this.colorizationOptions.enabled) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst result = this.textModel.bracketPairs.getBracketsInRange(range, true).map<IModelDecoration>(bracket => ({\n\t\t\tid: `bracket${bracket.range.toString()}-${bracket.nestingLevel}`,\n\t\t\toptions: {\n\t\t\t\tdescription: 'BracketPairColorization',\n\t\t\t\tinlineClassName: this.colorProvider.getInlineClassName(\n\t\t\t\t\tbracket,\n\t\t\t\t\tthis.colorizationOptions.independentColorPoolPerBracketType\n\t\t\t\t),\n\t\t\t},\n\t\t\townerId: 0,\n\t\t\trange: bracket.range,\n\t\t})).toArray();\n\n\t\treturn result;\n\t}\n\n\tgetAllDecorations(ownerId?: number, filterOutValidation?: boolean): IModelDecoration[] {\n\t\tif (ownerId === undefined) {\n\t\t\treturn [];\n\t\t}\n\t\tif (!this.colorizationOptions.enabled) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this.getDecorationsInRange(\n\t\t\tnew Range(1, 1, this.textModel.getLineCount(), 1),\n\t\t\townerId,\n\t\t\tfilterOutValidation\n\t\t);\n\t}\n}\n\nclass ColorProvider {\n\tpublic readonly unexpectedClosingBracketClassName = 'unexpected-closing-bracket';\n\n\tgetInlineClassName(bracket: BracketInfo, independentColorPoolPerBracketType: boolean): string {\n\t\tif (bracket.isInvalid) {\n\t\t\treturn this.unexpectedClosingBracketClassName;\n\t\t}\n\t\treturn this.getInlineClassNameOfLevel(independentColorPoolPerBracketType ? bracket.nestingLevelOfEqualBracketType : bracket.nestingLevel);\n\t}\n\n\tgetInlineClassNameOfLevel(level: number): string {\n\t\t// To support a dynamic amount of colors up to 6 colors,\n\t\t// we use a number that is a lcm of all numbers from 1 to 6.\n\t\treturn `bracket-highlighting-${level % 30}`;\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst colors = [\n\t\teditorBracketHighlightingForeground1,\n\t\teditorBracketHighlightingForeground2,\n\t\teditorBracketHighlightingForeground3,\n\t\teditorBracketHighlightingForeground4,\n\t\teditorBracketHighlightingForeground5,\n\t\teditorBracketHighlightingForeground6\n\t];\n\tconst colorProvider = new ColorProvider();\n\n\tcollector.addRule(`.monaco-editor .${colorProvider.unexpectedClosingBracketClassName} { color: ${theme.getColor(editorBracketHighlightingUnexpectedBracketForeground)}; }`);\n\n\tconst colorValues = colors\n\t\t.map(c => theme.getColor(c))\n\t\t.filter((c): c is Color => !!c)\n\t\t.filter(c => !c.isTransparent());\n\n\tfor (let level = 0; level < 30; level++) {\n\t\tconst color = colorValues[level % colorValues.length];\n\t\tcollector.addRule(`.monaco-editor .${colorProvider.getInlineClassNameOfLevel(level)} { color: ${color}; }`);\n\t}\n});\n"]}