{"version":3,"sources":["file:///workspace/appflow/src/vs/editor/common/services/textResourceConfigurationService.ts"],"names":[],"mappings":"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","file":"textResourceConfigurationService.js","sourceRoot":"file:///workspace/appflow/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { IPosition, Position } from 'vs/editor/common/core/position';\nimport { ILanguageService } from 'vs/editor/common/languages/language';\nimport { IModelService } from 'vs/editor/common/services/model';\nimport { ITextResourceConfigurationService, ITextResourceConfigurationChangeEvent } from 'vs/editor/common/services/textResourceConfiguration';\nimport { IConfigurationService, ConfigurationTarget, IConfigurationValue, IConfigurationChangeEvent } from 'vs/platform/configuration/common/configuration';\n\nexport class TextResourceConfigurationService extends Disposable implements ITextResourceConfigurationService {\n\n\tpublic _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeConfiguration: Emitter<ITextResourceConfigurationChangeEvent> = this._register(new Emitter<ITextResourceConfigurationChangeEvent>());\n\tpublic readonly onDidChangeConfiguration: Event<ITextResourceConfigurationChangeEvent> = this._onDidChangeConfiguration.event;\n\n\tconstructor(\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IModelService private readonly modelService: IModelService,\n\t\t@ILanguageService private readonly languageService: ILanguageService,\n\t) {\n\t\tsuper();\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => this._onDidChangeConfiguration.fire(this.toResourceConfigurationChangeEvent(e))));\n\t}\n\n\tgetValue<T>(resource: URI | undefined, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, at?: IPosition, section?: string): T;\n\tgetValue<T>(resource: URI | undefined, arg2?: any, arg3?: any): T {\n\t\tif (typeof arg3 === 'string') {\n\t\t\treturn this._getValue(resource, Position.isIPosition(arg2) ? arg2 : null, arg3);\n\t\t}\n\t\treturn this._getValue(resource, null, typeof arg2 === 'string' ? arg2 : undefined);\n\t}\n\n\tupdateValue(resource: URI, key: string, value: any, configurationTarget?: ConfigurationTarget): Promise<void> {\n\t\tconst language = this.getLanguage(resource, null);\n\t\tconst configurationValue = this.configurationService.inspect(key, { resource, overrideIdentifier: language });\n\t\tif (configurationTarget === undefined) {\n\t\t\tconfigurationTarget = this.deriveConfigurationTarget(configurationValue, language);\n\t\t}\n\t\tswitch (configurationTarget) {\n\t\t\tcase ConfigurationTarget.MEMORY:\n\t\t\t\treturn this._updateValue(key, value, configurationTarget, configurationValue.memory?.override, resource, language);\n\t\t\tcase ConfigurationTarget.WORKSPACE_FOLDER:\n\t\t\t\treturn this._updateValue(key, value, configurationTarget, configurationValue.workspaceFolder?.override, resource, language);\n\t\t\tcase ConfigurationTarget.WORKSPACE:\n\t\t\t\treturn this._updateValue(key, value, configurationTarget, configurationValue.workspace?.override, resource, language);\n\t\t\tcase ConfigurationTarget.USER_REMOTE:\n\t\t\t\treturn this._updateValue(key, value, configurationTarget, configurationValue.userRemote?.override, resource, language);\n\t\t\tdefault:\n\t\t\t\treturn this._updateValue(key, value, configurationTarget, configurationValue.userLocal?.override, resource, language);\n\t\t}\n\t}\n\n\tprivate _updateValue(key: string, value: any, configurationTarget: ConfigurationTarget, overriddenValue: any | undefined, resource: URI, language: string | null): Promise<void> {\n\t\tif (language && overriddenValue !== undefined) {\n\t\t\treturn this.configurationService.updateValue(key, value, { resource, overrideIdentifier: language }, configurationTarget);\n\t\t} else {\n\t\t\treturn this.configurationService.updateValue(key, value, { resource }, configurationTarget);\n\t\t}\n\t}\n\n\tprivate deriveConfigurationTarget(configurationValue: IConfigurationValue<any>, language: string | null): ConfigurationTarget {\n\t\tif (language) {\n\t\t\tif (configurationValue.memory?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t\t}\n\t\t\tif (configurationValue.workspaceFolder?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t\t}\n\t\t\tif (configurationValue.workspace?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t\t}\n\t\t\tif (configurationValue.userRemote?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t\t}\n\t\t\tif (configurationValue.userLocal?.override !== undefined) {\n\t\t\t\treturn ConfigurationTarget.USER_LOCAL;\n\t\t\t}\n\t\t}\n\t\tif (configurationValue.memory?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.MEMORY;\n\t\t}\n\t\tif (configurationValue.workspaceFolder?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE_FOLDER;\n\t\t}\n\t\tif (configurationValue.workspace?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.WORKSPACE;\n\t\t}\n\t\tif (configurationValue.userRemote?.value !== undefined) {\n\t\t\treturn ConfigurationTarget.USER_REMOTE;\n\t\t}\n\t\treturn ConfigurationTarget.USER_LOCAL;\n\t}\n\n\tprivate _getValue<T>(resource: URI | undefined, position: IPosition | null, section: string | undefined): T {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\tif (typeof section === 'undefined') {\n\t\t\treturn this.configurationService.getValue<T>({ resource, overrideIdentifier: language });\n\t\t}\n\t\treturn this.configurationService.getValue<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tinspect<T>(resource: URI | undefined, position: IPosition | null, section: string): IConfigurationValue<Readonly<T>> {\n\t\tconst language = resource ? this.getLanguage(resource, position) : undefined;\n\t\treturn this.configurationService.inspect<T>(section, { resource, overrideIdentifier: language });\n\t}\n\n\tprivate getLanguage(resource: URI, position: IPosition | null): string | null {\n\t\tconst model = this.modelService.getModel(resource);\n\t\tif (model) {\n\t\t\treturn position ? model.getLanguageIdAtPosition(position.lineNumber, position.column) : model.getLanguageId();\n\t\t}\n\t\treturn this.languageService.guessLanguageIdByFilepathOrFirstLine(resource);\n\t}\n\n\tprivate toResourceConfigurationChangeEvent(configurationChangeEvent: IConfigurationChangeEvent): ITextResourceConfigurationChangeEvent {\n\t\treturn {\n\t\t\taffectedKeys: configurationChangeEvent.affectedKeys,\n\t\t\taffectsConfiguration: (resource: URI | undefined, configuration: string) => {\n\t\t\t\tconst overrideIdentifier = resource ? this.getLanguage(resource, null) : undefined;\n\t\t\t\treturn configurationChangeEvent.affectsConfiguration(configuration, { resource, overrideIdentifier });\n\t\t\t}\n\t\t};\n\t}\n}\n"]}